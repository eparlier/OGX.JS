if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.Window=function(n){"use strict";function i(){var n=l();$(A.container).append(n),y.el=u=$(A.container).find(".ogx_window:last");var i=u.find(".ogx_view:first"),o=u.height()-i.position().top;i.height(o)}function o(n,i){var o;return i.indexOf("%")!==-1?(o=i.split("%"),o=parseInt(o[0]),o=Math.round(o*$(window)[n]()/100)):(o=i.split("px"),o=parseInt(o[0])),o}function t(n){return n.hasOwnProperty("originalEvent")?n.originalEvent.changedTouches[0]:n}function e(n){n?u.on(f,function(n){n=t(n),W=n.pageX,M=n.pageY,X=0,v=0,D=0,u.css("transition","none"),x||(x=u.position().left,G=u.position().top),a(!0),$("body").on(m,function(n){n.preventDefault(),n.stopImmediatePropagation(),n=t(n),D||!X&&!v||(D=Math.abs(n.pageX-W)>Math.abs(n.pageY-M)?"x":"y"),X=n.pageX-W,v=n.pageY-M}),$("body").on(O,function(n){if(a(!1),$("body").off(m),$("body").off(O),n=t(n),I=Math.abs(x-X),T=Math.abs(G-v),y.anim===OGX.Window.ANIM_RIGHT||y.anim===OGX.Window.ANIM_LEFT){if(T<I)if(y.anim===OGX.Window.ANIM_RIGHT){if(Math.abs(X)>A.drag_min_x)return void A.core.hideWindow(A.name,A)}else if(y.anim===OGX.Window.ANIM_LEFT&&x>X)return void A.core.hideWindow(A.name,A);u.on("transitionend",function(){u.off("transitionend"),u.css("transition","none")}),I&&u.css("transition","all "+Math.round(X*A.win_anim_in_time/u.width())+"ms"),u.css({transform:"translate3D("+x+"px, 0px, 0px)"})}else if(y.anim===OGX.Window.ANIM_BOTTOM||y.anim===OGX.Window.ANIM_TOP){if(T>I)if(y.anim===OGX.Window.ANIM_BOTTOM){if(v>A.drag_min_y&&M<n.pageY)return void A.core.hideWindow(A.name,A)}else if(y.anim===OGX.Window.ANIM_TOP&&G>v&&Math.abs(v)>A.drag_min_y)return void A.core.hideWindow(A.name,A);u.on("transitionend",function(){u.off("transitionend"),u.css("transition","none")}),T&&u.css("transition","all "+Math.round(v*A.win_anim_in_time/u.height())+"ms"),u.css({transform:"translate3D(0px, "+G+"px, 0px)"})}x=!1})}):u.off(f)}function a(n){n?p||(p=setInterval(d,10)):p&&(clearInterval(p),p=!1)}function d(){"x"!==D||y.anim!==OGX.Window.ANIM_RIGHT&&y.anim!==OGX.Window.ANIM_LEFT?"y"!==D||y.anim!==OGX.Window.ANIM_BOTTOM&&y.anim!==OGX.Window.ANIM_TOP||y.anim&&(y.anim===OGX.Window.ANIM_BOTTOM?v>0&&u.css({transform:"translate3D(0px, "+(G+v)+"px, 0px)"}):y.anim===OGX.Window.ANIM_TOP&&v<0&&u.css({transform:"translate3D(0px, "+v+"px, 0px)"})):Math.abs(G-v)<Math.abs(x-X)&&y.anim&&(y.anim===OGX.Window.ANIM_RIGHT?x+X+y.el.outerWidth()>$(window).width()&&u.css({transform:"translate3D("+(x+X)+"px, 0px, 0px)"}):y.anim===OGX.Window.ANIM_LEFT&&x>X&&u.css({transform:"translate3D("+X+"px, 0px, 0px)"}))}function s(n){n?u.on("click",".ogx_window_main_icon",function(){A.core.hideWindow(A)}):u.off("click",".ogx_window_main_icon")}function r(n){n?u.on("click",".ogx_window_icon",function(){u.trigger(OGX.Window.HIT_ICON,{index:$(this).index()})}):u.off("click",".ogx_window_icon")}function w(n){n?window.addEventListener("resize",y.update):window.removeEventListener("resize",y.update)}function l(){var n={};n.w=o("width",A.width)+"px",n.h=o("height",A.height)+"px",n.style=A.style,n.title=A.title,n.css=A.css,n.icons=A.icons,n.html="",n.name=A.name,A.zindex&&(n.zindex="z-index:"+A.zindex+";"),A.html&&(n.html=A.html),A.template&&(n.html=OGX.Templater.getTemplate(A.template));var i=OGX.Templater.templatize(n,A.win_html);return i}function c(){for(var n in N)A.hasOwnProperty(n)||(A[n]=N[n]);switch(A.mode){case OGX.Window.MODE_MOBILE:f="touchstart",O="touchend",m="touchmove";break;case OGX.Window.MODE_DESKTOP:f="mousedown",O="mouseup",m="mousemove"}}function _(){if(c(),i(),g=y.el.find(".ogx_view:first"),A.scroll){if("undefined"==typeof OGX.Scroller)return void console.log("%c CRITICAL ERROR - OGX.Scroller not found! ","background:#222; color: #FF0000");if("undefined"==typeof OGX.Templater)return void console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000");E=y.el.find(".ogx_view:first"),h=new OGX.Scroller({container:E[0],init_delay:100,nartural_scroll:A.nartural_scroll}),E.on(OGX.Scroller.READY,function(){E.off(OGX.Scroller.READY),y.el.trigger(OGX.Window.READY),y.ready=!0;var n=h.getOuter(),i=$(window).height();A.style!==OGX.Window.STYLE_NONE&&(i-=y.el.find(".ogx_window_head:first").height()),$(n).css("height",i+"px"),g=h.getContainer()})}else y.ready=!0;A.icons.length>0&&r(!0),A.drag&&e(!0),s(!0),w(!0)}var f,O,m,h,g,p,u,x,G,X,v,W,M,I,T,E,y=this,A=n,N={style:OGX.Window.STYLE_BACK,mode:OGX.Window.MODE_MOBILE,icons:[],css:"",scroll:!1,nartural_scroll:!0,drag:!0,drag_min_x:100,drag_max_y:30,drag_min_y:100,width:"100%",height:"100%",title:"",win_html:'<div class="ogx_window ogx_hw {{$css}}" style="width:{{$w}}; height:{{$h}}; $zindex" data-ogx="{{$name}}"><div class="ogx_window_head ogx_window_head_{{$style}}"><span class="ogx_window_main_{{$style}} ogx_window_main_icon"></span><span class="ogx_window_title">{{$title}}</span><span class="ogx_window_icons">{{loop $icons <span class="ogx_window_icon" style="background-image:url(\'$icons.$\')"></span>}}</span></div><div class="ogx_view">{{$html}}</div></div>',html:!1,template:!1,win_anim_in_time:350,win_anim_out_time:350,zindex:!1},D=0;this.snooze=!1,this.scroll=A.scroll,this.views={},this.anim=null,this.el=null,this.status=OGX.Window.CLOSED,this.zindex=A.zindex,this.ready=!1,this.enableDrag=function(){A.drag||(A.drag=!0,e(!0))},this.disableDrag=function(){A.drag&&(A.drag=!1,e(!1))},this.addOverlay=function(n){var i="",o="";"undefined"==typeof n&&(n=!0,i="ogx_overlay_fade_in"),n||(o="opacity:1;");var t=u.find(".ogx_view:first");t.prepend('<div class="ogx_overlay '+i+'" style="'+o+'"></div>'),t.on(f,".ogx_overlay",function(n){n.preventDefault(),n.stopImmediatePropagation()}),A.mode===OGX.Window.MODE_DESKTOP&&t.on("mousewheel",function(n){n.preventDefault(),n.stopImmediatePropagation()})},this.removeOverlay=function(){var n=u.find(".ogx_view:first");n.off(f,".ogx_overlay"),A.mode===OGX.Window.MODE_DESKTOP&&n.off("mousewheel"),n.find(".ogx_overlay:first").remove()},this.update=function(){var n=o("width",A.width),i=o("height",A.height);u.css("width",n).css("height",i);var t=u.find(".ogx_view:first");i=u.height()-t.position().top,t.height(i),A.scroll&&h.update()},this.updateScroll=function(){return!!A.scroll&&(h.update(),!0)},this.getTiming=function(){return{in:A.win_anim_in_time,out:A.win_anim_out_time}},this.getContainer=function(){return g},this.swapIcon=function(n,i){A.icons[n]=i,y.el.find(".ogx_window_icons").find(".ogx_window_icon:eq("+String(n)+")").css("background-image",i)},this.destroy=function(){E&&E.off(OGX.Scroller.READY),A.scroll&&h.destroy(),A.icons.length&&r(!1),w(!1),A.drag&&e(!1),s(!1),a(!1)},_()},OGX.Window=function(n){"use strict";return new OGX.prototype.Window(n)},OGX.Window.READY="windowReady",OGX.Window.ANIM_LEFT="windowAnimLeft",OGX.Window.ANIM_RIGHT="windowAnimRight",OGX.Window.ANIM_TOP="windowAnimTop",OGX.Window.ANIM_BOTTOM="windowAnimBottom",OGX.Window.ANIM_NONE="windowAnimNone",OGX.Window.STYLE_BACK="icon_back",OGX.Window.STYLE_CLOSE="icon_close",OGX.Window.STYLE_NONE="none",OGX.Window.CLOSE="windowClose",OGX.Window.CLOSED="windowClosed",OGX.Window.OPEN="windowOpen",OGX.Window.OPENED="windowOpened",OGX.Window.HIT_ICON="windowHitIcon",OGX.Window.MODE_DESKTOP="modeDesktop",OGX.Window.MODE_MOBILE="modeMobile";