if(void 0===OGX)var OGX=function(){};OGX.Window=function(n){"use strict";var e,i,o,t,a,d,s,r,w,l,c,_,f,m,O,h,g=this,u=n,p={style:OGX.Window.STYLE_BACK,mode:OGX.Window.MODE_MOBILE,icons:[],css:"",scroll:!1,natural_scroll:!0,drag:!0,drag_min_x:100,drag_max_y:30,drag_min_y:100,width:"100%",height:"100%",title:"",win_html:'<div class="ogx_window ogx_hw {{$css}}" style="width:{{$w}}; height:{{$h}}; {{$zindex}}" data-ogx="{{$name}}"><div class="ogx_window_head ogx_window_head_{{$style}}"><span class="ogx_window_main_{{$style}} ogx_window_main_icon"></span><span class="ogx_window_title">{{$title}}</span><span class="ogx_window_icons">{{loop $icons <span class="ogx_window_icon" style="background-image:url(\'$icons.$\')"></span>}}</span></div><div class="ogx_view">{{$html}}</div></div>',html:!1,template:!1,win_anim_in_time:350,win_anim_out_time:350,zindex:!1},x=0;function G(){var n=function(){var n={};n.w=v("width",u.width)+"px",n.h=v("height",u.height)+"px",n.style=u.style,n.title=u.title,n.css=u.css,n.icons=u.icons,n.html="",n.name=u.name,u.zindex?n.zindex="z-index:"+u.zindex+";":n.zindex="";u.html&&(n.html=u.html);u.template&&(n.html=OGX.Templater.getTemplate(u.template));return OGX.Templater.templatize(n,u.win_html)}();$(u.container).append(n),g.el=s=$(u.container).find(".ogx_window:last");var i=s.find(".ogx_view:first"),o=s.height()-i.position().top;i.height(o)}function v(n,i){var o;return-1!==i.indexOf("%")?(o=i.split("%"),o=parseInt(o[0]),o=Math.round(o*$(window)[n]()/100)):(o=i.split("px"),o=parseInt(o[0])),o}function X(n){return n.hasOwnProperty("originalEvent")?n.originalEvent.changedTouches[0]:n}function W(n){n?s.on(e,function(n){n=X(n),_=n.pageX,f=n.pageY,x=c=l=0,s.css("transition","none"),r||(r=s.position().left,w=s.position().top),M(!0),$("body").on(o,function(n){n.preventDefault(),n.stopImmediatePropagation(),n=X(n),x||!l&&!c||(x=Math.abs(n.pageX-_)>Math.abs(n.pageY-f)?"x":"y"),l=n.pageX-_,c=n.pageY-f}),$("body").on(i,function(n){if(M(!1),$("body").off(o),$("body").off(i),n=X(n),m=Math.abs(r-l),O=Math.abs(w-c),g.anim===OGX.Window.ANIM_RIGHT||g.anim===OGX.Window.ANIM_LEFT){if(O<m)if(g.anim===OGX.Window.ANIM_RIGHT){if(Math.abs(l)>u.drag_min_x)return void u.core.hideWindow(u.name,u)}else if(g.anim===OGX.Window.ANIM_LEFT&&l<r)return void u.core.hideWindow(u.name,u);s.on("transitionend",function(){s.off("transitionend"),s.css("transition","none")}),m&&s.css("transition","all "+Math.round(l*u.win_anim_in_time/s.width())+"ms"),s.css({transform:"translate3D("+r+"px, 0px, 0px)"})}else if(g.anim===OGX.Window.ANIM_BOTTOM||g.anim===OGX.Window.ANIM_TOP){if(m<O)if(g.anim===OGX.Window.ANIM_BOTTOM){if(c>u.drag_min_y&&f<n.pageY)return void u.core.hideWindow(u.name,u)}else if(g.anim===OGX.Window.ANIM_TOP&&c<w&&Math.abs(c)>u.drag_min_y)return void u.core.hideWindow(u.name,u);s.on("transitionend",function(){s.off("transitionend"),s.css("transition","none")}),O&&s.css("transition","all "+Math.round(c*u.win_anim_in_time/s.height())+"ms"),s.css({transform:"translate3D(0px, "+w+"px, 0px)"})}r=!1})}):s.off(e)}function M(n){n?d||(d=setInterval(I,10)):d&&(clearInterval(d),d=!1)}function I(){"x"!==x||g.anim!==OGX.Window.ANIM_RIGHT&&g.anim!==OGX.Window.ANIM_LEFT?"y"!==x||g.anim!==OGX.Window.ANIM_BOTTOM&&g.anim!==OGX.Window.ANIM_TOP||g.anim&&(g.anim===OGX.Window.ANIM_BOTTOM?0<c&&s.css({transform:"translate3D(0px, "+(w+c)+"px, 0px)"}):g.anim===OGX.Window.ANIM_TOP&&c<0&&s.css({transform:"translate3D(0px, "+c+"px, 0px)"})):Math.abs(w-c)<Math.abs(r-l)&&g.anim&&(g.anim===OGX.Window.ANIM_RIGHT?r+l+g.el.outerWidth()>$(window).width()&&s.css({transform:"translate3D("+(r+l)+"px, 0px, 0px)"}):g.anim===OGX.Window.ANIM_LEFT&&l<r&&s.css({transform:"translate3D("+l+"px, 0px, 0px)"}))}function T(n){n?s.on("click",".ogx_window_main_icon",function(){u.core.hideWindow(u)}):s.off("click",".ogx_window_main_icon")}function E(n){n?s.on("click",".ogx_window_icon",function(){s.trigger(OGX.Window.HIT_ICON,{index:$(this).index()})}):s.off("click",".ogx_window_icon")}function y(n){n?window.addEventListener("resize",g.update):window.removeEventListener("resize",g.update)}this.snooze=!1,this.scroll=u.scroll,this.views={},this.anim=null,this.el=null,this.status=OGX.Window.CLOSED,this.zindex=u.zindex,this.ready=!1,this.enableDrag=function(){u.drag||W(u.drag=!0)},this.disableDrag=function(){u.drag&&W(u.drag=!1)},this.addOverlay=function(n){var i="",o="";void 0===n&&(n=!0,i="ogx_overlay_fade_in"),n||(o="opacity:1;");var t=s.find(".ogx_view:first");t.prepend('<div class="ogx_overlay '+i+'" style="'+o+'"></div>'),t.on(e,".ogx_overlay",function(n){n.preventDefault(),n.stopImmediatePropagation()}),u.mode===OGX.Window.MODE_DESKTOP&&t.on("mousewheel",function(n){n.preventDefault(),n.stopImmediatePropagation()})},this.removeOverlay=function(){var n=s.find(".ogx_view:first");n.off(e,".ogx_overlay"),u.mode===OGX.Window.MODE_DESKTOP&&n.off("mousewheel"),n.find(".ogx_overlay:first").remove()},this.update=function(){var n=v("width",u.width),i=v("height",u.height);s.css("width",n).css("height",i);var o=s.find(".ogx_view:first");i=s.height()-o.position().top,o.height(i),u.scroll&&t.update()},this.updateScroll=function(){return!!u.scroll&&(t.update(),!0)},this.getTiming=function(){return{in:u.win_anim_in_time,out:u.win_anim_out_time}},this.getContainer=function(){return a},this.swapIcon=function(n,i){u.icons[n]=i,g.el.find(".ogx_window_icons").find(".ogx_window_icon:eq("+String(n)+")").css("background-image",i)},this.destroy=function(){h&&h.off(OGX.Scroller.READY),u.scroll&&t.destroy(),u.icons.length&&E(!1),y(!1),u.drag&&W(!1),T(!1),M(!1)},function(){if(function(){for(var n in p)u.hasOwnProperty(n)||(u[n]=p[n]);switch(u.mode){case OGX.Window.MODE_MOBILE:e="touchstart",i="touchend",o="touchmove";break;case OGX.Window.MODE_DESKTOP:e="mousedown",i="mouseup",o="mousemove"}}(),G(),a=g.el.find(".ogx_view:first"),u.scroll){if(void 0===OGX.Scroller)return console.log("%c CRITICAL ERROR - OGX.Scroller not found! ","background:#222; color: #FF0000");if(void 0===OGX.Templater)return console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000");h=g.el.find(".ogx_view:first"),t=new OGX.Scroller({container:h[0],init_delay:100,natural_scroll:u.natural_scroll}),h.on(OGX.Scroller.READY,function(){h.off(OGX.Scroller.READY),g.el.trigger(OGX.Window.READY),g.ready=!0;var n=t.getOuter(),i=$(window).height();u.style!==OGX.Window.STYLE_NONE&&(i-=g.el.find(".ogx_window_head:first").height()),$(n).css("height",i+"px"),a=t.getContainer()})}else g.ready=!0;0<u.icons.length&&E(!0),u.drag&&W(!0),T(!0),y(!0)}()},OGX.Window.READY="windowReady",OGX.Window.ANIM_LEFT="windowAnimLeft",OGX.Window.ANIM_RIGHT="windowAnimRight",OGX.Window.ANIM_TOP="windowAnimTop",OGX.Window.ANIM_BOTTOM="windowAnimBottom",OGX.Window.ANIM_NONE="windowAnimNone",OGX.Window.STYLE_BACK="icon_back",OGX.Window.STYLE_CLOSE="icon_close",OGX.Window.STYLE_NONE="none",OGX.Window.CLOSE="windowClose",OGX.Window.CLOSED="windowClosed",OGX.Window.OPEN="windowOpen",OGX.Window.OPENED="windowOpened",OGX.Window.HIT_ICON="windowHitIcon",OGX.Window.MODE_DESKTOP="modeDesktop",OGX.Window.MODE_MOBILE="modeMobile";