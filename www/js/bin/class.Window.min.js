if(void 0===OGX)var OGX=function(){};OGX.Window=function(n){"use strict";var t,o,i,e,a,d,r,s,l,c,w,_,h,f=this,g=n,m={name:"",style:OGX.Window.STYLE_BACK,icons:[],css:"",scroll:!1,natural_scroll:!0,drag:!0,dragable:!0,overlay:!1,blur:!0,drag_min_x:100,drag_max_y:30,drag_min_y:100,width:"100%",height:"100%",title:"",win_html:'<div class="ogx_window ogx_hw {{$css}}" style="width:{{$w}}; height:{{$h}}; {{$zindex}}" data-ogx="{{$name}}"><div class="ogx_window_head ogx_window_head_{{$style}}"><span class="ogx_window_main_{{$style}} ogx_window_main_icon"></span><span class="ogx_window_title">{{$title}}</span><span class="ogx_window_icons">{{loop $icons <span class="ogx_window_icon" style="background-image:url(\'$icons.$\')"></span>}}</span></div><div class="ogx_view">{{$html}}</div></div>',html:!1,template:!1,win_anim_in_time:350,win_anim_out_time:350,zindex:!1},u="mousedown",O="mouseup",p="mousemove",x=0;function v(){var n=function(){var n={};n.w=W("width",g.width)+"px",n.h=W("height",g.height)+"px",n.style=g.style,n.title=g.title,n.css=g.css,n.icons=g.icons,n.html="",n.name=g.name,g.zindex?n.zindex="z-index:"+g.zindex+";":n.zindex="";g.html&&(n.html=g.html);g.template&&(n.html=OGX.Templater.getTemplate(g.template));return OGX.Templater.templatize(n,g.win_html)}();$(g.container).append(n),f.el=e=$(g.container).find(".ogx_window:last");var i=e.find(".ogx_view:first"),o=e.height()-i.position().top;i.height(o)}function W(n,i){var o;return-1!==i.indexOf("%")?(o=i.split("%"),o=parseInt(o[0]),o=Math.round(o*$(window)[n]()/100)):(o=i.split("px"),o=parseInt(o[0])),o}function G(n){n?e.on(u,function(n){n=E(n),l=n.pageX,c=n.pageY,x=s=r=0,e.css("transition","none"),a||(a=e.position().left,d=e.position().top),X(!0),$("body").on(p,function(n){n.preventDefault(),n.stopImmediatePropagation(),n=E(n),x||!r&&!s||(x=Math.abs(n.pageX-l)>Math.abs(n.pageY-c)?"x":"y"),r=n.pageX-l,s=n.pageY-c}),$("body").on(O,function(n){if(n=E(n),X(!1),$("body").off(p),$("body").off(O),w=Math.abs(a-r),_=Math.abs(d-s),f.anim===OGX.Window.ANIM_RIGHT||f.anim===OGX.Window.ANIM_LEFT){if(_<w)if(f.anim===OGX.Window.ANIM_RIGHT){if(Math.abs(r)>g.drag_min_x)return void g.core.hideWindow(g.name,g)}else if(f.anim===OGX.Window.ANIM_LEFT&&r<a)return void g.core.hideWindow(g.name,g);e.on("transitionend",function(){e.off("transitionend"),e.css("transition","none")}),w&&e.css("transition","all "+Math.round(r*g.win_anim_in_time/e.width())+"ms"),e.css({transform:"translate3D("+a+"px, 0px, 0px)"})}else if(f.anim===OGX.Window.ANIM_BOTTOM||f.anim===OGX.Window.ANIM_TOP){if(w<_)if(f.anim===OGX.Window.ANIM_BOTTOM){if(s>g.drag_min_y&&c<n.pageY)return void g.core.hideWindow(g.name,g)}else if(f.anim===OGX.Window.ANIM_TOP&&s<d&&Math.abs(s)>g.drag_min_y)return void g.core.hideWindow(g.name,g);e.on("transitionend",function(){e.off("transitionend"),e.css("transition","none")}),_&&e.css("transition","all "+Math.round(s*g.win_anim_in_time/e.height())+"ms"),e.css({transform:"translate3D(0px, "+d+"px, 0px)"})}a=!1})}):e.off(u)}function X(n){n?i||(i=setInterval(T,10)):i&&(clearInterval(i),i=!1)}function T(){"x"!==x||f.anim!==OGX.Window.ANIM_RIGHT&&f.anim!==OGX.Window.ANIM_LEFT?"y"!==x||f.anim!==OGX.Window.ANIM_BOTTOM&&f.anim!==OGX.Window.ANIM_TOP||f.anim&&(f.anim===OGX.Window.ANIM_BOTTOM?0<s&&e.css({transform:"translate3D(0px, "+(d+s)+"px, 0px)"}):f.anim===OGX.Window.ANIM_TOP&&s<0&&e.css({transform:"translate3D(0px, "+s+"px, 0px)"})):Math.abs(d-s)<Math.abs(a-r)&&f.anim&&(f.anim===OGX.Window.ANIM_RIGHT?a+r+f.el.outerWidth()>$(window).width()&&e.css({transform:"translate3D("+(a+r)+"px, 0px, 0px)"}):f.anim===OGX.Window.ANIM_LEFT&&r<a&&e.css({transform:"translate3D("+r+"px, 0px, 0px)"}))}function I(n){n?e.on("click",".ogx_window_main_icon",function(){g.core.hideWindow(g)}):e.off("click",".ogx_window_main_icon")}function M(n){n?e.on("click",".ogx_window_icon",function(){e.trigger(OGX.Window.HIT_ICON,{index:$(this).index(),window:g.name})}):e.off("click",".ogx_window_icon")}function y(n){n?window.addEventListener("resize",f.update):window.removeEventListener("resize",f.update)}function E(n){return n.hasOwnProperty("originalEvent")&&void 0!==n.originalEvent.changedTouches?n.originalEvent.changedTouches[0]:n}this._NAME_=OGX.Window.NAME,this.snooze=!1,this.blurred=!1,this.blur=!1,this.scroll=!1,this.views={},this.anim=null,this.el=null,this.status=OGX.Window.CLOSED,this.zindex=g.zindex,this.ready=!1,this.getName=function(){return g.name},this.enableDrag=function(){g.dragable&&!g.drag&&G(g.drag=!0)},this.disableDrag=function(){g.dragable&&g.drag&&G(g.drag=!1)},this.isDragable=function(){return g.dragable},this.addOverlay=function(n){var i="",o="";void 0===n&&(n=!0,i="ogx_overlay_fade_in"),n||(o="opacity:1;");var t=e.find(".ogx_view:first");t.prepend('<div class="ogx_overlay '+i+'" style="'+o+'"></div>'),t.on(u,".ogx_overlay",function(n){n.preventDefault(),n.stopImmediatePropagation()}),g.mode===OGX.Window.MODE_DESKTOP&&t.on("mousewheel",function(n){n.preventDefault(),n.stopImmediatePropagation()})},this.removeOverlay=function(){var n=e.find(".ogx_view:first");n.off(u,".ogx_overlay"),g.mode===OGX.Window.MODE_DESKTOP&&n.off("mousewheel"),n.find(".ogx_overlay:first").remove()},this.update=function(){var n=W("width",g.width),i=W("height",g.height);e.css("width",n).css("height",i);var o=e.find(".ogx_view:first");i=e.height()-o.position().top,o.height(i),g.scroll&&t.update()},this.updateScroll=function(){return!!g.scroll&&(t.update(),!0)},this.getTiming=function(){return{in:g.win_anim_in_time,out:g.win_anim_out_time}},this.getContainer=function(){return o},this.swapIcon=function(n,i){g.icons[n]=i,f.el.find(".ogx_window_icons").find(".ogx_window_icon:eq("+String(n)+")").css("background-image",i)},this.destroy=function(){h&&h.off(OGX.Scroller.READY),g.scroll&&t.destroy(),g.icons.length&&M(!1),y(!1),g.drag&&G(!1),I(!1),X(!1)},function(){if(function(){for(var n in m)g.hasOwnProperty(n)||(g[n]=m[n]);g.drag&&(g.dragable=!0),f.blur=g.blur,f.scroll=g.scroll,void 0!==window.ontouchstart&&(u="touchstart",p="touchmove",O="touchend")}(),v(),o=f.el.find(".ogx_view:first"),g.scroll){if(void 0===OGX.Scroller)return console.log("%c CRITICAL ERROR - OGX.Scroller not found! ","background:#222; color: #FF0000");if(void 0===OGX.Templater)return console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000");h=f.el.find(".ogx_view:first"),t=new OGX.Scroller({container:h[0],init_delay:100,natural_scroll:g.natural_scroll}),h.on(OGX.Scroller.READY,function(){h.off(OGX.Scroller.READY),f.el.trigger(OGX.Window.READY),f.ready=!0;var n=t.getOuter(),i=$(window).height();g.style!==OGX.Window.STYLE_NONE&&(i-=f.el.find(".ogx_window_head:first").height()),$(n).css("height",i+"px"),o=t.getContainer()})}else f.ready=!0;0<g.icons.length&&M(!0),g.drag&&G(!0),g.overlay&&f.addOverlay(),I(!0),y(!0)}()},OGX.Window.NAME="OgxWindow",OGX.Window.READY="WindowReady",OGX.Window.ANIM_LEFT="WindowAnimLeft",OGX.Window.ANIM_RIGHT="WindowAnimRight",OGX.Window.ANIM_TOP="WindowAnimTop",OGX.Window.ANIM_BOTTOM="WindowAnimBottom",OGX.Window.ANIM_NONE="WindowAnimNone",OGX.Window.STYLE_BACK="icon_back",OGX.Window.STYLE_CLOSE="icon_close",OGX.Window.STYLE_NONE="none",OGX.Window.CLOSE="WindowClose",OGX.Window.CLOSED="WindowClosed",OGX.Window.OPEN="WindowOpen",OGX.Window.OPENED="WindowOpened",OGX.Window.HIT_ICON="WindowHitIcon";