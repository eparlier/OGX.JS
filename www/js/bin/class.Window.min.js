if(void 0===OGX)var OGX=function(){};OGX.Window=function(n){"use strict";var o,e,i,t,a,d,r,s,l,c,w,_,m,g=this,O=n,f={name:"",style:OGX.Window.STYLE_BACK,icons:[],css:"",scroll:!1,drag:!0,dragable:!0,overlay:!1,blur:!0,drag_min_x:100,drag_max_y:30,drag_min_y:100,width:"100%",height:"100%",title:"",win_html:'<div class="ogx_window ogx_hw {{$css}}" style="width:{{$w}}; height:{{$h}}; {{$zindex}}" data-ogx="{{$name}}"><div class="ogx_window_head ogx_window_head_{{$style}} ogx_window_head_{{$side}}">$INNER</div><div class="ogx_view">{{$html}}</div></div>',win_inner:['<span class="ogx_window_main_{{$style}} ogx_window_main_icon"></span>','<span class="ogx_window_title">{{$title}}</span>','<span class="ogx_window_icons">{{loop $icons <span class="ogx_window_icon" style="background-image:url($icons.$)"></span>}}</span>'],html:!1,template:!1,win_anim_in_time:350,win_anim_out_time:350,zindex:!1},u="mousedown",h="mouseup",p="mousemove",G=0;function W(){var n=function(){var n={};n.w=O.width,n.h=O.height,n.style=O.style,n.title=O.title,n.css=O.css,n.icons=O.icons,n.html="",n.name=O.name,O.zindex?n.zindex="z-index:"+O.zindex+";":n.zindex="";O.html&&(n.html=O.html);O.template&&(n.html=OGX.Templater.getTemplate(O.template));var i,o=O.win_html;switch(O.anim){case OGX.Window.ANIM_RIGHT:case OGX.Window.ANIM_TOP:case OGX.Window.ANIM_BOTTOM:i=O.win_inner,n.side="right";break;case OGX.Window.ANIM_LEFT:i=O.win_inner.reverse(),n.side="left"}return i=i.toString().replace(/>,</g,"><"),o=o.replace("$INNER",i),OGX.Templater.templatize(n,o)}();$(O.container).append(n),g.el=t=$(O.container).find(".ogx_window:last")}function x(n){n?t.on(u,function(n){n=M(n),l=n.pageX,c=n.pageY,G=s=r=0,t.css("transition","none"),a||(a=t.position().left,d=t.position().top),X(!0),$("body").on(p,function(n){n.preventDefault(),n.stopImmediatePropagation(),n=M(n),G||!r&&!s||(Math.abs(n.pageX-l)>Math.abs(n.pageY-c)?(G="x",O.scroll&&o.disable()):G="y"),r=n.pageX-l,s=n.pageY-c}),$("body").on(h,function(n){if(n=M(n),X(!1),$("body").off(p),$("body").off(h),w=Math.abs(a-r),_=Math.abs(d-s),g.anim===OGX.Window.ANIM_RIGHT||g.anim===OGX.Window.ANIM_LEFT){if(_<w)if(g.anim===OGX.Window.ANIM_RIGHT){if(Math.abs(r)>O.drag_min_x)return app.hideWindow(O.name,O),$(document).trigger(OGX.Window.CLOSING,O.name),void(O.scroll&&o.enable())}else if(g.anim===OGX.Window.ANIM_LEFT&&r<a)return app.hideWindow(O.name,O),$(document).trigger(OGX.Window.CLOSING,O.name),void(O.scroll&&o.enable());t.on("transitionend",function(){t.off("transitionend"),t.css("transition","none"),O.scroll&&o.enable()}),w&&t.css("transition","all "+Math.round(r*O.win_anim_in_time/t.width())+"ms"),t.css({transform:"translate3D("+a+"px, 0px, 0px)"})}else if(g.anim===OGX.Window.ANIM_BOTTOM||g.anim===OGX.Window.ANIM_TOP){if(w<_)if(g.anim===OGX.Window.ANIM_BOTTOM){if(s>O.drag_min_y&&c<n.pageY)return app.hideWindow(O.name,O),void $(document).trigger(OGX.Window.CLOSING,O.name)}else if(g.anim===OGX.Window.ANIM_TOP&&s<d&&Math.abs(s)>O.drag_min_y)return app.hideWindow(O.name,O),void $(document).trigger(OGX.Window.CLOSING,O.name);t.on("transitionend",function(){t.off("transitionend"),t.css("transition","none")}),_&&t.css("transition","all "+Math.round(s*O.win_anim_in_time/t.height())+"ms"),t.css({transform:"translate3D(0px, "+d+"px, 0px)"})}a=!1})}):t.off(u)}function X(n){n?i||(i=setInterval(v,10)):i&&(clearInterval(i),i=!1)}function v(){"x"!==G||g.anim!==OGX.Window.ANIM_RIGHT&&g.anim!==OGX.Window.ANIM_LEFT?"y"!==G||g.anim!==OGX.Window.ANIM_BOTTOM&&g.anim!==OGX.Window.ANIM_TOP||g.anim&&(g.anim===OGX.Window.ANIM_BOTTOM?0<s&&t.css({transform:"translate3D(0px, "+(d+s)+"px, 0px)"}):g.anim===OGX.Window.ANIM_TOP&&s<0&&t.css({transform:"translate3D(0px, "+s+"px, 0px)"})):Math.abs(d-s)<Math.abs(a-r)&&g.anim&&(g.anim===OGX.Window.ANIM_RIGHT?a+r+g.el.outerWidth()>$(window).width()&&t.css({transform:"translate3D("+(a+r)+"px, 0px, 0px)"}):g.anim===OGX.Window.ANIM_LEFT&&r<a&&t.css({transform:"translate3D("+r+"px, 0px, 0px)"}))}function I(n){n?t.on("click",".ogx_window_main_icon",function(){app.hideWindow(O.name,O)}):t.off("click",".ogx_window_main_icon")}function N(n){n?t.on("click",".ogx_window_icon",function(){t.trigger(OGX.Window.HIT_ICON,{index:$(this).index(),window:O.name})}):t.off("click",".ogx_window_icon")}function T(n){n?window.addEventListener("resize",g.update):window.removeEventListener("resize",g.update)}function M(n){return n.hasOwnProperty("originalEvent")&&void 0!==n.originalEvent.changedTouches?n.originalEvent.changedTouches[0]:n}this._NAME_=OGX.Window.NAME,this.snooze=!1,this.blurred=!1,this.blur=!1,this.scroll=!1,this.views={},this.anim=null,this.el=null,this.status=OGX.Window.CLOSED,this.zindex=O.zindex,this.ready=!1,this.getName=function(){return O.name},this.enableDrag=function(){O.dragable&&!O.drag&&x(O.drag=!0)},this.disableDrag=function(){O.dragable&&O.drag&&x(O.drag=!1)},this.isDragable=function(){return O.dragable},this.addOverlay=function(n){var i="",o="";void 0===n&&(n=!0,i="ogx_overlay_fade_in"),n||(o="opacity:1;");var e=t.find(".ogx_view:first");e.prepend('<div class="ogx_overlay '+i+'" style="'+o+'"></div>'),e.on(u,".ogx_overlay",function(n){n.preventDefault(),n.stopImmediatePropagation()}),O.mode===OGX.Window.MODE_DESKTOP&&e.on("mousewheel",function(n){n.preventDefault(),n.stopImmediatePropagation()})},this.removeOverlay=function(){var n=t.find(".ogx_view:first");n.off(u,".ogx_overlay"),O.mode===OGX.Window.MODE_DESKTOP&&n.off("mousewheel"),n.find(".ogx_overlay:first").remove()},this.update=function(){},this.updateScroll=function(){return!!O.scroll&&(o.update(),!0)},this.getTiming=function(){return{in:O.win_anim_in_time,out:O.win_anim_out_time}},this.getContainer=function(){return e},this.swapIcon=function(n,i){O.icons[n]=i,g.el.find(".ogx_window_icons").find(".ogx_window_icon:eq("+String(n)+")").css("background-image",i)},this.destroy=function(){m&&m.off(OGX.Scroller.READY),O.scroll&&o.destroy(),O.icons.length&&N(!1),T(!1),O.drag&&x(!1),I(!1),X(!1)},function(){if(function(){for(var n in f)O.hasOwnProperty(n)||(O[n]=f[n]);O.drag&&(O.dragable=!0),g.blur=O.blur,g.scroll=O.scroll,void 0!==window.ontouchstart&&(u="touchstart",p="touchmove",h="touchend")}(),W(),e=g.el.find(".ogx_view:first"),O.scroll){if(void 0===OGX.Scroller)return console.log("%c CRITICAL ERROR - OGX.Scroller not found! ","background:#222; color: #FF0000");if(void 0===OGX.Templater)return console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000");m=g.el.find(".ogx_view:first"),o=new OGX.Scroller({container:m[0],init_delay:100}),m.on(OGX.Scroller.READY,function(){m.off(OGX.Scroller.READY),g.el.trigger(OGX.Window.READY),g.ready=!0;var n=o.getOuter(),i=$(window).height();O.style!==OGX.Window.STYLE_NONE&&(i-=g.el.find(".ogx_window_head:first").height()),$(n).css("height",i+"px"),e=o.getContainer()})}else g.ready=!0;0<O.icons.length&&N(!0),O.drag&&x(!0),O.overlay&&g.addOverlay(),I(!0),T(!0)}()},OGX.Window.NAME="OgxWindow",OGX.Window.READY="WindowReady",OGX.Window.ANIM_LEFT="WindowAnimLeft",OGX.Window.ANIM_RIGHT="WindowAnimRight",OGX.Window.ANIM_TOP="WindowAnimTop",OGX.Window.ANIM_BOTTOM="WindowAnimBottom",OGX.Window.ANIM_NONE="WindowAnimNone",OGX.Window.STYLE_BACK="icon_back",OGX.Window.STYLE_CLOSE="icon_close",OGX.Window.STYLE_NONE="none",OGX.Window.CLOSING="WindowClosing",OGX.Window.CLOSED="WindowClosed",OGX.Window.OPENING="WindowOpening",OGX.Window.OPEN="WindowOpen",OGX.Window.HIT_ICON="WindowHitIcon";