if(void 0===OGX)var OGX=function(){};OGX.prototype.GroupedList=function(t){"use strict";var e,i,r,s,a,o=this,u=t,n={group_by:"name",group_mode:null,group_param:null,sort:null,template:"",css:"",enabled:!0,list:new OGX.List},c={};function l(t){var e,i=[];for(var r in t){e={title:u.group_mode?r:t[r][0].item[u.group_by],body:"",scopes:["public"],open:!0};for(var o=0;o<t[r].length;o++)e.body+='<span class="ogx_grouped_list_item '+u.css+'" data-id="'+t[r][o].pos+'">'+OGX.Templater.templatize(t[r][o].item,u.template)+"</span>";i.push(e)}return i}function d(t){t?o.el.on("click",".ogx_grouped_list_item",function(){o.el.find(".ogx_grouped_list_selected_item").removeClass("ogx_grouped_list_selected_item"),$(this).addClass("ogx_grouped_list_selected_item");var t=u.list[Number($(this).data("id"))];o.el.trigger(OGX.GroupedList.SELECT,t)}):o.el.off("click",".ogx_grouped_list_item")}function f(t){if("object"==typeof c[t]){switch(c[t].__proto__.constructor){case OGX.prototype.DynamicList:c[t].el.off(OGX.DynamicList.SELECT),c[t].el.off(OGX.DynamicList.UNSELECT);break;case OGX.prototype.TagManager:c[t].el.off(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED);break;case OGX.prototype.Switch:c[t].el.off(OGX.Switch.TOGGLE);break;case OGX.prototype.SwitchMulti:c[t].el.off(OGX.DynamicList.CHANGE);break;default:c[t].off("input")}u.list.removeFilter(t),delete c[t],s=u.list.filter(),a=!0,g()}return!0}function p(t,e){for(var i=c[t].getSelection(),r=[],o=0;o<i.length;o++)r.push(i[o][e]);return r}function g(){if(u.list){var t=u.list;return a&&(t=s),t=t.group(u.group_by,u.group_mode,u.group_param),i.setData(l(t)),!0}return!1}this.el=null,this.val=function(t){if(void 0===t)return u.list;t.hasOwnProperty("insert")?u.list=t:u.list=new OGX.List(t),r=u.list.group(u.group_by,u.group_mode,u.group_param),i.setData(l(r))},this.bind=function(t,e,i,r){return!c.hasOwnProperty(t)&&function(i,t,r,o){null==r&&(r=i);null==o&&(o="eqjson");if("object"==typeof t)switch((c[i]=t).__proto__.constructor){case OGX.prototype.DynamicList:u.list.removeFilter(i);var n=p(i,r);u.list.addFilter(i,o,n),c[i].el.on(OGX.DynamicList.SELECT,function(t,e){u.list.removeFilter(i),n=c[i].mode()===OGX.DynamicList.SELECT_MODE_SINGLE||c[i].mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?c[i].getSelection()[0][r]:p(i,r),u.list.addFilter(i,o,n),s=u.list.filter(),a=!0,g()}),c[i].el.on(OGX.DynamicList.UNSELECT,function(t,e){u.list.removeFilter(i),0<(n=c[i].mode()===OGX.DynamicList.SELECT_MODE_SINGLE||c[i].mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?[]:p(i,r)).length&&u.list.addFilter(i,o,n),s=u.list.filter(),a=!0,g()});break;case OGX.prototype.TagManager:u.list.removeFilter(i),u.list.addFilter(i,o,t.getCurrentTags()),c[i].el.on(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED,function(t,e){u.list.removeFilter(i),u.list.addFilter(i,o,c[i].getCurrentTags()),s=u.list.filter(),a=!0,g()});break;case OGX.prototype.Switch:u.list.removeFilter(i),u.list.addFilter(i,o,t.val()),c[i].el.on(OGX.Switch.TOGGLE,function(t,e){u.list.removeFilter(i),u.list.addFilter(i,o,e),s=u.list.filter(),a=!0,g()});break;case OGX.prototype.SwitchMulti:u.list.removeFilter(i),u.list.addFilter(i,o,t.val()),c[i].el.on(OGX.DynamicList.CHANGE,function(t,e){u.list.removeFilter(i),u.list.addFilter(i,o,e),s=u.list.filter(),a=!0,g()})}else if("string"==typeof t){if(0===$(t).length)return!1;var e;switch(c[i]=$(t),$(t).attr("type").toLowerCase()){case"text":case"number":case"email":case"password":c[i].on("input",function(){e=$(this).val(),u.list.removeFilter(i),e.length&&u.list.addFilter(i,o,e),s=u.list.filter(),a=!0,g()});break;case"range":var l;c[i].on("input",function(){l=Number($(this).attr("min")),u.list.removeFilter(i),u.list.addFilter(i,o,[l,$(this).val()]),s=u.list.filter(),a=!0,g()})}}}(t,e,i,r)},this.unbind=function(t){return!!c.hasOwnProperty(t)&&f(t)},this.filter=function(){s=u.list.filter(),a=!0,g()},this.unfilter=function(){a=!1,g()},this.addFilter=function(t,e,i){return u.list.addFilter(t,e,i)},this.removeFilter=function(t,e,i){return u.list.removeFilter(t,e,i)},this.resetFilters=function(){return u.list.resetFilters()},this.getFilters=function(){return u.list.getFilters()},this.enable=function(){u.enabled||(d(u.enabled=!0),i.enable())},this.disable=function(){u.enabled&&(d(u.enabled=!1),i.disable())},this.render=function(){return g()},this.refresh=function(){var t=o.el.find(".ogx_grouped_list_selected_item:first");if(0<t.length){var e=t.data("id");t.html(OGX.Templater.templatize(u.list[e],u.template))}},this.getNested=function(){return i||!1},this.destroy=function(){!function(){for(var t in c)f(t)}(),d(!1),i.destroy()},function(){if("undefined"!=typeof moment)if(void 0!==OGX.List)if(void 0!==OGX.Templater)if(void 0!==OGX.NestedList){!function(){for(var t in n)u.hasOwnProperty(t)||(u[t]=n[t]);0<u.list.length&&!u.list.hasOwnProperty("insert")&&(u.list=new OGX.List(u.list)),o.el=e=$(u.container),e.addClass("ogx_grouped_list")}();var t=l(r=u.list.group(u.group_by,u.group_mode,u.group_param));i=new OGX.NestedList({container:u.container,enabled:u.enabled,data:t}),u.enabled&&d(!0)}else console.log("%c CRITICAL ERROR - OGX.NestedList not found! ","background:#222; color: #FF0000");else console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000");else console.log("%c CRITICAL ERROR - OGX.List not found! ","background:#222; color: #FF0000");else console.log("%c CRITICAL ERROR - moment.js not found! ","background:#222; color: #FF0000")}()},OGX.GroupedList=function(t){"use strict";return new OGX.prototype.GroupedList(t)},OGX.GroupedList.SELECT="select";