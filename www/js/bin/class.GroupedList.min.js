if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.GroupedList=function(t){"use strict";function e(t){var e,i,r=[];for(var n in t){i=G.group_mode?n:t[n][0].item[G.group_by],e={title:i,body:"",scopes:["public"],open:!0};for(var o=0;o<t[n].length;o++)e.body+='<span class="ogx_grouped_list_item '+G.css+'" data-id="'+t[n][o].pos+'">'+OGX.Templater.templatize(t[n][o].item,G.template)+"</span>";r.push(e)}return r}function i(t){t?m.el.on("click",".ogx_grouped_list_item",function(){m.el.find(".ogx_grouped_list_selected_item").removeClass("ogx_grouped_list_selected_item"),$(this).addClass("ogx_grouped_list_selected_item");var t=G.list[Number($(this).data("id"))];m.el.trigger(OGX.GroupedList.SELECT,t)}):m.el.off("click",".ogx_grouped_list_item")}function r(t,e,i,r){if("undefined"!=typeof i&&null!==i||(i=t),"undefined"!=typeof r&&null!==r||(r="eqjson"),"object"==typeof e)switch(_[t]=e,e.__proto__.constructor){case OGX.prototype.DynamicList:G.list.removeFilter(t);var n=o(t,i);G.list.addFilter(t,r,n),_[t].el.on(OGX.DynamicList.SELECT,function(e,l){G.list.removeFilter(t),n=_[t].mode()===OGX.DynamicList.SELECT_MODE_SINGLE||_[t].mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?_[t].getSelection()[0][i]:o(t,i),G.list.addFilter(t,r,n),p=G.list.filter(),g=!0,s()}),_[t].el.on(OGX.DynamicList.UNSELECT,function(e,l){G.list.removeFilter(t),n=_[t].mode()===OGX.DynamicList.SELECT_MODE_SINGLE||_[t].mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?[]:o(t,i),n.length>0&&G.list.addFilter(t,r,n),p=G.list.filter(),g=!0,s()});break;case OGX.prototype.TagManager:G.list.removeFilter(t),G.list.addFilter(t,r,e.getCurrentTags()),_[t].el.on(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED,function(e,i){G.list.removeFilter(t),G.list.addFilter(t,r,_[t].getCurrentTags()),p=G.list.filter(),g=!0,s()});break;case OGX.prototype.Switch:G.list.removeFilter(t),G.list.addFilter(t,r,e.val()),_[t].el.on(OGX.Switch.TOGGLE,function(e,i){G.list.removeFilter(t),G.list.addFilter(t,r,i),p=G.list.filter(),g=!0,s()});break;case OGX.prototype.SwitchMulti:G.list.removeFilter(t),G.list.addFilter(t,r,e.val()),_[t].el.on(OGX.DynamicList.CHANGE,function(e,i){G.list.removeFilter(t),G.list.addFilter(t,r,i),p=G.list.filter(),g=!0,s()})}else if("string"==typeof e){if(0===$(e).length)return!1;_[t]=$(e);var l;switch($(e).attr("type").toLowerCase()){case"text":case"number":case"email":case"password":_[t].on("input",function(){l=$(this).val(),G.list.removeFilter(t),l.length&&G.list.addFilter(t,r,l),p=G.list.filter(),g=!0,s()});break;case"range":var a;_[t].on("input",function(){a=Number($(this).attr("min")),G.list.removeFilter(t),G.list.addFilter(t,r,[a,$(this).val()]),p=G.list.filter(),g=!0,s()})}}}function n(t){if("object"==typeof _[t]){switch(_[t].__proto__.constructor){case OGX.prototype.DynamicList:_[t].el.off(OGX.DynamicList.SELECT),_[t].el.off(OGX.DynamicList.UNSELECT);break;case OGX.prototype.TagManager:_[t].el.off(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED);break;case OGX.prototype.Switch:_[t].el.off(OGX.Switch.TOGGLE);break;case OGX.prototype.SwitchMulti:_[t].el.off(OGX.DynamicList.CHANGE);break;default:_[t].off("input")}G.list.removeFilter(t),delete _[t],p=G.list.filter(),g=!0,s()}return!0}function o(t,e){for(var i=_[t].getSelection(),r=[],n=0;n<i.length;n++)r.push(i[n][e]);return r}function l(){for(var t in _)n(t)}function s(){if(G.list){var t=G.list;return g&&(t=p),t=t.group(G.group_by,G.group_mode,G.group_param),c.setData(e(t)),!0}return!1}function a(){for(var t in O)G.hasOwnProperty(t)||(G[t]=O[t]);G.list.length>0&&!G.list.hasOwnProperty("insert")&&(G.list=new OGX.List(G.list)),m.el=d=$(G.container),d.addClass("ogx_grouped_list")}function u(){if("undefined"==typeof moment)return void console.log("%c CRITICAL ERROR - moment.js not found! ","background:#222; color: #FF0000");if("undefined"==typeof OGX.List)return void console.log("%c CRITICAL ERROR - OGX.List not found! ","background:#222; color: #FF0000");if("undefined"==typeof OGX.Templater)return void console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000");if("undefined"==typeof OGX.NestedList)return void console.log("%c CRITICAL ERROR - OGX.NestedList not found! ","background:#222; color: #FF0000");a(),f=G.list.group(G.group_by,G.group_mode,G.group_param);var t=e(f);c=new OGX.NestedList({container:G.container,enabled:G.enabled,data:t}),G.enabled&&i(!0)}var d,c,f,p,g,m=this,G=t,O={group_by:"name",group_mode:null,group_param:null,sort:null,template:"",css:"",enabled:!0,list:new OGX.List},_={};this.el=null,this.val=function(t){return"undefined"==typeof t?G.list:(t.hasOwnProperty("insert")?G.list=t:G.list=new OGX.List(t),f=G.list.group(G.group_by,G.group_mode,G.group_param),void c.setData(e(f)))},this.bind=function(t,e,i,n){return!_.hasOwnProperty(t)&&r(t,e,i,n)},this.unbind=function(t){return!!_.hasOwnProperty(t)&&n(t)},this.filter=function(){p=G.list.filter(),g=!0,s()},this.unfilter=function(){g=!1,s()},this.addFilter=function(t,e,i){return G.list.addFilter(t,e,i)},this.removeFilter=function(t,e,i){return G.list.removeFilter(t,e,i)},this.resetFilters=function(){return G.list.resetFilters()},this.getFilters=function(){return G.list.getFilters()},this.enable=function(){G.enabled||(G.enabled=!0,i(!0),c.enable())},this.disable=function(){G.enabled&&(G.enabled=!1,i(!1),c.disable())},this.render=function(){return s()},this.refresh=function(){var t=m.el.find(".ogx_grouped_list_selected_item:first");if(t.length>0){var e=t.data("id");t.html(OGX.Templater.templatize(G.list[e],G.template))}},this.getNested=function(){return!!c&&c},this.destroy=function(){l(),i(!1),c.destroy()},u()},OGX.GroupedList=function(t){"use strict";return new OGX.prototype.GroupedList(t)},OGX.GroupedList.SELECT="select";