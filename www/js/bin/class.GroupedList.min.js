if(void 0===OGX)var OGX=function(){};OGX.GroupedList=function(t){"use strict";var r,s,l,o,n,i=this,p=t,a={group_by:"name",group_mode:null,group_param:null,group_order:null,sort:null,enabled:!0,list:new OGX.List,display:null,key:null,swipe:!1,reorder:!1,display:!1,mode:OGX.DynamicList.SELECT_MODE_HIT},u={},d="mousedown",e="static";function c(t){var e,r=new OGX.List;for(var i in t)e={title:p.group_mode?i:t[i][0][p.group_by],display:p.display,mode:p.mode,key:p.key,swipe:p.swipe,reoder:p.reorder,list:t[i],open:!0},r.push(e);return r}function m(t){t?"static"===e&&r.on(d,".ogx_grouped_list_item",f):"static"===e&&r.off(d,".ogx_grouped_list_item",f)}function f(){r.find(".ogx_grouped_list_selected_item").removeClass("ogx_grouped_list_selected_item"),$(this).addClass("ogx_grouped_list_selected_item");var t=p.list[Number($(this).data("id"))];r.trigger(OGX.GroupedList.SELECT,t)}function y(t){if("object"==typeof u[t].object){switch(u[t].object._NAME_){case OGX.DynamicList.NAME:u[t].object.el.off(OGX.DynamicList.SELECT),u[t].object.el.off(OGX.DynamicList.UNSELECT);break;case OGX.TagManager.NAME:u[t].object.el.off(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED);break;case OGX.Switch.NAME:u[t].object.el.off(OGX.Switch.TOGGLE);break;case OGX.SwitchMulti.NAME:u[t].object.el.off(OGX.SwitchMulti.CHANGE);break;default:u[t].object.off("input")}p.list.removeFilter(t),delete u[t],o=p.list.filter(),n=!0,setTimeout(h,0)}else u[t].object.off("input");return!0}function g(t,e){for(var r=u[t].getSelection(),i=[],o=0;o<r.length;o++)i.push(r[o][e]);return i}function h(){if(p.list){var t=p.list;return n&&(t=o),t=t.group(p.group_by,p.group_mode,p.group_param),s.setData(c(t)),!0}return!1}this._NAME_=OGX.GroupedList.NAME,this.el=null,this.val=function(t){if(void 0===t)return p.list;var e=p.list.getFilters();t.hasOwnProperty("insert")?p.list=t:p.list=new OGX.List(t),"{}"!==JSON.stringify(e)?(p.list.setFilters(e),l=p.list.filter()):l=p.list,l=(l=p.list).group(p.group_by,p.group_mode,p.group_param),s.setData(c(l))},this.bind=function(t){return!u.hasOwnProperty(t.property)&&function(r){r.hasOwnProperty("mode")||(r.mode="eqjson");if("object"==typeof r.object)switch((u[r.property]=r).object._NAME_){case OGX.DynamicList.NAME:p.list.removeFilter(r.property);var i=g(r.property,r.remote_property);p.list.addFilter(r.property,r.mode,i),u[r.property].object.el.on(OGX.DynamicList.SELECT,function(t,e){return p.list.removeFilter(r.property),i=u[r.property].object.mode()===OGX.DynamicList.SELECT_MODE_SINGLE||u[r.property].object.mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?u[r.property].object.getSelection()[0][__object.remote_property]:g(r.property,r.remote_property),p.list.addFilter(r.property,r.mode,i),o=p.list.filter(),n=!0,setTimeout(h,0),!1}),u[r.property].object.el.on(OGX.DynamicList.UNSELECT,function(t,e){return p.list.removeFilter(r.property),0<(i=u[r.property].object.mode()===OGX.DynamicList.SELECT_MODE_SINGLE||u[r.property].object.mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?[]:g(r.property,r.remote_property)).length&&p.list.addFilter(r.property,r.mode,i),o=p.list.filter(),n=!0,setTimeout(h,0),!1});break;case OGX.TagManager.NAME:p.list.removeFilter(r.property),p.list.addFilter(r.property,r.mode,r.object.getCurrentTags()),u[r.property].object.el.on(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED,function(t,e){return p.list.removeFilter(r.property),p.list.addFilter(r.property,r.mode,u[r.property].object.getCurrentTags()),o=p.list.filter(),n=!0,setTimeout(h,0),!1});break;case OGX.Switch.NAME:p.list.removeFilter(r.property),p.list.addFilter(r.property,r.mode,r.object.val()),u[r.property].object.el.on(OGX.Switch.TOGGLE,function(t,e){return p.list.removeFilter(r.property),p.list.addFilter(r.property,r.mode,e),o=p.list.filter(),n=!0,setTimeout(h,0),!1});break;case OGX.SwitchMulti.NAME:p.list.removeFilter(r.property),p.list.addFilter(r.property,r.mode,r.object.val()),u[r.property].object.el.on(OGX.SwitchMulti.CHANGE,function(t,e){return p.list.removeFilter(r.property),p.list.addFilter(r.property,r.mode,e),o=p.list.filter(),n=!0,setTimeout(h,0),!1})}else if("string"==typeof r.object){if(0===$(r.object).length)return!1;r.object=$(r.object);var t=(u[r.property]=r).object.val();switch(u[r.property].hasOwnProperty("min_length")?(u[r.property].last_val=t).length>=u[r.property].min_length&&(p.list.removeFilter(r.property),p.list.addFilter(r.property,r.mode,t)):(p.list.removeFilter(r.property),p.list.addFilter(r.property,r.mode,t)),r.object.attr("type").toLowerCase()){case"text":case"number":case"email":case"password":case"tel":u[r.property].object.on("input",function(){return t=$(this).val(),p.list.removeFilter(r.property),u[r.property].hasOwnProperty("min_length")?t.length<u[r.property].min_length&&u[r.property].last_val.length>=u[r.property].min_length||t.length>=u[r.property].min_length?(t.length>=u[r.property].min_length&&p.list.addFilter(r.property,r.mode,t),o=p.list.filter(),n=!0,u[r.property].last_val=t,setTimeout(h,0)):u[r.property].last_val=t:(t.length&&p.list.addFilter(r.property,r.mode,t),o=p.list.filter(),n=!0,setTimeout(h,0)),!1});break;case"range":var e;u[r.property].object.on("input",function(){return e=Number($(this).attr("min")),p.list.removeFilter(r.property),p.list.addFilter(r.property,r.mode,[e,$(this).val()]),o=p.list.filter(),n=!0,setTimeout(h,0),!1})}}return!0}(t)},this.unbind=function(t){return!!u.hasOwnProperty(t)&&y(t)},this.filter=function(){return o=p.list.filter(),n=!0,setTimeout(h,0),!0},this.unfilter=function(){return n=!1,setTimeout(h,0),!0},this.addFilter=function(t,e,r){return p.list.addFilter(t,e,r)},this.removeFilter=function(t,e,r){return p.list.removeFilter(t,e,r)},this.resetFilters=function(){return p.list.resetFilters()},this.getFilters=function(){return p.list.getFilters()},this.removeGroup=function(t){},this.addItem=function(t){p.list.push(t);var e=new OGX.List(t),r=e.group(p.group_by,p.group_mode,p.group_param);for(var i in r){if(l.hasOwnProperty(i))this.addToGroup(i,e[0]);else{var o=c(r)[0];s.addItem(o),l[i]=[e[0]]}return}},this.removeItem=function(t,e){for(var r in l)if(this.getGroupList(r).val().find(t,e,1))return this.removeFromGroup(r,t,e),!0;return!1},this.replaceItem=function(t,e,r){var i,o;for(var s in l)if(o=(i=this.getGroupList(s)).val().find(t,e,1))return o[p.group_by]!==r[p.group_by]?(this.removeItem(o),this.addItem(r)):i.replace(t,e,r),!0;return!1},this.updateItem=function(t,e,r,i){var o,s;for(var n in l)if(s=(o=this.getGroupList(n)).val().find(t,e,1))return s[p.group_by]!==__item[p.group_by]?(this.removeItem(s),this.addItem(__item)):o.update(t,e,r,i,1),!0;return!1},this.addToGroup=function(t,e){p.list.push(e),l[t].push(e),s.getList(t).insert(e),setTimeout(function(){s.updateItemHeight(t)},0)},this.removeFromGroup=function(t,e,r){p.list.findDelete(e,r,1);for(var i=0;i<l[t].length;i++)if(l[t][i][e]===r){l[t].splice(i,1);break}s.getList(t).findDelete(e,r,1),l[t].length?setTimeout(function(){s.updateItemHeight(t)},0):(s.removeItem(t),delete l[t])},this.updateGroupItem=function(t,e,r,i){this.getGroupList(t).update(e,r,i,!1,1)},this.replaceGroupItem=function(t,e,r,i){this.getGroupList(t).replace(e,r,i)},this.getGroupList=function(t){return s.getList(t)},this.enable=function(){p.enabled||(m(p.enabled=!0),s.enable())},this.disable=function(){p.enabled&&(m(p.enabled=!1),s.disable())},this.render=function(){return setTimeout(h,0),!0},this.refresh=function(){var t=r.find(".ogx_grouped_list_selected_item:first");if(0<t.length){var e=t.data("id");t.html(OGX.Templater.templatize(p.list[e],p.template))}},this.getNested=function(){return s||!1},this.destroy=function(){!function(){for(var t in u)y(t)}(),m(!1),s.destroy()},function(){if("undefined"!=typeof moment)if(void 0!==OGX.List)if(void 0!==OGX.Templater)if(void 0!==OGX.NestedList){!function(){for(var t in a)p.hasOwnProperty(t)||(p[t]=a[t]);0<p.list.length&&!p.list.hasOwnProperty("insert")&&(p.list=new OGX.List(p.list)),void 0!==window.ontouchstart&&(d="touchstart"),i.el=r=$(p.container),r.addClass("ogx_grouped_list")}(),p.display&&p.display.hasOwnProperty("css")&&("object"!=typeof p.display.css?p.display.css+=" ogx_grouped_list_item":p.display.hasOwnProperty("add")?p.display.add="ogx_grouped_list_item "+p.display.add:p.display.add="ogx_grouped_list_item"),r.on(OGX.NestedList.READY,function(){r.off(OGX.NestedList.READY),p.enabled&&m(!0)});var t=c(l=p.list.group(p.group_by,p.group_mode,p.group_param)),e={container:p.container,list:t,enabled:p.enabled,display:p.display};s=new OGX.NestedList(e)}else console.log("%c CRITICAL ERROR - OGX.NestedList not found! ","background:#222; color: #FF0000");else console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000");else console.log("%c CRITICAL ERROR - OGX.List not found! ","background:#222; color: #FF0000");else console.log("%c CRITICAL ERROR - moment.js not found! ","background:#222; color: #FF0000")}()},OGX.GroupedList.NAME="OgxGroupedList",OGX.GroupedList.SELECT="GroupedListSelect";