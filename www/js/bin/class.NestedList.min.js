if(void 0===OGX)var OGX=function(){};OGX.NestedList=function(t){"use strict";var a,e=this,i={core:!1,scopes:["public"],set_heights_timeout:0,action_timeout:30,enabled:!0,template:'<div class="ogx_nested_list_item"><div class="ogx_nested_list_item_head {{$css}}"><span class="ogx_nested_list_item_title">{{$title}}</span></div><div class="ogx_nested_list_item_body"><span class="ogx_nested_list_item_content">{{$body}}</span></div></div>',display:null,key:null,list_mode:OGX.DynamicList.SELECT_MODE_SINGLE},d=t,n=[],o=[],s="mousedown";function _(t){t?a.on(s,".ogx_nested_list_item_head",function(t){var e=$(this).next(),i=$(this).parent(0).index();if(e.removeClass("ogx_nested_list_item_body_anim_in"),e.removeClass("ogx_nested_list_item_body_anim_out"),$(this).hasClass("ogx_nested_list_item_head_closed")){var s=e.data("height");e.addClass("ogx_nested_list_item_body_anim_in"),setTimeout(function(){e.css("max-height",s)},d.action_timeout),$(this).removeClass("ogx_nested_list_item_head_closed"),$(this).addClass("ogx_nested_list_item_head_open"),a.trigger(OGX.NestedList.OPEN,d.data[i])}else{s=e.height();e.data("height",s+"px"),e.addClass("ogx_nested_list_item_body_anim_out"),setTimeout(function(){e.css("max-height","0px")},d.action_timeout),$(this).addClass("ogx_nested_list_item_head_closed"),$(this).removeClass("ogx_nested_list_item_head_open"),a.trigger(OGX.NestedList.CLOSE,d.data[i])}e.on("transitionend",function(){e.off("transitionend"),e.hasClass("ogx_nested_list_item_body_anim_in")?a.trigger(OGX.NestedList.OPENED,d.data[i]):a.trigger(OGX.NestedList.CLOSED,d.data[i])})}):a.off(s,".ogx_nested_list_item_head")}function l(){a.empty(),a.css({position:"absolute",top:-1e4,visibility:"hidden",display:"block"});for(var t,e,i="",s=!1,n=0;n<d.data.length;n++)d.data[n].css="ogx_nested_list_item_head_open",d.data[n].hasOwnProperty("items")?s=!(d.data[n].body=""):d.data[n].hasOwnProperty("view")&&d.core&&(o.push({index:n,view:d.data[n].view}),d.data[n].view.hasOwnProperty("template")&&(t=d.data[n].view.hasOwnProperty("data")?d.data[n].view.data:{},d.data[n].body=OGX.Templater.templatize(OGX.Templater.getTemplate(d.data[n].view.template),t))),i+=OGX.Templater.templatize(d.data[n],d.template);if(a.html(i),o.length)for(n=0;n<o.length;n++)o[n].view.container=(e=o[n].index,a.children(".ogx_nested_list_item:eq("+e+")").children(".ogx_nested_list_item_body:first").chidren(".ogx_nested_list_item_content:first")[0]),d.core.addToStage(o[n].view);s&&h(0,d.data.length),setTimeout(function(){c(),function(){for(var t,e=0;e<d.data.length;e++)d.data[e].open||((t=a.children(".ogx_nested_list_item:eq("+e+")").children(".ogx_nested_list_item_head:first")).addClass("ogx_nested_list_item_head_closed"),t.next().css("max-height","0px"))}(),r(),a.css({position:"static",visibility:"visible"}),a.trigger(OGX.NestedList.READY)},d.set_heights_timeout)}function h(t,e){for(var i,s=t;s<e;s++)d.data[s].hasOwnProperty("items")&&(i=a.children(".ogx_nested_list_item:eq("+s+")").children(".ogx_nested_list_item_body:first").children(".ogx_nested_list_item_content:first"),n[s]=new OGX.DynamicList({container:i[0],display:d.display,key:d.key,mode:d.list_mode,list:d.data[s].items}))}function r(){for(var t=0;t<d.data.length;t++)m(d.data[t])?a.children(".ogx_nested_list_item:eq("+t+")").removeClass("ogx_nested_list_item_hidden"):a.children(".ogx_nested_list_item:eq("+t+")").addClass("ogx_nested_list_item_hidden")}function c(){a.find(".ogx_nested_list_item_body").each(function(t,e){var i=$(this).outerHeight(!0);$(this).data("height",i+"px"),$(this).parent(0).children(".ogx_nested_list_item_head:first").hasClass("ogx_nested_list_item_head_closed")?$(this).css("max-height","0px"):i&&$(this).css("max-height",i+"px")})}function m(t){if(t.hasOwnProperty("scopes"))for(var e=0;e<t.scopes.length;e++)if(-1!==d.scopes.indexOf(t.scopes[e]))return!0;return!1}this._NAME_=OGX.NestedList.NAME,this.el=null,this.setScopes=function(t){d.scopes=t,r()},this.getScopes=function(){return d.scopes},this.updateItem=function(t,e){a.find(".ogx_nested_list_item_content:nth-child("+(t+1)+")").html(e),c()},this.updateHeight=function(t){var e=$(this).outerHeight(!0);a.find(".ogx_nested_list_item_content:eq("+t+")").data("height",e+"px")},this.setData=function(t){d.data=t,l()},this.addData=function(t){for(var e="",i=0;i<t.length;i++)t[i].css="ogx_nested_list_item_head_open",t[i].hasOwnProperty("items")&&(t[i].body=""),e+=OGX.Templater.templatize(t[i],d.template);if(a.append(e),t.length&&t[0].hasOwnProperty("items")){var s=d.data.length;d.data=d.data.concat(t),h(s,d.data.length),c()}},this.getData=function(){return d.data},this.enable=function(){d.enabled||_(d.enabled=!0)},this.disable=function(){d.enabled&&_(d.enabled=!1)},this.resetListSelection=function(){if(n.length)for(var t=0;t<n.length;t++)n[t].resetSelection()},this.destroy=function(){d.enabled&&_(!0),function(){if(n.length){for(var t=0;t<n.length;t++)n[t].destroy();n=[]}}(),function(){if(o.length){for(var t=0;t<o.length;t++)d.core.removeFromStage(o[t].view.container);o=[]}}()},void 0!==OGX.Templater?(function(){for(var t in i)d.hasOwnProperty(t)||(d[t]=i[t]);void 0!==window.ontouchstart&&(s="touchstart"),e.el=a=$(d.container),a.addClass("ogx_nested_list")}(),d.mode!==OGX.NestedList.MODE_DYNAMIC||void 0!==OGX.DynamicList?(l(),d.enabled&&_(!0)):console.log("%c CRITICAL ERROR - OGX.DynamicList not found! ","background:#222; color: #FF0000")):console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000")},OGX.NestedList.NAME="OgxNestedList",OGX.NestedList.OPEN="NestedListOpen",OGX.NestedList.CLOSE="NestedListClose",OGX.NestedList.OPENED="NestedListOpened",OGX.NestedList.CLOSED="NestedListClosed",OGX.NestedList.READY="NestedListReady";