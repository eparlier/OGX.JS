if(void 0===OGX)var OGX=function(){};OGX.NestedList=function(e){"use strict";var o,t=this,i={core:!1,scopes:["public"],set_heights_timeout:200,action_timeout:30,enabled:!0,template:'<div class="ogx_nested_list_item {{$dsp}}"><div class="ogx_nested_list_item_head {{$css}}"><span class="ogx_nested_list_item_title">{{$title}}</span></div><div class="ogx_nested_list_item_body"><div class="ogx_nested_list_item_content">{{$body}}</div></div></div>',display:null,key:null,list:new OGX.List,list_mode:OGX.DynamicList.SELECT_MODE_SINGLE},l=e,n=[],d=new OGX.List,_=(new Date).getTime()+""+Math.round(1e3*Math.random()),s=!1,r=0,a=0,c={y:0,h:0,way:1};function h(e){e?o.on("click",".ogx_nested_list_item_head",g):o.off("click",".ogx_nested_list_item_head",g)}function g(e){if(!s){s=!0;var t=$(this),i=t.parent(0).index();t.hasClass("ogx_nested_list_item_head_closed")?(c.way=1,t.addClass("ogx_nested_list_item_head_open").removeClass("ogx_nested_list_item_head_closed"),l.list[i].open=!0):(c.way=0,t.removeClass("ogx_nested_list_item_head_open").addClass("ogx_nested_list_item_head_closed"),l.list[i].open=!1),l.list[i].open?o.trigger(OGX.NestedList.OPEN,l.list[i]):o.trigger(OGX.NestedList.CLOSE,l.list[i]),setTimeout(p,0)}}function m(){o.empty(),o.addClass("ogx_nested_list_prep");for(var e,t="",i=!1,s=0;s<l.list.length;s++)l.list[s].hasOwnProperty("items")&&(i=!0),t+=f(l.list[s],s);if(t+='<div class="ogx_nested_list_mask"></div>',o.html(t),d.length)for(s=0;s<d.length;s++)d[s].view.container=(e=d[s].index,'.ogx_nested_list[data-ogx-nested-list="'+_+'"] .ogx_nested_list_item:eq('+e+") .ogx_nested_list_item_body:first .ogx_nested_list_item_content:first"),l.core.addToStage(d[s].view);i&&u(0,l.list.length),setTimeout(function(){v(),function(){for(var e,t,i=a=0;i<l.list.length;i++)e=o.children(".ogx_nested_list_item:eq("+i+")"),t=e.children(".ogx_nested_list_item_head:first"),r||(r=t.outerHeight(!0)),l.list[i].open||t.addClass("ogx_nested_list_item_head_closed").removeClass("ogx_nested_list_item_head_open"),x(l.list[i])?l.list[i].hidden=!1:(l.list[i].hidden=!0,e.addClass("ogx_nested_list_item_hidden"));setTimeout(p,0)}(),o.removeClass("ogx_nested_list_prep"),o.trigger(OGX.NestedList.READY)},l.set_heights_timeout)}function f(e,t){if(e.css="ogx_nested_list_item_head_open",e.dsp="",e.hasOwnProperty("items"))e.body="";else if(e.hasOwnProperty("view")&&l.core){d.push({index:t,view:e.view});var i=new OGX.DisplayObject(e.view);e.view.hasOwnProperty("data")?e.body=i.html(e.view.data):e.body=i.html()}var s=OGX.Templater.templatize(e,l.template);return delete e.dsp,delete e.css,s}function u(e,t){for(var i,s=e;s<t;s++)l.list[s].hasOwnProperty("items")&&(i=o.children(".ogx_nested_list_item:eq("+s+")").children(".ogx_nested_list_item_body:first").children(".ogx_nested_list_item_content:first"),n[s]=new OGX.DynamicList({container:i[0],display:l.display,key:l.key,swipe:l.swipe,reorder:l.reorder,mode:l.list_mode,list:l.list[s].items}))}function p(){var e;!function(){var e=0;a=0,c.y=0;for(var t=c.h=0;t<l.list.length;t++)l.list[t].y=e,l.list[t].hidden||(a+=r,c.y=e,l.list[t].open&&(c.y+=l.list[t].height,e+=l.list[t].height,a+=l.list[t].height),c.h=l.list[t].height);a-=c.h}();for(var t=o.children(".ogx_nested_list_mask:first"),i=0;i<l.list.length;i++)(e=o.children(".ogx_nested_list_item:eq("+i+")")).removeClass("ogx_nested_list_item_noanim"),e.css("transform","translateY("+l.list[i].y+"px)");t.on("transitionend",function(){t.off("transitionend"),c.way||o.css("height",a+c.h),s=!1}),c.way&&o.css("height",a+c.h),setTimeout(function(){t.css({transform:"translateY("+c.y+"px)"})},0)}function v(){var i,s;o.children(".ogx_nested_list_item").each(function(e,t){i=(i=$(t)).children(".ogx_nested_list_item_body:first"),s=i.outerHeight(!0),l.list[e].height=s})}function x(e){if(e.hasOwnProperty("scopes"))for(var t=0;t<e.scopes.length;t++)if(-1!==l.scopes.indexOf(e.scopes[t]))return!0;return!1}this._NAME_=OGX.NestedList.NAME,this.el=null,this.setScopes=function(e){l.scopes=e,function(){for(var e,t=0;t<l.list.length;t++)(e=o.children(".ogx_nested_list_item:eq("+t+")")).addClass("ogx_nested_list_item_noanim"),x(l.list[t])?(l.list[t].hidden=!1,e.removeClass("ogx_nested_list_item_hidden")):(l.list[t].hidden=!0,e.addClass("ogx_nested_list_item_hidden"));setTimeout(p,0)}()},this.getScopes=function(){return l.scopes},this.updateItem=function(e,t){o.children(".ogx_nested_list_item:eq("+e+")").children(".ogx_nested_list_item_body:first").children(".ogx_nested_list_item_content:first").html(t),v()},this.updateHeight=function(e){var t=o.find(".ogx_nested_list_item_body:eq("+e+")"),i=t.children(".ogx_nested_list_item_content:first").innerHeight();t.css("height",i+"px"),l.list[e].height=i,p()},this.setData=function(e){l.list=e,setTimeout(m,0)},this.addData=function(e){for(var t="",i=0;i<e.length;i++)t+=f(e[i],l.list.length);if(o.children(".ogx_nested_list_mask:first").before(t),e.length&&e[0].hasOwnProperty("items")){var s=l.list.length;if(l.list=l.list.concat(e),u(s,l.list.length),!r){var n=o.children(".ogx_nested_list_item:first").children(".ogx_nested_list_item_head:first");r=n.outerHeight(!0)}setTimeout(function(){v(),p()},20)}else p()},this.removeNest=function(e){!function(e,t){for(var i=e;i<t;i++)l.list[i].hasOwnProperty("items")&&(n[i].destroy(),n[i]=!1);for(i=0;i<n.length;i++)n[i]||(n.splice(i,1),i--)}(e,e+1),l.list.splice(e,1),o.children(".ogx_nested_list_item:eq("+e+")").remove()},this.getData=function(){return l.list},this.getView=function(e){var t=d.find("index",e,1);if(t){var i=l.core.getCurrentStage();return l.core.getView(i,t.view.container)}},this.getList=function(e){return n[e]},this.enable=function(){l.enabled||h(l.enabled=!0)},this.disable=function(){l.enabled&&h(l.enabled=!1)},this.resetListSelection=function(){if(n.length)for(var e=0;e<n.length;e++)n[e].resetSelection()},this.destroy=function(){l.enabled&&h(!0),function(){if(n.length){for(var e=0;e<n.length;e++)n[e].destroy();n=[]}}(),function(){if(d.length){for(var e=0;e<d.length;e++)l.core.removeFromStage(d[e].view.container);d=new OGX.List}}()},void 0!==OGX.DisplayObject?void 0!==OGX.Templater?(function(){for(var e in i)l.hasOwnProperty(e)||(l[e]=i[e]);l.list=l.list.slice(0),t.el=o=$(l.container),o.addClass("ogx_nested_list"),o.attr("data-ogx-nested-list",_)}(),l.mode!==OGX.NestedList.MODE_DYNAMIC||void 0!==OGX.DynamicList?(setTimeout(m,0),l.enabled&&h(!0)):console.log("%c CRITICAL ERROR - OGX.DynamicList not found! ","background:#222; color: #FF0000")):console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000"):console.log("%c CRITICAL ERROR - OGX.DisplayObject not found! ","background:#222; color: #FF0000")},OGX.NestedList.NAME="OgxNestedList",OGX.NestedList.OPEN="NestedListOpen",OGX.NestedList.CLOSE="NestedListClose",OGX.NestedList.READY="NestedListReady";