if(void 0===OGX)var OGX=function(){};OGX.NestedList=function(e){"use strict";var n,t=this,i={core:!1,scopes:["public"],set_heights_timeout:200,action_timeout:30,enabled:!0,template:'<div class="ogx_nested_list_item {{$dsp}}"><div class="ogx_nested_list_item_head {{$css}}"><span class="ogx_nested_list_item_title">{{$title}}</span></div><div class="ogx_nested_list_item_body"><div class="ogx_nested_list_item_content">{{$body}}</div></div></div>',display:null,key:null,list:new OGX.List,list_mode:OGX.DynamicList.SELECT_MODE_SINGLE},o=e,l=[],d=new OGX.List,_="nested-list-"+(new Date).getTime()+Math.round(1e3*Math.random()),s=!1,a=0,r=0,c={y:0,h:0,way:1};function h(e){e?n.on("click",".ogx_nested_list_item_head",g):n.off("click",".ogx_nested_list_item_head",g)}function g(e){if(!s){s=!0;var t=$(this),i=t.parent(0).index();t.hasClass("ogx_nested_list_item_head_closed")?(c.way=1,t.addClass("ogx_nested_list_item_head_open").removeClass("ogx_nested_list_item_head_closed"),o.list[i].open=!0):(c.way=0,t.removeClass("ogx_nested_list_item_head_open").addClass("ogx_nested_list_item_head_closed"),o.list[i].open=!1),o.list[i].open?n.trigger(OGX.NestedList.OPEN,o.list[i]):n.trigger(OGX.NestedList.CLOSE,o.list[i]),setTimeout(p,0)}}function m(){n.empty(),n.addClass("ogx_nested_list_prep");for(var e,t="",i=!1,s=0;s<o.list.length;s++)o.list[s].hasOwnProperty("items")&&(i=!0),t+=f(o.list[s],s);if(t+='<div class="ogx_nested_list_mask"></div>',n.html(t),d.length)for(s=0;s<d.length;s++)d[s].view.container=(e=d[s].index,'.ogx_nested_list[data-ogx="'+_+'"] .ogx_nested_list_item:eq('+e+") .ogx_nested_list_item_body:first .ogx_nested_list_item_content:first"),o.core.addToStage(d[s].view);i&&u(0,o.list.length),setTimeout(function(){v(),function(){for(var e,t,i=r=0;i<o.list.length;i++)e=n.children(".ogx_nested_list_item:eq("+i+")"),t=e.children(".ogx_nested_list_item_head:first"),a||(a=t.outerHeight(!0)),o.list[i].open||t.addClass("ogx_nested_list_item_head_closed").removeClass("ogx_nested_list_item_head_open"),x(o.list[i])?o.list[i].hidden=!1:(o.list[i].hidden=!0,e.addClass("ogx_nested_list_item_hidden"));setTimeout(p,0)}(),n.removeClass("ogx_nested_list_prep"),n.trigger(OGX.NestedList.READY)},o.set_heights_timeout)}function f(e,t){if(e.css="ogx_nested_list_item_head_open",e.dsp="",e.hasOwnProperty("items"))e.body="";else if(e.hasOwnProperty("view")&&o.core){d.push({index:t,view:e.view});var i=new OGX.DisplayObject(e.view);e.view.hasOwnProperty("data")?e.body=i.html(e.view.data):e.body=i.html()}var s=OGX.Templater.templatize(e,o.template);return delete e.dsp,delete e.css,s}function u(e,t){for(var i,s=e;s<t;s++)o.list[s].hasOwnProperty("items")&&(i=n.children(".ogx_nested_list_item:eq("+s+")").children(".ogx_nested_list_item_body:first").children(".ogx_nested_list_item_content:first"),l[s]=new OGX.DynamicList({container:i[0],display:o.display,key:o.key,swipe:o.swipe,reorder:o.reorder,mode:o.list_mode,list:o.list[s].items}))}function p(){var e;!function(){var e=0;r=0,c.y=0;for(var t=c.h=0;t<o.list.length;t++)o.list[t].y=e,o.list[t].hidden||(r+=a,c.y=e,o.list[t].open&&(c.y+=o.list[t].height,e+=o.list[t].height,r+=o.list[t].height),c.h=o.list[t].height);r-=c.h}();for(var t=n.children(".ogx_nested_list_mask:first"),i=0;i<o.list.length;i++)(e=n.children(".ogx_nested_list_item:eq("+i+")")).removeClass("ogx_nested_list_item_noanim"),e.css("transform","translateY("+o.list[i].y+"px)");t.on("transitionend",function(){t.off("transitionend"),c.way||n.css("height",r+c.h),s=!1}),c.way&&n.css("height",r+c.h),setTimeout(function(){t.css({transform:"translateY("+c.y+"px)"})},0)}function v(){var i,s;n.children(".ogx_nested_list_item").each(function(e,t){i=(i=$(t)).children(".ogx_nested_list_item_body:first"),s=i.outerHeight(!0),o.list[e].height=s})}function x(e){if(e.hasOwnProperty("scopes"))for(var t=0;t<e.scopes.length;t++)if(-1!==o.scopes.indexOf(e.scopes[t]))return!0;return!1}this._NAME_=OGX.NestedList.NAME,this.el=null,this.setScopes=function(e){o.scopes=e,function(){for(var e,t=0;t<o.list.length;t++)(e=n.children(".ogx_nested_list_item:eq("+t+")")).addClass("ogx_nested_list_item_noanim"),x(o.list[t])?(o.list[t].hidden=!1,e.removeClass("ogx_nested_list_item_hidden")):(o.list[t].hidden=!0,e.addClass("ogx_nested_list_item_hidden"));setTimeout(p,0)}()},this.getScopes=function(){return o.scopes},this.updateItem=function(e,t){n.children(".ogx_nested_list_item:eq("+e+")").children(".ogx_nested_list_item_body:first").children(".ogx_nested_list_item_content:first").html(t),v()},this.updateHeight=function(e){var t=$(this).outerHeight(!0);n.find(".ogx_nested_list_item_body:eq("+e+")").attr("height",t+"px")},this.setData=function(e){o.list=e,setTimeout(m,0)},this.addData=function(e){for(var t="",i=0;i<e.length;i++)t+=f(e[i],o.list.length);if(n.append(t),e.length&&e[0].hasOwnProperty("items")){var s=o.list.length;o.list=o.list.concat(e),u(s,o.list.length),v()}},this.getData=function(){return o.list},this.getView=function(e){var t=d.find("index",e,1);if(t){var i=o.core.getCurrentStage();return o.core.getView(i,t.view.container)}},this.enable=function(){o.enabled||h(o.enabled=!0)},this.disable=function(){o.enabled&&h(o.enabled=!1)},this.resetListSelection=function(){if(l.length)for(var e=0;e<l.length;e++)l[e].resetSelection()},this.destroy=function(){o.enabled&&h(!0),function(){if(l.length){for(var e=0;e<l.length;e++)l[e].destroy();l=[]}}(),function(){if(d.length){for(var e=0;e<d.length;e++)o.core.removeFromStage(d[e].view.container);d=new OGX.List}}()},void 0!==OGX.DisplayObject?void 0!==OGX.Templater?(function(){for(var e in i)o.hasOwnProperty(e)||(o[e]=i[e]);void 0!==window.ontouchstart&&"touchstart",o.list=o.list.slice(0),t.el=n=$(o.container),n.addClass("ogx_nested_list"),n.attr("data-ogx",_)}(),o.mode!==OGX.NestedList.MODE_DYNAMIC||void 0!==OGX.DynamicList?(setTimeout(m,0),o.enabled&&h(!0)):console.log("%c CRITICAL ERROR - OGX.DynamicList not found! ","background:#222; color: #FF0000")):console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000"):console.log("%c CRITICAL ERROR - OGX.DisplayObject not found! ","background:#222; color: #FF0000")},OGX.NestedList.NAME="OgxNestedList",OGX.NestedList.OPEN="NestedListOpen",OGX.NestedList.CLOSE="NestedListClose",OGX.NestedList.READY="NestedListReady";