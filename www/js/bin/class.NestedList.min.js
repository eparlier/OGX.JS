if(void 0===OGX)var OGX=function(){};OGX.NestedList=function(t){"use strict";var n,e=this,i={core:!1,scopes:["public"],set_heights_timeout:0,action_timeout:30,enabled:!0,template:'<div class="ogx_nested_list_item"><div class="ogx_nested_list_item_head {{$css}}"><span class="ogx_nested_list_item_title">{{$title}}</span></div><div class="ogx_nested_list_item_body"><span class="ogx_nested_list_item_content">{{$body}}</span></div></div>',display:null,key:null,list_mode:OGX.DynamicList.SELECT_MODE_SINGLE},a=t,o=[],d=new OGX.List,_="nested-list-"+(new Date).getTime()+Math.round(1e3*Math.random()),s="mousedown";function l(t){t?n.on(s,".ogx_nested_list_item_head",function(t){var e=$(this).next(),i=$(this).parent(0).index();if(e.removeClass("ogx_nested_list_item_body_anim_in"),e.removeClass("ogx_nested_list_item_body_anim_out"),$(this).hasClass("ogx_nested_list_item_head_closed")){var s=e.data("height");e.addClass("ogx_nested_list_item_body_anim_in"),setTimeout(function(){e.css("max-height",s)},a.action_timeout),$(this).removeClass("ogx_nested_list_item_head_closed"),$(this).addClass("ogx_nested_list_item_head_open"),n.trigger(OGX.NestedList.OPEN,a.data[i])}else{s=e.height();e.data("height",s+"px"),e.addClass("ogx_nested_list_item_body_anim_out"),setTimeout(function(){e.css("max-height","0px")},a.action_timeout),$(this).addClass("ogx_nested_list_item_head_closed"),$(this).removeClass("ogx_nested_list_item_head_open"),n.trigger(OGX.NestedList.CLOSE,a.data[i])}e.on("transitionend",function(){e.off("transitionend"),e.hasClass("ogx_nested_list_item_body_anim_in")?n.trigger(OGX.NestedList.OPENED,a.data[i]):n.trigger(OGX.NestedList.CLOSED,a.data[i])})}):n.off(s,".ogx_nested_list_item_head")}function r(){n.empty(),n.css({position:"absolute",top:-1e4,visibility:"hidden",display:"block"});for(var t,e="",i=!1,s=0;s<a.data.length;s++)a.data[s].css="ogx_nested_list_item_head_open",a.data[s].hasOwnProperty("items")&&(i=!0),e+=h(a.data[s],s);if(n.html(e),d.length)for(s=0;s<d.length;s++)d[s].view.container=(t=d[s].index,'.ogx_nested_list[data-ogx="'+_+'"] .ogx_nested_list_item:eq('+t+") .ogx_nested_list_item_body:first .ogx_nested_list_item_content:first"),a.core.addToStage(d[s].view);i&&c(0,a.data.length),setTimeout(function(){m(),function(){for(var t,e=0;e<a.data.length;e++)a.data[e].open||((t=n.children(".ogx_nested_list_item:eq("+e+")").children(".ogx_nested_list_item_head:first")).addClass("ogx_nested_list_item_head_closed"),t.next().css("max-height","0px"))}(),g(),n.css({position:"static",visibility:"visible"}),n.trigger(OGX.NestedList.READY)},a.set_heights_timeout)}function h(t,e){return t.css="ogx_nested_list_item_head_open",t.hasOwnProperty("items")?t.body="":t.hasOwnProperty("view")&&a.core&&(d.push({index:e,view:t.view}),t.view.hasOwnProperty("template")?t.view.hasOwnProperty("data")?t.body=OGX.Templater.templatize(t.view.data,OGX.Templater.getTemplate(t.view.template)):t.body=OGX.Templater.getTemplate(t.view.template):t.view.hasOwnProperty("html")&&(t.body=t.view.html)),OGX.Templater.templatize(t,a.template)}function c(t,e){for(var i,s=t;s<e;s++)a.data[s].hasOwnProperty("items")&&(i=n.children(".ogx_nested_list_item:eq("+s+")").children(".ogx_nested_list_item_body:first").children(".ogx_nested_list_item_content:first"),o[s]=new OGX.DynamicList({container:i[0],display:a.display,key:a.key,mode:a.list_mode,list:a.data[s].items}))}function g(){for(var t=0;t<a.data.length;t++)f(a.data[t])?n.children(".ogx_nested_list_item:eq("+t+")").removeClass("ogx_nested_list_item_hidden"):n.children(".ogx_nested_list_item:eq("+t+")").addClass("ogx_nested_list_item_hidden")}function m(){n.find(".ogx_nested_list_item_body").each(function(t,e){var i=$(this).outerHeight(!0);$(this).data("height",i+"px"),$(this).parent(0).children(".ogx_nested_list_item_head:first").hasClass("ogx_nested_list_item_head_closed")?$(this).css("max-height","0px"):i&&$(this).css("max-height",i+"px")})}function f(t){if(t.hasOwnProperty("scopes"))for(var e=0;e<t.scopes.length;e++)if(-1!==a.scopes.indexOf(t.scopes[e]))return!0;return!1}this._NAME_=OGX.NestedList.NAME,this.el=null,this.setScopes=function(t){a.scopes=t,g()},this.getScopes=function(){return a.scopes},this.updateItem=function(t,e){n.find(".ogx_nested_list_item_content:nth-child("+(t+1)+")").html(e),m()},this.updateHeight=function(t){var e=$(this).outerHeight(!0);n.find(".ogx_nested_list_item_content:eq("+t+")").data("height",e+"px")},this.setData=function(t){a.data=t,r()},this.addData=function(t){for(var e="",i=0;i<t.length;i++)e+=h(t[i],a.data.length);if(n.append(e),t.length&&t[0].hasOwnProperty("items")){var s=a.data.length;a.data=a.data.concat(t),c(s,a.data.length),m()}},this.getData=function(){return a.data},this.getView=function(t){var e=d.find("index",t,1);if(e){var i=a.core.getCurrentStage();return a.core.getView(i,e.view.container)}},this.enable=function(){a.enabled||l(a.enabled=!0)},this.disable=function(){a.enabled&&l(a.enabled=!1)},this.resetListSelection=function(){if(o.length)for(var t=0;t<o.length;t++)o[t].resetSelection()},this.destroy=function(){a.enabled&&l(!0),function(){if(o.length){for(var t=0;t<o.length;t++)o[t].destroy();o=[]}}(),function(){if(d.length){for(var t=0;t<d.length;t++)a.core.removeFromStage(d[t].view.container);d=new OGX.List}}()},void 0!==OGX.Templater?(function(){for(var t in i)a.hasOwnProperty(t)||(a[t]=i[t]);void 0!==window.ontouchstart&&(s="touchstart"),e.el=n=$(a.container),n.addClass("ogx_nested_list"),n.attr("data-ogx",_)}(),a.mode!==OGX.NestedList.MODE_DYNAMIC||void 0!==OGX.DynamicList?(r(),a.enabled&&l(!0)):console.log("%c CRITICAL ERROR - OGX.DynamicList not found! ","background:#222; color: #FF0000")):console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000")},OGX.NestedList.NAME="OgxNestedList",OGX.NestedList.OPEN="NestedListOpen",OGX.NestedList.CLOSE="NestedListClose",OGX.NestedList.OPENED="NestedListOpened",OGX.NestedList.CLOSED="NestedListClosed",OGX.NestedList.READY="NestedListReady";