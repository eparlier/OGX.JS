if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.FormTools=function(){"use strict";function e(e){return $(e).serializeArray().map(function(e){return this[e.name]=e.value,this}.bind({}))[0]}function t(e,t){var n=$(e).val(),a=i[e];if(a.val!==n&&(a.val=n,a.changing=(new Date).getTime()),a.changing&&(new Date).getTime()>a.wait+a.changing&&(clearInterval(a.intv),a.intv=!1,a.change_cb)){var o={value:null,obj:{},el:null};o.el=$(e)[0],o.value=a.val,o.obj[a.prop]=a.val,a.change_cb(o,t)}}function n(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n]);return t}var a={multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:1500,intv:null,prop:null},i={},o={};this.bindForm=function(t,n,a){"undefined"==typeof n&&(n=!1),i.hasOwnProperty(t)||(i[t]=n,$(t).on("submit",function(i){i.preventDefault(),i.stopImmediatePropagation();var o={obj:e(t),el:$(t)[0]};n?n(o,a):$(t).trigger("change",o)}))},this.unbindForm=function(e){i.hasOwnProperty(e)&&($(document).off("submit",e),delete i[e])},this.bindField=function(e,o,r){if(!i.hasOwnProperty(e)){var l=n(a,o);l.prop=$(e).attr("name"),i[e]=l,$(e).on("input",function(){if(l.input_cb){var n={value:null,obj:{},el:null};n.el=$(e)[0],n.value=$(this).val(),n.obj[i[e].prop]=$(this).val(),l.input_cb(n,r)}i[e].intv||(i[e].intv=setInterval(function(){t(e,r)},300))}),l.multiline||$(e).on("keypress",function(t){if(13===t.which)if(t.preventDefault(),t.stopImmediatePropagation(),i[e].intv&&(clearInterval(i[e].intv),i[e].intv=null),l.change_cb){var n={value:null,obj:{},el:null};n.el=$(e)[0],n.value=$(this).val(),n.obj[i[e].prop]=$(this).val(),l.change_cb(n,r)}else $(e).trigger("change",$(this).val())})}},this.unbindField=function(e){i.hasOwnProperty(e)&&($(e).off("input"),i[e].multiline||$(e).off("keypress"),i[e].intv&&clearInterval(i[e].intv),delete i[e])},this.restrictField=function(e,t){var n={allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\-\\:\\(\\)\\\/_,;%'"â€™ ]$/gi,forbidden:!1,paste:!0,autocomplete:!0,multiline:!0,max:2500};if("undefined"==typeof t&&(t={}),t.hasOwnProperty("forbidden")&&delete n.allowed,!o.hasOwnProperty(e)){if("undefined"==typeof t)t=n;else for(var a in n)t.hasOwnProperty(a)||(t[a]=n[a]);var i=$(e);i.attr("pattern")&&(t.allowed=i.attr("pattern").replace(/{[0-9,]+}/,"")),o[e]=t,o[e].keys=[],console.log("auto complete allowed?",t.autocomplete),t.autocomplete?t.allowed=new RegExp(t.allowed.toString().replace("$/gi","+$").replace("/^","^"),"gi"):o[e].keys.push(229),["input","texarea"].indexOf(i.get(0).tagName.toLowerCase())!==-1?o[e].content="val":o[e].content="html",o[e].multiline||o[e].keys.push(13),i.on("textInput keydown",function(t){if("textInput"===t.type){var n=t.originalEvent.data;if(o[e].allowed){if(!n.match(o[e].allowed))return t.preventDefault(),t.stopImmediatePropagation(),!1}else if(o[e].forbidden&&n.match(o[e].forbidden))return t.preventDefault(),t.stopImmediatePropagation(),!1}if("keydown"===t.type){if(o[e].keys.indexOf(t.which)!==-1)return t.preventDefault(),t.stopImmediatePropagation(),!1;if($(this)[o[e].content]().length>=o[e].max&&8!==t.which)return t.preventDefault(),t.stopImmediatePropagation(),!1}}),o[e].paste||i.on("paste",function(e){e.preventDefault(),e.stopImmediatePropagation()})}},this.unrestrictField=function(e){if(o.hasOwnProperty(e)){var t=$(e);t.off("textInput keydown"),o[e].paste||t.off("paste"),delete o[e]}},this.formToObj=function(t){return e(t)},this.validateForm=function(e){var t,n,a,i=$(e),o={},r=!0;return i.find("input").each(function(e,i){t=$(i),i.hasAttribute("required")&&i.hasAttribute("pattern")&&"submit"!==t.attr("type")&&(n=t.attr("pattern"),a=t.val(),n&&(n=new RegExp(n,"g"),n.test(a)||(o[t.attr("name")]=!1,r=!1)))}),!!r||o}},OGX.FormTools=new OGX.prototype.FormTools;