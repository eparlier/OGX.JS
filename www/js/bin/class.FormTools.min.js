if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.FormTools=function(){"use strict";function t(t){return $(t).serializeArray().map(function(t){return this[t.name]=t.value,this}.bind({}))[0]}function e(t,e){var n=$(t).val(),a=i[t];if(a.val!==n&&(a.val=n,a.changing=(new Date).getTime()),a.changing&&(new Date).getTime()>a.wait+a.changing&&(clearInterval(a.intv),a.intv=!1,a.change_cb)){var r={value:null,obj:{},el:null};r.el=$(t)[0],r.value=a.val,r.obj[a.prop]=a.val,a.change_cb(r,e)}}function n(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n]);return e}var a={multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:1500,intv:null,prop:null},i={},r={};this.bindForm=function(e,n,a){"undefined"==typeof n&&(n=!1),i.hasOwnProperty(e)||(i[e]=n,$(e).on("submit",function(i){i.preventDefault(),i.stopImmediatePropagation();var r={obj:t(e),el:$(e)[0]};n?n(r,a):$(e).trigger("change",r)}))},this.unbindForm=function(t){i.hasOwnProperty(t)&&($(document).off("submit",t),delete i[t])},this.bindField=function(t,r,o){if(!i.hasOwnProperty(t)){var l=n(a,r);l.prop=$(t).attr("name"),i[t]=l,$(t).on("input",function(){if(l.input_cb){var n={value:null,obj:{},el:null};n.el=$(t)[0],n.value=$(this).val(),n.obj[i[t].prop]=$(this).val(),l.input_cb(n,o)}i[t].intv||(i[t].intv=setInterval(function(){e(t,o)},300))}),l.multiline||$(t).on("keypress",function(e){if(13===e.which)if(e.preventDefault(),e.stopImmediatePropagation(),i[t].intv&&(clearInterval(i[t].intv),i[t].intv=null),l.change_cb){var n={value:null,obj:{},el:null};n.el=$(t)[0],n.value=$(this).val(),n.obj[i[t].prop]=$(this).val(),l.change_cb(n,o)}else $(t).trigger("change",$(this).val())})}},this.unbindField=function(t){i.hasOwnProperty(t)&&($(t).off("input"),i[t].multiline||$(t).off("keypress"),i[t].intv&&clearInterval(i[t].intv),delete i[t])},this.restrictField=function(t,e){var n={allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\-\\:\\(\\)\\\/_,;%'"â€™ ]$/gi,forbidden:!1,paste:!0,autocomplete:!0,multiline:!0,max:2500};if("undefined"==typeof e&&(e={}),e.hasOwnProperty("forbidden")&&(n.allowed=!1),!r.hasOwnProperty(t)){if("undefined"==typeof e)e=n;else for(var a in n)e.hasOwnProperty(a)||(e[a]=n[a]);var i=$(t);i.attr("pattern")&&(e.allowed=i.attr("pattern").replace(/{[0-9,]+}/,"")),r[t]=e,r[t].keys=[],e.autocomplete?e.hasOwnProperty("allowed")&&e.allowed&&(e.allowed=new RegExp(e.allowed.toString().replace("$/gi","+$").replace("/^","^"),"gi")):r[t].keys.push(229),["input","texarea"].indexOf(i.get(0).tagName.toLowerCase())!==-1?r[t].content="val":r[t].content="html",r[t].multiline||r[t].keys.push(13),i.on("textInput keydown",function(e){if("textInput"===e.type){var n=e.originalEvent.data;if(r[t].allowed){if(!n.match(r[t].allowed))return e.preventDefault(),e.stopImmediatePropagation(),!1}else if(r[t].forbidden&&n.match(r[t].forbidden))return e.preventDefault(),e.stopImmediatePropagation(),!1}if("keydown"===e.type){if(r[t].keys.indexOf(e.which)!==-1)return e.preventDefault(),e.stopImmediatePropagation(),!1;if($(this)[r[t].content]().length>=r[t].max&&8!==e.which)return e.preventDefault(),e.stopImmediatePropagation(),!1}}),r[t].paste||i.on("paste",function(t){t.preventDefault(),t.stopImmediatePropagation()})}},this.unrestrictField=function(t){if(r.hasOwnProperty(t)){var e=$(t);e.off("textInput keydown"),r[t].paste||e.off("paste"),delete r[t]}},this.formToObj=function(e){return t(e)},this.validateForm=function(t){var e,n,a,i=$(t),r={},o=!0;return i.find("input").each(function(t,i){e=$(i),i.hasAttribute("required")&&i.hasAttribute("pattern")&&"submit"!==e.attr("type")&&(n=e.attr("pattern"),a=e.val(),n&&(n=new RegExp(n,"g"),n.test(a)||(r[e.attr("name")]=!1,o=!1)))}),!!o||r}},OGX.FormTools=new OGX.prototype.FormTools;