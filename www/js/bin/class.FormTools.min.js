if(void 0===OGX)var OGX=function(){};OGX.FormTools=function(){"use strict";var l=this,t={container:!1,allowed:!1,forbidden:!1,submit_cb:!1,validate:!1},e={container:!1,allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\-\\:\\(\\)\\/_,;%'"â€™ ]$/gi,forbidden:!1,mask:!1,mask_char:"%",paste:!0,autocomplete:null,multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:1e3,intv:null,max:2500,type:"string",params:null},u={},a={};function o(n,t){if(u[t].change_cb){var e=c(t);for(var a in e)u[t].hasOwnProperty("fields")&&u[t].fields.hasOwnProperty(a)&&u[t].fields[a].hasOwnProperty("type")?e[a]=s(u[t].fields[a].type,e[a]):u[t].hasOwnProperty("type")&&(e[a]=s(u[t].type,e[a]));u[t].change_cb(e)}}function s(n,t){switch(n){case"string":return String(t);case"number":return Number(t);case"int":return parseInt(t);case"bool":return"true"===n||1===n}}function c(n){return $(n).serializeArray().map(function(n){return this[n.name]=n.value,this}.bind({}))[0]}function p(n){return Object.assign({},n)}function f(n,t){for(var e in t)n.hasOwnProperty(e)&&(n[e]=t[e]);return n}this.bindForm=function(n){return!u.hasOwnProperty(n.container)&&(function(e){var i,r=f(p(t),e);function a(n,t,e){if(e.hasAttribute("name")){if(i=$(e).attr("name"),delete(r=p(n)).fields,delete r.container,n.hasOwnProperty("fields")&&n.fields.hasOwnProperty(i))for(var a in n.fields[i])r[a]=n.fields[i][a];r.container=n.container+" "+e.tagName+'[name="'+i+'"]',r.change_cb=o,r.params=n.container,l.bindField(r)}}$(e.container).on("submit",function(n){n.preventDefault(),n.stopImmediatePropagation();var t={obj:c(e.container),form:e.container};u[e.container].validate&&(t.valid=l.validateForm(e.container)),u[e.container].change_cb?u[e.container].change_cb(t):u[e.container].submit_cb?u[e.container].submit_cb(t):$(e.container).trigger("change",t)}),$(e.container).find("input").each(function(n,t){a(e,n,t)}),$(e.container).find("textarea").each(function(n,t){a(e,n,t)})}(u[n.container]=n),!0)},this.unbindForm=function(n){var e,a;u.hasOwnProperty(n)&&(e=n,$(document).off("submit",e),$(e).find("input").each(function(n,t){a=$(t).attr("name"),l.unbindField(e+' input[name="'+a+'"]')}),$(e).find("textarea").each(function(n,t){a=$(t).attr("name"),l.unbindField(e+' textarea[name="'+a+'"]')}),delete u[e],delete u[n])},this.bindField=function(n){if(u.hasOwnProperty(n.container))return!1;!function(n){var r=f(p(e),n),o=$(r.container),c=o.attr("name");o.on("input change",function(){var n=$(this).val();if(r.input_cb){var t={value:null,obj:{},el:null};n=s(r.type,n),t.el=o[0],t.value=n,t.property=c,t.obj[c]=n,options.input_cb(t,r.params)}u[r.container].intv||(u[r.container].intv=setInterval(function(){!function(n,t){var e=$(n).val(),a=u[n];if(a.val!==e&&(a.val=e,a.changing=(new Date).getTime()),a.changing&&(new Date).getTime()>a.wait+a.changing&&(clearInterval(a.intv),a.intv=!1,u[n].change_cb)){var i={value:null,obj:{},el:null};e=s(u[n].type,e),i.el=$(n)[0],i.property=$(n).attr("name"),i.value=e,i.obj[i.property]=e,u[n].change_cb(i,t)}}(r.container,r.params)},50))}),r.multiline||o.on("keypress",function(n){var t=$(this).val();if(13!==n.which&&r.mask){if(t.length>r.mask.length)return n.preventDefault(),n.stopImmediatePropagation(),!1;for(var e=r.mask,a=0;a<t.length;a++)r.mask.substr(a,1)===r.mask_char&&(e=e.replace(r.mask_char,t.substr(a,1)));-1!==(t=e).indexOf(r.mask_char)&&(t=t.substr(0,t.indexOf(r.mask_char))),o.val(t)}if(13===n.which){n.preventDefault(),n.stopImmediatePropagation();var t=$(this).val();if(u[r.container].intv&&(clearInterval(u[r.container].intv),u[r.container].intv=null),r.change_cb){var i={value:null,obj:{},el:null};t=s(r.type,t),i.el=o[0],i.property=c,i.value=t,i.obj[c]=t,r.change_cb(i,r.params)}else o.trigger("change",t)}});((u[r.container]=r).allowed||r.forbidden)&&l.restrictField(r)}(n)},this.unbindField=function(n){if(u.hasOwnProperty(n)){var t=$(n);t.off("input change"),u[n].multiline||t.off("keypress"),u[n].intv&&clearInterval(u[n].intv),a.hasOwnProperty(n)&&this.unrestrictField(n),delete u[n]}},this.restrictField=function(n){return!a.hasOwnProperty(n.container)&&(function(e){var n=$(e.container);a[e.container]=e,a[e.container].keys=[],null===e.autocomplete&&n[0].hasAttribute("autocomplete")&&"on"===n.attr("autocomplete")?e.autocomplete=!0:e.autocomplete=!1;e.autocomplete?e.hasOwnProperty("allowed")&&e.allowed&&(e.allowed=new RegExp(e.allowed.toString().replace("$/gi","+$").replace("/^","^"),"gi")):a[e.container].keys.push(229);-1!==["input","texarea"].indexOf(n.get(0).tagName.toLowerCase())?a[e.container].content="val":a[e.container].content="html";a[e.container].multiline||a[e.container].keys.push(13);n.on("textInput keydown",function(n){if("textInput"===n.type){var t=n.originalEvent.data;if(a[e.container].allowed){if(!t.match(a[e.container].allowed))return n.preventDefault(),n.stopImmediatePropagation(),!1}else if(a[e.container].forbidden&&t.match(a[e.container].forbidden))return n.preventDefault(),n.stopImmediatePropagation(),!1}if("keydown"===n.type){if(-1!==a[e.container].keys.indexOf(n.which))return n.preventDefault(),n.stopImmediatePropagation(),!1;if($(this)[a[e.container].content]().length>=a[e.container].max&&8!==n.which)return n.preventDefault(),n.stopImmediatePropagation(),!1}}),a[e.container].paste||n.on("paste",function(n){n.preventDefault(),n.stopImmediatePropagation()})}(n),!0)},this.unrestrictField=function(n){if(a.hasOwnProperty(n)){var t=$(n);return t.off("textInput keydown"),a[n].paste||t.off("paste"),delete a[n],!0}return!1},this.formToObj=function(n){return c(n)},this.populateForm=function(n,e){var a,t=$(n);function i(n,t){a=$(t).attr("name"),n.hasOwnProperty(a)&&$(t).val(n[a])}t.find("input").each(function(n,t){i(e,t)}),t.find("texarea").each(function(n,t){i(e,t)})},this.validateForm=function(n){var e,a,i,t=$(n),r={},o=!0;return t.find("input").each(function(n,t){e=$(t),t.hasAttribute("required")&&t.hasAttribute("pattern")&&"submit"!==e.attr("type")&&(a=e.attr("pattern"),i=e.val(),a&&((a=new RegExp(a,"g")).test(i)||(r[e.attr("name")]=!1,o=!1)))}),!!o||r}},OGX.FormTools=new OGX.FormTools;