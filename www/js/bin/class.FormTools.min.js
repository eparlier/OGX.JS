if(void 0===OGX)var OGX=function(){};OGX.FormTools=function(){"use strict";var r=this,e={multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:1500,intv:null,prop:null},o={},l={};function u(t,e){o[e]?o[e](r.formToObj(e)):$(e).trigger("change",r.formToObj(e))}function p(t){return $(t).serializeArray().map(function(t){return this[t.name]=t.value,this}.bind({}))[0]}this.bindForm=function(t,e,n){var a,i;void 0===e&&(e=!1),o.hasOwnProperty(t)||(o[t]=e,a=t,$(a).on("submit",function(t){t.preventDefault(),t.stopImmediatePropagation();var e={obj:p(a),el:$(a)[0]};__callback?__callback(e,__extra_param):$(a).trigger("change",e)}),$(a).find("input").each(function(t,e){i=$(e).attr("name"),r.bindField(a+' input[name="'+i+'"]',{change_cb:u},a)}))},this.unbindForm=function(t){var n,a;o.hasOwnProperty(t)&&(n=t,$(document).off("submit",n),$(n).find("input").each(function(t,e){a=$(e).attr("name"),r.unbindField(n+' input[name="'+a+'"]')}),delete o[t])},this.bindField=function(n,t,a){var i=$(n);if(!o.hasOwnProperty(n)){var r=function(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n]);return e}(e,t);r.prop=i.attr("name"),o[n]=r,i.on("input change",function(){if(r.input_cb){var t={value:null,obj:{},el:null};t.el=i[0],t.value=$(this).val(),t.obj[o[n].prop]=$(this).val(),r.input_cb(t,a)}o[n].intv||(o[n].intv=setInterval(function(){!function(t,e){var n=$(t).val(),a=o[t];a.val!==n&&(a.val=n,a.changing=(new Date).getTime());if(a.changing&&(new Date).getTime()>a.wait+a.changing&&(clearInterval(a.intv),a.intv=!1,a.change_cb)){var i={value:null,obj:{},el:null};i.el=$(t)[0],i.value=a.val,i.obj[a.prop]=a.val,a.change_cb(i,e)}}(n,a)},300))}),r.multiline||i.on("keypress",function(t){if(13===t.which)if(t.preventDefault(),t.stopImmediatePropagation(),o[n].intv&&(clearInterval(o[n].intv),o[n].intv=null),r.change_cb){var e={value:null,obj:{},el:null};e.el=i[0],e.value=$(this).val(),e.obj[o[n].prop]=$(this).val(),r.change_cb(e,a)}else i.trigger("change",$(this).val())})}},this.unbindField=function(t){var e=$(t);o.hasOwnProperty(t)&&(e.off("input change"),o[t].multiline||e.off("keypress"),o[t].intv&&clearInterval(o[t].intv),delete o[t])},this.restrictField=function(n,t){var e={allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\-\\:\\(\\)\\/_,;%'"â€™ ]$/gi,forbidden:!1,paste:!0,autocomplete:!0,multiline:!0,max:2500};if(void 0===t&&(t={}),t.hasOwnProperty("forbidden")&&(e.allowed=!1),!l.hasOwnProperty(n)){if(void 0===t)t=e;else for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a]);var i=$(n);i.attr("pattern")&&(t.allowed=i.attr("pattern").replace(/{[0-9,]+}/,"")),l[n]=t,l[n].keys=[],t.autocomplete?t.hasOwnProperty("allowed")&&t.allowed&&(t.allowed=new RegExp(t.allowed.toString().replace("$/gi","+$").replace("/^","^"),"gi")):l[n].keys.push(229),-1!==["input","texarea"].indexOf(i.get(0).tagName.toLowerCase())?l[n].content="val":l[n].content="html",l[n].multiline||l[n].keys.push(13),i.on("textInput keydown",function(t){if("textInput"===t.type){var e=t.originalEvent.data;if(l[n].allowed){if(!e.match(l[n].allowed))return t.preventDefault(),t.stopImmediatePropagation(),!1}else if(l[n].forbidden&&e.match(l[n].forbidden))return t.preventDefault(),t.stopImmediatePropagation(),!1}if("keydown"===t.type){if(-1!==l[n].keys.indexOf(t.which))return t.preventDefault(),t.stopImmediatePropagation(),!1;if($(this)[l[n].content]().length>=l[n].max&&8!==t.which)return t.preventDefault(),t.stopImmediatePropagation(),!1}}),l[n].paste||i.on("paste",function(t){t.preventDefault(),t.stopImmediatePropagation()})}},this.unrestrictField=function(t){if(l.hasOwnProperty(t)){var e=$(t);e.off("textInput keydown"),l[t].paste||e.off("paste"),delete l[t]}},this.formToObj=function(t){return p(t)},this.populateForm=function(t,n){var a;$(t).find("input").each(function(t,e){a=$(e).attr("name"),n.hasOwnProperty(a)&&$(e).val(n[a])})},this.validateForm=function(t){var n,a,i,e=$(t),r={},o=!0;return e.find("input").each(function(t,e){n=$(e),e.hasAttribute("required")&&e.hasAttribute("pattern")&&"submit"!==n.attr("type")&&(a=n.attr("pattern"),i=n.val(),a&&((a=new RegExp(a,"g")).test(i)||(r[n.attr("name")]=!1,o=!1)))}),!!o||r}},OGX.FormTools=new OGX.FormTools;