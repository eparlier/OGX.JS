if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.FormTools=function(){"use strict";function n(n){return $(n).serializeArray().map(function(n){return this[n.name]=n.value,this}.bind({}))[0]}function t(n,t){var e=$(n).val(),i=a[n];if(i.val!==e&&(i.val=e,i.changing=(new Date).getTime()),i.changing&&(new Date).getTime()>i.wait+i.changing&&(clearInterval(i.intv),i.intv=!1,i.change_cb)){var r={value:null,obj:{},el:null};r.el=$(n)[0],r.value=i.val,r.obj[i.prop]=i.val,i.change_cb(r,t)}}function e(n,t){for(var e in n)t.hasOwnProperty(e)||(t[e]=n[e]);return t}var i={multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:1500,intv:null,prop:null},a={},r={};this.bindForm=function(t,e,i){"undefined"==typeof e&&(e=!1),a.hasOwnProperty(t)||(a[t]=e,$(t).on("submit",function(a){a.preventDefault(),a.stopImmediatePropagation();var r={obj:n(t),el:$(t)[0]};e?e(r,i):$(t).trigger("change",r)}))},this.unbindForm=function(n){a.hasOwnProperty(n)&&($(document).off("submit",n),delete a[n])},this.bindField=function(n,r,o){if(!a.hasOwnProperty(n)){var l=e(i,r);l.prop=$(n).attr("name"),a[n]=l,$(n).on("input",function(){if(l.input_cb){var e={value:null,obj:{},el:null};e.el=$(n)[0],e.value=$(this).val(),e.obj[a[n].prop]=$(this).val(),l.input_cb(e,o)}a[n].intv||(a[n].intv=setInterval(function(){t(n,o)},300))}),l.multiline||$(n).on("keypress",function(t){if(13===t.which)if(t.preventDefault(),t.stopImmediatePropagation(),a[n].intv&&(clearInterval(a[n].intv),a[n].intv=null),l.change_cb){var e={value:null,obj:{},el:null};e.el=$(n)[0],e.value=$(this).val(),e.obj[a[n].prop]=$(this).val(),l.change_cb(e,o)}else $(n).trigger("change",$(this).val())})}},this.unbindField=function(n){a.hasOwnProperty(n)&&($(n).off("input"),a[n].multiline||$(n).off("keypress"),a[n].intv&&clearInterval(a[n].intv),delete a[n])},this.restrictField=function(n,t){var e={allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\-\\:\\(\\)\\\/_,;%'" ]$/gi,multiline:!0,max:2500};if(!r.hasOwnProperty(n)){if("undefined"==typeof t)t=e;else for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);r[n]=t,r[n].keys=[8],r[n].multiline&&r[n].keys.push(13),$(n).on("keydown",function(t){return t.originalEvent.key.match(r[n].allowed)||r[n].keys.indexOf(t.originalEvent.which)!==-1?$(this).html().length>=r[n].max?(t.preventDefault(),t.stopImmediatePropagation(),!1):void 0:(t.preventDefault(),t.stopImmediatePropagation(),!1)})}},this.unrestrictField=function(n){r.hasOwnProperty(n)&&(delete r[n],$(n).off("keydown"))},this.formToObj=function(t){return n(t)},this.validateForm=function(n){var t,e,i,a=$(n),r={},o=!0;return a.find("input").each(function(n,a){t=$(a),a.hasAttribute("required")&&a.hasAttribute("pattern")&&"submit"!==t.attr("type")&&(e=t.attr("pattern"),i=t.val(),e&&(e=new RegExp(e,"g"),e.test(i)||(r[t.attr("name")]=!1,o=!1)))}),!!o||r}},OGX.FormTools=new OGX.prototype.FormTools;