if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.FormTools=function(){"use strict";function n(n){return $(n).serializeArray().map(function(n){return this[n.name]=n.value,this}.bind({}))[0]}function e(n,e){var t=$(n).val(),i=a[n];if(i.val!==t&&(i.val=t,i.changing=(new Date).getTime()),i.changing&&(new Date).getTime()>i.wait+i.changing&&(clearInterval(i.intv),i.intv=!1,i.change_cb)){var o={value:null,obj:{},el:null};o.el=$(n)[0],o.value=i.val,o.obj[i.prop]=i.val,i.change_cb(o,e)}}function t(n,e){for(var t in n)e.hasOwnProperty(t)||(e[t]=n[t]);return e}var i={multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:1500,intv:null,prop:null},a={},o={};this.bindForm=function(e,t,i){"undefined"==typeof t&&(t=!1),a.hasOwnProperty(e)||(a[e]=t,$(e).on("submit",function(a){a.preventDefault(),a.stopImmediatePropagation();var o={obj:n(e),el:$(e)[0]};t?t(o,i):$(e).trigger("change",o)}))},this.unbindForm=function(n){a.hasOwnProperty(n)&&($(document).off("submit",n),delete a[n])},this.bindField=function(n,o,l){if(!a.hasOwnProperty(n)){var r=t(i,o);r.prop=$(n).attr("name"),a[n]=r,$(n).on("input",function(){if(r.input_cb){var t={value:null,obj:{},el:null};t.el=$(n)[0],t.value=$(this).val(),t.obj[a[n].prop]=$(this).val(),r.input_cb(t,l)}a[n].intv||(a[n].intv=setInterval(function(){e(n,l)},300))}),r.multiline||$(n).on("keypress",function(e){if(13===e.which)if(e.preventDefault(),e.stopImmediatePropagation(),a[n].intv&&(clearInterval(a[n].intv),a[n].intv=null),r.change_cb){var t={value:null,obj:{},el:null};t.el=$(n)[0],t.value=$(this).val(),t.obj[a[n].prop]=$(this).val(),r.change_cb(t,l)}else $(n).trigger("change",$(this).val())})}},this.unbindField=function(n){a.hasOwnProperty(n)&&($(n).off("input"),a[n].multiline||$(n).off("keypress"),a[n].intv&&clearInterval(a[n].intv),delete a[n])},this.restrictField=function(n,e){var t={allowed:/^[a-z0-9!_\\.\\?\\#\\@\\-\\:\\(\\)\\\/,; ]$/gi,multiline:!0,max:2500};if(!o.hasOwnProperty(n)){if("undefined"==typeof e)e=t;else for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i]);o[n]=e,o[n].keys=[8],o[n].multiline&&o[n].keys.push(13),$(n).on("keydown",function(e){return e.originalEvent.key.match(o[n].allowed)||o[n].keys.indexOf(e.originalEvent.which)!==-1?$(this).html().length>=o[n].max?(e.preventDefault(),e.stopImmediatePropagation(),!1):void 0:(e.preventDefault(),e.stopImmediatePropagation(),!1)})}},this.unrestrictField=function(n){o.hasOwnProperty(n)&&(delete o[n],$(n).off("keydown"))},this.formToObj=function(e){return n(e)}},OGX.FormTools=new OGX.prototype.FormTools;