if(void 0===OGX)var OGX=function(){};OGX.FormTools=function(){"use strict";var l=this,n={container:!1,allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\-\\:\\(\\)\\/_,;%'"â€™ ]$/gi,forbidden:!1,mask:!1,mask_char:"%",paste:!0,autocomplete:null,multiline:!1,input_cb:!1,change_cb:!1,submit_cb:!1,val:null,changing:!1,wait:1e3,intv:null,max:2500,type:"string",params:null},u={},a={};function o(t,e){if(u[e].change_cb){var n=c(e);for(var a in n)u[e].hasOwnProperty("fields")&&u[e].fields.hasOwnProperty(a)&&u[e].fields[a].hasOwnProperty("type")?n[a]=s(u[e].fields[a].type,n[a]):u[e].hasOwnProperty("type")&&(n[a]=s(u[e].type,n[a]));u[e].change_cb(n)}}function s(t,e){switch(t){case"string":return String(e);case"number":return Number(e);case"int":return parseInt(e);case"bool":return"true"===t||1===t}}function c(t){return $(t).serializeArray().map(function(t){return this[t.name]=t.value,this}.bind({}))[0]}function p(t){return Object.assign({},t)}this.bindForm=function(t){return!u.hasOwnProperty(t.container)&&(function(n){var r,i;function a(t,e,n){if(n.hasAttribute("name")){if(r=$(n).attr("name"),delete(i=p(t)).fields,delete i.container,t.hasOwnProperty("fields")&&t.fields.hasOwnProperty(r))for(var a in t.fields[r])i[a]=t.fields[r][a];i.container=t.container+" "+n.tagName+'[name="'+r+'"]',i.change_cb=o,i.params=t.container,l.bindField(i)}}$(n.container).on("submit",function(t){t.preventDefault(),t.stopImmediatePropagation();var e={obj:c(n.container),form:n.container};u[n.container].hasOwnProperty("change_cb")?u[n.container].change_cb(e):u[n.container].hasOwnProperty("submit_cb")?u[n.container].submit_cb(e):$(n.container).trigger("change",e)}),$(n.container).find("input").each(function(t,e){a(n,t,e)}),$(n.container).find("textarea").each(function(t,e){a(n,t,e)})}(u[t.container]=t),!0)},this.unbindForm=function(t){var n,a;u.hasOwnProperty(t)&&(n=t,$(document).off("submit",n),$(n).find("input").each(function(t,e){a=$(e).attr("name"),l.unbindField(n+' input[name="'+a+'"]')}),$(n).find("textarea").each(function(t,e){a=$(e).attr("name"),l.unbindField(n+' textarea[name="'+a+'"]')}),delete u[t])},this.bindField=function(t){if(u.hasOwnProperty(t.container))return!1;!function(t){var i=p(n);for(var e in t)i.hasOwnProperty(e)&&(i[e]=t[e]);var o=$(i.container),c=o.attr("name");o.on("input change",function(){var t=$(this).val();if(i.input_cb){var e={value:null,obj:{},el:null};t=s(i.type,t),e.el=o[0],e.value=t,e.property=c,e.obj[c]=t,options.input_cb(e,i.params)}u[i.container].intv||(u[i.container].intv=setInterval(function(){!function(t,e){var n=$(t).val(),a=u[t];if(a.val!==n&&(a.val=n,a.changing=(new Date).getTime()),a.changing&&(new Date).getTime()>a.wait+a.changing&&(clearInterval(a.intv),a.intv=!1,u[t].change_cb)){var r={value:null,obj:{},el:null};n=s(u[t].type,n),r.el=$(t)[0],r.property=$(t).attr("name"),r.value=n,r.obj[r.property]=n,u[t].change_cb(r,e)}}(i.container,i.params)},50))}),i.multiline||o.on("keypress",function(t){var e=$(this).val();if(13!==t.which&&i.mask){if(e.length>i.mask.length)return t.preventDefault(),t.stopImmediatePropagation(),!1;for(var n=i.mask,a=0;a<e.length;a++)i.mask.substr(a,1)===i.mask_char&&(n=n.replace(i.mask_char,e.substr(a,1)));-1!==(e=n).indexOf(i.mask_char)&&(e=e.substr(0,e.indexOf(i.mask_char))),o.val(e)}if(13===t.which){t.preventDefault(),t.stopImmediatePropagation();var e=$(this).val();if(u[i.container].intv&&(clearInterval(u[i.container].intv),u[i.container].intv=null),i.change_cb){var r={value:null,obj:{},el:null};e=s(i.type,e),r.el=o[0],r.property=c,r.value=e,r.obj[c]=e,i.change_cb(r,i.params)}else o.trigger("change",e)}});((u[i.container]=i).allowed||i.forbidden)&&l.restrictField(i)}(t)},this.unbindField=function(t){if(u.hasOwnProperty(t)){var e=$(t);e.off("input change"),u[t].multiline||e.off("keypress"),u[t].intv&&clearInterval(u[t].intv),a.hasOwnProperty(t)&&this.unrestrictField(t),delete u[t]}},this.restrictField=function(t){return!a.hasOwnProperty(t.container)&&(function(n){var t=$(n.container);!n.allowed&&t[0].hasAttribute("pattern")&&(n.allowed=t.attr("pattern").replace(/{[0-9,]+}/,""));a[n.container]=n,a[n.container].keys=[],null===n.autocomplete&&t[0].hasAttribute("autocomplete")&&"on"===t.attr("autocomplete")?n.autocomplete=!0:n.autocomplete=!1;n.autocomplete?n.hasOwnProperty("allowed")&&n.allowed&&(n.allowed=new RegExp(n.allowed.toString().replace("$/gi","+$").replace("/^","^"),"gi")):a[n.container].keys.push(229);-1!==["input","texarea"].indexOf(t.get(0).tagName.toLowerCase())?a[n.container].content="val":a[n.container].content="html";a[n.container].multiline||a[n.container].keys.push(13);t.on("textInput keydown",function(t){if("textInput"===t.type){var e=t.originalEvent.data;if(a[n.container].allowed){if(!e.match(a[n.container].allowed))return t.preventDefault(),t.stopImmediatePropagation(),!1}else if(a[n.container].forbidden&&e.match(a[n.container].forbidden))return t.preventDefault(),t.stopImmediatePropagation(),!1}if("keydown"===t.type){if(-1!==a[n.container].keys.indexOf(t.which))return t.preventDefault(),t.stopImmediatePropagation(),!1;if($(this)[a[n.container].content]().length>=a[n.container].max&&8!==t.which)return t.preventDefault(),t.stopImmediatePropagation(),!1}}),a[n.container].paste||t.on("paste",function(t){t.preventDefault(),t.stopImmediatePropagation()})}(t),!0)},this.unrestrictField=function(t){if(a.hasOwnProperty(t)){var e=$(t);return e.off("textInput keydown"),a[t].paste||e.off("paste"),delete a[t],!0}return!1},this.formToObj=function(t){return c(t)},this.populateForm=function(t,n){var a,e=$(t);function r(t,e){a=$(e).attr("name"),t.hasOwnProperty(a)&&$(e).val(t[a])}e.find("input").each(function(t,e){r(n,e)}),e.find("texarea").each(function(t,e){r(n,e)})},this.validateForm=function(t){var n,a,r,e=$(t),i={},o=!0;return e.find("input").each(function(t,e){n=$(e),e.hasAttribute("required")&&e.hasAttribute("pattern")&&"submit"!==n.attr("type")&&(a=n.attr("pattern"),r=n.val(),a&&((a=new RegExp(a,"g")).test(r)||(i[n.attr("name")]=!1,o=!1)))}),!!o||i}},OGX.FormTools=new OGX.FormTools;