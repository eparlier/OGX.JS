if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.FormTools=function(){"use strict";function t(t){return $(t).serializeArray().map(function(t){return this[t.name]=t.value,this}.bind({}))[0]}function e(t,e){var n=$(t).val(),i=a[t];if(i.val!==n&&(i.val=n,i.changing=(new Date).getTime()),i.changing&&(new Date).getTime()>i.wait+i.changing&&(clearInterval(i.intv),i.intv=!1,i.change_cb)){var r={value:null,obj:{},el:null};r.el=$(t)[0],r.value=i.val,r.obj[i.prop]=i.val,i.change_cb(r,e)}}function n(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n]);return e}var i={multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:1500,intv:null,prop:null},a={},r={};this.bindForm=function(e,n,i){"undefined"==typeof n&&(n=!1),a.hasOwnProperty(e)||(a[e]=n,$(e).on("submit",function(a){a.preventDefault(),a.stopImmediatePropagation();var r={obj:t(e),el:$(e)[0]};n?n(r,i):$(e).trigger("change",r)}))},this.unbindForm=function(t){a.hasOwnProperty(t)&&($(document).off("submit",t),delete a[t])},this.bindField=function(t,r,o){if(!a.hasOwnProperty(t)){var l=n(i,r);l.prop=$(t).attr("name"),a[t]=l,$(t).on("input",function(){if(l.input_cb){var n={value:null,obj:{},el:null};n.el=$(t)[0],n.value=$(this).val(),n.obj[a[t].prop]=$(this).val(),l.input_cb(n,o)}a[t].intv||(a[t].intv=setInterval(function(){e(t,o)},300))}),l.multiline||$(t).on("keypress",function(e){if(13===e.which)if(e.preventDefault(),e.stopImmediatePropagation(),a[t].intv&&(clearInterval(a[t].intv),a[t].intv=null),l.change_cb){var n={value:null,obj:{},el:null};n.el=$(t)[0],n.value=$(this).val(),n.obj[a[t].prop]=$(this).val(),l.change_cb(n,o)}else $(t).trigger("change",$(this).val())})}},this.unbindField=function(t){a.hasOwnProperty(t)&&($(t).off("input"),a[t].multiline||$(t).off("keypress"),a[t].intv&&clearInterval(a[t].intv),delete a[t])},this.restrictField=function(t,e){var n={allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\-\\:\\(\\)\\\/_,;%'" ]$/gi,forbidden:!1,paste:!0,autocomplete:!0,multiline:!0,max:2500};if("undefined"==typeof e&&(e={}),e.hasOwnProperty("forbidden")&&delete n.allowed,!r.hasOwnProperty(t)){if("undefined"==typeof e)e=n;else for(var i in n)e.hasOwnProperty(i)||(e[i]=n[i]);var a=$(t);a.attr("pattern")&&(e.allowed=a.attr("pattern").replace(/{[0-9,]+}/,"")),r[t]=e,r[t].keys=[],e.autocomplete||r[t].keys.push(229),["input","texarea"].indexOf(a.get(0).tagName.toLowerCase())!==-1?r[t].content="val":r[t].content="html",r[t].multiline||r[t].keys.push(13),a.on("textInput keydown",function(e){if("textInput"===e.type){var n=e.originalEvent.data;if(r[t].allowed){if(!n.match(r[t].allowed))return e.preventDefault(),e.stopImmediatePropagation(),!1}else if(r[t].forbidden&&n.match(r[t].forbidden))return e.preventDefault(),e.stopImmediatePropagation(),!1}if("keydown"===e.type){if(r[t].keys.indexOf(e.which)!==-1)return e.preventDefault(),e.stopImmediatePropagation(),!1;if($(this)[r[t].content]().length>=r[t].max&&8!==e.which)return e.preventDefault(),e.stopImmediatePropagation(),!1}}),r[t].paste||a.on("paste",function(t){t.preventDefault(),t.stopImmediatePropagation()})}},this.unrestrictField=function(t){if(r.hasOwnProperty(t)){var e=$(t);e.off("textInput keydown"),r[t].paste||e.off("paste"),delete r[t]}},this.formToObj=function(e){return t(e)},this.validateForm=function(t){var e,n,i,a=$(t),r={},o=!0;return a.find("input").each(function(t,a){e=$(a),a.hasAttribute("required")&&a.hasAttribute("pattern")&&"submit"!==e.attr("type")&&(n=e.attr("pattern"),i=e.val(),n&&(n=new RegExp(n,"g"),n.test(i)||(r[e.attr("name")]=!1,o=!1)))}),!!o||r}},OGX.FormTools=new OGX.prototype.FormTools;