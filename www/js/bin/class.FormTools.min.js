if(void 0===OGX)var OGX=function(){};OGX.FormTools=function(){"use strict";var l=this,e={multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:1500,intv:null,prop:null},u={},r={};function p(t,e){u[e]?u[e](l.formToObj(e)):$(e).trigger("change",l.formToObj(e))}function f(t){return $(t).serializeArray().map(function(t){return this[t.name]=t.value,this}.bind({}))[0]}this.bindForm=function(n,a,i){var r,o;void 0===a&&(a=!1),u.hasOwnProperty(n)||(u[n]=a,$(n).on("submit",function(t){t.preventDefault(),t.stopImmediatePropagation();var e={obj:f(n),el:$(n)[0]};a?a(e,i):$(n).trigger("change",e)}),r=n,$(r).find("input").each(function(t,e){o=$(e).attr("name"),l.bindField(r+" input[name="+o+"]",{change_cb:p},r)}))},this.unbindForm=function(t){var n,a;u.hasOwnProperty(t)&&($(document).off("submit",t),n=t,$(n).find("input").each(function(t,e){a=$(e).attr("name"),l.unbindField(n+" input[name="+a+"]")}),delete u[t])},this.bindField=function(n,t,a){if(!u.hasOwnProperty(n)){var i=function(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n]);return e}(e,t);i.prop=$(n).attr("name"),u[n]=i,$(n).on("input",function(){if(i.input_cb){var t={value:null,obj:{},el:null};t.el=$(n)[0],t.value=$(this).val(),t.obj[u[n].prop]=$(this).val(),i.input_cb(t,a)}u[n].intv||(u[n].intv=setInterval(function(){!function(t,e){var n=$(t).val(),a=u[t];a.val!==n&&(a.val=n,a.changing=(new Date).getTime());if(a.changing&&(new Date).getTime()>a.wait+a.changing&&(clearInterval(a.intv),a.intv=!1,a.change_cb)){var i={value:null,obj:{},el:null};i.el=$(t)[0],i.value=a.val,i.obj[a.prop]=a.val,a.change_cb(i,e)}}(n,a)},300))}),i.multiline||$(n).on("keypress",function(t){if(13===t.which)if(t.preventDefault(),t.stopImmediatePropagation(),u[n].intv&&(clearInterval(u[n].intv),u[n].intv=null),i.change_cb){var e={value:null,obj:{},el:null};e.el=$(n)[0],e.value=$(this).val(),e.obj[u[n].prop]=$(this).val(),i.change_cb(e,a)}else $(n).trigger("change",$(this).val())})}},this.unbindField=function(t){u.hasOwnProperty(t)&&($(t).off("input"),u[t].multiline||$(t).off("keypress"),u[t].intv&&clearInterval(u[t].intv),delete u[t])},this.restrictField=function(n,t){var e={allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\-\\:\\(\\)\\/_,;%'"â€™ ]$/gi,forbidden:!1,paste:!0,autocomplete:!0,multiline:!0,max:2500};if(void 0===t&&(t={}),t.hasOwnProperty("forbidden")&&(e.allowed=!1),!r.hasOwnProperty(n)){if(void 0===t)t=e;else for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a]);var i=$(n);i.attr("pattern")&&(t.allowed=i.attr("pattern").replace(/{[0-9,]+}/,"")),r[n]=t,r[n].keys=[],t.autocomplete?t.hasOwnProperty("allowed")&&t.allowed&&(t.allowed=new RegExp(t.allowed.toString().replace("$/gi","+$").replace("/^","^"),"gi")):r[n].keys.push(229),-1!==["input","texarea"].indexOf(i.get(0).tagName.toLowerCase())?r[n].content="val":r[n].content="html",r[n].multiline||r[n].keys.push(13),i.on("textInput keydown",function(t){if("textInput"===t.type){var e=t.originalEvent.data;if(r[n].allowed){if(!e.match(r[n].allowed))return t.preventDefault(),t.stopImmediatePropagation(),!1}else if(r[n].forbidden&&e.match(r[n].forbidden))return t.preventDefault(),t.stopImmediatePropagation(),!1}if("keydown"===t.type){if(-1!==r[n].keys.indexOf(t.which))return t.preventDefault(),t.stopImmediatePropagation(),!1;if($(this)[r[n].content]().length>=r[n].max&&8!==t.which)return t.preventDefault(),t.stopImmediatePropagation(),!1}}),r[n].paste||i.on("paste",function(t){t.preventDefault(),t.stopImmediatePropagation()})}},this.unrestrictField=function(t){if(r.hasOwnProperty(t)){var e=$(t);e.off("textInput keydown"),r[t].paste||e.off("paste"),delete r[t]}},this.formToObj=function(t){return f(t)},this.populateForm=function(t,n){var a;$(t).find("input").each(function(t,e){a=$(e).attr("name"),n.hasOwnProperty(a)&&$(e).val(n[a])})},this.validateForm=function(t){var n,a,i,e=$(t),r={},o=!0;return e.find("input").each(function(t,e){n=$(e),e.hasAttribute("required")&&e.hasAttribute("pattern")&&"submit"!==n.attr("type")&&(a=n.attr("pattern"),i=n.val(),a&&((a=new RegExp(a,"g")).test(i)||(r[n.attr("name")]=!1,o=!1)))}),!!o||r}},OGX.FormTools=new OGX.FormTools;