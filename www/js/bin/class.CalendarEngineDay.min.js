if(void 0===OGX)var OGX=function(){};OGX.Calendar.Engines.Day=function(e){"use strict";OGX.Calendar.Engines.Engine.call(this),null==e&&(e={});var d,a,r=this,M=e,n={selectable:!0,min_hour:6,max_hour:22,render_hour_grid:!0},t=!1,_={};function o(e,a,r){for(var n,d=0;d<_[e][a].length;d++)if((n=_[e][a][d])._id===r)return n;return!1}function l(e,a,r,n){var d,t,_,o,l,i,c,s,h,g,m,u,y,p,f,v,x=(d=e,t=a,_={},o=M.max_hour-M.min_hour+1,l=d.height(),c=100*(i=l/o)/l,s=t.start.split(":"),h=Number(s[0])+Number(s[1])/60-M.min_hour,_.h_pc=Math.round(c*(t.length/60)*100)/100,_.h=Math.round(i*(t.length/60)*100)/100,_.y_pc=Math.round(h*c*100)/100,_.y=Math.round(h*i*100)/100,_),C=e.children(".ogx_calendar_day_renderer_column").length,E=!1;if(0===C)e.html('<div class="ogx_calendar_day_renderer_column"></div>'),E=e.children(".ogx_calendar_day_renderer_column:first");else{for(var b=0;b<C;b++){if(p=!1,0<(g=e.children(".ogx_calendar_day_renderer_column:eq("+b+")").children(".ogx_calendar_day_renderer_apt").length)){for(var D=0;D<g;D++)if(u=(m=e.children(".ogx_calendar_day_renderer_column:eq("+b+")").children(".ogx_calendar_day_renderer_apt:eq("+D+")")).position().top,y=m.height(),f={top:x.y,bottom:x.y+x.h},v={top:u,bottom:u+y},Math.max(f.top,v.top)<Math.min(f.bottom,v.bottom)){p=!0;break}if(!p){E=e.children(".ogx_calendar_day_renderer_column:eq("+b+")");break}}if(E)break}E||(e.append('<div class="ogx_calendar_day_renderer_column"></div>'),E=e.children(".ogx_calendar_day_renderer_column:last"))}E.append('<div class="ogx_calendar_day_renderer_apt" style="height:'+x.h_pc+"%; top:"+x.y_pc+"%; background-color:"+n[a.type].color+'" data-id="'+a._id+'" data-time="'+a.start+'" data-date="'+r+'"><div class="ogx_calendar_day_renderer_apt_info"><span class="ogx_calendar_day_renderer_apt_time">'+a.start+'</span><span class="ogx_calendar_day_renderer_apt_label">'+a.label+"</span></div></div>")}function i(e,a,r,n){e.html('<div class="ogx_calendar_day_renderer"><div class="ogx_calendar_day_renderer_hours"></div><div class="ogx_calendar_day_renderer_columns"></div></div>'),M.render_hour_grid&&function(e){for(var a=e.find(".ogx_calendar_day_renderer_hours:first"),r="",n=M.min_hour;n<M.max_hour+1;n++)r+='<div class="ogx_calendar_day_renderer_hour"><span class="ogx_calendar_day_renderer_hour_label">'+n+"</span></div>";a.html(r)}(e);var d=e.find(".ogx_calendar_day_renderer_columns:first");for(var t in a)for(var _=0;_<a[t].length;_++)l(d,a[t][_],r,n.categories)}this.render=function(e,a,r){void 0===r&&(r=moment()),moment.isMoment(r)||(r=moment(r));var n=r.format("YYYY-MM-DD");_[n]=OGX.Calendar.Helpers.DataHelper.getDay(r,a),i(d=$(e),_[n],n,a),M.selectable&&this.listenApt(!0)},this.update=function(e,a,r){void 0===r&&(r=moment()),moment.isMoment(r)||(r=moment(r));var n=r.format("YYYY-MM-DD");_[n]=OGX.Calendar.Helpers.DataHelper.getDay(r,a),i(d=$(e),_[n],n,a)},this.listenApt=function(e){e?d&&d.on("click",".ogx_calendar_day_renderer_apt",function(e){if($(this).hasClass("ogx_calendar_day_renderer_selected_apt"))return $(this).removeClass("ogx_calendar_day_renderer_selected_apt"),d.trigger(OGX.Calendar.Engines.Day.UNSELECT,o(t.data("date"),t.data("time"),t.data("id"))),void(a=t=null);t&&t.removeClass("ogx_calendar_day_renderer_selected_apt"),$(this).addClass("ogx_calendar_day_renderer_selected_apt"),t=$(this),a=o(t.data("date"),t.data("time"),t.data("id")),d.trigger(OGX.Calendar.Engines.Day.SELECT,a)}):d&&d.off("click",".ogx_calendar_day_renderer_apt")},this.destroy=function(){M.selectable&&r.listenApt(!1)},"undefined"!=typeof moment?function(){for(var e in n)M.hasOwnProperty(e)||(M[e]=n[e])}():console.log("%c CRITICAL ERROR - moment.js not found! ","background:#222; color: #FF0000")},OGX.Calendar.Engines.Day.SELECT="CalendarEngineDaySelect",OGX.Calendar.Engines.Day.UNSELECT="CalendarEngineDayUnselect";