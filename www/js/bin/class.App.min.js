if(void 0===OGX)var OGX=function(){};OGX.Stages=function(){},OGX.Views=function(){},OGX.Controllers=function(){},OGX.Overlays={},OGX.App=function(){"use strict";var that=this,config,config_default={scope:["public"],overlay_delay:350,observe:!1,auto_exit:!1,chromeos:!1},windows_default,popups_default,stage=!1,stageShown=!1,stages={},stageNav=!1,isWebView=!1,locked=!1,gfx=new OGX.ResponsiveGraphics({bind:!1}),winZ=1e3,to_preload=0,preloaded=0,sounds={},route,url;function createStage(e){e.hasOwnProperty("template")&&(e.html=OGX.Templater.getTemplate(e.template)),e.hasOwnProperty("data")&&"{}"!==JSON.stringify(e.data)&&(e.html=OGX.Templater.templatize(e.data,e.html)),e.hasOwnProperty("use")&&e.use&&(stage=e.name,$("body").append('<div class="ogx_stage" style="display:none">'+e.html+"</div>")),OGX.Stages[e.name].prototype=Object.create(OGX.BaseStage.prototype),OGX.Stages[e.name].prototype.constructor=OGX.Stages[e.name];var s=new OGX.Stages[e.name];return e.el=$("body").children(".ogx_stage:last"),s._construct_(e),setTimeout(function(){s.constructor(e.data),e.hasOwnProperty("use")&&e.use&&s.ux(!0)},0),s}function blurStage(e){if(!stages.hasOwnProperty(e))return!1;for(var s in stages[e].windows)stages[e].windows[s].hasOwnProperty("blur")&&stages[e].windows[s].blur();for(var s in stages[e].popups)stages[e].popups[s].hasOwnProperty("blur")&&stages[e].popups[s].blur();for(var s in stages[e].views)stages[e].views[s].hasOwnProperty("blur")&&stages[e].views[s].blur()}function focusStage(e){if(!stages.hasOwnProperty(e))return!1;for(var s in stages[e].windows)stages[e].windows[s].hasOwnProperty("focus")&&stages[e].windows[s].focus();for(var s in stages[e].popups)stages[e].popups[s].hasOwnProperty("focus")&&stages[e].popups[s].focus();for(var s in stages[e].views)stages[e].views[s].hasOwnProperty("focus")&&stages[e].views[s].focus()}function clearStage(e){var s=!1;for(var t in e!==stage&&(s=stage,app.useStage(e)),clearStageViews(e),stages[e].popups)destroyPopup(t);for(var a in stages[e].windows)destroyWindow(a);for(var o in stages[e].controllers)destroyController(o);s&&app.useStage(s)}function clearStageViews(e){for(var s in stages[e].views)destroyView(s)}function attachWindow(e,s){var t=stages[stage].windows[e];void 0!==s&&s?(stages[stage].stage.el.append('<div id="ogx_temp" style="display:none;">'+t.el+"</div>"),t.el=stages[stage].stage.el.find("#ogx_temp").find(".ogx_window:first")):(stages[stage].stage.el.append(t.el),t.el=stages[stage].stage.el.find(".ogx_window:last")),t.attached=!0}function detachWindow(e,s){var t=stages[stage].windows[e];t.el=t.el.detach(),s&&stages[stage].stage.el.find("#ogx_temp").remove(),t.attached=!1}function destroyWindow(e){for(var s in listenWindow(!1,e),stages[stage].windows[e].views)destroyWindowView(e,s);stages[stage].windows[e].el.remove(),stages[stage].windows[e].destroy(),delete stages[stage].windows[e]}function animWindow(e,s){var t={opac:1,tX:0,tY:0},a=stages[stage].stage.el.width(),o=stages[stage].stage.el.height(),n=stages[stage].windows[e],i=n.el.outerWidth(),r=n.el.outerHeight(),g=n.el.find(".ogx_window_main_icon:first"),p=n.getTiming();switch(s.way&&(void 0===n.zindex&&(n.el.css("z-index",winZ),winZ++),s.hasOwnProperty("fade")&&s.fade&&n.el.css("opacity",0)),s.way?(placeWindow(e,s.anim,!0),p=p.in,g.removeClass("ogx_window_main_icon_left ogx_window_main_icon_right ogx_window_main_icon_top")):(p=p.out,s.hasOwnProperty("fade")&&s.fade&&(t.opac=0)),s.anim){case OGX.Window.ANIM_NONE:break;case OGX.Window.ANIM_TOP:s.way?(t.tY=0,g.addClass("ogx_window_main_icon_top")):t.tY=-r;break;case OGX.Window.ANIM_BOTTOM:s.way?(t.tY=o-r,g.addClass("ogx_window_main_icon_bottom")):t.tY=o;break;case OGX.Window.ANIM_RIGHT:s.way?(t.tX=a-i,g.addClass("ogx_window_main_icon_right")):t.tX=a;break;case OGX.Window.ANIM_LEFT:s.way?(t.tX=0,g.addClass("ogx_window_main_icon_left")):t.tX=-i}void 0!==s.anim_params&&(s.anim_params.hasOwnProperty("left")&&(t.tX=a-getSize("width",s.anim_params.left)),s.anim_params.hasOwnProperty("top")&&(t.tY=getSize("height",s.anim_params.top)),s.anim_params.hasOwnProperty("right")&&(t.tX=getSize("width",s.anim_params.right)));var l=100;s.way||(l=0),setTimeout(function(){n.el.on("transitionend",function(){n.el.off("transitionend"),s.way?(n.isDragable()&&n.enableDrag(),n.el.removeClass("ogx_window_anim_in")):n.el.removeClass("ogx_window_anim_out"),s.hasOwnProperty("cb")&&s.cb&&(s.hasOwnProperty("params")&&s.params?s.cb.apply(that,[s.params]):s.cb()),s.way?(n.status=OGX.Window.OPENED,stages[stage].stage.el.trigger(OGX.Window.OPENED,e),that.focusWindow(e)):(n.status=OGX.Window.CLOSED,stages[stage].stage.el.trigger(OGX.Window.CLOSED,e),s.remove&&that.removeWindow(e))}),s.way?(n.status=OGX.Window.OPEN,stages[stage].stage.el.trigger(OGX.Window.OPEN,e)):(that.blurWindow(e),n.status=OGX.Window.CLOSE,stages[stage].stage.el.trigger(OGX.Window.CLOSE,e)),n.el.css({transform:"translate3D("+t.tX+"px, "+t.tY+"px, 0px)",opacity:t.opac,transition:"all "+p+"ms",visibility:"visible"})},l)}function placeWindow(e,s,t){var a=stages[stage].stage.el.width(),o=stages[stage].stage.el.height(),n=stages[stage].windows[e],i=n.el.outerHeight(),r=n.el.outerWidth();switch(n.el.css("transition","none"),s){case OGX.Window.ANIM_NONE:t&&n.el.css({transform:"translate3D(0px, 0px, 0px)"});break;case OGX.Window.ANIM_TOP:t&&n.el.css({transform:"translate3D(0px, -"+i+"px, 0px)"});break;case OGX.Window.ANIM_BOTTOM:t&&n.el.css({transform:"translate3D(0px, "+o+"px, 0px)"});break;case OGX.Window.ANIM_RIGHT:t&&n.el.css({transform:"translate3D("+a+"px, 0px, 0px)"});break;case OGX.Window.ANIM_LEFT:t&&(a=n.el.outerWidth(),n.el.css({transform:"translate3D("+-r+"px, 0px, 0px)"}))}t||n.el.css("visibility","hidden")}function listenWindow(e,s){e?stages[stage].windows[s].el.on("mousedown",".ogx_window_main_icon_back",function(){that.hideWindow(s)}):stages[stage].windows[s].el.off("mousedown",".ogx_window_main_icon_back")}function destroyWindowView(e,s){void 0===s&&(s='.ogx_window[data-ogx="'+e+'"] .ogx_view'),stages[stage].windows[e].views[s]._destroy_(),stages[stage].windows[e].views[s].destroy(),stages[stage].windows[e].views[s].empty(),delete stages[stage].windows[e].views[s]}function listenPopupAnim(e,s){stages[stage].popups.hasOwnProperty(s)&&stages[stage].popups[s].el&&(e?stages[stage].popups[s].el.on("transitionend",function(){listenPopupAnim(!1),destroyPopup(s)}):stages[stage].popups[s].el.off("transitionend"))}function destroyPopup(e){if(stages[stage].popups.hasOwnProperty(e)){for(var s in stages[stage].popups[e].views)stages[stage].popups[e].views[s]._destroy_(),stages[stage].popups[e].views[s].destroy(),stages[stage].popups[e].views[s].empty(),delete stages[stage].popups[e].views[s];stages[stage].popups[e].destroy(),stages[stage].popups[e].el.remove(),delete stages[stage].popups[e]}}function listenOverlay(e){e?stages[stage].overlay.el.on("touchstart",onTouchOverlay):stages[stage].overlay.el.off("touchstart",onTouchOverlay)}function onTouchOverlay(e){e.preventDefault(),e.stopImmediatePropagation(),stages[stage].stage.el.trigger(OGX.App.OVERLAY_REMOVE),that.removeOverlay(),stages[stage].popup&&that.removePopup()}function removeOverlay(e){if(stages[stage].overlay&&stages[stage].overlay.hasOwnProperty("el")&&stages[stage].overlay.el.length)if(void 0!==e)switch(e){case OGX.App.OVERLAY_FADE:stages[stage].overlay.el.removeClass("ogx_overlay_fade_in"),stages[stage].overlay.el.addClass("ogx_overlay_fade_out"),0<stages[stage].overlay.el.css("opacity")?stages[stage].overlay.el.on("transitionend",function(){stages[stage].overlay&&stages[stage].overlay.el&&(stages[stage].overlay.el.off("transitionend"),stages[stage].overlay.el.remove(),stages[stage].overlay=null)}):(stages[stage].overlay.el.removeClass("ogx_overlay_fade_in"),stages[stage].overlay.el.removeClass("ogx_overlay_fade_out"),stages[stage].overlay.el.off("transitionend"),stages[stage].overlay.el.remove(),stages[stage].overlay=null)}else stages[stage].overlay.el.remove(),stages[stage].overlay=null}function createView(e){e.hasOwnProperty("template")&&(e.html=OGX.Templater.getTemplate(e.template)),e.hasOwnProperty("html")&&(e.hasOwnProperty("data")&&"{}"!==JSON.stringify(e.data)?e.html=OGX.Templater.templatize(e.data,e.html):e.data={}),OGX.Views[e.name].prototype=Object.create(OGX.BaseView.prototype),OGX.Views[e.name].prototype.constructor=OGX.Views[e.name];var s=new OGX.Views[e.name];s._construct_(e),s.el.addClass("ogx_view"),s.el.attr("data-ogx",e.name);var t=0;return(e.hasOwnProperty("html")||e.hasOwnProperty("scroll")&&e.scroll)&&(t=config.views.delay),setTimeout(function(){s.constructor(e.data)},t),s}function destroyView(e){stages[stage].views[e]._destroy_(),stages[stage].views[e].destroy(),stages[stage].views[e].empty(),delete stages[stage].views[e]}function createController(e,s,t){OGX.Controllers[e].prototype=Object.create(OGX.BaseController.prototype),OGX.Controllers[e].prototype.constructor=OGX.Controllers[e];var a=new OGX.Controllers[e];return a._construct_(s),a.constructor(t),a.ux(!0),a}function destroyController(e){stages[stage].controllers[e].destroy(),delete stages[stage].controllers[e]}function handleRoute(e,s){var t,a,o,n,i,r,g={data:{}};if(e.route.hasOwnProperty("controllers"))for(var p in a=!1,e.route.controllers){if(e.route.controllers[p].hasOwnProperty("template"))for(var l in e.route.controllers[p].hasOwnProperty("template"))a=OGX.Templater.getTemplate(e.route.controllers[p].template[l]),t=l;if(e.route.controllers[p].hasOwnProperty("html"))for(var l in e.route.controllers[p].html)a=e.route.controllers[p].html[l],t=l;for(var l in a&&stages[stage].stage.el.find(t).html(a),i={},e.route.controllers[p].views)i[(r=e.route.controllers[p].views[l]).container=l]=createView(r),stages[stage].views[l]=i[l];n=null,e.route.controllers[p].hasOwnProperty("data")&&e.route.controllers[p].data&&(n=e.route.controllers[p].data),o=createController(p,i,n),stages[stage].controllers[p]=o}else for(var d in e.route.views)(g=merge(g,e.route.views[d],!0)).data=merge(g.data,s,!0),g.data=merge(e.data,g.data,!0),g.container=d,g.name=e.route.views[d].name,stages[stage].views[d]=createView(g)}function findRoute(e){var s;for(var t in config.routing)if((s=e.match("^"+t+"$"))&&s.length){s.shift();for(var a={},o=0;o<s.length;o++)a[config.routing[t].properties[o]]=s[o];return{route:config.routing[t],data:a}}return!1}function addToHist(e){var s={url:e};history.pushState(s,"title"+(new Date).getTime(),"index.html#"+e)}function writeFile(s,t,a){window.resolveLocalFileSystemURL(cordova.file.dataDirectory,function(e){e.getFile(s,{create:!0},function(e){e.createWriter(function(e){var s=new Blob([t],{type:"text/plain"});e.write(s),void 0!==a&&a()})})})}function readFile(e){file=e,window.resolveLocalFileSystemURL(cordova.file.dataDirectory+e,gotFile,onFail)}function gotFile(e){e.file(function(e){var s=new FileReader;s.onloadend=function(e){},s.readAsText(e)})}function onFail(e){$(document).trigger("LOAD_ERROR",e.code)}function listenResize(e){e?window.addEventListener("resize",onResize):window.removeEventListener("resize",onResize)}function onResize(){var e,s,t,a,o,n;for(var i in stages)e=stages[i].stage.el.width(),s=stages[i].stage.el.height(),stages[i].popup&&stages[i].popup.hasOwnProperty("el")&&stages[i].popup.el&&(o=stages[i].popup.width,n=stages[i].popup.height,"string"==typeof o&&-1!==o.indexOf("%")&&(o=Number(o.split("%")[0]),o=Math.round(o*e/100),stages[i].popup.el.width(o)),"string"==typeof n&&-1!==n.indexOf("%")&&(n=Number(n.split("%")[0]),n=Math.round(n*s/100)),t=Math.round(e/2-o/2),a=Math.round(s/2-n/2),stages[i].popup.el.css("top",a+"px"),stages[i].popup.el.css("left",t+"px"))}function getSize(e,s){var t;return-1!==s.indexOf("%")?(t=s.split("%"),t=parseInt(t[0]),t=Math.round(t*stages[stage].stage.el[e]()/100)):(t=s.split("px"),t=parseInt(t[0])),t}function checkScope(e){for(var s=0;s<e.length;s++)if(-1!==config.scope.indexOf(e[s]))return!0;return!1}function merge(e,s,t){for(var a in s)t?e[a]=s[a]:e.hasOwnProperty(a)||(e[a]=s[a]);return e}function initPopState(){$(document).on("backbutton",function(e){if(e.preventDefault(),e.stopImmediatePropagation(),!locked){var s=!1;for(var t in stages[stage].windows)that.hideWindow(t,{remove:!0}),s=!0;for(var t in stages[stage].popups)that.removePopup(t,OGX.Popup.NOANIM),s=!0;that.removeOverlay(),s||($(document).trigger(OGX.App.NAV_BACK),navigator.app.backHistory())}}),$(window).on("popstate",function(e){if(locked)return e.preventDefault(),e.stopImmediatePropagation(),!1;null!==e.originalEvent.state?that.goto(e.originalEvent.state.url,!1):url!==config.stages[stage].home&&that.goto(config.stages[stage].home,!1)})}function initStages(){var e;for(var s in config.stages)config.stages.hasOwnProperty(s)&&(e=!1,config.stages[s].hasOwnProperty("html")?e=config.stages[s].html:config.stages[s].hasOwnProperty("template")&&(e=OGX.Templater.getTemplate(config.stages[s].template)),config.stages[s].name=s,config.stages[s].html=e,that.addStage(config.stages[s]))}function initPreload(){config.hasOwnProperty("templates")&&(to_preload++,setTimeout(function(){preloadTemplates()},0)),config.hasOwnProperty("preload")&&(config.preload.hasOwnProperty("images")&&(to_preload++,setTimeout(function(){preloadImages(config.preload.images)},0)),config.preload.hasOwnProperty("sounds")&&(to_preload++,setTimeout(function(){preloadSounds(config.preload.sounds)},0)),config.preload.hasOwnProperty("fonts")&&(to_preload++,setTimeout(function(){preloadFonts(config.preload.fonts)},0))),0===to_preload&&appReady()}function preloadTemplates(){var e=[],s=config.templates.path;for(var t in config.templates.files)e.push({name:t,file:s+config.templates.files[t]});OGX.Templater.loadTemplates(e,onPreloaded)}function preloadImages(e){var s,t=0;if(e.files.length)for(var a=0;a<e.files.length;a++)(s=new Image).onload=function(){++t===e.files.length&&onPreloaded()},s.src=e.path+e.files[a];else onPreloaded()}function preloadSounds(e){var s=0,t=0;for(var a in e.files)t++;if(t)for(a in e.files)sounds[e.files[a]]=new Audio,sounds[e.files[a]].oncanplaythrough=function(){t===++s&&onPreloaded()},sounds[e.files[a]].src=e.path+e.files[a],sounds[e.files[a]].load();else onPreloaded()}function preloadFonts(e){var s='<div class="ogx_font_loader">';if(e.length){for(var t=0;t<e.length;t++)s+='<span class="'+e[t]+'"></span>';s+="</div>",$("body").append(s),onPreloaded()}else onPreloaded()}function onPreloaded(){preloaded++,$(document).trigger(OGX.App.LOADING,{total:to_preload,loaded:preloaded}),preloaded===to_preload&&(initPopState(),listenResize(!0),appReady())}function appReady(){initStages(),that.goto(config.stages[stage].home),$(document).trigger(OGX.App.READY)}function initDefaults(){for(var a in isWebView=void 0!==window.ontouchstart,config_default)config.hasOwnProperty(a)||(config[a]=config_default[a]);if(config.hasOwnProperty("windows")&&config.windows&&(windows_default=config.windows,config.windows.hasOwnProperty("style")&&(config.windows.style=eval(config.windows.style))),config.hasOwnProperty("popups")&&config.popups&&(popups_default=config.popups,popups_default.hasOwnProperty("anim")&&(popups_default.anim=eval(popups_default.anim))),config.hasOwnProperty("overlays")&&config.overlays)for(var a in config.overlays)OGX.Overlays[a]=config.overlays[a];that.el=$(document)}function loadConfig(){$.getJSON("app.json",function(e){config=e,init()})}function checkModules(){return void 0===OGX.Templater?(console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000"),!1):void 0===OGX.Scroller?(console.log("%c CRITICAL ERROR - OGX.Scroller not found! ","background:#222; color: #FF0000"),!1):void 0===OGX.BaseView?(console.log("%c CRITICAL ERROR - OGX.BaseView not found! ","background:#222; color: #FF0000"),!1):void 0===OGX.BaseController?(console.log("%c CRITICAL ERROR - OGX.BaseController not found! ","background:#222; color: #FF0000"),!1):void 0===OGX.BaseStage?(console.log("%c CRITICAL ERROR - OGX.BaseStage not found! ","background:#222; color: #FF0000"),!1):void 0===OGX.Window?(console.log("%c CRITICAL ERROR - OGX.Window not found! ","background:#222; color: #FF0000"),!1):void 0!==OGX.Popup||(console.log("%c CRITICAL ERROR - OGX.Popup not found! ","background:#222; color: #FF0000"),!1)}function init(){initDefaults(),initPreload()}this.isWebView=function(){return isWebView},this.bindGfx=function(e,s){gfx.bind(e,s)},this.unbindGfx=function(e){gfx.unbind(e)},this.refreshGfx=function(e){gfx.resize(e)},this.showStageNav=function(){stageNav||(stageNav=new OGX.MobileStageNavigator({}))},this.addStage=function(e){if(void 0===e)return!1;if(!e.hasOwnProperty("name"))return!1;if(stages.hasOwnProperty(e.name))return!1;var s=createStage(e);stages[e.name]={stage:s,windows:{},popups:{},views:{},controllers:{},overlay:null,snooze:!1},e.hasOwnProperty("use")||(e.use=!0),e.use&&that.showStage(e.name)},this.removeStage=function(e){if(!stages.hasOwnProperty(e))return!1;clearStage(e),delete stages[e]},this.useStage=function(e){stage=e},this.getCurrentStage=function(){return stage},this.getStage=function(e){return!!stages.hasOwnProperty(e)&&stages[e]},this.snoozeStage=function(e){if(!stages[e].snooze){for(var s in stages[e].snooze=!0,stages[e].stage.views)stages[e].stage.views[s].blur();stages[e].stage.el=stages[e].stage.el.detach()}},this.wakeStage=function(e){if(stages[e].snooze){for(var s in stages[e].snooze=!0,stages[e].stage.views)stages[e].stage.views[s].focus();stages[stageShown].stage.el.appendTo("body"),stages[e].stage.el=$("body").find(".ogx_stage:last")}},this.showStage=function(e,s){if(void 0===s&&(s=!1),s){var t=$(window).height();switch(s){case OGX.MobileStage.ANIM_SWAP:stages[stageShown].stage.el.on("transitionend",function(){stages[stageShown].stage.el.off("transitionend"),stages[stageShown].stage.el.css("top",-t+"px"),stages[e].stage.el.css("top","0px"),stages[e].stage.el.on("transitionend",function(){stages[e].stage.el.off("transitionend"),stages[e].stage.el.css("transform","scale(1)"),stages[stageShown].stage.el.removeClass("ogx_stage_anim"),stages[stageShown].stage.el.css("display","none"),stageShown=e,that.el.trigger(OGX.MobileStage.STAGE_CHANGE,{old:stageShown,new:e})})}),stages[e].stage.el.addClass("ogx_stage_anim"),stages[stageShown].stage.el.addClass("ogx_stage_anim"),stages[stageShown].stage.el.css("transform","scale(0.9)"),stages[e].stage.el.css("top",t+"px"),stages[e].stage.el.css("display","block"),stages[e].stage.el.css("transform","scale(0.9)"),stages[e].stage.el.addClass("ogx_stage_anim");break;case OGX.MobileStage.ANIM_FLIP:stages[e].stage.el.appendTo("body"),stages[e].stage.el.addClass("ogx_stage_anim_swap"),stages[stageShown].stage.el.addClass("ogx_stage_anim"),stages[stageShown].stage.el.addClass("ogx_stage_anim_flip")}}else stageShown&&stages[stageShown].stage.el.css("display","none"),stages[e].stage.el.css("display","block"),stageShown=e},this.addView=function(e){var s=$(e.container).parents(".ogx_window");if(s.length)return this.addToWindow($(s[0]).data("ogx"),e);var t=$(e.container).parents(".ogx_popup");return t.length?this.addToPopup($(t[0]).data("ogx"),e):this.addToStage(e)},this.findView=function(e){var s=$(e).parents(".ogx_window");if(s.length)return this.getWindowView($(s[0]).data("ogx"),e);var t=$(e).parents(".ogx_popup");return t.length?this.getPopupView($(t[0]).data("ogx"),e):this.getView(stage,e)},this.removeView=function(e){var s=$(e).parents(".ogx_window");if(s.length)return this.removeFromWindow($(s[0]).data("ogx"),e);var t=$(e).parents(".ogx_popup");return t.length?this.removeFromPopup($(t[0]).data("ogx"),e):this.removeFromStage(e)},this.addToStage=function(e){return void 0!==e&&(!!e.hasOwnProperty("name")&&(!!e.hasOwnProperty("container")&&("string"!=typeof e.container?(console.log("%c CRITICAL ERROR - container must be a selector for view "+e.name+"! ","background:#222; color: #FF0000"),!1):OGX.Views.hasOwnProperty(e.name)?(e.hasOwnProperty("history")||(e.history=!0),OGX.Views[e.name].hasOwnProperty("scope")||(OGX.Views[e.name].scope=["public"]),checkScope(OGX.Views[e.name].scope)?(stages[stage].views.hasOwnProperty(e.container)&&that.removeFromStage(e.container),stages[stage].views[e.container]=createView(e),!0):(console.log("%c ERROR  - Bad scope for view "+e.name),!1)):(console.log("%c CRITICAL ERROR - OGX.Views."+e.name+" not found! ","background:#222; color: #FF0000"),!1))))},this.removeFromStage=function(e){stages[stage].views.hasOwnProperty(e)&&destroyView(e)},this.windowExists=function(e){return stages[stage].windows.hasOwnProperty(e)},this.getWindow=function(e){return"object"==typeof e&&(e=e._window_()),!("string"!=typeof e||!that.windowExists(e))&&stages[stage].windows[e]},this.addWindow=function(e){if(!e.hasOwnProperty("name")||this.windowExists(e.name))return!1;(e=void 0===e?JSON.parse(JSON.stringify(windows_default)):merge(e,windows_default,!1)).container=stages[stage].stage.el[0],e.core=this;var s=new OGX.Window(e);return s.snooze=!1,stages[stage].windows[e.name]=s,e.hasOwnProperty("view")&&that.addToWindow(e.name,e.view),e.hasOwnProperty("anim")&&e.anim&&that.showWindow(e.name,e),s},this.showWindow=function(e,s){var t={anim:OGX.Window.ANIM_NONE,params:!1,fade:!1};if(s=void 0===s?JSON.parse(JSON.stringify(t)):merge(s,t,!1),stages[stage].windows.hasOwnProperty(e)){var a=stages[stage].windows[e];a.blur&&a.blurred&&that.focusWindow(e),a.anim=s.anim,s.way=!0,setTimeout(function(){animWindow(e,s)},0),listenWindow(!0,e)}},this.hideWindow=function(e,s){var t={params:!1,fade:!1};if(s=void 0===s?JSON.parse(JSON.stringify(t)):merge(s,t,!1),!that.windowExists(e))return!1;that.blurWindow(e),stages[stage].windows[e].isDragable()&&stages[stage].windows[e].disableDrag(),s.hasOwnProperty("anim")||stages[stage].windows[e].anim&&(s.anim=stages[stage].windows[e].anim),listenWindow(!1,e),s.way=0,setTimeout(function(){animWindow(e,s)},0),stages[stage].stage.el.trigger(OGX.Window.CLOSE,e),stages[stage].stage.el.trigger(OGX.Window.CLOSE+"_"+e,e)},this.swapWindows=function(e,s){var t,a,o,n;return!(!that.windowExists(e)||!that.windowExists(s))&&(t=that.getWindow(e),a=that.getWindow(s),o=t.el.css("z-index"),n=a.el.css("z-index"),t.el.css("z-index",n),a.el.css("z-index",o),!0)},this.snoozeWindow=function(e){stages[stage].windows[e].snooze||(stages[stage].windows[e].snooze=!0,that.blurWindow(e),stages[stage].windows[e].el=stages[stage].windows[e].el.detach())},this.wakeWindow=function(e){stages[stage].windows[e].snooze&&(stages[stage].windows[e].snooze=!1,that.focusWindow(e),stages[stage].windows[e].el=stages[stage].windows[e].el.detach(),stages[stage].windows[e].el.appendTo(stages[stage].stage.el),stages[stage].windows[e].el=stages[stage].stage.el.find(".ogx_window:last"))},this.blurWindow=function(e){if(stages[stage].windows[e].blur&&!stages[stage].windows[e].blurred){for(var s in stages[stage].windows[e].views)stages[stage].windows[e].views[s].blur();stages[stage].windows[e].blurred=!0}},this.focusWindow=function(e){if(stages[stage].windows[e].blur&&stages[stage].windows[e].blurred){for(var s in stages[stage].windows[e].views)stages[stage].windows[e].views[s].focus();stages[stage].windows[e].blurred=!1}},this.removeWindow=function(e){return!!that.windowExists(e)&&(destroyWindow(e),!0)},this.removeWindows=function(e){for(var s in e)that.windowExists(s)&&destroyWindow(s);return!0},this.removeAllWindows=function(e){for(var s in void 0===e&&(e=[]),stages[stage].windows)-1!==e.indexOf(s)&&destroyWindow(__window_name)},this.addToWindow=function(e,s){if(!s.hasOwnProperty("name"))return!1;s.hasOwnProperty("container")||(s.container='.ogx_window[data-ogx="'+e+'"] .ogx_view'),stages[stage].windows[e].snooze&&that.wakeWindow(e),stages[stage].windows[e].views.hasOwnProperty(s.container)&&that.removeFromWindow(e,s.container),s.hasOwnProperty("data")||(s.data={}),stages[stage].windows[e].scroll&&!stages[stage].windows[e].ready?stages[stage].windows[e].el.on(OGX.Window.READY,function(){stages[stage].windows[e].el.off(OGX.Window.READY),stages[stage].windows[e].views[s.container]=createView(s),stages[stage].windows[e].views[s.container]._window_(e)}):(stages[stage].windows[e].views[s.container]=createView(s),stages[stage].windows[e].views[s.container]._window_(e))},this.removeFromWindow=function(e,s){return!!stages[stage].windows[e].views.hasOwnProperty(s)&&(destroyWindowView(e,s),!0)},this.getWindowView=function(e,s){return void 0===s&&(s='.ogx_window[data-ogx="'+e+'"] .ogx_view'),!!stages[stage].windows[e].views.hasOwnProperty(s)&&stages[stage].windows[e].views[s]},this.addPopup=function(e){if(!e.hasOwnProperty("name"))return!1;if(stages[stage].popups.hasOwnProperty(e.name))return!1;e.container=stages[stage].stage.el,e.chromeos=config.chromeos,e=void 0===e?JSON.parse(JSON.stringify(popups_default)):merge(e,popups_default,!1);var s,t=new OGX.Popup(e);(e.hasOwnProperty("anim")||(e.anim=OGX.Popup.NOANIM),e.hasOwnProperty("overlay")||(e.overlay=!1),stages[stage].popups[e.name]=t,e.hasOwnProperty("view")&&e.view)&&(e.view.hasOwnProperty("container")?(s=e.view.container,e.view.container=stages[stage].popups[e.name].el.find(".ogx_popup_body:first").find(s)[0]):(s=".ogx_popup_body:first",e.view.container=stages[stage].popups[e.name].el.find(s)[0]),stages[stage].popups[e.name].views[s]=createView(e.view));switch(e.anim){case OGX.Popup.ANIM_FADE:setTimeout(function(){stages[stage].popups[e.name].el.removeClass("ogx_popup_fade_out"),stages[stage].popups[e.name].el.addClass("ogx_popup_fade_in")},100);break;case OGX.Popup.NOANIM:stages[stage].popups[e.name].el.css("opacity",1)}return e.overlay&&this.addOverlay(e.listen_overlay,OGX.App.OVERLAY_FADE),!0},this.removePopup=function(e,s){if(stages[stage].popups.hasOwnProperty(e)){switch(stages[stage].popups[e].blur(),void 0!==s?s:stages[stage].popups[e].anim){case OGX.Popup.ANIM_FADE:listenPopupAnim(!0,e),stages[stage].popups[e].el.removeClass("ogx_popup_fade_in"),stages[stage].popups[e].el.addClass("ogx_popup_fade_out");break;case OGX.Popup.NOANIM:destroyPopup(e)}return!0}return!1},this.getPopup=function(e){return!!this.popupExists(e)&&stages[stage].popups[e]},this.popupExists=function(e){return stages[stage].popups.hasOwnProperty(e)},this.getVisiblePopups=function(){var e=[];for(var s in stages[stage].popups)"visible"===stages[stage].popups[s].el.css("visibility")&&e.push(s);return e},this.hidePopup=function(e,s){if(!stages[stage].popups.hasOwnProperty(e))return!1;if(void 0===s&&(s=!1),s)switch(s){case OGX.Popup.ANIM_FADE:stages[stage].popups[e].el.on("transitionend",function(){stages[stage].popups[e].el.off("transitionend"),stages[stage].popups[e].el.css("visibility","hidden")}),stages[stage].popups[e].el.removeClass("ogx_popup_fade_in"),stages[stage].popups[e].el.addClass("ogx_popup_fade_out")}else stages[stage].popups[e].el.removeClass("ogx_popup_fade_in"),stages[stage].popups[e].el.removeClass("ogx_popup_fade_out"),stages[stage].popups[e].el.css("visibility","hidden"),stages[stage].popups[e].el.css("opacity",0)},this.showPopup=function(e,s){if(!stages[stage].popups.hasOwnProperty(e))return!1;if(void 0===s&&(s=!1),s)switch(s){case OGX.Popup.ANIM_FADE:stages[stage].popups[e].el.removeClass("ogx_popup_fade_out"),stages[stage].popups[e].el.addClass("ogx_popup_fade_in"),stages[stage].popups[e].el.css("visibility","visible")}else stages[stage].popups[e].el.removeClass("ogx_popup_fade_in"),stages[stage].popups[e].el.removeClass("ogx_popup_fade_out"),stages[stage].popups[e].el.css("visibility","visible"),stages[stage].popups[e].el.css("opacity",1)},this.bringPopupToFront=function(e){if(!stages[stage].popups.hasOwnProperty(e))return!1;stages[stage].popups[e].bringToFront()},this.addToPopup=function(e,s){return!!stages[stage].popups.hasOwnProperty(e)&&(s.hasOwnProperty("container")||(s.container='.ogx_popup[data-ogx="'+e+'"] .ogx_view'),stages[stage].popups[e].snooze&&that.wakePopup(e),stages[stage].popups[e].views.hasOwnProperty(s.container)&&that.removeFromPopup(e,s.container),!stages[stage].popups[e].scroll||stages[stage].popups[e].tabbed||stages[stage].popups[e].ready?stages[stage].popups[e].views[s.container]=createView(s):stages[stage].popups[e].el.on(OGX.Popup.READY,function(){stages[stage].popups[e].el.off(OGX.Popup.READY),stages[stage].popups[e].views[s.container]=createView(s)}),!0)},this.getPopupView=function(e,s){if(void 0===s&&(s=".ogx_popup_body:first"),stages[stage].popups.hasOwnProperty(e)){if(stages[stage].popups[e].tabbed){var t=stages[stage].popups[e].getCurrent();s=stages[stage].popups[e].getContainers()[t]}if(stages[stage].popups[e].views.hasOwnProperty(s))return stages[stage].popups[e].views[s]}return!1},this.getPopupViews=function(e){var s=[];if(stages[stage].popups.hasOwnProperty(e)&&stages[stage].popups[e].tabbed){for(var t in stages[stage].popups[e].views)s.push(stages[stage].popups[e].views[t]);return s}return!1},this.removeFromPopup=function(e,s){return!!stages[stage].popups.hasOwnProperty(e)&&(!!stages[stage].popups[e].views.hasOwnProperty(s)&&(destroyView(stages[stage].popups[e].views[s]),delete stages[stage].popups[e].views[s],!0))},this.wakePopup=function(e){if(!stages[stage].popups.hasOwnProperty(e))return!1;if(stages[stage].popups[e].snooze)for(var s in stages[stage].popups[e].views)stages[stage].popups[e].views[s].focus()},this.centerPopup=function(e){if(!stages[stage].popups.hasOwnProperty(e))return!1;stages[stage].popups[e].center()},this.resizePopup=function(e,s,t){if(!stages[stage].popups.hasOwnProperty(e))return!1;stages[stage].popups[e].resize(s,t)},this.movePopup=function(e,s,t){if(!stages[stage].popups.hasOwnProperty(e))return!1;void 0===s&&(s=null),void 0===t&&(t=null),stages[stage].popups[e].move(s,t)},this.addOverlay=function(e,s,t){if(void 0===e&&(e=!1),void 0===t&&(t=config.overlay_delay),stages[stage].overlay)stages[stage].stage.el.off("transitionend");else{stages[stage].stage.el.prepend('<div class="ogx_overlay"></div>'),stages[stage].overlay={el:stages[stage].stage.el.find(".ogx_overlay:first")},e&&listenOverlay(!0)}switch(s){case OGX.App.OVERLAY_FADE:setTimeout(function(){stages[stage].overlay&&stages[stage].overlay.el&&(stages[stage].overlay.el.removeClass("ogx_overlay_fade_out"),stages[stage].overlay.el.addClass("ogx_overlay_fade_in"))},t);break;default:stages[stage].overlay&&stages[stage].overlay.el&&stages[stage].overlay.el.css("opacity",1)}},this.removeOverlay=function(e){stages[stage].overlay&&(listenOverlay(!1),setTimeout(function(){removeOverlay(e)},0))},this.getOverlay=function(){return!!stages[stage].overlay&&stages[stage].overlay.el},this.getView=function(e,s){return!!(stages.hasOwnProperty(e)&&stages[e].hasOwnProperty("views")&&stages[e].views.hasOwnProperty(s)&&stages[e].views[s])&&stages[e].views[s]},this.hasView=function(e,s){if(stages.hasOwnProperty(e)&&stages[e].hasOwnProperty("views"))for(var t in stages[e].views)if(stages[e].views[t].el&&stages[e].views[t].el.data("ogx")===s)return!0;return!1},this.getViewClass=function(e,s){var t=that.getView(e,s);return!!t&&t.el.data("ogx")},this.lock=function(){locked=!0},this.unlock=function(){locked=!1},this.isLocked=function(){return locked},this.goto=function(e,s,t){clearStageViews(stage),void 0===t&&(t={}),void 0===s&&(s=!0);var a=findRoute(e);a&&(url=e,handleRoute(route=a,t),s&&addToHist(e))},this.getRoute=function(){return route},this.getUrl=function(){return url},this.readFile=function(e,s){},this.writeFile=function(e,s,t){},this.getSound=function(e){return!!sounds.hasOwnProperty(e)&&sounds[e]},checkModules()&&loadConfig()},OGX.App.LOADING="coreLoading",OGX.App.READY="coreReady",OGX.App.OVERLAY_FADE="coreOverlayFade",OGX.App.OVERLAY_REMOVE="coreOverlayRemove",OGX.App.NAV_BACK="coreNavBack",OGX.App.APP_EXIT="coreAppExit",OGX.App.RESIZE="coreResize",OGX.App.MODE_MOBILE="coreModeMobile",OGX.App.MODE_DESKTOP="coreModeDesktop";