if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.TagManager=function(a){"use strict";function n(a){var n=!1;switch(m.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:m.current_tags.indexOf(a)===-1&&(m.current_tags.push(a),n=!0);break;case OGX.TagManager.MODE_OBJECT:var t=m.current_tags.find("label",a,1);0===t.length&&(t=m.tags.find("label",a,1),t?m.current_tags.push(t[0]):m.current_tags.push({label:a}),n=!0)}if(n){var e="";m.editable===!0?e='<span class="ogx_tag_manager_remove"></span>':null;var r='<span class="ogx_tag_manager_tag"><span>'+a+"</span>"+e+"</span>";$(m.container).find(".ogx_tag_manager_tags:first").append(r),$(m.container).trigger(OGX.TagManager.TAG_ADDED,a)}$(m.container).find(".ogx_tag_manager_input:first").focus()}function t(a){var n=!1,t=!1;switch(m.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:var e=m.current_tags.indexOf(a);e>-1&&(m.current_tags.splice(e,1),n=!0);break;case OGX.TagManager.MODE_OBJECT:n=m.current_tags.findDelete("label",a)}return n&&$(m.container).find(".ogx_tag_manager_tags:first").find(".ogx_tag_manager_tag").each(function(n,e){if($(e).find("span:first").text()===a)return $(e).remove(),void(t=!0)}),t}function e(a,n){if(a){$(m.container).find(".ogx_tag_manager_tags_container:first").length>0&&(e(!1),c(!1));for(var t='<div class="ogx_tag_manager_tags_container">',r=0;r<n.length;r++)switch(m.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:t+='<span class="ogx_tag_manager_tag ogx_tag_manager_tags_container_tag">'+n[r]+"</span>";break;case OGX.TagManager.MODE_OBJECT:t+='<span class="ogx_tag_manager_tag ogx_tag_manager_tags_container_tag">'+n[r].label+"</span>"}t+="</div>",$(m.container).append(t),c(!0)}else $(m.container).find(".ogx_tag_manager_tags_container").remove(),c(!1)}function r(a){for(var n="",t="",e=0;e<a.length;e++)switch(t=m.editable===!0?'<span class="ogx_tag_manager_remove"></span>':"",m.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:n+='<span class="ogx_tag_manager_tag"><span>'+a[e]+"</span>"+t+"</span>";break;case OGX.TagManager.MODE_OBJECT:n+='<span class="ogx_tag_manager_tag"><span>'+a[e].label+"</span>"+t+"</span>"}return m.current_tags=a,$(m.container).find(".ogx_tag_manager_tags:first").html(n),!0}function g(a){var n=[];a=a.substr(0,3);for(var t=0;t<m.tags.length;t++)0===m.tags[t].toLowerCase().indexOf(a.toLowerCase())&&m.current_tags.indexOf(m.tags[t])===-1&&n.push(m.tags[t]);return n}function i(a){for(var n=new RegExp(a,"gi"),t=m.tags.find("label",n),e=0;e<m.current_tags.length;e++)t.findDelete("label",m.current_tags[e].label);return t}function s(a){var n=a.substr(0,3),t=o(n),e=[];if(m.tags_ascii[t])for(var r=0;r<m.tags_ascii[t].length;r++)m.tags_ascii[t][r].toLowerCase().indexOf(a.toLowerCase())!==-1&&m.current_tags.indexOf(m.tags[r])===-1&&e.push(m.tags_ascii[t][r]);return e}function o(a){for(var n="",t=0;t<a.length;t++)n+=a.toLowerCase().charCodeAt(t).toString();return n}function _(a){a?$(m.container).find(".ogx_tag_manager_input:first").on("keyup",function(a){var t=$(this).val();if(t.length>=3)if(a.which===m.keycode&&m.add_new)n(t),$(m.container).find(".ogx_tag_manager_input:first").val(""),e(!1);else{var r;switch(m.mode){case OGX.TagManager.MODE_STRING:r=g(t);break;case OGX.TagManager.MODE_OBJECT:r=i(t);break;case OGX.TagManager.MODE_ASCII:r=s(t)}r.length>0?e(!0,r):e(!1)}else e(!1)}):$(m.container).find(".ogx_tag_manager_input:first").off("keyup")}function c(a){a?$(m.container).find(".ogx_tag_manager_tags_container:first").on("click",".ogx_tag_manager_tags_container_tag",function(){var a=$(this).text();n(a),$(m.container).find(".ogx_tag_manager_input:first").val(""),e(!1)}):$(m.container).find(".ogx_tag_manager_tags_container:first").off("click",".ogx_tag_manager_tags_container_tag")}function f(a){a?$(m.container).on("click",".ogx_tag_manager_remove",function(){var a=$(this).parent("span:first").find("span:first").text();t(a),$(m.container).trigger(OGX.TagManager.TAG_REMOVED,a),$(m.container).find(".ogx_tag_manager_input:first").focus()}):$(m.container).off("click",".ogx_tag_manager_remove")}function u(){if($(m.container).addClass("ogx_tag_manager"),$(m.container).html('<span class="ogx_tag_manager_tags"></span><input type="text" class="ogx_tag_manager_input" placeholder="'+m.placeholder+'">'),m.restrict){var a={multiline:!1,max:30};"object"==typeof m.restrict&&(a=m.restrict),OGX.FormTools.restrictField($(m.container).find(".ogx_tag_manager_input:first")[0],a)}}function l(){m||(m={});for(var a in h)m.hasOwnProperty(a)||(m[a]=h[a]);m.tags.hasOwnProperty("insert")||(m.tags=new OGX.List(m.tags)),m.current_tags.hasOwnProperty("insert")||(m.current_tags=new OGX.List(m.current_tags)),O.el=p=$(m.container)}function d(){return"undefined"==typeof OGX.List?void console.log("%c CRITICAL ERROR - OGX.List not found! ","background:#222; color: #FF0000"):m&&m.restrict&&"undefined"==typeof OGX.FormTools?void console.log("%c CRITICAL ERROR - OGX.FormTools not found! ","background:#222; color: #FF0000"):(l(),u(),m.enabled&&m.editable?(m.enabled=!1,O.enable()):(m.enabled=!0,O.disable()),void(m.current_tags.length>0&&r(m.current_tags)))}var p,O=this,m=a,h={editable:!1,add_new:!0,tags:[],current_tags:[],tags_ascii:[],mode:OGX.TagManager.MODE_STRING,keycode:13,placeholder:"keywords",enabled:!0,restrict:!1};this.el=null,this.enable=function(){m.enabled||(m.enabled=!0,_(!0),c(!0),f(!0),$(m.container).find(".ogx_tag_manager_input:first").prop("placeholder",m.placeholder),$(m.container).find(".ogx_tag_manager_input:first").prop("disabled",!1))},this.disable=function(){m.enabled&&(m.enabled=!1,_(!1),c(!1),f(!1),$(m.container).find(".ogx_tag_manager_input:first").prop("placeholder",""),$(m.container).find(".ogx_tag_manager_input:first").prop("disabled",!0))},this.setTags=function(a){return a.hasOwnProperty("insert")||(a=new OGX.List(a)),m.tags=a,!0},this.getTags=function(){return m.tags},this.getCurrentTags=function(){return m.current_tags},this.setCurrentTags=function(a){return a.hasOwnProperty("insert")||(a=new OGX.List(a)),m.current_tags=a,r(m.current_tags)},this.showTags=function(a){return r(a)},this.addTag=function(a){return n(a)},this.removeTag=function(a){return t(a)},this.destroy=function(){_(!1),c(!1),f(!1),m.restrict&&OGX.FormTools.unrestrictField($(m.container).find(".ogx_tag_manager_input:first")[0])},d()},OGX.TagManager=function(a){"use strict";return new OGX.prototype.TagManager(a)},OGX.TagManager.tagDataset=function(a,n,t){"use strict";"undefined"==typeof t&&(t=!1);for(var e,r=[],g=0;g<a.length;g++)for(var i=0;i<n.length;i++)if(a[g].hasOwnProperty(n[i])){e=a[g][n[i]].split(" ");for(var s=0;s<e.length;s++)t&&t.indexOf(e[s])!==-1||r.indexOf(e[s])===-1&&r.push(e[s])}return r},OGX.TagManager.tagDatatree=function(a,n){"use strict";function t(a,n){function t(a){if(a.hasOwnProperty("items"))for(var r=0;r<a.items.length;r++){for(var g in a.items[r])n.indexOf(g)>-1&&e.indexOf(a.items[r][g])===-1&&e.push(a.items[r][g]);return t(a.items[r]),!0}}var e=[],r=t(a);if(r)return e}t(a,n)},OGX.TagManager.TAG_ADDED="tagAdded",OGX.TagManager.TAG_REMOVED="tagRemoved",OGX.TagManager.MODE_STRING="modeString",OGX.TagManager.MODE_OBJECT="modeObject",OGX.TagManager.MODE_ASCII="modeAscii";