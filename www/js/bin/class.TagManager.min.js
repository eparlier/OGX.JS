if(void 0===OGX)var OGX=function(){};OGX.prototype.TagManager=function(a){"use strict";var n=this,g=a,t={editable:!1,add_new:!0,tags:[],current_tags:[],tags_ascii:[],mode:OGX.TagManager.MODE_STRING,keycode:13,placeholder:"keywords",enabled:!0,restrict:!1};function e(a){var n=!1;switch(g.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:-1===g.current_tags.indexOf(a)&&(g.current_tags.push(a),n=!0);break;case OGX.TagManager.MODE_OBJECT:var t=g.current_tags.find("label",a,1);0===t.length&&((t=g.tags.find("label",a,1))?g.current_tags.push(t[0]):g.current_tags.push({label:a}),n=!0)}if(n){var e="";!0===g.editable&&(e='<span class="ogx_tag_manager_remove"></span>');var r='<span class="ogx_tag_manager_tag"><span>'+a+"</span>"+e+"</span>";$(g.container).find(".ogx_tag_manager_tags:first").append(r),$(g.container).trigger(OGX.TagManager.TAG_ADDED,a)}$(g.container).find(".ogx_tag_manager_input:first").focus()}function r(t){var a=!1,e=!1;switch(g.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:var n=g.current_tags.indexOf(t);-1<n&&(g.current_tags.splice(n,1),a=!0);break;case OGX.TagManager.MODE_OBJECT:a=g.current_tags.findDelete("label",t)}return a&&$(g.container).find(".ogx_tag_manager_tags:first").find(".ogx_tag_manager_tag").each(function(a,n){if($(n).find("span:first").text()===t)return $(n).remove(),void(e=!0)}),e}function i(a,n){if(a){0<$(g.container).find(".ogx_tag_manager_tags_container:first").length&&(i(!1),_(!1));for(var t='<div class="ogx_tag_manager_tags_container">',e=0;e<n.length;e++)switch(g.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:t+='<span class="ogx_tag_manager_tag ogx_tag_manager_tags_container_tag">'+n[e]+"</span>";break;case OGX.TagManager.MODE_OBJECT:t+='<span class="ogx_tag_manager_tag ogx_tag_manager_tags_container_tag">'+n[e].label+"</span>"}t+="</div>",$(g.container).append(t),_(!0)}else $(g.container).find(".ogx_tag_manager_tags_container").remove(),_(!1)}function s(a){for(var n="",t="",e=0;e<a.length;e++)switch(t=!0===g.editable?'<span class="ogx_tag_manager_remove"></span>':"",g.mode){case OGX.TagManager.MODE_STRING:case OGX.TagManager.MODE_ASCII:n+='<span class="ogx_tag_manager_tag"><span>'+a[e]+"</span>"+t+"</span>";break;case OGX.TagManager.MODE_OBJECT:n+='<span class="ogx_tag_manager_tag"><span>'+a[e].label+"</span>"+t+"</span>"}return g.current_tags=a,$(g.container).find(".ogx_tag_manager_tags:first").html(n),!0}function o(a){a?$(g.container).find(".ogx_tag_manager_input:first").on("keyup",function(a){var n=$(this).val();if(3<=n.length)if(a.which===g.keycode&&g.add_new)e(n),$(g.container).find(".ogx_tag_manager_input:first").val(""),i(!1);else{var t;switch(g.mode){case OGX.TagManager.MODE_STRING:t=function(a){var n=[];a=a.substr(0,3);for(var t=0;t<g.tags.length;t++)0===g.tags[t].toLowerCase().indexOf(a.toLowerCase())&&-1===g.current_tags.indexOf(g.tags[t])&&n.push(g.tags[t]);return n}(n);break;case OGX.TagManager.MODE_OBJECT:t=function(a){for(var n=new RegExp(a,"gi"),t=g.tags.find("label",n),e=0;e<g.current_tags.length;e++)t.findDelete("label",g.current_tags[e].label);return t}(n);break;case OGX.TagManager.MODE_ASCII:t=function(a){var n=function(a){for(var n="",t=0;t<a.length;t++)n+=a.toLowerCase().charCodeAt(t).toString();return n}(a.substr(0,3)),t=[];if(g.tags_ascii[n])for(var e=0;e<g.tags_ascii[n].length;e++)-1!==g.tags_ascii[n][e].toLowerCase().indexOf(a.toLowerCase())&&-1===g.current_tags.indexOf(g.tags[e])&&t.push(g.tags_ascii[n][e]);return t}(n)}0<t.length?i(!0,t):i(!1)}else i(!1)}):$(g.container).find(".ogx_tag_manager_input:first").off("keyup")}function _(a){a?$(g.container).find(".ogx_tag_manager_tags_container:first").on("click",".ogx_tag_manager_tags_container_tag",function(){e($(this).text()),$(g.container).find(".ogx_tag_manager_input:first").val(""),i(!1)}):$(g.container).find(".ogx_tag_manager_tags_container:first").off("click",".ogx_tag_manager_tags_container_tag")}function c(a){a?$(g.container).on("click",".ogx_tag_manager_remove",function(){var a=$(this).parent("span:first").find("span:first").text();r(a),$(g.container).trigger(OGX.TagManager.TAG_REMOVED,a),$(g.container).find(".ogx_tag_manager_input:first").focus()}):$(g.container).off("click",".ogx_tag_manager_remove")}this.el=null,this.enable=function(){g.enabled||(o(g.enabled=!0),_(!0),c(!0),$(g.container).find(".ogx_tag_manager_input:first").prop("placeholder",g.placeholder),$(g.container).find(".ogx_tag_manager_input:first").prop("disabled",!1))},this.disable=function(){g.enabled&&(o(g.enabled=!1),_(!1),c(!1),$(g.container).find(".ogx_tag_manager_input:first").prop("placeholder",""),$(g.container).find(".ogx_tag_manager_input:first").prop("disabled",!0))},this.setTags=function(a){return a.hasOwnProperty("insert")||(a=new OGX.List(a)),g.tags=a,!0},this.getTags=function(){return g.tags},this.getCurrentTags=function(){return g.current_tags},this.setCurrentTags=function(a){return a.hasOwnProperty("insert")||(a=new OGX.List(a)),g.current_tags=a,s(g.current_tags)},this.showTags=function(a){return s(a)},this.addTag=function(a){return e(a)},this.removeTag=function(a){return r(a)},this.destroy=function(){o(!1),_(!1),c(!1),g.restrict&&OGX.FormTools.unrestrictField($(g.container).find(".ogx_tag_manager_input:first")[0])},void 0!==OGX.List?g&&g.restrict&&void 0===OGX.FormTools?console.log("%c CRITICAL ERROR - OGX.FormTools not found! ","background:#222; color: #FF0000"):(function(){for(var a in g||(g={}),t)g.hasOwnProperty(a)||(g[a]=t[a]);g.tags.hasOwnProperty("insert")||(g.tags=new OGX.List(g.tags)),g.current_tags.hasOwnProperty("insert")||(g.current_tags=new OGX.List(g.current_tags)),n.el=$(g.container)}(),function(){if($(g.container).addClass("ogx_tag_manager"),$(g.container).html('<span class="ogx_tag_manager_tags"></span><input type="text" class="ogx_tag_manager_input" placeholder="'+g.placeholder+'">'),g.restrict){var a={multiline:!1,max:30};"object"==typeof g.restrict&&(a=g.restrict),OGX.FormTools.restrictField($(g.container).find(".ogx_tag_manager_input:first")[0],a)}}(),g.enabled&&g.editable?(g.enabled=!1,n.enable()):(g.enabled=!0,n.disable()),0<g.current_tags.length&&s(g.current_tags)):console.log("%c CRITICAL ERROR - OGX.List not found! ","background:#222; color: #FF0000")},OGX.TagManager=function(a){"use strict";return new OGX.prototype.TagManager(a)},OGX.TagManager.tagDataset=function(a,n,t){"use strict";void 0===t&&(t=!1);for(var e,r=[],g=0;g<a.length;g++)for(var i=0;i<n.length;i++)if(a[g].hasOwnProperty(n[i])){e=a[g][n[i]].split(" ");for(var s=0;s<e.length;s++)t&&-1!==t.indexOf(e[s])||-1===r.indexOf(e[s])&&r.push(e[s])}return r},OGX.TagManager.tagDatatree=function(a,n){"use strict";!function(a,r){var g=[];if(function a(n){if(n.hasOwnProperty("items"))for(var t=0;t<n.items.length;t++){for(var e in n.items[t])-1<r.indexOf(e)&&-1===g.indexOf(n.items[t][e])&&g.push(n.items[t][e]);return a(n.items[t]),!0}}(a));}(a,n)},OGX.TagManager.TAG_ADDED="tagAdded",OGX.TagManager.TAG_REMOVED="tagRemoved",OGX.TagManager.MODE_STRING="modeString",OGX.TagManager.MODE_OBJECT="modeObject",OGX.TagManager.MODE_ASCII="modeAscii";