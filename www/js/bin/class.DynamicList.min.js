OGX.prototype.DynamicList=function(t){"use strict";function e(){for(var t,e,n,r,s=d(),l="",a=0;a<s.length;a++)t=a,e=!1,n="",t=s[a][O],e=G.find(O,t,1),e.length&&(n="ogx_dynamic_list_selected_item"),r=i(s[a]),l+='<span class="ogx_dynamic_list_item '+n+" "+r.css+'" data-id='+t+">"+OGX.Templater.templatize(s[a],r.html)+"</span>";y.html(l),E.trigger&&y.trigger(OGX.DynamicList.RENDER)}function i(t){var e={html:"",css:""},i=E.display;return i.hasOwnProperty("html")?e.html=i.html:i.hasOwnProperty("template")&&("object"==typeof i.template&&i.template.hasOwnProperty("bind")?t.hasOwnProperty(i.template.bind)&&(e.html=OGX.Templater.getTemplate(t[i.template.bind])):"string"==typeof i.template&&(e.html=OGX.Templater.getTemplate(i.template))),i.hasOwnProperty("css")&&("object"==typeof i.css&&i.css.hasOwnProperty("bind")?t.hasOwnProperty(i.css.bind)&&(e.css=t[i.css.bind]):"string"==typeof i.css&&(e.css=i.css)),e}function n(t,i,n,r){if("undefined"!=typeof n&&null!==n||(n=t),"undefined"!=typeof r&&null!==r||(r="eqjson"),"object"==typeof i)switch(D[t]=i,i.__proto__.constructor){case OGX.prototype.DynamicList:E.list.removeFilter(t);var l=s(t,n);E.list.addFilter(t,r,l),D[t].el.on(OGX.DynamicList.SELECT,function(i,l){E.list.removeFilter(t);var a;a=D[t].mode()===OGX.DynamicList.SELECT_MODE_SINGLE||D[t].mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?D[t].getSelection()[0][n]:s(t,n),E.list.addFilter(t,r,a),h=E.list.filter(),g=!0,e()}),D[t].el.on(OGX.DynamicList.UNSELECT,function(i,l){E.list.removeFilter(t);var a;a=D[t].mode()===OGX.DynamicList.SELECT_MODE_SINGLE||D[t].mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?[]:s(t,n),a.length>0&&E.list.addFilter(t,r,a),h=E.list.filter(),g=!0,e()});break;case OGX.prototype.TagManager:E.list.removeFilter(t),E.list.addFilter(t,r,i.getCurrentTags()),D[t].el.on(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED,function(i,n){E.list.removeFilter(t),E.list.addFilter(t,r,D[t].getCurrentTags()),h=E.list.filter(),g=!0,e()});break;case OGX.prototype.Switch:E.list.removeFilter(t),E.list.addFilter(t,r,i.val()),D[t].el.on(OGX.Switch.TOGGLE,function(i,n){E.list.removeFilter(t),E.list.addFilter(t,r,n),h=E.list.filter(),g=!0,e()});break;case OGX.prototype.SwitchMulti:E.list.removeFilter(t),E.list.addFilter(t,r,i.val()),D[t].el.on(OGX.DynamicList.CHANGE,function(i,n){E.list.removeFilter(t),E.list.addFilter(t,r,n),h=E.list.filter(),g=!0,e()})}else if("string"==typeof i){if(0===$(i).length)return!1;D[t]=$(i);var a;switch($(i).attr("type").toLowerCase()){case"text":case"number":case"email":case"password":D[t].on("input",function(){a=$(this).val(),E.list.removeFilter(t),a.length&&E.list.addFilter(t,r,a),h=E.list.filter(),g=!0,e()});break;case"range":var o;D[t].on("input",function(){o=Number($(this).attr("min")),E.list.removeFilter(t),E.list.addFilter(t,r,[o,$(this).val()]),h=E.list.filter(),g=!0,e()})}}}function r(t){if("object"==typeof D[t])switch(D[t].__proto__.constructor){case OGX.prototype.DynamicList:D[t].el.off(OGX.DynamicList.SELECT),D[t].el.off(OGX.DynamicList.UNSELECT);break;case OGX.prototype.TagManager:D[t].el.off(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED);break;case OGX.prototype.Switch:D[t].el.off(OGX.Switch.TOGGLE);break;case OGX.prototype.SwitchMulti:D[t].el.off(OGX.DynamicList.CHANGE);break;default:D[t].off("input")}else D[t].off("input");return E.list.removeFilter(t),delete D[t],h=E.list.filter(),g=!0,e(),!0}function s(t,e){for(var i=D[t].getSelection(),n=[],r=0;r<i.length;r++)n.push(i[r][e]);return n}function l(){for(var t in D)r(t)}function a(t){t?y.on("click",".ogx_dynamic_list_item",function(){switch(E.mode){case OGX.DynamicList.SELECT_MODE_SINGLE:$(this).hasClass("ogx_dynamic_list_selected_item")||(c($(this).index(),!0),y.trigger(OGX.DynamicList.SELECT,G[G.length-1]));break;case OGX.DynamicList.SELECT_MODE_TOGGLE:$(this).hasClass("ogx_dynamic_list_selected_item")?(c($(this).index(),!1),y.trigger(OGX.DynamicList.UNSELECT)):(p.resetSelection(),c($(this).index(),!0),y.trigger(OGX.DynamicList.SELECT,G[G.length-1]));break;case OGX.DynamicList.SELECT_MODE_MULTI:$(this).hasClass("ogx_dynamic_list_selected_item")?(c($(this).index(),!1),y.trigger(OGX.DynamicList.UNSELECT)):(c($(this).index(),!0),y.trigger(OGX.DynamicList.SELECT,G))}}):y.off("click",".ogx_dynamic_list_item")}function o(t,e,i){"single"===E.mode&&p.resetSelection();for(var n,r=d(),s=r.find(t,e),l=0;l<s.length;l++)n=y.find(".ogx_dynamic_list_item[data-id="+s[l][O]+"]:first"),n&&(i?(n.addClass("ogx_dynamic_list_selected_item"),G.push(s[l])):n.removeClass("ogx_dynamic_list_selected_item"));return"single"===E.mode&&s.length?s[0]:s}function c(t,e){var i,n=d();return i=y.find(".ogx_dynamic_list_item:eq("+t+")"),i.length>0&&(E.mode===OGX.DynamicList.SELECT_MODE_SINGLE&&p.resetSelection(),e?(i.addClass("ogx_dynamic_list_selected_item"),G.push(n[t])):(i.removeClass("ogx_dynamic_list_selected_item"),G.findDelete(O,i.data("id"),1)),!0)}function d(){return g?h:E.list}function m(){for(var t=0;t<E.list.length;t++)E.list[t][O]=X,X++}function f(t){for(var e=0;e<t.length;e++)delete t[e][O];return t}function u(){E||(E={});for(var t in L)E.hasOwnProperty(t)||(E[t]=L[t]);E.list.length>0&&!E.list.hasOwnProperty("insert")&&(E.list=new OGX.List(E.list)),!E.key&&E.list.length>0?(O=v,m()):O=E.key,$(E.container).append('<div class="ogx_dynamic_list"></div>'),p.el=y=$(E.container).children(".ogx_dynamic_list:first")}function _(){return"undefined"==typeof OGX.Templater?void console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000"):"undefined"==typeof OGX.List?void console.log("%c CRITICAL ERROR - OGX.List not found! ","background:#222; color: #FF0000"):(u(),p.val(E.list),e(),void(E.enabled&&a(!0)))}var y,h,g,O,p=this,E=t,L={container:null,enabled:!0,key:!1,display:!1,list:[],mode:OGX.DynamicList.SELECT_MODE_SINGLE,render_mode:OGX.DynamicList.RENDER_MODE_SIMPLE,trigger:!1},G=new OGX.List,D={},X=1,v="__id__";this.el=null,this.val=function(t){if("undefined"==typeof t){if(!E.key){var i=JSON.parse(JSON.stringify(E.list));return f(i)}return E.list}t.hasOwnProperty("insert")||(t=new OGX.List(t)),E.list=t,E.key||(X=1,O=v,m()),e()},this.display=function(t){return"undefined"==typeof t?E.display:(E.display=t,!0)},this.mode=function(t){return"undefined"==typeof t?E.mode:(E.mode=t,!0)},this.enable=function(){return!E.enabled&&(E.enabled=!0,a(!0),!0)},this.disable=function(){return!!E.enabled&&(E.enabled=!1,a(!1),!0)},this.bind=function(t,e,i,r){return!D.hasOwnProperty(t)&&n(t,e,i,r)},this.unbind=function(t){return!!D.hasOwnProperty(t)&&r(t)},this.order=function(t,i){E.list.order(t,i),e()},this.filter=function(){return h=E.list.filter(),g=!0,e(),h},this.unfilter=function(){return g=!1,e(),!0},this.addFilter=function(t,e,i){return E.list.addFilter(t,e,i)},this.removeFilter=function(t,e,i){return E.list.removeFilter(t,e,i)},this.resetFilters=function(){return E.list.resetFilters()},this.getFilters=function(){return E.list.getFilters()},this.insert=function(t,e){E.key||(t[O]=X++);var n,r=!0;if(g){var s=new OGX.List(t);s.setFilters(E.list.getFilters()),0===s.filter().length&&(r=!1)}var l=i(t),a='<span class="ogx_dynamic_list_item '+l.css+'" data-id='+t[O]+">"+OGX.Templater.templatize(t,l.html)+"</span>";if("undefined"==typeof e)E.list.push(t),r&&y.append(a);else if(E.list.insert(t,e),r){if(g)h=E.list.filter(),n=h.findIndex(O,t[O]);else{if(0===e)return y.prepend(a),!0;n=E.list.findIndex(O,t[O])}var o=y.children(".ogx_dynamic_list_item:nth-child("+(n.index+1)+")");o.length>0?o.before(a):y.append(a),E.trigger&&y.trigger(OGX.DynamicList.RENDER)}return r},this.delete=function(t){var e=d();return!!e.delete(t)&&(y.children(".ogx_dynamic_list_item:eq("+t+")").remove(),!0)},this.deleteSelection=function(){for(var t=d(),e=0;e<G.length;e++)t.findDelete(O,G[e][O],1),y.children(".ogx_dynamic_list_selected_item").remove();return!0},this.findDelete=function(t,e,i){for(var n=E.list.findDelete(t,e,i),r=0;r<n.length;r++)y.children(".ogx_dynamic_list_item[data-id="+n[r][O]+"]:first").remove();return n},this.select=function(t,e){return o(t,e,!0)},this.selectIndex=function(t){return c(t,!0)},this.unselect=function(t,e){return o(t,e,!1)},this.unselectIndex=function(t){return c(t,!1)},this.resetSelection=function(){G=new OGX.List,y.children(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item")},this.getSelection=function(t){if("undefined"==typeof t&&(t=!1),!t){if(!E.key){var e=JSON.parse(JSON.stringify(G));return f(e)}return G}return y.children(".ogx_dynamic_list_selected_item")},this.replace=function(t,e,n){E.key||(n[O]=X++);var r=E.list.findReplace(t,e,n,1);if(r.length>0){var s=y.children(".ogx_dynamic_list_item[data-id="+r[0][O]+"]:first");if(s.length){var l=i(n),a=OGX.Templater.templatize(n,l.html);s.attr("data-id",n[O]),s.html(a),E.trigger&&y.trigger(OGX.DynamicList.RENDER)}return!0}return!1},this.update=function(t,e,n,r,s){var l,a,o=E.list.findUpdate(t,e,n,r,s);if(o.length){for(var c,d=0;d<o.length;d++)l=y.children(".ogx_dynamic_list_item[data-id="+o[d][O]+"]:first"),l.length>0&&(c=i(o[d]),a=OGX.Templater.templatize(o[d],c.html),l.html(a),E.trigger&&y.trigger(OGX.DynamicList.RENDER));return o.length}return!1},this.clear=function(){y.empty()},this.reset=function(){y.empty(),g=!1,E.list=new OGX.List,G=new OGX.List,h=new OGX.List},this.destroy=function(){l(),E.enabled&&a(!1),y.empty(),y.removeClass("ogx_dynamic_list")},this.render=function(){e()},_()},OGX.DynamicList=function(t){"use strict";return new OGX.prototype.DynamicList(t)},OGX.DynamicList.SELECT="DynamicListSelect",OGX.DynamicList.UNSELECT="DynamicListUnselect",OGX.DynamicList.RENDER="DynamicListRender",OGX.DynamicList.SELECT_MODE_SINGLE="single",OGX.DynamicList.SELECT_MODE_TOGGLE="toggle",OGX.DynamicList.SELECT_MODE_MULTI="multi",OGX.DynamicList.RENDER_MODE_SIMPLE="DynamicListRenderModeSimple",OGX.DynamicList.RENDER_MODE_SCROLL="DynamicListRenderModeScroll";