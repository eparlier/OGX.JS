OGX.DynamicList=function(t){"use strict";var l,a,c,d,o=this,m=t,e={container:null,enabled:!0,key:!1,display:!1,reorder:!1,swipe:!1,chromeos:!1,min_x:30,click_time:100,hold_time:2e3,interval:20,list:[],mode:OGX.DynamicList.SELECT_MODE_SINGLE,trigger:!1,swipe_template:'<div class="ogx_dynamic_list_item ogx_dynamic_list_swiper_back_item" style="height:{{$height}}px; z-index:{{$zindex}};">{{$template}}</div>'},i={mode:OGX.DynamicList.SWIPE_MODE_DELETE,template:!1,html:""},p=new OGX.List,n={},_=1,r="__id__",y={mode:!1,stime:0,target:0,si:0,ei:0,y:0},s=null,g=null,f=null,u="mousedown",h="mouseup",O="mousemove";function E(){for(var t,e,i=P(),r="",s=0;s<i.length;s++)!1,e="",t=i[s][d],p.find(d,t,1)&&(e="ogx_dynamic_list_selected_item"),r+='<div class="ogx_dynamic_list_item '+e+" "+m.display.css(i[s])+'" data-id='+t+">"+m.display.html(i[s])+"</div>";l.html(r),m.trigger&&l.trigger(OGX.DynamicList.RENDER)}function L(t){if(n.hasOwnProperty(t)&&"object"==typeof n[t].object)switch(n[t].object._NAME_){case OGX.DynamicList.NAME:n[t].object.el.off(OGX.DynamicList.SELECT),n[t].object.el.off(OGX.DynamicList.UNSELECT);break;case OGX.TagManager.NAME:n[t].object.el.off(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED);break;case OGX.Switch.NAME:n[t].object.el.off(OGX.Switch.TOGGLE);break;case OGX.SwitchMulti.NAME:n[t].object.el.off(OGX.SwitchMulti.CHANGE);break;case OGX.Roulette.NAME:n[t].object.el.off(OGX.Roulette.CHANGE);break;default:n[t].object.off("input")}else n[t].object.off("input");return m.list.removeFilter(t),delete n[t],a=m.list.filter(),c=!0,setTimeout(E,0),!0}function v(t,e){for(var i=n[t].object.getSelection(),r=[],s=0;s<i.length;s++)r.push(i[s][e]);return r}function D(t){t?l.on("click",".ogx_dynamic_list_item",A):l.off("click",".ogx_dynamic_list_item",A)}function G(t){t?l.on(u,".ogx_dynamic_list_item",X):l.off(u,".ogx_dynamic_list_item",X)}function x(t){t?g=setInterval(b,20):(clearInterval(g),g=null)}function w(t){t?l.on(O,".ogx_dynamic_list_item",T):l.off(O,".ogx_dynamic_list_item")}function X(t){y.mode=!1,y.target=$(t.currentTarget),y.si=y.target.index(),y.cy=l.offset().top,t=I(t),y.startx=t.pageX,y.starty=t.pageY,f&&clearInterval(f),y.stime=(new Date).getTime(),m.reorder&&x(!0),w(!0),$("body").on(h,S)}function T(t){t=I(t),y.y=-1*(y.starty-t.pageY),y.mx=t.pageX-y.startx,y.px=t.pageX,y.py=t.pageY,y.mode||Math.abs(y.mx)>m.min_x&&(y.mode="swipe",m.reorder&&x(!1),C(!0))}function b(){!y.mode&&(new Date).getTime()-y.stime>m.hold_time&&(y.mode="reorder",y.item=m.list.find(d,y.target.data("id").toString(),1),l.trigger(OGX.DynamicList.HOLD,y.item),x(!1),setTimeout(function(){y.tgy=y.target.position().top,y.tgx=y.target.position().left,y.y=0;var t=y.target.outerWidth(),e=y.target.outerHeight();y.clone=y.target.clone().css({position:"absolute",left:y.tgx+"px",top:y.tgy+"px",width:t+"px",height:e+"px"}).addClass("ogx_dynamic_list_reorder").prependTo(l),y.target.addClass("ogx_dynamic_list_frozen"),f=setInterval(j,m.interval),l.on(O,N)}(),0))}function S(t){if($("body").off(h,S),(m.reorder||m.swipe)&&(clearInterval(f),w(f=!1)),m.swipe&&C(!1),m.reorder&&x(!1),m.reorder&&"reorder"===y.mode){if(l.off(O,N),y.clone){var e=JSON.parse(JSON.stringify(m.list[y.si]));return m.list.delete(y.si),m.list.insert(e,y.ei),y.clone.remove(),y.clone=!1,y.target.removeClass("ogx_dynamic_list_frozen"),void l.trigger(OGX.DynamicList.DROP,y.item)}if((new Date).getTime()-y.stime<m.click_time){var i=y.target.data("id").toString(),r=m.list.find(d,i,1);l.trigger(OGX.DynamicList.SELECT,r),o.select(d,i)}}else if(m.swipe&&"swipe"===y.mode){var s=y.target.width(),n=Math.abs(100*y.mx/s);n<50?n?(y.target.addClass("ogx_dynamic_list_swiper_trans_item_restore"),y.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX(0px)")):(y.target.next(".ogx_dynamic_list_swiper_back_item:first").remove(),y.target.css("transform","translateX(0px)")):0<y.mx?(y.target.attr("data-side","left"),y.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX("+s+"px)")):(y.target.attr("data-side","right"),y.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX("+-1*s+"px)"))}y.mode=!1}function C(t){t?s=setInterval(M,m.interval):(clearInterval(s),s=!1)}function M(){if("swipe"===y.mode&&Math.abs(y.mx)>m.min_x){var t=y.target.outerHeight();if(!y.target.hasClass("ogx_dynamic_list_swiper_work")){y.target.addClass("ogx_dynamic_list_swiper_work");var e={};e.height=t,e.margin=t,e.top=y.target.position().top,e.zindex=m.zindex;var i="";m.swipe.template?i=OGX.Templater.getTemplate(m.swipe.template):m.swipe.html&&(i=m.swipe.html),e.template=i,i=OGX.Templater.templatize(e,m.swipe_template),y.target.after(i)}if(y.py>=y.target.offset().top&&y.py<=y.target.offset().top+t){y.target.css("transform","translateX("+y.mx+"px)");var r=y.target.next(".ogx_dynamic_list_swiper_back_item:first");y.mx<0?(r.removeClass("ogx_dynamic_list_swiper_left"),r.addClass("ogx_dynamic_list_swiper_right")):(r.addClass("ogx_dynamic_list_swiper_left"),r.removeClass("ogx_dynamic_list_swiper_right"))}else S(y.target)}}function F(t){t?l.on("transitionend",".ogx_dynamic_list_swiper_trans_item",function(){var t,e=$(this),i=e.next(".ogx_dynamic_list_swiper_back_item:first");if(e.hasClass("ogx_dynamic_list_swiper_trans_item_restore"))i.remove(),e.css("transform","translateX(0px)"),e.removeClass("ogx_dynamic_list_swiper_trans_item");else switch(m.swipe.mode){case OGX.DynamicList.SWIPE_MODE_DELETE:var r=e.index();e.remove(),(t=i).addClass("ogx_dynamic_list_swiper_delete"),t.on("transitionend",function(){t.off("transitionend"),t.remove()});var s=e.data("id"),n=m.list.findDelete(m.key,s,1);l.trigger(OGX.DynamicList.DELETE,{item:n,index:r});break;case OGX.DynamicList.SWIPE_MODE_CUSTOM:}e.removeClass("ogx_dynamic_list_swiper_work"),e.removeClass("ogx_dynamic_list_swiper_trans_item_restore")}):l.off("transitionend",".ogx_dynamic_list_swiper_trans_item")}function N(t){t.preventDefault(),t.stopImmediatePropagation(),t=I(t),y.y=-1*(y.starty-t.pageY)}function j(){if(1<Math.abs(l.offset().top-y.cy))return clearInterval(f),f=!1,y.clone.remove(),y.clone=!1,y.target.removeClass("ogx_dynamic_list_frozen"),void l.trigger(OGX.DynamicList.RELEASE);var i=!1,t=l.children(".ogx_dynamic_list_item:last"),e=t.offset().top+-1*y.cy;if(y.tgy+y.y<e?y.clone.css({top:y.tgy+y.y}):i=t,!i){var r,s,n,o,a=0;l.children(".ogx_dynamic_list_item").each(function(t,e){if((e=$(e))[0]!==y.clone[0]&&!e.hasClass("ogx_dynamic_list_frozen")){if(r=e.offset().top,s=e.outerHeight(),o=r+s/2,n=y.clone.offset().top,r<n&&n<o)return a=-1,void(i=e);if(o<n&&n<r+s)return a=1,void(i=e)}})}if(i){switch(y.ei=m.list.findIndex(d,$(i).data("id").toString()).index,a){case-1:i.index()-1!==y.target.index()&&y.target.detach().insertBefore(i);break;case 1:i.index()+1!==y.target.index()&&y.target.detach().insertAfter(i)}i=!1}}function A(t){switch(m.mode){case OGX.DynamicList.SELECT_MODE_SINGLE:$(this).hasClass("ogx_dynamic_list_selected_item")||(k($(this).index(),!0),l.trigger(OGX.DynamicList.SELECT,p[p.length-1]));break;case OGX.DynamicList.SELECT_MODE_TOGGLE:$(this).hasClass("ogx_dynamic_list_selected_item")?(k($(this).index(),!1),l.trigger(OGX.DynamicList.UNSELECT)):(o.resetSelection(),k($(this).index(),!0),l.trigger(OGX.DynamicList.SELECT,p[p.length-1]));break;case OGX.DynamicList.SELECT_MODE_MULTI:$(this).hasClass("ogx_dynamic_list_selected_item")?(k($(this).index(),!1),l.trigger(OGX.DynamicList.UNSELECT)):(k($(this).index(),!0),l.trigger(OGX.DynamicList.SELECT,p));break;case OGX.DynamicList.SELECT_MODE_HIT:var e=P();l.trigger(OGX.DynamicList.SELECT,e[$(this).index()])}}function R(t,e,i){"single"===m.mode&&o.resetSelection();var r,s=P().find(t,e);s&&!Array.isArray(s)&&(s=[s]);for(var n=0;n<s.length;n++)(r=l.find(".ogx_dynamic_list_item[data-id="+s[n][d]+"]:first"))&&(i?(r.addClass("ogx_dynamic_list_selected_item"),p.push(s[n])):r.removeClass("ogx_dynamic_list_selected_item"));return"single"===m.mode&&s.length?s[0]:s}function k(t,e){var i,r=P();return 0<(i=l.find(".ogx_dynamic_list_item:eq("+t+")")).length&&(m.mode===OGX.DynamicList.SELECT_MODE_SINGLE&&o.resetSelection(),e?(i.addClass("ogx_dynamic_list_selected_item"),p.push(r[t])):(i.removeClass("ogx_dynamic_list_selected_item"),p.findDelete(d,i.data("id"),1)),!0)}function I(t){return t.hasOwnProperty("originalEvent")&&void 0!==t.originalEvent.changedTouches?t.originalEvent.changedTouches[0]:t}function P(){return c?a:m.list}function H(){for(var t=0;t<m.list.length;t++)m.list[t][d]=String(_),_++}function U(t){for(var e=0;e<t.length;e++)delete t[e][d];return t}this._NAME_=OGX.DynamicList.NAME,this.el=null,this.val=function(t){if(void 0===t)return m.key?m.list:U(JSON.parse(JSON.stringify(m.list)));t.hasOwnProperty("insert")||(t=new OGX.List(t)),m.list=t,m.key||(_=1,d=r,H()),setTimeout(E,0)},this.getFilteredList=function(){return!!c&&a},this.display=function(t){return void 0===t?m.display:(m.display=t,!0)},this.mode=function(t){return void 0===t?m.mode:(m.mode=t,!0)},this.enable=function(){return!m.enabled&&(D(m.enabled=!0),!0)},this.disable=function(){return!!m.enabled&&(D(m.enabled=!1),!0)},this.bind=function(t){return!n.hasOwnProperty(t.property)&&function(r){r.hasOwnProperty("mode")||(r.mode="eqjson");if("object"==typeof r.object)switch((n[r.property]=r).object._NAME_){case OGX.DynamicList.NAME:m.list.removeFilter(r.property);var t=v(r.property,r.remote_property);m.list.addFilter(r.property,r.mode,t),n[r.property].object.el.on(OGX.DynamicList.SELECT,function(t,e){var i;return m.list.removeFilter(r.property),i=n[r.property].object.mode()===OGX.DynamicList.SELECT_MODE_SINGLE||n[r.property].object.mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?n[r.property].object.getSelection()[0][r.remote_property]:v(r.property,r.remote_property),m.list.addFilter(r.property,r.mode,i),a=m.list.filter(),c=!0,setTimeout(E,0),!1}),n[r.property].object.el.on(OGX.DynamicList.UNSELECT,function(t,e){var i;return m.list.removeFilter(r.property),0<(i=n[r.property].object.mode()===OGX.DynamicList.SELECT_MODE_SINGLE||n[r.property].object.mode()===OGX.DynamicList.SELECT_MODE_TOGGLE?[]:v(r.property,r.remote_property)).length&&m.list.addFilter(r.property,r.mode,i),a=m.list.filter(),c=!0,setTimeout(E,0),!1});break;case OGX.TagManager.NAME:m.list.removeFilter(r.property),m.list.addFilter(r.property,r.mode,r.object.getCurrentTags()),n[r.property].object.el.on(OGX.TagManager.TAG_ADDED+" "+OGX.TagManager.TAG_REMOVED,function(t,e){return m.list.removeFilter(r.property),m.list.addFilter(r.property,r.mode,n[r.property].object.getCurrentTags()),a=m.list.filter(),c=!0,setTimeout(E,0),!1});break;case OGX.Switch.NAME:m.list.removeFilter(r.property),m.list.addFilter(r.property,r.mode,r.object.val()),n[r.property].object.el.on(OGX.Switch.TOGGLE,function(t,e){return m.list.removeFilter(r.property),m.list.addFilter(r.property,r.mode,e),a=m.list.filter(),c=!0,setTimeout(E,0),!1});break;case OGX.SwitchMulti.NAME:m.list.removeFilter(r.property),m.list.addFilter(r.property,r.mode,r.object.val()),n[r.property].object.el.on(OGX.SwitchMulti.CHANGE,function(t,e){return m.list.removeFilter(r.property),""!==e&&m.list.addFilter(r.property,r.mode,e),a=m.list.filter(),c=!0,setTimeout(E,0),!1});break;case OGX.Roulette.NAME:m.list.removeFilter(r.property),m.list.addFilter(r.property,r.mode,r.object.val()),n[r.property].object.el.on(OGX.Roulette.CHANGE,function(t,e){return m.list.removeFilter(r.property),""!==e&&m.list.addFilter(r.property,r.mode,e),a=m.list.filter(),c=!0,setTimeout(E,0),!1})}else if("string"==typeof r.object){if(0===$(r.object).length)return!1;r.object=$(r.object);var e=(n[r.property]=r).object.val();switch(n[r.property].hasOwnProperty("min_length")?(n[r.property].last_val=e).length>=n[r.property].min_length&&(m.list.removeFilter(r.property),m.list.addFilter(r.property,r.mode,e)):(m.list.removeFilter(r.property),m.list.addFilter(r.property,r.mode,e)),r.object.attr("type").toLowerCase()){case"text":case"number":case"email":case"password":case"tel":n[r.property].object.on("input",function(){return e=$(this).val(),m.list.removeFilter(r.property),n[r.property].hasOwnProperty("min_length")?e.length<n[r.property].min_length&&n[r.property].last_val.length>=n[r.property].min_length||e.length>=n[r.property].min_length?(e.length>=n[r.property].min_length&&m.list.addFilter(r.property,r.mode,e),a=m.list.filter(),c=!0,n[r.property].last_val=e,setTimeout(E,0)):n[r.property].last_val=e:(e.length&&m.list.addFilter(r.property,r.mode,e),a=m.list.filter(),c=!0,setTimeout(E,0)),!1});break;case"range":var i;n[r.property].object.on("input",function(){return i=Number($(this).attr("min")),m.list.removeFilter(r.property),m.list.addFilter(r.property,r.mode,[i,$(this).val()]),a=m.list.filter(),c=!0,setTimeout(E,0),!1})}}}(t)},this.unbind=function(t){return!!n.hasOwnProperty(t)&&L(t)},this.order=function(t,e){return m.list.order(t,e),setTimeout(E,0),!0},this.filter=function(){return a=m.list.filter(),c=!0,setTimeout(E,0),a},this.unfilter=function(){return c=!1,setTimeout(E,0),!0},this.addFilter=function(t,e,i){return m.list.addFilter(t,e,i)},this.removeFilter=function(t,e,i){return m.list.removeFilter(t,e,i)},this.resetFilters=function(){return m.list.resetFilters()},this.getFilters=function(){return m.list.getFilters()},this.insert=function(t,e){var i;m.key||(t[d]=_++);var r=!0;if(c){var s=new OGX.List(t);s.setFilters(m.list.getFilters()),0===s.filter().length?r=!1:a.push(t)}var n='<span class="ogx_dynamic_list_item '+m.display.css(t)+'" data-id='+t[d]+">"+m.display.html(t)+"</span>";if(void 0===e)m.list.push(t),r&&l.append(n);else if(m.list.insert(t,e),r){if(c)i=(a=m.list.filter()).findIndex(d,t[d]);else{if(0===e)return l.prepend(n),!0;i=m.list.findIndex(d,t[d])}var o=l.children(".ogx_dynamic_list_item:nth-child("+(i.index+1)+")");0<o.length?o.before(n):l.append(n),m.trigger&&l.trigger(OGX.DynamicList.RENDER)}return r},this.delete=function(t){return!!P().delete(t)&&(l.children(".ogx_dynamic_list_item:eq("+t+")").remove(),!0)},this.deleteSelection=function(){for(var t=P(),e=0;e<p.length;e++)t.findDelete(d,p[e][d],1),l.children(".ogx_dynamic_list_selected_item").remove();return!0},this.findDelete=function(t,e,i){var r=m.list.findDelete(t,e,i);r&&!Array.isArray(r)&&(r=[r]);for(var s=0;s<r.length;s++)l.children(".ogx_dynamic_list_item[data-id="+r[s][d]+"]:first").remove();return r},this.select=function(t,e){return R(t,e,!0)},this.selectIndex=function(t){return k(t,!0)},this.unselect=function(t,e){return R(t,e,!1)},this.unselectIndex=function(t){return k(t,!1)},this.resetSelection=function(){p=new OGX.List,l.children(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item")},this.getSelection=function(t){return void 0===t&&(t=!1),t?l.children(".ogx_dynamic_list_selected_item"):m.key?p:U(JSON.parse(JSON.stringify(p)))},this.replace=function(t,e,i){m.key||(i[d]=_++);var r=m.list.findReplace(t,e,i,1);if(r){var s=l.children(".ogx_dynamic_list_item[data-id="+r[d]+"]:first");return s.length&&(s.attr("data-id",i[d]),s.html(m.display.html(i)),m.trigger&&l.trigger(OGX.DynamicList.RENDER)),!0}return!1},this.update=function(t,e,i,r,s){var n,o=m.list.findUpdate(t,e,i,r,s);if(o&&!Array.isArray(o)&&(o=[o]),o.length){for(var a=0;a<o.length;a++)0<(n=l.children(".ogx_dynamic_list_item[data-id="+o[a][d]+"]:first")).length&&(n.html(m.display.html(o[a])),m.trigger&&l.trigger(OGX.DynamicList.RENDER));return o.length}return!1},this.clear=function(){l.empty()},this.reset=function(){l.empty(),c=!1,m.list=new OGX.List,p=new OGX.List,a=new OGX.List},this.destroy=function(){!function(){for(var t in n)L(t)}(),m.enabled&&D(!1),(m.reorder||m.swipe)&&(G(!1),m.swipe&&F(!1)),l.empty(),l.removeClass("ogx_dynamic_list")},this.render=function(){setTimeout(E,0)},void 0!==OGX.Templater?void 0!==OGX.List?void 0!==OGX.DisplayObject?(OGX.hasOwnProperty("TagManager")||(OGX.TagManager={NAME:"OgxTagManager"}),OGX.hasOwnProperty("Switch")||(OGX.Switch={NAME:"OgxSwitch"}),OGX.hasOwnProperty("SwitchMulti")||(OGX.SwitchMulti={NAME:"OgxSwitchMulti"}),OGX.hasOwnProperty("Roulette")||(OGX.Roulette={NAME:"OgxRoulette"}),function(){for(var t in m||(m={}),e)m.hasOwnProperty(t)||(m[t]=e[t]);if(0<m.list.length&&!m.list.hasOwnProperty("insert")&&(m.list=new OGX.List(m.list)),!m.key&&0<m.list.length?(d=r,H()):d=m.key,m.display.hasOwnProperty("_NAME_")||(m.display=new OGX.DisplayObject(m.display)),m.swipe)for(var t in"object"!=typeof m.swipe&&(m.swipe={}),i)m.swipe.hasOwnProperty(t)||(m.swipe[t]=i[t]);$(m.container).append('<div class="ogx_dynamic_list"></div>'),o.el=l=$(m.container).children(".ogx_dynamic_list:first"),void 0===window.ontouchstart||m.chromeos||(u="touchstart",O="touchmove",h="touchend")}(),o.val(m.list),setTimeout(E,0),m.enabled&&D(!0),(m.reorder||m.swipe)&&(G(!0),m.swipe&&F(!0)),setTimeout(function(){l.trigger(OGX.DynamicList.READY)},0)):console.log("%c CRITICAL ERROR - OGX.DisplayObject not found! ","background:#222; color: #FF0000"):console.log("%c CRITICAL ERROR - OGX.List not found! ","background:#222; color: #FF0000"):console.log("%c CRITICAL ERROR - OGX.Templater not found! ","background:#222; color: #FF0000")},OGX.DynamicList.NAME="OgxDynamicList",OGX.DynamicList.HOLD="DynamicListHold",OGX.DynamicList.RELEASE="DynamicListRelease",OGX.DynamicList.DROP="DynamicListDrop",OGX.DynamicList.SELECT="DynamicListSelect",OGX.DynamicList.DELETE="DynamicListDelete",OGX.DynamicList.UNSELECT="DynamicListUnselect",OGX.DynamicList.RENDER="DynamicListRender",OGX.DynamicList.SELECT_MODE_SINGLE="single",OGX.DynamicList.SELECT_MODE_TOGGLE="toggle",OGX.DynamicList.SELECT_MODE_MULTI="multi",OGX.DynamicList.SELECT_MODE_HIT="hit",OGX.DynamicList.SWIPE_LEFT="DynamicListSwipeLeft",OGX.DynamicList.SWIPE_RIGHT="DynamicListSwipeRight",OGX.DynamicList.SWIPE_MODE_DELETE="DynamicListSwipeModeDelete",OGX.DynamicList.SWIPE_MODE_CUSTOM="DynamicListSwipeModeCustom",OGX.DynamicList.READY="DynamicListReady";