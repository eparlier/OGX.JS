if("undefined"==typeof OGX)var OGX=function(){};OGX.prototype.GeoTools=function(t){"use strict";function o(t){return t*(Math.PI/180)}function e(t){var o=new google.maps.LatLng(t.coords.latitude,t.coords.longitude),e={gmap:o,raw:{lat:t.coords.latitude,lng:t.coords.longitude}};u?(u(e),u=null):$(document).trigger(OGX.GeoTools.BROWSER_LOC_SUCCESS,e)}function a(t){$(document).trigger(OGX.GeoTools.BROWSER_LOC_ERROR,t)}function n(){if(m.map){var t=m.map.getBounds(),o=t.getCenter(),e=t.getNorthEast(),a=3963,n=o.lat()/57.2958,s=o.lng()/57.2958,r=e.lat()/57.2958,i=e.lng()/57.2958,d=a*Math.acos(Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos(i-s));return d}return!1}function s(){var t=m.map.getCenter(),o=new google.maps.LatLng(t.lat(),t.lng());return o}function r(){for(var t in g)m.hasOwnProperty(t)||(m[t]=g[t])}function i(){return"undefined"==typeof google||"undefined"==typeof google.maps?void $(document).trigger(OGX.GeoTools.ERROR_GMAP):(d=new google.maps.Geocoder,m||(m={}),r(),void(m.map&&m.markers.length>0))}var d,c,l,u,g={map:null,markers:[],icon:"",browser_loc:null},m=t;this.setMap=function(t){m.map=t,google.maps.event.addListenerOnce(m.map,"tilesloaded",function(){$(document).trigger(OGX.GeoTools.MAP_LOADED)})},this.getMap=function(){return m.map},this.getMapRadius=function(){return!!m.map&&n()},this.getCurrentLocation=function(){return!!m.map&&s()},this.getBrowserLocation=function(t){u="undefined"==typeof t?null:t,l=navigator.geolocation.getCurrentPosition(e,a,{maximumAge:0,timeout:1e4,enableHighAccuracy:!0})},this.getDistance=function(t,e,a,n){var s=6371,r=o(a-t),i=o(n-e),d=Math.sin(r/2)*Math.sin(r/2)+Math.cos(o(t))*Math.cos(o(a))*Math.sin(i/2)*Math.sin(i/2),c=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),l=s*c;return Math.round(l/1e3*100)/100},this.addressToLatLng=function(t,o,e){d.geocode({address:t},function(t,a){a==google.maps.GeocoderStatus.OK?o(t[0].geometry.location,e):o(!1,e)})},this.getCityBoundaries=function(t,o,e,a,n){d.geocode({address:t+", "+o+", "+e},function(t,o){o==google.maps.GeocoderStatus.OK?a(t[0].geometry,n):a(!1,n)})},this.latLngToZip=function(t,o,e){d.geocode({location:t},function(t,a){if(a===google.maps.GeocoderStatus.OK){var n=t[0].formatted_address.match(/([a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|([0-9]{2}[ ]?[0-9]{3})/);n?o(n[0],e):o(null,e)}else o(!1,e)})},this.latLngToCountryStateCity=function(t,o,e){d.geocode({location:t},function(t,a){if(a===google.maps.GeocoderStatus.OK){for(var n={},s=0;s<t[0].address_components.length;s++)t[0].address_components[s].types.indexOf("locality")!==-1&&(n.city=t[0].address_components[s].short_name),t[0].address_components[s].types.indexOf("administrative_area_level_1")!==-1&&(n.state=t[0].address_components[s].short_name),t[0].address_components[s].types.indexOf("country")!==-1&&(n.country=t[0].address_components[s].short_name);o(n,e)}else o(!1,e)})},this.partialAddressToCountryStateCity=function(t,o,e){d.geocode({address:t},function(t,a){if(a===google.maps.GeocoderStatus.OK){for(var n={},s=0;s<t[0].address_components.length;s++)t[0].address_components[s].types.indexOf("locality")!==-1&&(n.city=t[0].address_components[s].short_name),t[0].address_components[s].types.indexOf("administrative_area_level_1")!==-1&&(n.state=t[0].address_components[s].short_name),t[0].address_components[s].types.indexOf("country")!==-1&&(n.country=t[0].address_components[s].short_name);o(n,e)}else o(!1,e)})},this.latLngToAddress=function(t,o,e){d.geocode({location:t},function(a,n){if(n===google.maps.GeocoderStatus.OK){var s={},r=a[0].formatted_address.match(/([a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|([0-9]{2}[ ]?[0-9]{3})/);r&&(s.zip=r[0]);var r=a[0].formatted_address.match(/[ ]([a-zA-Z]+)$/);r&&(s.country=r[1]);var r=a[0].formatted_address.match(/[ ]([A-Z]{2})[ ](?:[a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|(?:[0-9]{2}[ ]?[0-9]{3})/);r&&(s.state=r[1]);var r=a[0].formatted_address.match(/(?:[, ]+)?(['a-zA-Z]+[\- ]?[a-zA-Z]+)[,](?:[ ][A-Z]{2}[ ])/);r&&(s.city=r[1]);var r=a[0].formatted_address.match(/^([0-9]+)[ ]([a-zA-Z' ]+)[, ]/);r&&(s.number=r[1],s.street=r[2]),s.formatted=a[0].formatted_address,s.lat=t.lat,s.lng=t.lng,o(s,e)}else o(!1,e)})},this.zipToAddress=function(t,o,e){d.geocode({address:t},function(t,a){if(a===google.maps.GeocoderStatus.OK){var n={},s=t[0].formatted_address.match(/([a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|([0-9]{2}[ ]?[0-9]{3})/);s&&(n.zip=s[0]);var s=t[0].formatted_address.match(/[ ]([a-zA-Z]+)$/);s&&(n.country=s[1]);var s=t[0].formatted_address.match(/[ ]([A-Z]{2})[ ](?:[a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|(?:[0-9]{2}[ ]?[0-9]{3})/);s&&(n.state=s[1]);var s=t[0].formatted_address.match(/(?:[, ]+)?(['a-zA-Z]+[\- ]?[a-zA-Z]+)[,](?:[ ][A-Z]{2}[ ])/);s&&(n.city=s[1]);var s=t[0].formatted_address.match(/^([0-9]+)[ ]([a-zA-Z' ]+)[, ]/);s&&(n.number=s[1],n.street=s[2]),n.formatted=t[0].formatted_address,n.lat=t[0].geometry.location.lat(),n.lng=t[0].geometry.location.lng(),o(n,e)}else o(!1,e)})},this.zipToLatLng=function(t,o,e){d.geocode({address:t},function(t,a){if(a===google.maps.GeocoderStatus.OK){var n={};n.lat=t[0].geometry.location.lat(),n.lng=t[0].geometry.location.lng(),o(n,e)}else o(!1,e)})},this.getRoute=function(t,o,e,a,n){if("undefined"==typeof e)var e=OGX.GeoTools.TRAVEL_MODE_CAR;var s=new google.maps.DirectionsService,r={origin:t,destination:o,travelMode:e};s.route(r,function(t,o){o===google.maps.DirectionsStatus.OK?a(t,n):a(!1,n)})},this.calcRouteMinutes=function(t){for(var o=0,e=0;e<t.legs.length;e++)o+=t.legs[e].duration.value;return o=Math.round(o/60)},this.drawRoute=function(t){c||(c=new google.maps.DirectionsRenderer),c.setMap(m.map),c.setDirections(t)},this.clearMap=function(){m.map&&c&&c.setMap(null)},i()},OGX.GeoTools=function(t){"use strict";return new OGX.prototype.GeoTools(t)},OGX.GeoTools.ERROR="GEOTOOLS_error",OGX.GeoTools.ERROR_GMAP="GEOTOOLS_GMAP_ERROR",OGX.GeoTools.TRAVEL_MODE_CAR="GEOTOOLS_DRIVING",OGX.GeoTools.TRAVEL_MODE_TRANSIT="GEOTOOLS_TRANSIT",OGX.GeoTools.TRAVEL_MODE_WALK="GEOTOOLS_WALKING",OGX.GeoTools.TRAVEL_MODE_BIKE="GEOTOOLS_BICYCLING",OGX.GeoTools.BROWSER_LOC_SUCCESS="GEOTOOLS_BROWSER_LOC_SUCCESS",OGX.GeoTools.BROWSER_LOC_ERROR="GEOTOOLS_BROWSER_LOC_ERROR",OGX.GeoTools.MAP_LOADED="GEOTOOLS_MAP_LOADED";