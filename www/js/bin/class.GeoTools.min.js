if(void 0===OGX)var OGX=function(){};OGX.GeoTools=function(o){"use strict";var r,t,e,a={map:null,markers:[],icon:"",browser_loc:null},l=o;function s(o,t){for(var e,a={},n=0;n<o.length;n++){e=!1;for(var r=0;r<t.length;r++){for(var s=0;s<t[r].address_components.length;s++)if(-1!==t[r].address_components[s].types.indexOf(o[n][0])){a[o[n][1]]=t[r].address_components[s].short_name,e=!0;break}if(e)break}}return a}function c(o){return o*(Math.PI/180)}function i(o){return Array.isArray(o)?new google.maps.LatLng(o[0],o[1]):"function"!=typeof o.lat?new google.maps.LatLng(o.lat,o.lng):o}function n(o){var t={gmap:new google.maps.LatLng(o.coords.latitude,o.coords.longitude),raw:{lat:o.coords.latitude,lng:o.coords.longitude}};e?(e(t),e=null):$(document).trigger(OGX.GeoTools.BROWSER_LOC_SUCCESS,t)}function u(o){$(document).trigger(OGX.GeoTools.BROWSER_LOC_ERROR,o)}this._NAME_=OGX.GeoTools.NAME,this.setMap=function(o){l.map=o,google.maps.event.addListenerOnce(l.map,"tilesloaded",function(){$(document).trigger(OGX.GeoTools.MAP_LOADED)})},this.getMap=function(){return l.map},this.getMapRadius=function(){return!!l.map&&function(){if(l.map){var o=l.map.getBounds(),t=o.getCenter(),e=o.getNorthEast(),a=t.lat()/57.2958,n=t.lng()/57.2958,r=e.lat()/57.2958,s=e.lng()/57.2958,i=3963*Math.acos(Math.sin(a)*Math.sin(r)+Math.cos(a)*Math.cos(r)*Math.cos(s-n));return i}return!1}()},this.getCurrentLocation=function(){return!!l.map&&(o=l.map.getCenter(),new google.maps.LatLng(o.lat(),o.lng()));var o},this.getBrowserLocation=function(o){e=void 0===o?null:o,navigator.geolocation.getCurrentPosition(n,u,{maximumAge:0,timeout:1e4,enableHighAccuracy:!0})},this.getDistance=function(o,t,e,a){var n=c(e-o),r=c(a-t),s=Math.sin(n/2)*Math.sin(n/2)+Math.cos(c(o))*Math.cos(c(e))*Math.sin(r/2)*Math.sin(r/2),i=6371*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)));return Math.round(i/1e3*100)/100},this.addressToLatLng=function(o,e,a){r.geocode({address:o},function(o,t){t==google.maps.GeocoderStatus.OK?e(o[0].geometry.location,a):e(!1,a)})},this.getCityBoundaries=function(o,t,e,a,n){r.geocode({address:o+", "+t+", "+e},function(o,t){t==google.maps.GeocoderStatus.OK?a(o[0].geometry,n):a(!1,n)})},this.latLngToZip=function(o,a,t){o=i(o),r.geocode({location:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=s([["postal_code","zip"]],o);a(e)}})},this.latLngToCountryStateCity=function(o,a,n){o=i(o),r.geocode({location:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=s([["country","country"],["administrative_area_level_1","state"],["locality","city"]],o);a(e,n)}else a(!1,n)})},this.partialAddressToCountryStateCity=function(o,a,n){r.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=s([["country","country"],["administrative_area_level_1","state"],["locality","city"]],o);a(e,n)}else a(!1,n)})},this.latLngToAddress=function(o,a,n){o=i(o),r.geocode({location:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=s([["street_number","number"],["route","street"],["country","country"],["administrative_area_level_1","state"],["locality","city"]],o);o[0].hasOwnProperty("formatted_address")&&(e.formatted=o[0].formatted_address),a(e,n)}else a(!1,n)})},this.partialAddressToAddress=function(o,a,n){r.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=s([["street_number","number"],["route","street"],["country","country"],["administrative_area_level_1","state"],["locality","city"]],o);o[0].hasOwnProperty("formatted_address")&&(e.formatted=o[0].formatted_address),a(e,n)}else a(!1,n)})},this.zipToAddress=function(o,t,e){this.partialAddressToAddress(zip,t,e)},this.zipToLatLng=function(o,a,n){r.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e={};e.lat=o[0].geometry.location.lat(),e.lng=o[0].geometry.location.lng(),a(e,n)}else a(!1,n)})},this.getRoute=function(e){var o={start:!1,end:!1,waypoints:!1,optimize:!0,mode:OGX.GeoTools.TRAVEL_MODE_CAR,callback:!1,params:!1};for(var t in o)e.hasOwnProperty(t)||(e[t]=o[t]);var a=new google.maps.DirectionsService,n={origin:e.start,destination:e.end,travelMode:e.mode};e.waypoints&&(n.waypoints=e.waypoints,e.optimize&&(n.optimizeWaypoints=!0)),a.route(n,function(o,t){t===google.maps.DirectionsStatus.OK?e.callback(o,e.params):e.callback(!1,e.params)})},this.calcRouteMinutes=function(o){for(var t=0,e=0;e<o.legs.length;e++)t+=o.legs[e].duration.value;return t=Math.round(t/60)},this.drawRoute=function(o){t||(t=new google.maps.DirectionsRenderer),t.setMap(l.map),t.setDirections(o)},this.clearMap=function(){l.map&&t&&t.setMap(null)},this.latLngToLoc=function(o,t){return new google.maps.LatLng(o,t)},"undefined"!=typeof google&&void 0!==google.maps?(r=new google.maps.Geocoder,l||(l={}),function(){for(var o in a)l.hasOwnProperty(o)||(l[o]=a[o])}(),l.map&&l.markers.length):$(document).trigger(OGX.GeoTools.ERROR_GMAP)},OGX.GeoTools.NAME="OgxGeoTools",OGX.GeoTools.ERROR="GEOTOOLS_error",OGX.GeoTools.ERROR_GMAP="GEOTOOLS_GMAP_ERROR",OGX.GeoTools.TRAVEL_MODE_CAR="DRIVING",OGX.GeoTools.TRAVEL_MODE_TRANSIT="TRANSIT",OGX.GeoTools.TRAVEL_MODE_WALK="WALKING",OGX.GeoTools.TRAVEL_MODE_BIKE="BICYCLING",OGX.GeoTools.BROWSER_LOC_SUCCESS="GEOTOOLS_BROWSER_LOC_SUCCESS",OGX.GeoTools.BROWSER_LOC_ERROR="GEOTOOLS_BROWSER_LOC_ERROR",OGX.GeoTools.MAP_LOADED="GEOTOOLS_MAP_LOADED";