if(void 0===OGX)var OGX=function(){};OGX.GeoTools=function(o){"use strict";var s,t,e,n={map:null,markers:[],icon:"",browser_loc:null},c=o;function r(o,t){for(var e,n={},a=0;a<o.length;a++){e=!1;for(var s=0;s<t.length;s++){for(var r=0;r<t[s].address_components.length;r++)if(-1!==t[s].address_components[r].types.indexOf(o[a][0])){n[o[a][1]]=t[s].address_components[r].short_name,e=!0;break}if(e)break}}return n}function l(o){return o*(Math.PI/180)}function a(o){var t={gmap:new google.maps.LatLng(o.coords.latitude,o.coords.longitude),raw:{lat:o.coords.latitude,lng:o.coords.longitude}};e?(e(t),e=null):$(document).trigger(OGX.GeoTools.BROWSER_LOC_SUCCESS,t)}function i(o){$(document).trigger(OGX.GeoTools.BROWSER_LOC_ERROR,o)}this._NAME_=OGX.GeoTools.NAME,this.setMap=function(o){c.map=o,google.maps.event.addListenerOnce(c.map,"tilesloaded",function(){$(document).trigger(OGX.GeoTools.MAP_LOADED)})},this.getMap=function(){return c.map},this.getMapRadius=function(){return!!c.map&&function(){if(c.map){var o=c.map.getBounds(),t=o.getCenter(),e=o.getNorthEast(),n=t.lat()/57.2958,a=t.lng()/57.2958,s=e.lat()/57.2958,r=e.lng()/57.2958,i=3963*Math.acos(Math.sin(n)*Math.sin(s)+Math.cos(n)*Math.cos(s)*Math.cos(r-a));return i}return!1}()},this.getCurrentLocation=function(){return!!c.map&&(o=c.map.getCenter(),new google.maps.LatLng(o.lat(),o.lng()));var o},this.getBrowserLocation=function(o){e=void 0===o?null:o,navigator.geolocation.getCurrentPosition(a,i,{maximumAge:0,timeout:1e4,enableHighAccuracy:!0})},this.getDistance=function(o,t,e,n){var a=l(e-o),s=l(n-t),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(l(o))*Math.cos(l(e))*Math.sin(s/2)*Math.sin(s/2),i=6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return Math.round(i/1e3*100)/100},this.addressToLatLng=function(o,e,n){s.geocode({address:o},function(o,t){t==google.maps.GeocoderStatus.OK?e(o[0].geometry.location,n):e(!1,n)})},this.getCityBoundaries=function(o,t,e,n,a){s.geocode({address:o+", "+t+", "+e},function(o,t){t==google.maps.GeocoderStatus.OK?n(o[0].geometry,a):n(!1,a)})},this.latLngToZip=function(o,n,t){s.geocode({location:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=r([["postal_code","zip"]],o);n(e)}})},this.latLngToCountryStateCity=function(o,n,a){s.geocode({location:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=r([["country","country"],["administrative_area_level_1","state"],["locality","city"]],o);n(e,a)}else n(!1,a)})},this.partialAddressToCountryStateCity=function(o,n,a){s.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=r([["country","country"],["administrative_area_level_1","state"],["locality","city"]],o);n(e,a)}else n(!1,a)})},this.latLngToAddress=function(o,n,a){s.geocode({location:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=r([["street_number","number"],["route","street"],["country","country"],["administrative_area_level_1","state"],["locality","city"]],o);o[0].hasOwnProperty("formatted_address")&&(e.formatted=o[0].formatted_address),n(e,a)}else n(!1,a)})},this.partialAddressToAddress=function(o,n,a){s.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=r([["street_number","number"],["route","street"],["country","country"],["administrative_area_level_1","state"],["locality","city"]],o);o[0].hasOwnProperty("formatted_address")&&(e.formatted=o[0].formatted_address),n(e,a)}else n(!1,a)})},this.zipToAddress=function(o,t,e){this.partialAddressToAddress(zip,t,e)},this.zipToLatLng=function(o,n,a){s.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e={};e.lat=o[0].geometry.location.lat(),e.lng=o[0].geometry.location.lng(),n(e,a)}else n(!1,a)})},this.getRoute=function(o,t,e,n,a){if(void 0===e)e=OGX.GeoTools.TRAVEL_MODE_CAR;var s={origin:o,destination:t,travelMode:e};(new google.maps.DirectionsService).route(s,function(o,t){t===google.maps.DirectionsStatus.OK?n(o,a):n(!1,a)})},this.calcRouteMinutes=function(o){for(var t=0,e=0;e<o.legs.length;e++)t+=o.legs[e].duration.value;return t=Math.round(t/60)},this.drawRoute=function(o){t||(t=new google.maps.DirectionsRenderer),t.setMap(c.map),t.setDirections(o)},this.clearMap=function(){c.map&&t&&t.setMap(null)},this.latLngToLoc=function(o,t){return new google.maps.LatLng(o,t)},"undefined"!=typeof google&&void 0!==google.maps?(s=new google.maps.Geocoder,c||(c={}),function(){for(var o in n)c.hasOwnProperty(o)||(c[o]=n[o])}(),c.map&&c.markers.length):$(document).trigger(OGX.GeoTools.ERROR_GMAP)},OGX.GeoTools.NAME="OgxGeoTools",OGX.GeoTools.ERROR="GEOTOOLS_error",OGX.GeoTools.ERROR_GMAP="GEOTOOLS_GMAP_ERROR",OGX.GeoTools.TRAVEL_MODE_CAR="GEOTOOLS_DRIVING",OGX.GeoTools.TRAVEL_MODE_TRANSIT="GEOTOOLS_TRANSIT",OGX.GeoTools.TRAVEL_MODE_WALK="GEOTOOLS_WALKING",OGX.GeoTools.TRAVEL_MODE_BIKE="GEOTOOLS_BICYCLING",OGX.GeoTools.BROWSER_LOC_SUCCESS="GEOTOOLS_BROWSER_LOC_SUCCESS",OGX.GeoTools.BROWSER_LOC_ERROR="GEOTOOLS_BROWSER_LOC_ERROR",OGX.GeoTools.MAP_LOADED="GEOTOOLS_MAP_LOADED";