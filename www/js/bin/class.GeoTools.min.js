if(void 0===OGX)var OGX=function(){};OGX.GeoTools=function(o){"use strict";var i,t,e,a={map:null,markers:[],icon:"",browser_loc:null},d=o;function c(o){return o*(Math.PI/180)}function s(o){var t={gmap:new google.maps.LatLng(o.coords.latitude,o.coords.longitude),raw:{lat:o.coords.latitude,lng:o.coords.longitude}};e?(e(t),e=null):$(document).trigger(OGX.GeoTools.BROWSER_LOC_SUCCESS,t)}function n(o){$(document).trigger(OGX.GeoTools.BROWSER_LOC_ERROR,o)}this._NAME_=OGX.GeoTools.NAME,this.setMap=function(o){d.map=o,google.maps.event.addListenerOnce(d.map,"tilesloaded",function(){$(document).trigger(OGX.GeoTools.MAP_LOADED)})},this.getMap=function(){return d.map},this.getMapRadius=function(){return!!d.map&&function(){if(d.map){var o=d.map.getBounds(),t=o.getCenter(),e=o.getNorthEast(),a=t.lat()/57.2958,s=t.lng()/57.2958,n=e.lat()/57.2958,r=e.lng()/57.2958,i=3963*Math.acos(Math.sin(a)*Math.sin(n)+Math.cos(a)*Math.cos(n)*Math.cos(r-s));return i}return!1}()},this.getCurrentLocation=function(){return!!d.map&&(o=d.map.getCenter(),new google.maps.LatLng(o.lat(),o.lng()));var o},this.getBrowserLocation=function(o){e=void 0===o?null:o,navigator.geolocation.getCurrentPosition(s,n,{maximumAge:0,timeout:1e4,enableHighAccuracy:!0})},this.getDistance=function(o,t,e,a){var s=c(e-o),n=c(a-t),r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(c(o))*Math.cos(c(e))*Math.sin(n/2)*Math.sin(n/2),i=6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return Math.round(i/1e3*100)/100},this.addressToLatLng=function(o,e,a){i.geocode({address:o},function(o,t){t==google.maps.GeocoderStatus.OK?e(o[0].geometry.location,a):e(!1,a)})},this.getCityBoundaries=function(o,t,e,a,s){i.geocode({address:o+", "+t+", "+e},function(o,t){t==google.maps.GeocoderStatus.OK?a(o[0].geometry,s):a(!1,s)})},this.latLngToZip=function(o,a,s){i.geocode({location:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e=o[0].formatted_address.match(/([a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|([0-9]{2}[ ]?[0-9]{3})/);a(e?e[0]:null,s)}else a(!1,s)})},this.latLngToCountryStateCity=function(o,s,n){i.geocode({location:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){for(var e={},a=0;a<o[0].address_components.length;a++)-1!==o[0].address_components[a].types.indexOf("locality")&&(e.city=o[0].address_components[a].short_name),-1!==o[0].address_components[a].types.indexOf("administrative_area_level_1")&&(e.state=o[0].address_components[a].short_name),-1!==o[0].address_components[a].types.indexOf("country")&&(e.country=o[0].address_components[a].short_name);s(e,n)}else s(!1,n)})},this.partialAddressToCountryStateCity=function(o,s,n){i.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){for(var e={},a=0;a<o[0].address_components.length;a++)-1!==o[0].address_components[a].types.indexOf("locality")&&(e.city=o[0].address_components[a].short_name),-1!==o[0].address_components[a].types.indexOf("administrative_area_level_1")&&(e.state=o[0].address_components[a].short_name),-1!==o[0].address_components[a].types.indexOf("country")&&(e.country=o[0].address_components[a].short_name);s(e,n)}else s(!1,n)})},this.latLngToAddress=function(s,n,r){i.geocode({location:s},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e,a={};(e=o[0].formatted_address.match(/([a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|([0-9]{2}[ ]?[0-9]{3})/))&&(a.zip=e[0]),(e=o[0].formatted_address.match(/[ ]([a-zA-Z]+)$/))&&(a.country=e[1]),(e=o[0].formatted_address.match(/[ ]([A-Z]{2})[ ](?:[a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|(?:[0-9]{2}[ ]?[0-9]{3})/))&&(a.state=e[1]),(e=o[0].formatted_address.match(/(?:[, ]+)?(['a-zA-Z]+[\- ]?[a-zA-Z]+)[,](?:[ ][A-Z]{2}[ ])/))&&(a.city=e[1]),(e=o[0].formatted_address.match(/^([0-9]+)[ ]([a-zA-Z' ]+)[, ]/))&&(a.number=e[1],a.street=e[2]),a.formatted=o[0].formatted_address,a.lat=s.lat,a.lng=s.lng,n(a,r)}else n(!1,r)})},this.zipToAddress=function(o,s,n){i.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e,a={};(e=o[0].formatted_address.match(/([a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|([0-9]{2}[ ]?[0-9]{3})/))&&(a.zip=e[0]),(e=o[0].formatted_address.match(/[ ]([a-zA-Z]+)$/))&&(a.country=e[1]),(e=o[0].formatted_address.match(/[ ]([A-Z]{2})[ ](?:[a-zA-Z][0-9][a-zA-Z][ -]?[0-9][a-zA-Z][0-9])|(?:[0-9]{2}[ ]?[0-9]{3})/))&&(a.state=e[1]),(e=o[0].formatted_address.match(/(?:[, ]+)?(['a-zA-Z]+[\- ]?[a-zA-Z]+)[,](?:[ ][A-Z]{2}[ ])/))&&(a.city=e[1]),(e=o[0].formatted_address.match(/^([0-9]+)[ ]([a-zA-Z' ]+)[, ]/))&&(a.number=e[1],a.street=e[2]),a.formatted=o[0].formatted_address,a.lat=o[0].geometry.location.lat(),a.lng=o[0].geometry.location.lng(),s(a,n)}else s(!1,n)})},this.zipToLatLng=function(o,a,s){i.geocode({address:o},function(o,t){if(t===google.maps.GeocoderStatus.OK){var e={};e.lat=o[0].geometry.location.lat(),e.lng=o[0].geometry.location.lng(),a(e,s)}else a(!1,s)})},this.getRoute=function(o,t,e,a,s){if(void 0===e)e=OGX.GeoTools.TRAVEL_MODE_CAR;var n={origin:o,destination:t,travelMode:e};(new google.maps.DirectionsService).route(n,function(o,t){t===google.maps.DirectionsStatus.OK?a(o,s):a(!1,s)})},this.calcRouteMinutes=function(o){for(var t=0,e=0;e<o.legs.length;e++)t+=o.legs[e].duration.value;return t=Math.round(t/60)},this.drawRoute=function(o){t||(t=new google.maps.DirectionsRenderer),t.setMap(d.map),t.setDirections(o)},this.clearMap=function(){d.map&&t&&t.setMap(null)},"undefined"!=typeof google&&void 0!==google.maps?(i=new google.maps.Geocoder,d||(d={}),function(){for(var o in a)d.hasOwnProperty(o)||(d[o]=a[o])}(),d.map&&d.markers.length):$(document).trigger(OGX.GeoTools.ERROR_GMAP)},OGX.GeoTools.NAME="OgxGeoTools",OGX.GeoTools.ERROR="GEOTOOLS_error",OGX.GeoTools.ERROR_GMAP="GEOTOOLS_GMAP_ERROR",OGX.GeoTools.TRAVEL_MODE_CAR="GEOTOOLS_DRIVING",OGX.GeoTools.TRAVEL_MODE_TRANSIT="GEOTOOLS_TRANSIT",OGX.GeoTools.TRAVEL_MODE_WALK="GEOTOOLS_WALKING",OGX.GeoTools.TRAVEL_MODE_BIKE="GEOTOOLS_BICYCLING",OGX.GeoTools.BROWSER_LOC_SUCCESS="GEOTOOLS_BROWSER_LOC_SUCCESS",OGX.GeoTools.BROWSER_LOC_ERROR="GEOTOOLS_BROWSER_LOC_ERROR",OGX.GeoTools.MAP_LOADED="GEOTOOLS_MAP_LOADED";