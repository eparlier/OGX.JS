if(void 0===OGX)var OGX=function(){};OGX.GeoTools=function(t){"use strict";var i,e,o,s=this,a={map:null,markers:[],icon:"",browser_loc:null},c=t;function r(t,e){for(var o,a={},n=0;n<t.length;n++){o=!1;for(var i=0;i<e.length;i++){for(var r=0;r<e[i].address_components.length;r++)if(-1!==e[i].address_components[r].types.indexOf(t[n][0])){a[t[n][1]]=e[i].address_components[r].short_name,o=!0;break}if(o)break}}return a=s.clean(a)}function l(t){return t*(Math.PI/180)}function d(t){return Array.isArray(t)?new google.maps.LatLng(t[0],t[1]):"function"!=typeof t.lat?new google.maps.LatLng(t.lat,t.lng):t}function n(t){var e={gmap:new google.maps.LatLng(t.coords.latitude,t.coords.longitude),raw:{lat:t.coords.latitude,lng:t.coords.longitude}};o?(o(e),o=null):$(document).trigger(OGX.GeoTools.BROWSER_LOC_SUCCESS,e)}function g(t){$(document).trigger(OGX.GeoTools.BROWSER_LOC_ERROR,t)}this._NAME_=OGX.GeoTools.NAME,this.setMap=function(t){c.map=t,google.maps.event.addListenerOnce(c.map,"tilesloaded",function(){$(document).trigger(OGX.GeoTools.MAP_LOADED)})},this.getMap=function(){return c.map},this.getMapRadius=function(){return!!c.map&&function(){if(c.map){var t=c.map.getBounds(),e=t.getCenter(),o=t.getNorthEast(),a=e.lat()/57.2958,n=e.lng()/57.2958,i=o.lat()/57.2958,r=o.lng()/57.2958,s=3963*Math.acos(Math.sin(a)*Math.sin(i)+Math.cos(a)*Math.cos(i)*Math.cos(r-n));return s}return!1}()},this.getCurrentLocation=function(){return!!c.map&&(t=c.map.getCenter(),new google.maps.LatLng(t.lat(),t.lng()));var t},this.getBrowserLocation=function(t){o=void 0===t?null:t,navigator.geolocation.getCurrentPosition(n,g,{maximumAge:0,timeout:1e4,enableHighAccuracy:!0})},this.getDistance=function(t,e,o,a){var n=l(o-t),i=l(a-e),r=Math.sin(n/2)*Math.sin(n/2)+Math.cos(l(t))*Math.cos(l(o))*Math.sin(i/2)*Math.sin(i/2),s=6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return Math.round(s/1e3*100)/100},this.addressToLatLng=function(t,o,a){i.geocode({address:t},function(t,e){e==google.maps.GeocoderStatus.OK?o(t[0].geometry.location,a):o(!1,a)})},this.getCityBoundaries=function(t,e,o,a,n){i.geocode({address:t+", "+e+", "+o},function(t,e){e==google.maps.GeocoderStatus.OK?a(t[0].geometry,n):a(!1,n)})},this.latLngToZip=function(t,a,e){t=d(t),i.geocode({location:t},function(t,e){if(e===google.maps.GeocoderStatus.OK){var o=r([["postal_code","zip"]],t);a(o)}})},this.latLngToCountryStateCity=function(t,a,n){t=d(t),i.geocode({location:t},function(t,e){if(e===google.maps.GeocoderStatus.OK){var o=r([["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],t);a(o,n)}else a(!1,n)})},this.partialAddressToCountryStateCity=function(t,a,n){i.geocode({address:t},function(t,e){if(e===google.maps.GeocoderStatus.OK){var o=r([["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],t);a(o,n)}else a(!1,n)})},this.latLngToAddress=function(t,a,n){t=d(t),i.geocode({location:t},function(t,e){if(e===google.maps.GeocoderStatus.OK){var o=r([["street_number","number"],["route","street"],["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],t);t[0].hasOwnProperty("formatted_address")&&(o.formatted=t[0].formatted_address),a(o,n)}else a(!1,n)})},this.partialAddressToAddress=function(t,a,n){i.geocode({address:t},function(t,e){if(e===google.maps.GeocoderStatus.OK){var o=r([["street_number","number"],["route","street"],["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],t);t[0].hasOwnProperty("formatted_address")&&(o.formatted=t[0].formatted_address),a(o,n)}else a(!1,n)})},this.zipToAddress=function(t,e,o){this.partialAddressToAddress(zip,e,o)},this.zipToLatLng=function(t,a,n){i.geocode({address:t},function(t,e){if(e===google.maps.GeocoderStatus.OK){var o={};o.lat=t[0].geometry.location.lat(),o.lng=t[0].geometry.location.lng(),a(o,n)}else a(!1,n)})},this.getRoute=function(o){var t={start:!1,end:!1,waypoints:!1,optimize:!0,mode:OGX.GeoTools.TRAVEL_MODE_CAR,callback:!1,params:!1};for(var e in t)o.hasOwnProperty(e)||(o[e]=t[e]);var a=new google.maps.DirectionsService,n={origin:o.start,destination:o.end,travelMode:o.mode};o.waypoints&&(n.waypoints=o.waypoints,o.optimize&&(n.optimizeWaypoints=!0)),a.route(n,function(t,e){e===google.maps.DirectionsStatus.OK?o.callback(t,o.params):o.callback(!1,o.params)})},this.calcRouteMinutes=function(t){for(var e=0,o=0;o<t.legs.length;o++)e+=t.legs[o].duration.value;return e=Math.round(e/60)},this.drawRoute=function(t){e||(e=new google.maps.DirectionsRenderer),e.setMap(c.map),e.setDirections(t)},this.clearMap=function(){c.map&&e&&e.setMap(null)},this.latLngToLoc=function(t,e){return new google.maps.LatLng(t,e)},this.clean=function(t,e){var o;if(void 0===e&&(e=!1),t.hasOwnProperty("city")&&t.hasOwnProperty("vicinity")&&-1!==t.vicinity.indexOf(",")&&(o=new RegExp(", ([a-z -']+)$","gi").exec(t.vicinity))&&1<o.length&&(t.city===o[1]?t.vicinity=t.vicinity.replace(o[0],""):t.city.length>o[1].length&&(t.city=o[1],t.vicinity=t.vicinity.replace(o[0],""))),e)for(var a in t)-1===e.indexOf(a)&&delete t[a];return t},"undefined"!=typeof google&&void 0!==google.maps?(i=new google.maps.Geocoder,void 0===c&&(c={}),function(){for(var t in a)c.hasOwnProperty(t)||(c[t]=a[t])}(),c.map&&c.markers.length):$(document).trigger(OGX.GeoTools.ERROR_GMAP)},OGX.GeoTools.NAME="OgxGeoTools",OGX.GeoTools.ERROR="GEOTOOLS_error",OGX.GeoTools.ERROR_GMAP="GEOTOOLS_GMAP_ERROR",OGX.GeoTools.TRAVEL_MODE_CAR="DRIVING",OGX.GeoTools.TRAVEL_MODE_TRANSIT="TRANSIT",OGX.GeoTools.TRAVEL_MODE_WALK="WALKING",OGX.GeoTools.TRAVEL_MODE_BIKE="BICYCLING",OGX.GeoTools.BROWSER_LOC_SUCCESS="GEOTOOLS_BROWSER_LOC_SUCCESS",OGX.GeoTools.BROWSER_LOC_ERROR="GEOTOOLS_BROWSER_LOC_ERROR",OGX.GeoTools.MAP_LOADED="GEOTOOLS_MAP_LOADED";