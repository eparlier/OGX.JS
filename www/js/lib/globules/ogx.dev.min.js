/* globules.io OGX.JS 1.26.0.12.debug */ 
if(String.prototype.hasOwnProperty("substr")||(String.prototype.substr=function(t,e){return t<0&&(t=this.length-t),this.slice(t,t+e)}),void 0===OGX)var OGX={};if(OGX.Data={},OGX.Data.weld=(t,e,r,i)=>{void 0===r&&(r=!1),void 0===i&&(i=!1);var a=t;return i&&(a=JSON.parse(JSON.stringify(t))),function t(e,i){for(var a in i)!e.hasOwnProperty(a)||r?e[a]=i[a]:"object"==typeof i[a]&&t(e[a],i[a])}(a,e),a},OGX.Data.merge=(t,e,r,i,a)=>{for(var s in void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===a&&(a=!1),i&&(t=JSON.parse(JSON.stringify(t))),e)r?a?t.hasOwnProperty(s)&&(t[s]=e[s]):t[s]=e[s]:t.hasOwnProperty(s)||a||(t[s]=e[s]);return t},OGX.Data.diff=(t,e,r)=>{void 0===r&&(r=!1);var i={},a=!1;for(var s in e)(!r&&!t.hasOwnProperty(s)||r&&t.hasOwnProperty(s)&&t[s]!==e[s])&&(i[s]=e[s],a=!0);return!!a&&i},OGX.Data.props=(t,e)=>{for(var r in e)if(!t.hasOwnProperty(e[r]))return!1;return!0},OGX.Data.clone=t=>JSON.parse(JSON.stringify(t)),OGX.Data.isOML=t=>{for(var e in t)if(-1!==e.indexOf(":"))return!0;return!1},OGX.Data.stringToVal=t=>{if("string"!=typeof t)return t;var e=-1;return"true"===t&&(e=!0),"false"===t&&(e=!1),-1!==e?e:t.match(/^([0-9]+(\.[0-9]+)?)$/g)?Number(t):t.match(/^(\[|{)/g)?JSON.parse(t):t},OGX.Data.pad=(t,e,r,i)=>{void 0===i&&(i="0"),void 0===r&&(r=-1);for(var a=String(t);a.length<e;)-1===r?a=i+a:a+=i;return a},OGX.Data.addDec=t=>parseFloat(Math.round(100*t)/100).toFixed(2),OGX.Data.isInt=t=>Number(t)===t&&t%1==0,OGX.Data.isFloat=t=>Number(t)===t&&t%1!=0,OGX.Data.dateToLocale=(t,e)=>("string"==typeof t&&(t=new Date(t+" ")),void 0===e&&(e={}),OGX.Data.merge(e,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),t.toLocaleDateString(navigator.language,e)),OGX.Data.eval=(__obj,__path,__value)=>{void 0===__value&&(__value=null);var str="__obj."+__path,res;__value&&(str+=" = "+JSON.stringify(__value));try{res=eval(str)}catch(t){debug(1,"Eval error",__path)}return res},OGX.Data.getBestSize=(t,e,r,i)=>{if(void 0===r&&(r=10),void 0===i&&(i=200),"string"==typeof e){if(-1!==e.indexOf("|")){var a=e.substr(e.length-1,1);["+","-"].includes(a)?e=e.substr(0,e.length-1):a="+",a="+"===a?1:-1;for(var s,n=e.split("|"),o=new OGX.List,l=0;l<n.length;l++)-1!==(s=n[l]).indexOf("px")&&(s=s.replace("px","")),-1!==s.indexOf("%")&&(s=Math.round(Number(s.split("%")[0])*t/100)),s<=t&&o.insert({m:t-s,s:n[l],n:s});return o.order("m",a),"100%"===o[0].s&&o.length>1&&o[1].m<i?o[1].s:o[0].s}(m=/(\d+)(%|px)?/gi.exec(e))&&("%"===m[2].trim()?e=Math.round(Number(m[1])*t/100):("px"===m[2].trim()&&(e=m[1]),e=Number(e)))}return e},OGX.Data.same=(t,e,r)=>{void 0===r&&(r=!0);var i,a=0,s=0;for(i in t)a++;for(i in e)s++;if(a!==s)return!1;if(typeof t!=typeof e)return!1;if(!["object","array"].includes(typeof t))return t===e;return function t(e,a){for(i in e){if(typeof e[i]!=typeof a[i])return!1;if(r&&"object"==typeof e[i]&&a.hasOwnProperty(i)){if(!t(e[i],a[i]))return!1}else if("array"==typeof e[i]){if(e[i].length!==a[i].length)return!1;if(e[i].sort(),a[i].sort(),r){for(var s=0;s<e[i].length;s++)if(!t(e[i][s],a[i][s]))return!1}else if(JSON.parse(JSON.stringify(e[i]))!==JSON.parse(JSON.stringify(__b[i])))return!1}else if(e[i]!==a[i])return!1}return!0}(t,e)},OGX.Data.clipboard=t=>{if(void 0!==t)if(void 0!==navigator.clipboard)navigator.clipboard.writeText(t);else{var e=document.createElement("textarea");e.value=t,e.style.top="-1000px",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.trigger("focus"),e.select();try{document.execCommand("copy")}catch(t){}document.body.removeChild(e)}},void 0===OGX)var OGX={};OGX.Debug=function(){var t=1,e=[1,2,3],r=[null,{label:"Error",color:"#EE1111"},{label:"Warning",color:"#ffdb16"},{label:"Info",color:"#23b438"},{label:"Verbose",color:"#AAAAAA"},{label:"Detail",color:"#999999"}];this.log=function(i){var a=Array.prototype.slice.call(arguments);1===a.length&&(a[1]=a[0],a[0]=1);var s=!1;if("boolean"==typeof e){if(!e)return;s=!0}else Array.isArray(e)&&-1!==e.indexOf(i)&&(s=!0);a.shift();var n=a.join(" ");s&&(console.log.call(null,"%c ["+OGX.Data.pad(t,6,-1,"0")+"] "+OGX.Data.pad(r[i].label,8,1," ")+":","background:#222; color:"+r[i].color+"; padding:6px 3px 6px 3px;",n),t++)},this.level=function(){var t=Array.prototype.slice.call(arguments);if(!t.length)return e;e=1!==t.length||"boolean"!=typeof t[0]?t:t[0]},console.log("%c OGX.JS💞OML v1.26.0.12","background:#222; color:#DDD; padding:8px 3px 8px 3px;")},OGX.Debug=new OGX.Debug;var debug=OGX.Debug.log;if(void 0===OGX)var OGX={};if(OGX.List=function(){if("undefined"!=typeof moment){void 0===debug&&(debug=function(){});var filteringMode="and",filterCount=0,indexes=!1;1===arguments.length&&arguments[0]instanceof Array&&(arguments=arguments[0]);var array=Object.create(Array.prototype);for(var method in array=Array.apply(array,arguments)||array,OGX.List.prototype)OGX.List.prototype.hasOwnProperty(method)&&(array[method]=OGX.List.prototype[method]);return array.insert=function(t,e){return void 0===e?array.push(t):array.splice(e,0,t),indexes&&addToCache(t),!0},array.delete=function(t){var e=this,r=array.splice(t,1);if(r.length){if(indexes){var i=matchesCache(r[0]);i&&setTimeout((()=>{e.rebuild(i)}),0)}return r[0]}return!1},array.last=function(){if(this.length)return this[this.length-1]},array.findDelete=function(__property,__value,__limit){var t=0;void 0===__limit&&(__limit=0);for(var removed=new OGX.List,ev,prop,i=0;i<this.length;i++){prop=null,ev="this["+i+"]."+__property;try{prop=eval(ev)}catch(t){debug(1,"Property does not exist",__property)}if(null==prop);else if(prop===__value){if(removed.push(this.splice(i,1)[0]),indexes){var idxs=matchesCache(removed.last());idxs&&this.rebuild(idxs)}if(t++,__limit>0&&__limit===t)return 1===__limit?removed[0]:removed;i--}}return removed},array.findReplace=function(__property,__value,__object,__limit){var t=0;void 0===__limit&&(__limit=0);for(var replaced=new OGX.List,ev,prop,i=0;i<this.length;i++){prop=null,ev="this["+i+"]."+__property;try{prop=eval(ev)}catch(t){debug(2,"Property does not exist",__property)}if(null==prop);else if(prop===__value&&(replaced.push(this[i]),t++,this[i]=__object,__limit>0&&__limit===t))return 1===__limit?replaced[0]:replaced}return!!replaced.length&&replaced},array.findUpdate=function(__property,__value,__object,__strict,__limit){var t=0;void 0===__strict&&(__strict=!1),void 0===__limit&&(__limit=0);for(var updated=new OGX.List,upd,ev,prop,i=0;i<this.length;i++){prop=null,ev="this["+i+"]."+__property;try{prop=eval(ev)}catch(t){debug(2,"Property does not exist",__property)}if(null==prop);else if(prop===__value){for(var a in upd=!1,__object)__strict?this[i].hasOwnProperty(a)&&(this[i][a]=__object[a],upd=!0):(this[i][a]=__object[a],upd=!0);if(upd&&(t++,updated.push(this[i]),__limit>0&&__limit===t))return 1===__limit?updated[0]:updated}}return!!updated.length&&updated},array.findIndex=function(__property,__value){var isReg=!1,ev,prop;__value instanceof RegExp&&(isReg=!0);for(var i=0;i<this.length;i++){prop=null,ev="this["+i+"]."+__property;try{prop=eval(ev)}catch(t){debug(2,"Property does not exist",__property)}if(null!==prop)if(isReg){if(prop.match(__value))return{index:i}}else if(prop===__value)return{index:i}}return!1},array.find=function(t,e,r){var i=0,a=new OGX.List,s=!1;e instanceof RegExp&&(s=!0),void 0===r&&(r=0);for(var n=0;n<this.length;n++)if(s?this[n][t].match(e)&&(a.push(this[n]),i++):this[n][t]===e&&(a.push(this[n]),i++),r>0&&i===r)return 1===r?a[0]:a;return!!a.length&&a},array.swap=function(t,e){var r=this[t];this[t]=this[e],this[e]=r},array.cache=function(){indexes||(indexes={});var t=[],e=[];if(arguments.length>1){for(var r=0;r<arguments.length;r++)t.push(arguments[r]);t=t.join("|")}else t=arguments[0];indexes.hasOwnProperty(t)||(indexes[t]={});for(var i=0;i<this.length;i++){e=[];for(r=0;r<arguments.length;r++)e.push(this[i][arguments[r]]);e=e.join("|"),indexes[t].hasOwnProperty(e)||(indexes[t][e]=[]),indexes[t][e].push(this[i])}return!0},array.uncache=function(t){if(!indexes)return!1;var e=t;return arguments.length>1&&(e=arguments.join("|")),!!indexes.hasOwnProperty(e)&&(delete indexes[e],!0)},array.deleteProperty=function(t){for(var e=0,r=0;r<this.length;r++)this[r].hasOwnProperty(t)&&(delete this[r][t],e++);return indexes&&this.rebuild(),e},array.rebuild=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)delete indexes[t[e]],this.cache(t[e]);else if(indexes)for(var r in indexes)delete indexes[r],this.cache.apply(this,r.split("|"))},array.read=function(t,e,r){var i,a,s=arguments;if(!indexes)return!1;if(!s.length)return indexes;if("object"==typeof t){for(var n in r=s[1],i=[],a=[],t)i.push(n),a.push(t[n]);i=i.join("|"),a=a.join("|")}else i=t,a=e;return void 0===r&&(r=0),!(!indexes.hasOwnProperty(i)||!indexes[i].hasOwnProperty(a))&&(r?r>1?indexes[i][a].splice(0,r):indexes[i][a][0]:indexes[i][a])},array.clear=function(){indexes=!1,filterCount=0,this.length=0},array.unique=function(__prop,__as_object,__new_props){void 0===__as_object&&(__as_object=!0),void 0===__new_props?__new_props=[__prop]:Array.isArray(__new_props)||(__new_props=[__new_props]);var q={};q[__prop]={regex:/(.){1,}/};for(var l=this.get(),ar=[],final=new OGX.List,o,ev,i=0;i<l.length;i++){ev=null;try{ev=eval("l[i]."+__prop)}catch(t){}if(ev&&!ar.includes(ev)&&(ar.push(ev),__as_object)){o={};for(var j=0;j<__new_props.length;j++)o[__new_props[j]]=ev;final.push(o)}}return __as_object?final:ar},array.order=function(t,e){array.sort(dynamicSort(t,e))},array.group=function(t,e,r){if(Array.isArray(t))return array.groupm(t,e,r);for(var i,a={},s=0;s<this.length;s++)(i=extract(this[s],t,e,r))&&(i=i.split(".").pop(),a.hasOwnProperty(i)||(a[i]=new OGX.List),a[i].push(this[s]));return a},array.groupm=function(t,e,r){return function i(a,s){var n=new OGX.List(a),o=e,l=r;void 0!==e&&Array.isArray(e)&&(o=e[s]),void 0!==r&&Array.isArray(r)&&(l=r[s]);var f=n.group(t[s],o,l);if(s+1<=t.length-1)for(var h in f)f[h]=i(f[h],s+1);return f}(this,0)},array.filters={},array.addFilter=function(t,e,r){this.filters.hasOwnProperty(t)||(this.filters[t]=[]);var i={};return i[e]=r,this.filters[t].push(i),filterCount++,!0},array.removeFilter=function(t){return!!this.filters.hasOwnProperty(t)&&(filterCount-=this.filters[t].length,delete this.filters[t],!0)},array.getFilters=function(){return this.filters},array.resetFilters=function(){this.filters={},filterCount=0},array.setFilters=function(t){for(var e in this.resetFilters(),t)for(var r=0;r<t[e].length;r++)for(var i in t[e][r])array.addFilter(e,i,t[e][r][i])},array.setFilteringMode=function(t){filterMode=t},array.get=function(t,e,r,i,a){void 0===e&&(e=!1),void 0===r&&(r=!1),"number"==typeof r&&(i=r,r=!1),void 0===i&&(i=0),void 0===a&&(a=!1);var s=this.getFilters();for(var n in this.resetFilters(),t)for(var o in t[n])this.addFilter(n,o,t[n][o]);var l=this.filter(i,a);if(this.resetFilters(),this.setFilters(s),a)return l;if(1===i)return!!l.length&&l[0];if(e)for(var n in e){l.order(n,e[n]);break}return r?(!Array.isArray(r)&&(r=[r]),l.group.apply(l,r)):l},array.unset=function(t,e){void 0===e&&(e=0);var r=new OGX.List,i=this.get(t,null,null,e,!0);if(i)for(var a=0;a<i.length;a++)r.push(this.delete(i[a]-r.length));return 1===e&&r.length?r[0]:r},array.update=function(__filterobj,__updateobj,__strict,__limit){void 0===__strict&&(__strict=!1),void 0===__limit&&(__limit=0);var filtered=this.get(__filterobj,null,__limit);if(filtered&&(Array.isArray(filtered)||(filtered=[itinerary]),filtered.length)){for(var affected_indexes=[],idx,ev,i=0;i<filtered.length;i++)for(var a in __updateobj)ev=doEval("__o."+a,filtered[i]),__strict&&void 0===ev||(eval("filtered[i]."+a+"=__updateobj[a]"),idx=matchesCache(filtered[i]),idx&&-1===affected_indexes.indexOf(idx)&&affected_indexes.push(idx));return indexes&&affected_indexes.length&&setTimeout((()=>{that.rebuild(affected_indexes)}),0),filtered}return[]},array.filter=function(__limit,__as_position){void 0===__limit&&(__limit=0),void 0===__as_position&&(__as_position=!1);for(var ar=[],positions=[],isDate,isString,isNum,isArray,isObject,hasFilters=!1,reg=/[0-9]{4}\-[0-9]{2}\-[0-9]{2}( [0-9]{2}\:[0-9]{2}\:[0-9]{2})?/g,isMatch=!1,matches=0,str,o,err,counter,total,i=0;i<this.length;i++)for(var a in isMatch=!0,matches=0,this.filters){err=!1,hasFilters=!0;try{o=null,str="this["+i+"]."+a,o=eval(str)}catch(t){err=!0}if(err||void 0===o)isMatch=!1;else{isDate=!1,isString=!1,isNum=!1,isArray=Array.isArray(o),isObject=!isArray&&"object"==typeof o,isArray?"string"==typeof o[0]?(isString=!0,o[0].match(reg)&&(isDate=!0)):isNum="number"==typeof o[0]:"string"==typeof o?(isString=!0,o.match(reg)&&(isDate=!0)):isNum="number"==typeof o;for(var j=0;j<this.filters[a].length;j++)for(var b in this.filters[a][j]){if(String(this.filters[a][j][b]).length)if("function"===b)isMatch=this.filters[a][j][b](o),isMatch&&matches++;else switch(b){case"eq":if(isDate){if("string"!=typeof this.filters[a][j][b]||!this.filters[a][j][b].match(reg)){isMatch=!1;break}moment(o).format("YYYY-MM-DD")!==moment(this.filters[a][j][b]).format("YYYY-MM-DD")?isMatch=!1:matches++}else if(isString){if("string"!=typeof this.filters[a][j][b]){isMatch=!1;break}o.toLowerCase()!==String(this.filters[a][j][b]).toLowerCase()?isMatch=!1:matches++}else o!==this.filters[a][j][b]?isMatch=!1:matches++;break;case"eqjson":JSON.stringify(o)!==JSON.stringify(this.filters[a][j][b])?isMatch=!1:matches++;break;case"neq":if(isDate){if("string"!=typeof this.filters[a][j][b]||!this.filters[a][j][b].match(reg)){isMatch=!0,matches++;break}moment(o).format("YYYY-MM-DD")===moment(this.filters[a][j][b]).format("YYYY-MM-DD")?isMatch=!1:matches++}else if(isString){if("string"!=typeof this.filters[a][j][b]){isMatch=!0,matches++;break}o.toLowerCase()===this.filters[a][j][b].toLowerCase()?isMatch=!1:matches++}else o===this.filters[a][j][b]?isMatch=!1:matches++;break;case"in":if((isString||isNum)&&Array.isArray(this.filters[a][j][b])){isMatch=!1;for(var k=0;k<this.filters[a][j][b].length;k++)if(isString){if(-1!==o.indexOf(this.filters[a][j][b][k])){isMatch=!0;break}}else if(isNum&&o===this.filters[a][j][b][k]){isMatch=!0;break}isMatch&&matches++}else if(isString||isNum)isArray?isString&&-1===o.indexOf(this.filters[a][j][b])||isNum&&o!==this.filters[a][j][b]?isMatch=!1:matches++:isString&&-1===o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())||isNum&&o!==this.filters[a][j][b]?isMatch=!1:matches++;else if(isArray)-1===o.indexOf(this.filters[a][j][b])?isMatch=!1:matches++;else if(isObject){for(var p in counter=0,total=0,this.filters[a][j][b])total++,o.hasOwnProperty(p)&&-1!==String(o[p]).toLocaleLowerCase().indexOf(String(this.filters[a][j][b][p]).toLowerCase())&&counter++;isMatch=total===counter,isMatch&&matches++}break;case"nin":if(Array.isArray(this.filters[a][j][b])){for(var k=0;k<this.filters[a][j][b].length;k++)if(isString){if(-1!==o.indexOf(this.filters[a][j][b][k])){isMatch=!1;break}}else if(isNum&&o===this.filters[a][j][b][k]){isMatch=!1;break}isMatch&&matches++}else isString&&"string"==typeof this.filters[a][j][b]?-1!==o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())&&(isMatch=!1):isNum?o===this.filters[a][j][b]&&(isMatch=!1):-1!==o.indexOf(this.filters[a][j][b])&&(isMatch=!1),isMatch&&matches++;break;case"gt":if(isDate){if("string"!=typeof this.filters[a][j][b]||!this.filters[a][j][b].match(reg)){isMatch=!1;break}moment(o).unix()<=moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++}else{if("number"!=typeof this.filters[a][j][b]){isMatch=!1;break}o<=this.filters[a][j][b]?isMatch=!1:matches++}break;case"gte":if(isDate){if("string"!=typeof this.filters[a][j][b]||!this.filters[a][j][b].match(reg)){isMatch=!1;break}moment(o).unix()<moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++}else{if("number"!=typeof this.filters[a][j][b]){isMatch=!1;break}o<this.filters[a][j][b]?isMatch=!1:matches++}break;case"lt":if(isDate){if("string"!=typeof this.filters[a][j][b]||!this.filters[a][j][b].match(reg)){isMatch=!1;break}moment(o).unix()>=moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++}else{if("number"!=typeof this.filters[a][j][b]){isMatch=!1;break}o>=this.filters[a][j][b]?isMatch=!1:matches++}break;case"lte":if(isDate){if("string"!=typeof this.filters[a][j][b]||!this.filters[a][j][b].match(reg)){isMatch=!1;break}moment(o).unix()>moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++}else{if("number"!=typeof this.filters[a][j][b]){isMatch=!1;break}o>this.filters[a][j][b]?isMatch=!1:matches++}break;case"btw":if(isDate){if("string"!=typeof this.filters[a][j][b]||!this.filters[a][j][b].match(reg)){isMatch=!1;break}moment(this.filters[a][j][b][0]).unix()>moment(o).unix()||moment(this.filters[a][j][b][1]).unix()<moment(o).unix()?isMatch=!1:matches++}else{if("number"!=typeof this.filters[a][j][b]){isMatch=!1;break}this.filters[a][j][b][0]>o||this.filters[a][j][b][1]<o?isMatch=!1:matches++}break;case"substr":o.toLowerCase().substr(this.filters[a][j][b][0],this.filters[a][j][b][1]).toLowerCase()!==this.filters[a][j][b][2].toLowerCase()?isMatch=!1:matches++;break;case"regex":o.toString().match(this.filters[a][j][b])?matches++:isMatch=!1}else matches++;if(!isMatch)break}}if("or"===filteringMode?isMatch&&(ar.push(this[i]),positions.push(i)):matches===filterCount&&(ar.push(this[i]),positions.push(i)),__limit&&ar.length===__limit)return __as_position?positions:OGX.List.apply(null,ar)}return __as_position?positions:hasFilters?OGX.List.apply(null,ar):array},array}function doEval(t,e){return new Function("try{return eval("+t+");}catch(error){}")(e)}function addToCache(t){var e;for(var r in indexes){if(-1!==r.indexOf("|")){r=r.split("|"),e=[];for(var i=0;i<r.length;i++)t.hasOwnProperty(r[i])&&e.push(t[r[i]]);e=e.join("|"),r=r.join("|")}else t.hasOwnProperty(r)&&(e=t[r]);indexes.hasOwnProperty(r)||(indexes[r]={}),indexes[r][e]=t}}function matchesCache(t){var e,r=[],i=[];for(var a in indexes){e=!0,r=-1!==a.indexOf("|")?a.split("|"):[a];for(var s=0;s<r.length;s++)if(!t.hasOwnProperty(r[s])){e=!1;break}e&&i.push(a)}return!!i.length&&i}function dynamicSort(__prop,__way){return function(a,b){return eval("a."+__prop)<eval("b."+__prop)?-1*__way:eval("a."+__prop)>eval("b."+__prop)?__way:0}}function extract(__item,__by,__mode,__param){var data;try{data=eval("__item."+__by)}catch(t){}if(data)switch(__mode){case"substr":return data=data.substr(__param[0],__param[1]),data;case"numrange":return data=Number(data),Array.isArray(__param)?(data=Math.floor(data/__param[0]),data="pre"===__param[2]?__param[1]+data*__param[0]+" - "+__param[1]+(data+1)*__param[0]:data*__param[0]+__param[1]+" - "+(data+1)*__param[0]+__param[1]):(data=Math.floor(data/__param),data=data*__param+" - "+(data+1)*__param),data;case"date":if(!Array.isArray(__param)){if("year"===__param)return data=data.substr(0,4),data;if("month"===__param)return data=data.substr(0,7),data;if("week"===__param)return data=data.substr(0,4)+" week "+moment(data).week(),data}return data=moment(data).unix(),data=Math.floor(data/(60*__param[0]*60*24)),data*=60*__param[0]*60*24,data=moment(1e3*data).format(__param[1])+" - "+moment(1e3*data+1e3*__param[0]*60*60*24).format(__param[1]),data;default:return data}return!1}console.log("Error: moment.js not found!")},void 0===OGX)var OGX={};OGX.Object=function(){"use strict";var t=new OGX.List,e=new OGX.List;function r(t){for(var e=t.split("."),r=OGX,i=0;i<e.length;i++)void 0!==r[e[i]]&&(r=r[e[i]]);return r}e.cache("_NAME_","id"),this.isRegistered=function(t,e){return typeof("undefined"!==this.register[t][e])},this.getExtend=function(e){var r=t.get({main:{eq:e}},null,1);return!!r&&r.extends},this.getExtends=function(e){var r=[],i=t.get({main:{eq:e}},null,1);if(i){var a;r=r.concat(i.extends);for(var s=0;s<i.extends.length;s++)(a=this.getExtends(i.extends[s]))&&(r=r.concat(a))}var n=[];for(s=0;s<r.length;s++)n.includes(r[s])||n.push(r[s]);return n},this.register=function(){var e=Array.prototype.slice.call(arguments),r=e.shift();t.push({main:r,extends:e})},this.create=function(t,i){void 0===i&&(i={});var a=this.getExtends(t),s=!1,n=null,o=null;if(a.length){var l,f,h=r(t);h.prototype=Object.create({}),(l=[]).push(h.prototype);for(var p=0;p<a.length;p++)void 0!==(f=r(a[p]))&&l.push(f.prototype);Object.assign.apply(null,l),h.prototype.constructor=h,a.includes("View")||a.includes("Controller")||a.includes("Stage")?(o=(l=t.split(".")).pop(),n=l.join(".").slice(0,-1)):n=t,s=new h(i)}else OGX.hasOwnProperty(t)&&(s=new OGX[t](i));return o?(s._CLASS_=o,s._NAME_=n):s._NAME_=t,OGX.hasOwnProperty(t)&&OGX[t].hasOwnProperty("FLOAT")&&OGX[t].FLOAT&&(s.floating=!0),debug(5,"create",t,s.id),!!s&&(e.insert(s),s)},this.cache=function(t){if(void 0===t)return e;e.insert(t)},this.uncache=function(t){e.findDelete("id",t.id)},this.get=function(t,r,i){return e.get(t,r,i)},this.destroy=function(t,r){void 0===r&&(r=!0),debug(5,"object destroy uxi",t._NAME_,t.id),"function"==typeof t.blur&&t.blur(),"function"==typeof t.destroy&&t.destroy(),"function"==typeof t.__destroy&&t.__destroy(),r&&t.clear(),t.el&&t.el.remove(),t.parent&&t.parent.nodes.findDelete("id",t.id,1),e.findDelete("id",t.id,1)}},"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),i=1;i<arguments.length;i++){var a=arguments[i];if(null!=a)for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[s]=a[s])}return r},writable:!0,configurable:!0});if(void 0===OGX)var OGX={};function require(){OGX.Object.register.apply(null,arguments)}function construct(__that,__cls){var ext=OGX.Object.getExtend(__cls);for(var a in ext)eval("OGX."+ext[a]).call(__that,arguments.callee.caller.arguments[0])}OGX.Object=new OGX.Object;if(void 0===OGX)var OGX={};if(OGX.OML=function(e,t){"use strict";var o=e,n=t,i=!1,r=null,a={},d={},s=new OGX.List;function l(){i=!0}function p(e,t){var o,n,i=[];for(var r in t)if(o=/^(\S*)\:Bind$/g.exec(r))if(n=-1!==o[1].indexOf(",")?o[1].split(","):o[1],Array.isArray(t[r]))for(var a=0;a<t[r].length;a++)t[r][a].property=n,i.push({uxi:e,config:t[r][a]});else t[r].property=n,i.push({uxi:e,config:t[r]});return i}function u(e){setTimeout((()=>{h(e.config),e.uxi.bind(e.config)}),0)}function c(e){return e.hasOwnProperty("node:OML")||e.hasOwnProperty("instance")&&e.instance||e.hasOwnProperty("scroll")&&e.scroll}function f(e,t){if("string"==typeof t["node:OML"]){var o=null;t.hasOwnProperty("data")&&(o=t.data),t["node:OML"]=g(t["node:OML"],o)}else if(Array.isArray(t["node:OML"]))for(var n=0;n<t["node:OML"].length;n++)"string"==typeof t["node:OML"][n]&&(t["node:OML"][n]=g(t["node:OML"][n]));else if("object"==typeof t["node:OML"])for(var i in t["node:OML"])-1!==i.indexOf(":OML")&&"string"==typeof t["node:OML"][i]&&(t["node:OML"][i.replace(":OML","")]=g(t["node:OML"][i]),delete t["node:OML"][i]);return e.__proto__.hasOwnProperty("placeholder")&&e.placeholder(t),t}function g(e,t){return void 0===t&&(t={}),0===e.indexOf("{{")?OGX.OSE.exec(e,t):OGX.Data.clone(OGX.Cache.read("oml",e))}function h(e,t,o){var i,r=0;return function e(s){if(!(Array.isArray(s)||"object"!=typeof s||r>=n)){var l=!1;for(var p in s)-1!==p.indexOf(":OSE")?(s[i=p.split(":").shift()]=OGX.OSE.exec(s[p],t,a,o,d),delete s[p],l||(l=!0,r++),e(s[i])):-1!==p.indexOf(":")||"object"!=typeof s[p]||Array.isArray(s[p])||s[p]instanceof HTMLElement||s[p]instanceof jQuery||(l||(l=!0,r++),e(s[p]))}}(e),e}function O(e,t){switch(e){case"scope":return OGX.Scope.fork(t);default:return OGX.OSE.fork(e,t)}}this.get=e=>OGX.Cache.read("oml",e),this.make=(e,t,o)=>{var n={};return n[e+":"+t]=o,n},this.parse=e=>("string"==typeof e&&("{"!==e.substr(0,1)&&(e="{"+e+"}"),e=JSON.parse(e)),e),this.rename=(e,t,o)=>{function n(e,t,o){var n={};for(var i in e)n[i.replace(t,o)]=e[i];return n}void 0===o&&(o="default"),Array.isArray(o)||(o=[o],t=[t]);for(var i=0;i<o.length;i++)e=n(e,o[i],t[i]);return e},this.result=(e,t)=>{if(void 0===t){var o=s.findDelete("id",e,1);return!!o&&o.result}s.insert({id:e,result:t})},this.getNodeById=(e,t)=>function e(o){var n;for(var i in o){if(o[i].hasOwnProperty("id")&&o[i].id===t)return o[i];if(o[i].hasOwnProperty("node:OML"))if(Array.isArray(o[i]["node:OML"])){for(var r=0;r<o[i]["node:OML"].length;r++)if(n=e(o[i]["node:OML"][r]))return n}else if(n=e(o[i]["node:OML"]))return n}return!1}(e),this.replaceDataRecursive=(e,t,o)=>{function n(e){var a,d;for(var s in e)if(-1!==s.indexOf(":OSE"))a=s.split(":"),(d=r(e[s],t,o))&&(e[a[0]]=d,delete e[s],n(e[a[0]]));else if("node:OML"===s)if("string"==typeof e[s]&&0===e[s].indexOf("{{"))e[s]=OGX.OSE.exec(e[s]),i(e[s]);else if(Array.isArray(e[s]))for(var l=0;l<e[s].length;l++)i(e[s][l]);else i(e[s])}function i(e){var i;for(var a in e)-1!==a.indexOf("{{")&&(i=r(a,t,o))&&(e[i]=e[a],delete e[a],a=i),n(e[a])}function r(e,t,o){var n,i,r=/{{([\S ]+)}}/gi;o&&(a[o]=t);for(var d=0;n=r.exec(e);){if(i=OGX.OSE.exec(n[0],t,a),-1!==["string","number"].indexOf(typeof i))e=e.replace(n[0],i);else if(-1!==["boolean","object"].indexOf(typeof i))return i;if(r.lastIndex=0,++d>100)return}return e}i(e)},this.render=(e,t,n,a,d,s)=>{t=(t=f(e,{"node:OML":t}))["node:OML"],void 0===d&&(d=!1),"function"!=typeof s&&(s=!1),o&&(i=!1,r&&clearTimeout(r),r=setTimeout(l,o)),function(e,t,n,r,a,d){var s=[],l=(new Date).getTime(),m=[];function v(e,t,d){if(i)debug(1,"OML RENDER EXCEEDED "+o+"MS");else if(void 0===d&&(d=!0),!t.enabled&&(d=!1),Array.isArray(e))for(var l=0;l<e.length;l++)v(e[l],t,d);else{var u,w,b,y,G,X,x,_,M,L,P,S,A,C,E,N,k;if(!a)for(_ in e)-1!==_.indexOf(":Point")&&(u=_.split(":")[0],/^(#|\.)/gi.test(u)?(e[_].el=u,e[_].mode=0):(e[_].el=null,e[_].mode=1,e[_].id=u),e[_].parent=t,e[_].data=n,e[_].route_data=r,x=OGX.Object.create("Point",e[_]),t.add(x),x.parent=t,x.focus(),v(x.oml(),x,d),delete e[_]);for(_ in e)if((A=/((?!:)[\S ]+):(\S+)/gi.exec(_))&&(u=A[1],void 0!==(w=b=A[2])&&(-1!==u.indexOf("{{")&&"object"==typeof e[_]["data:OML"]&&(u=OGX.Templater.make(u,e[_]["data:OML"]),delete e[_]["data:OML"]),"string"==typeof e[_]&&0===e[_].indexOf("{{")&&(e[_]=g(e[_])),-1===["Route","OML"].indexOf(w)))){switch(b.indexOf(".")>0&&(b=b.substr(0,b.indexOf(".")-1)),X=e[_],e[_].hasOwnProperty("node:OML")&&(e[_]=f(e,e[_])),G=!0,y=!0,C=!1,N=!1,b){case"Function":return y=!1,X.parent=t,X.fnc=u,X=h(X,n,r),void OGX.Fonction(X,n,r);case"Uxi":return void e[_].attach(t,u);case"Fork":(S=O(u,e[_]))&&v(S,t,d),y=!1,G=!1;break;case"Html":X.el=u,X.html=e[_].html,(y=c(X))||(X.template=!1);break;case"Template":X.template=w.split(".")[1],X.el=u,y=c(X),w="Html";break;case"Ghost":X.el=u;break;case"Controller":X.id=u,N=!0;break;case"Scroller":k=$(u),X.el=u,X.content=k.html(),k.empty();break;default:-1!==[".","#"].indexOf(u.substr(0,1))?X.el=u:("node"!==u&&(X.id=u),X.el=t.el[0],X.parent=t)}if(G&&(X=h(X,n,r)),M=!1,L=!1,y){if(a)for(var W=new OGX.List(X),D=0;D<a.length;D++)if(W.get(a[D].q,null,1)){P=a[D].r,L=!0;break}L?(P.wake(X.el),x=P):x=OGX.Object.create(w,X),t.add(x),M=x}else C?(C.blur(),$(u).html(E),C.el=$(u),t.add(C),setTimeout((()=>{!t.blured&&d&&C.focus()}),0)):(M=t,"Html"===w&&OGX.HtmlRender(X));M&&e[_].hasOwnProperty("node:OML")&&!C&&!L&&v(e[_]["node:OML"],M,d),y&&(x.parent=t,"function"==typeof x.construct&&(L||(N?m.push({object:x,data:[r]}):x.construct.apply(x,[r])))),x&&!N&&(y||L)&&!t.blured&&d&&x.enabled&&(x.floating||x.focus()),void 0!==x&&x&&!N&&(s=s.concat(p(x,e[_])))}}}v(t,e),s.length&&function(e){for(var t=0;t<e.length;t++)u(e[t])}(s);OGX.OML.rendertime&&debug(3,"⏱ OML RENDER TIME "+((new Date).getTime()-l)+"ms ");(function(e){for(var t=0;t<e.length;t++)e[t].object.construct.apply(e[t].object,e[t].data),e[t].object.enabled&&e[t].object.focus()})(m),d&&d()}(e,t,n,a,d,s)}},void 0===OGX)OGX={};OGX.Stages={},OGX.Views={},OGX.Controllers={},require("Core","Uxi","Touch"),OGX.Core=function(e){construct(this,"Core");var t,o=this,n=OGX.Data.merge(e,{encrypted:!1,exportable:!1,max_render_time:300,max_depth:2,disable_context:!1,unique:!1}),i={jwt:!0,scope:["public"],routing:{},stages:{blured:!0,use:!1,closeable:!1,anim:!1},overlays:{delay:200,anim:"fade"},popups:{blured:!1,sleeping:!1},theater:!1,observe:!1,auto_exit:!1,chromeos:!1},r=!1,a=!1,d=!1,s=/(iPhone|iPod|iPad)/i.test(navigator.userAgent),l=matchMedia("(prefers-color-scheme: dark)").matches,p=null;function u(e){app.remove("Popup",e.id),e.cb&&e.cb(e.params),r.el.trigger(OGX.Popup.CLOSE,e.id)}function c(e){var t=e.matches;debug(3,"dark mode is",t)}function f(){if(r)for(var e=r.gather(),t=0;t<e.length;t++)"Controller"!==e[t]._NAME_&&(["Popup","Window"].includes(e[t]._NAME_)?"Popup"===e[t]._NAME_?e[t].sleeping||(e[t].resize(),e[t].centered&&e[t].center(),e[t].resizeNodes()):"Window"===e[t]._NAME_&&(e[t].sleeping||(e[t].resize(),e[t].resizeNodes())):e[t].sleeping||((e[t].__proto__.hasOwnProperty("resize")||e[t].hasOwnProperty("resize"))&&e[t].resize(),(e[t].__proto__.hasOwnProperty("resizeNodes")||e[t].hasOwnProperty("resizeNodes"))&&e[t].resizeNodes()))}function g(){debug(3,"preload done"),t.routing&&(o.router=new OGX.Router(t.routing),o.router.start()),function(){(function(){debug(5,"init stages");var e,n,i,a,d,s,l,p=!1;for(var u in t.vapps)n=(e=u.split(":"))[0],i=e[1],(d=OGX.Data.merge(t.vapps[u],t.stages,!1,!0)).id=n,!0===d.use&&(p=n,a=n+"/"+d.home),s=o.addStage(i,d),!0===d.use&&(r=s);p&&(l=t.routing.options.bookmark&&-1!==window.location.href.indexOf("#")&&app.router.request().route.stage==r.id?window.location.href.split("#").pop():a,l=a,setTimeout((()=>{o.goto(l)}),0),setTimeout((()=>{$(document).trigger(OGX.App.READY)}),100))})(),t.theater&&function(){for(var e=app.gather("Stage"),n=[],i=0;i<e.length;i++)e[i].theater&&n.push(e[i]);t.theater.stages=n,t.theater.el="body",o.theater=o.create("Theater",t.theater)}();debug(3,"app ready")}()}function h(e){return e}function O(e,t){return void 0===t&&(t=location.hostname),CryptoJS.AES.encrypt(e,t,{mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7})}function m(e,t){return void 0===t&&(t=location.hostname),CryptoJS.AES.decrypt(e,t,{mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString(CryptoJS.enc.Utf8)}this.blured=!1,this.router=!1,this.isWebView=()=>d,this.isTouch=()=>this.touch.touchable(),this.iOS=()=>s,this.getURL=()=>this.router.url(),this.isDarkMode=()=>l,this.toggleTheme=()=>{var e="(prefers-color-scheme: ";l?($("head").children('link[data="dark"]').attr("media",e+"light)"),$("head").children('link[data="light"]').attr("media",e+"dark)")):($("head").children('link[data="dark"]').attr("media",e+"dark)"),$("head").children('link[data="light"]').attr("media",e+"light)")),l=!l},this.moveNode=(e,t,o)=>{e.detach(),e.attach(t,o)},this.addStage=(e,o)=>{if(OGX.Data.merge(o,t.stages),void 0===o)return!1;if(!o.hasOwnProperty("id"))return!1;o.el="body";var n=OGX.Object.create(e,o);return this.add(n),o.hasOwnProperty("node:OML")&&OGX.OML.render(n,o["node:OML"]),setTimeout((()=>{n.construct(o),o.use?(n.el.css("display","block"),n.focus(),a=n):n.sleep()}),0),n},this.removeStage=e=>{var t=this.cfind("Stage",e);t&&(t.destroy(),t.kill(),this.find("Stage",e,"remove"))},this.useStage=e=>{if(!r||r.id!==e){var t=this.cfind("Stage",e);return!!t&&(r&&r.blur(2),debug(3,"app now using stage",e),(r=t).focus(1),!0)}},this.getStage=e=>{if(void 0===e)return r||a;var t=this.find("Stage",e);return t||!1},this.showStage=(e,t)=>{if(!r||r.id!==e){var n=this.cfind("Stage",e);if(n){if(debug(3,"app now showing stage",e,t),void 0===t&&(t=n.anim?n.anim:!!a.anim&&a.anim),t){var i=$(window).height();switch(t){case OGX.Stage.SWAP:a&&(n.wake(),a.el.on("transitionend",(function(){a.el.off("transitionend"),a.el.css("top",-i+"px"),n.el.css("top","0px"),n.el.on("transitionend",(function(){n.el.off("transitionend"),n.el.css("transform","scale(1)"),a.el.removeClass("ogx_stage_anim"),a.el.css({top:"0px",transform:"scale(1)"}),a.sleep(),o.el.trigger(OGX.Stage.SWAP,{old:a,new:n}),a=n}))})),n.el.addClass("ogx_stage_anim"),a.el.addClass("ogx_stage_anim"),a.el.css("transform","scale(0.9)")),n.el.css("top",i+"px"),n.el.css("display","block"),n.el.css("transform","scale(0.9)"),n.el.addClass("ogx_stage_anim");break;case OGX.Stage.FLIP:a&&(n.wake(),a.el.on("transitionend",(function(){a.el.off("transitionend"),a.el.removeClass("ogx_stage_anim"),a.el.css("transform","scaleX(1)"),a.sleep(),n.el.css("transform","scaleX(1)"),o.el.trigger(OGX.Stage.SWAP,{old:a,new:n}),a=n})),n.el.addClass("ogx_stage_anim"),n.el.css("transform","scaleX(0)"),a.el.addClass("ogx_stage_anim"),a.el.css("transform","scaleX(0)")),n.el.css("display","block")}}else a&&a.id!==n.id&&a.sleep(),n.sleeping&&n.wake(),n.el.css("display","block"),a=n;o.useStage(e)}}},this.getWindow=e=>this.cfind("Window",e),this.getWindows=()=>this.gather("Window"),this.windowExists=e=>!1!==this.cfind("Window",e),this.addWindow=(e,o)=>{if(debug(4,"app adding window",e.id),e=OGX.Data.merge(e,t.windows),void 0===o){if(!a)return!1;o=a}var n;return!!o&&(e.el=o.el,e.parent=o,e.hasOwnProperty("node:OML")?(n=OGX.Object.create("Window",e),o.add(n),n.focus(),OGX.OML.render(n,e["node:OML"])):n=o.create("Window",e),n)},this.windowOpen=e=>this.cfind("Window",e).status===OGX.Window.OPEN,this.showWindow=(e,o,n,i)=>{debug(4,"app showing window",e),!0===o&&(o=t.anim);var r=this.cfind("Window",e);return!!r&&(r.sleeping&&attachWindow(e),r.blured&&r.focus(),r.show(o,n,i),!0)},this.hideWindow=(e,o,n,i)=>{debug(4,"app hiding window",e),!0===o&&(o=t.anim),"string"!=typeof e&&(e=this.findWindow(e).id),this.cfind("Window",e).hide(o,n,i)},this.swapWindows=(e,t)=>{var o,n,i,r;return debug(4,"app swapping window",e,t),!(!this.windowExists(e)||!this.windowExists(t))&&(o=this.getWindow(e),n=this.getWindow(t),i=o.el.css("z-index"),r=n.el.css("z-index"),o.el.css("z-index",r),n.el.css("z-index",i),!0)},this.sleepWindow=e=>{debug(4,"app sleep window",e),this.cfind("Window",e).sleep()},this.blurWindow=e=>{debug(4,"app blur window",e),this.cfind("Window",e).blur()},this.focusWindow=e=>{debug(4,"app focus window",e),this.cfind("Window",e).focus()},this.removeWindow=e=>(debug(4,"app remove window",e),this.find("Window",e,"remove")),this.removeWindows=e=>{for(var t=0;t<e.length;t++)this.removeWindow(e[t]);return!0},this.removeAllWindows=e=>{void 0===e&&(e=[]);for(var t=this.gather("Window"),o=0;o<t.length;o++)e.includes(t[o].id)&&this.removeWindow(t[o].id)},this.findWindow=e=>{for(var t=e;t.hasOwnProperty("parent")&&t.parent;){if("Window"===t.parent._NAME_)return t.parent;t=t.parent}return!1},this.addPopup=(e,o)=>{var n;return debug(4,"app add popup",e.id),void 0!==o&&o||(o=r),e.el=o.el[0],e.parent=o,e.chromeos=t.chromeos,e.hasOwnProperty("node:OML")?(n=OGX.Object.create("Popup",e),o.add(n),n.focus(),OGX.OML.render(n,e["node:OML"]),n.construct()):n=o.create("Popup",e),n},this.removePopup=(e,t,o,n,i)=>{debug(4,"app remove popup",e);var r=!1;void 0===i&&(i=a,r=!0),void 0===o&&(o=!1),void 0===n&&(n=!1),void 0===t&&(t=!0);var d=null;return!!(d=r?i.find("Popup",e):app.cfind("Popup",e))&&(d.hide(t,u,{id:e,cb:o,params:n},null,!0),!0)},this.findPopup=e=>{var t;t=e instanceof HTMLElement?e:e.el;var o=$(t).parents(".ogx_popup");if(o.length){var n=$(o[0]).data("ogx-id");return this.cfind("Popup",n)}return!1},this.getVisiblePopups=()=>{for(var e=this.gather("Popup"),t=[],o=0;o<e.length;o++)"visible"===e[o].el.css("visibility")&&t.push(e[o]);return t},this.popupExists=e=>!1!==this.cfind("Popup",e),this.groupPopups=(e,t,n)=>{void 0===n&&(n=null);var i={drag:!0,resize:!0,anim:!1};n&&OGX.Data.merge(i,n,!0);var r=e.id,a=t.id,d=e.nodes.get({_NAME_:{eq:"Container"}},null,1),s=t.nodes.get({_NAME_:{eq:"Container"}},null,1);if(d&&s){var l=d.nodes.get({_NAME_:{eq:"Carousel"}},null,1),p=d.nodes.get({_NAME_:{eq:"Tabs"}},null,1),u=s.nodes.get({_NAME_:{eq:"Carousel"}},null,1),c=(O=s.nodes.get({_NAME_:{eq:"Tabs"}},null,1)).index(),f=l.panels().slice();e.nodes=new OGX.List;for(var g=0;g<f.length;g++)O.add(p[g]),M=f[g].instance?{"default:Uxi":f[g].instance}:{"default:Html":{html:f[g].html}},u.addNode(M,null,!1);c+=p.length,u.showPanel(c,!1),O.index(c),o.removePopup(e.id,!1,!1,!1,e.parent),$(document).trigger(OGX.Popup.GROUP,{popups:[r,a],popup:t})}else if(d||s){var h,O,m,v;d?(h=d.nodes.get({_NAME_:{eq:"Carousel"}},null,1),O=d.nodes.get({_NAME_:{eq:"Tabs"}},null,1),P=t,m=e):(h=s.nodes.get({_NAME_:{eq:"Carousel"}},null,1),O=s.nodes.get({_NAME_:{eq:"Tabs"}},null,1),P=e,m=t),P.nodes.length?((v=P.nodes[0]).detach(),P.nodes=new OGX.List,M={"default:Uxi":v}):M={"default:Html":{html:P.el.find(".ogx_popup_body").first().html()}};var w=P.title();o.removePopup(P.id,!1,!1,!1,P.parent),h.addNode(M,null,!0,!1,(function(){$(document).trigger(OGX.Popup.GROUP,{popups:[r,a],popup:m})})),O.add(w),O.index(O.set().length-1)}else{var b=e.nodes;b=!!b.length&&b[0];var y,G,X=t.nodes;X=!!X.length&&X[0],b?(b.detach(),y={"default:Uxi":b}):y={"default:Html":{html:e.el.find(".ogx_popup_body").children().first().detach()}},X?(X.detach(),G={"default:Uxi":X}):G={"default:Html":{html:t.el.find(".ogx_popup_body").children().first().detach()}};var x=t.icons()||e.icons();"boolean"==typeof x&&(x=!1),!(x&&Array.isArray(x)&&x.length)&&(x=!1);var _=this.gather("Popup");_=_.get({id:{in:e.group}});var M={id:e.group+"_"+_.length,width:e.el.width(),height:e.el.height(),title:e.group,group:e.group,icons:x,"node:OML":[{"default:Container":{index:1,tabs:{list:[t.title(),e.title()]},"node:OML":[G,y]}}]};OGX.Data.merge(M,i,!0);var L=e.parent,P=app.addPopup(M,e.parent);this.removePopup(e.id,!1,!1,!1,L),this.removePopup(t.id,!1,!1,!1,L),$(document).trigger(OGX.Popup.GROUP,{popups:[r,a],popup:P})}},this.ungroupPopup=(e,t,o,n,i)=>{var r=e.icons(),a=e.nodes.get({_NAME_:{eq:"Container"}},null,1).nodes.get({_NAME_:{eq:"Carousel"}},null,1),d=a.getPanel(t),s=e.parent,l=e.width(),p=e.height(),u=e.resizable,c=e.dragable,f={};if(d.instance){var g=a.nodes.get({id:{eq:d.instance.id},_NAME_:{eq:d.instance._NAME_}},null,1);g&&(f["default:Uxi"]=g)}else f["default:Html"]={html:d.html};a.removePanel(t,!1);var h="popup_"+(new Date).getTime(),O={id:h,group:e.group,title:o,resize:u,drag:c,width:l,height:p,icons:r,"node:OML":[f]};if(void 0!==n){var m=e.el.position(),v=e.el.offset();O.x=m.left+(n-v.left),O.y=m.top+(i-v.top)}this.addPopup(O,s),$(document).trigger(OGX.Popup.UNGROUP,{from_popup:e.id,from_index:t,to_popup:h})},this.addOverlay=(e,t)=>(debug(4,"app add overlay"),void 0===t&&(t=a),!!t&&(t.addOverlay(e),!0)),this.removeOverlay=(e,t)=>{debug(4,"app remove overlay"),void 0===t&&(t=a),t&&t.removeOverlay(e)},this.theater=!1,this.getJSON=e=>OGX.Data.clone(OGX.Cache.read("json",e)),this.getOML=e=>OGX.Data.clone(OGX.Cache.read("oml",e)),this.goto=(e,t)=>this.router.goto(e,t),this.refresh=()=>{OGX.Net.refresh(t.preload)},this.getDefaults=e=>t[e],(void 0===OGX.Data?(debug(1,"OGX.Data not found!"),0):void 0===OGX.Net?(debug(1,"OGX.Net not found!"),0):void 0===OGX.Templater?(debug(1,"OGX.Templater not found!"),0):void 0===OGX.Display?(debug(1,"OGX.Display not found!"),0):void 0===OGX.View?(debug(1,"OGX.View not found!"),0):void 0===OGX.Controller?(debug(1,"OGX.Controller not found!"),0):void 0===OGX.Stage?(debug(1,"OGX.Stage not found!"),0):void 0===OGX.Window?(debug(1,"OGX.Window not found!"),0):void 0===OGX.Popup?(debug(1,"OGX.Popup not found!"),0):void 0!==OGX.Container||(debug(1,"OGX.Container not found!"),0))&&(OGX.Net=new OGX.Net({ios:s,encrypted:n.encrypted}),OGX.Net.load("app.json",(function(e){if(debug(3,"init"),n.encrypted&&(e=function(e){if("undefined"==typeof CryptoJS)return debug(1,"CryptoJS not found!"),!1;var t=document.cookie.match("(^|[^;]+)\\s*ogx_key\\s*=\\s*([^;]+)");if(t)return t=decodeURIComponent(t.pop()),document.cookie="ogx_key=; expires=Thu, 01 Jan 1970 00:00:01 GMT;",e=m(e,t),JSON.parse(e);debug(1,"Cookie key not found!")}(e)),n.disable_context&&(window.oncontextmenu=function(){return!1}),n.exportable||(delete OGX.Uxi.prototype.toOML,delete OGX.Controller.prototype.toOML,delete OGX.View.prototype.toOML),n.unique){if("undefined"==typeof CryptoJS)return void debug(1,"CryptoJS not found!");var r="function"==typeof n.unique;if(!function(){var e=!1;(p=sessionStorage.getItem("ogx-tab"))?p=m(p):(p=(new Date).getTime()+"-"+Math.round(1e3*Math.random()),sessionStorage.setItem("ogx-tab",O(p)));var t=localStorage.getItem("ogx");return t?(t&&(t=m(t)),t&&((t=JSON.parse(t))&&t.instance!==p?t.unix+1500<(new Date).getTime()&&(t={instance:p,unix:(new Date).getTime()},localStorage.setItem("ogx",O(JSON.stringify(t))),e=!0):e=!0)):(t={instance:p,unix:(new Date).getTime()},localStorage.setItem("ogx",O(JSON.stringify(t))),e=!0),e&&(window.addEventListener("beforeunload",(function(){localStorage.removeItem("ogx")})),OGX.Workers.run(h,null,null,1e3,p,(function(e){var t={instance:e,unix:(new Date).getTime()};localStorage.setItem("ogx",O(JSON.stringify(t)))}))),e}())return debug(1,"App is already running in another tab"),r&&n.unique(!1),void o.el.trigger(OGX.App.DUPLICATE);r&&n.unique(!0)}t=e,OGX.Scope=new OGX.Scope(t.jwt),OGX.OML=new OGX.OML(n.max_render_time,n.max_depth),d=void 0!==window.ontouchstart,s&&$("body").addClass("ios"),t=OGX.Data.weld(t,i,!1,!1),o.el=$(document),OGX.Net.preload(t.preload,g),window.addEventListener("resize",f),function(e){if(!0){var t=window.matchMedia("(prefers-color-scheme: dark)");t.addListener(c)}else t.removeListener(c)}()})))},OGX.App=function(e){"use strict";return void 0===e&&(e={}),e.el="document",e.always_on=!0,OGX.Object.create("Core",e)},OGX.App.LOADING="AppLoading",OGX.App.READY="AppReady",OGX.App.DUPLICATE="AppDuplicate";if(void 0===OGX)var OGX={};if(OGX.Audio=function(){"use strict";var e=!1;this.get=e=>{var t;return!!(t=OGX.Cache.read("snd",e))&&t},this.play=(t,i,a)=>{void 0===i&&(i=1),void 0===a&&(a=!1);var n=this.get(t);return!!n&&(n.hasOwnProperty("howl")?(n.howl.volume(i),n.howl.loop(a)):n.howl=new Howl({src:["snd/"+n.file],loop:a,volume:i}),e?n.howl.play():setTimeout((()=>{n.howl.play()}),0),!0)},this.stop=e=>{if(void 0!==e){var t=this.get(e);if(t)return t.howl.stop(),!0}return!1},this.prepare=()=>{for(var e=OGX.Cache.get({ext:{eq:"snd"}}),t=0;t<e.length;t++)e[t].hasOwnProperty("howl")||(e[t].howl=new Howl({src:["snd/"+e[t].file]}))},$(document).on("touchstart mousedown",(function t(){e=!0,$(document).off("touchstart mousedown",t)}))},OGX.Audio=new OGX.Audio,void 0===OGX)var OGX={};if(OGX.Bind=function(){"use strict";var e=this,t={object:null,event:null,mode:"eq",action:"filter",property:null,remote_property:null,min_length:0,convert:!0},i={};function a(t,i){var a,r,s,l,d="string"==typeof i.object;function c(t,a){if("object"==typeof a){if(function(t,i){for(var a in t.__p)e.unbindFilter(a);t.__p={}}(i),i.remote_property&&Array.isArray(i.remote_property)){var s=0;for(var l in a)i.__p[i.remote_property[s]]=!0,r(i.remote_property[s],i.mode,a[l]),o(i.remote_property[s],a[l]),s++;return}if(i.remote_property)a="DynamicList"===i.object._NAME_?i.object.getSelection().unique(i.remote_property,!1):a[i.remote_property],r(i.property,i.mode,a),o(i.property,a),n(i,a);else{if(Array.isArray(i.property)){s=0;for(var l in a)i.__p[i.property[s]]=!0,r(i.property[s],i.mode,a[l]),o(i.property[s],a[l]),s++;return}r(i.property,i.mode,a),o(i.property,a),n(i,a)}}else i.remote_property?(r(i.remote_property,i.mode,a),o(i.remote_property,a)):(r(i.property,i.mode,a),o(i.property,a))}function u(e){if(i.min_length&&e.target.value.length<i.min_length&&e.target.value.length)return!1;var t=e.target.value;i.convert&&(t=OGX.Data.stringToVal(t)),r(i.property,i.mode,t)}switch(d?(t&&(i.object={el:$(i.object)},a=i.event),s=u):(t&&(a=OGX[i.object._NAME_].BIND),s=c),i.action){case"render":r=e.bindRender;break;case"filter":r=e.bindFilter}t?(i.object.el.on(a,s),d?u({target:{value:i.object.el.val()}}):(l=i.object.bindValue?i.object.bindValue():i.object.val(),Array.isArray(l)&&l.hasOwnProperty("insert")&&(l=JSON.parse(JSON.stringify(l))),c(0,l))):i.object.el.off(a,s)}function n(e,t){for(var i in t)e.__p[i]=!0}function o(t,i){e.el.trigger(OGX.Bind.FILTER,{property:t,value:i})}this.bind=e=>(debug(4,"binding",e.property,"of",this.id,"with",e.object),OGX.Data.merge(e,t),!!e.property&&(e.object&&"string"==typeof e.object&&(e.event="input change",e.action="filter"),e.__p={},i.hasOwnProperty(e.property)||(i[e.property]=[]),i[e.property].push(e),a(!0,e),!0)),this.unbind=e=>{debug(4,"unbinding",i[e].object.id,"from",this.id);for(var t=0;t<i[e].length;t++)a(!1,i[e][t]);return delete i[e],!0},this.clearBinds=()=>{for(var e in debug(4,"clearing binds"),i){for(var t=0;t<i[e].length;t++)a(!1,i[e][t]);delete i[e]}}},OGX.Bind.prototype.unbindFilter=function(e){},OGX.Bind.prototype.bindFilter=function(e,t,i){},OGX.Bind.prototype.bindRender=function(e,t){},OGX.Bind.prototype.bindValue=null,OGX.Bind.FILTER="bindFilter",void 0===OGX)var OGX={};if(OGX.Cache=function(){"use strict";var e=new OGX.List;e.cache("ext","id"),this.read=(t,i)=>{debug(5,"cache read",t,i);var a=e.read({ext:t,id:i},null,1);return!!a&&("snd"===a.ext?a:a.data)},this.get=(t,i)=>(void 0===i&&(i=0),debug(5,"cache get",t,i),e.get(t,null,null,i)),this.set=t=>{e=new OGX.List(t)},this.add=t=>{if(Array.isArray(t))for(var i=0;i<t.length;i++)debug(4,"cache insert",t[i].ext,t[i].file),e.insert(t[i]);else debug(4,"cache insert",t.ext,t.file),e.insert(t)},this.remove=function(t,i,a){void 0===a&&(a=1),debug(4,"cache unset",t,i);var n={};return void 0!==t&&t&&(n.ext={eq:t}),void 0!==i&&i&&(n.id={eq:i}),e.unset({ext:{eq:t},id:{eq:i}},a)},"undefined"!=typeof __array&&this.set(__array)},OGX.Cache=new OGX.Cache,void 0===OGX)var OGX=function(){};if(require("Calendar","Uxi","Bind","Touch"),OGX.Calendar=function(e){construct(this,"Calendar");var t,i,a,n,o=this,r=e,s={display_date:moment(),date:!1,format:"YYYY-MM-DD",layouts:[{layout:{name:"MONTH_DAYS"},engine:{name:"DAY_NUMBER"}}],layout:0,selectable:!0,no_selection:!1,off_dates:!1,mode:"select",swipe:!0,browse:!0,chromeos:!1,callbacks:{select:null,unselect:null}},l=[],d={x:1,y:1},c=!1;function u(e){e?(i.on(o.touch.down,".ogx_calendar_left",h),i.on(o.touch.down,".ogx_calendar_right",h)):(i.off(o.touch.down,".ogx_calendar_left",h),i.off(o.touch.down,".ogx_calendar_right",h))}function h(e){e.preventDefault(),e.stopImmediatePropagation(),c||(c=!0,$(this).hasClass("ogx_calendar_left")?(o.el.trigger(OGX.Calendar.BROWSE,-1),t.swipeLeft()):(o.el.trigger(OGX.Calendar.BROWSE,1),t.swipeRight()),setTimeout((()=>{c=!1}),350))}function g(e){e?i.on("click",".ogx_calendar_layout_item",f):i.off("click",".ogx_calendar_layout_item",f)}function f(e){var t=$(this),i=t.data("ogx-date");r.no_selection&&r.no_selection.includes(i)?debug(3,"Calendar selection prevented",i):("toggle"===r.mode&&t.hasClass("ogx_calendar_selected_item")?(m(),o.onUnselect(),o.el.trigger(OGX.Calendar.UNSELECT,""),r.date=!1):(m(),_(i),r.date=moment(i),r.display_date=r.date.clone(),o.onSelect(r.date),o.el.trigger(OGX.Calendar.SELECT,r.date),O()),setTimeout(p,0))}function p(){for(var e=t.getCells(),i=0;i<e.length;i++)0==e[i].offset.x&&0==e[i].offset.y||w(e[i].abs,e[i].rel,e[i].offset,$(e[i].element).children(0)[0])}function _(e){o.el.find('.ogx_calendar_layout_item[data-ogx-date="'+e+'"]').addClass("ogx_calendar_selected_item")}function m(){o.el.find(".ogx_calendar_selected_item").removeClass("ogx_calendar_selected_item")}function v(){O(),b(l[n].labels(r.display_date));for(var e=t.getCells(),i=0;i<e.length;i++)w(e[i].abs,e[i].rel,e[i].offset,$(e[i].element).children(0)[0])}function y(e){e?(i.on(OGX.GridSwiper.SWIPE_START,(()=>{r.selectable&&g(!1)})),i.on(OGX.GridSwiper.SWIPE_END,(()=>{r.selectable&&g(!0)})),i.on(OGX.GridSwiper.SWIPE_LEFT,((e,t)=>{var i=l[n].value();x(i.value,i.unit),b(l[n].labels(r.display_date))})),i.on(OGX.GridSwiper.SWIPE_RIGHT,((e,t)=>{var i=l[n].value();x(-1*i.value,i.unit),b(l[n].labels(r.display_date))})),i.on(OGX.GridSwiper.SWIPE_UP,((e,t)=>{n=t.cell.y-1,O(),b(l[n].labels(r.display_date))})),i.on(OGX.GridSwiper.SWIPE_DOWN,((e,t)=>{n=t.cell.y-1,O(),b(l[n].labels(r.display_date))}))):(i.off(OGX.GridSwiper.SWIPE_LEFT),i.off(OGX.GridSwiper.SWIPE_RIGHT),i.off(OGX.GridSwiper.SWIPE_UP),i.off(OGX.GridSwiper.SWIPE_DOWN),i.off(OGX.GridSwiper.SWIPE_START),i.off(OGX.GridSwiper.SWIPE_END))}function x(e,t){r.display_date.add(e,t),O()}function O(){var e=l[n].format(r.display_date),t="";r.browse&&(t+='<span class="ogx_calendar_left"></span><span class="ogx_calendar_display_date">'+r.display_date.format(e)+"</span>"),r.date&&(t+='<span class="ogx_calendar_selected_date">'+r.date.format(r.format)+"</span>"),r.browse&&(t+='<span class="ogx_calendar_right"></span>'),i.children(".ogx_calendar_head").children(".ogx_calendar_head_date").html(t)}function b(e){i.children(".ogx_calendar_head").children(".ogx_calendar_head_labels").html(e)}function w(e,t,i,a){if(t.y-1>=0&&t.y-1<r.layouts.length){var o=$(a),s=l[n].value(),d=r.display_date.clone().add(i.x*s.value,s.unit),c=l[t.y-1];if("object"!=typeof r.layouts[t.y-1].engine||!r.layouts[t.y-1].engine.hasOwnProperty("name"))return void debug(2,"Calendar engine format deprecated, please update");var u=c.html(d,OGX.CalendarEngine[r.layouts[t.y-1].engine.name],r.layouts[t.y-1].engine.config,r.date);o.html(u)}}function G(){for(var e,t=0;t<r.layouts.length;t++){if("object"!=typeof r.layouts[t].layout||!r.layouts[t].layout.hasOwnProperty("name"))return void debug(2,"Calendar layout format deprecated, please update");r.layouts[t].layout.hasOwnProperty("config")&&(e=r.layouts[t].layout.config),r.off_dates&&(e.off_dates=r.off_dates),l.push(X(r.layouts[t].layout.name,e))}}function X(e,t){return void 0===t&&(t={}),OGX.CalendarLayout[e].prototype=Object.create(OGX.CalendarLayout.BASE_LAYOUT.prototype),OGX.CalendarLayout[e].prototype.constructor=OGX.CalendarLayout[e],new OGX.CalendarLayout[e](t)}function T(){a=[[!1,!1,!1]];for(var e=0;e<r.layouts.length;e++)a.push([w,w,w]);a.push([!1,!1,!1])}this.onFocus=()=>(debug(5,"calendar",r.id,"enabled"),r.selectable&&g(!0),y(!0),r.browse&&u(!0),this),this.onBlur=()=>(debug(5,"calendar",r.id,"disabled"),r.selectable&&g(!1),y(!1),r.browse&&u(!1),this),this.resize=()=>(this.resizeNodes(),this),this.onSelect=()=>{},this.onUnselect=()=>{},this.resetSelection=()=>{m(),r.date=null},this.val=(e,t)=>(void 0===t&&(t=!0),void 0!==e?(r.date=e,moment.isMoment(r.date)||(r.date=moment(r.date)),r.display_date=r.date.clone(),O(),void(t?setTimeout(v,0):(m(),_(r.date.format("YYYY-MM-DD"))))):r.date?r.date:""),this.refresh=()=>(setTimeout(v,0),this),this.display=e=>void 0!==e?(r.display_date=e,moment.isMoment(r.display_date)||(r.display_date=moment(r.display_date)),O(),setTimeout(v,0),!0):r.display_date,this.axis=(e,t)=>(r.axis.x=e,r.axis.y=t,this),this.getLayout=()=>n,this.layouts=(e,i)=>void 0===e?r.layouts:(r.layouts=e,r.layout=void 0!==i?i:0,n=r.layout,l=[],G(),T(),t.setMap(a,{x:0,y:r.layout+1}),v(),this),this.offDates=(e,i)=>void 0===e?r.off_dates:(void 0===i&&(i=!0),r.off_dates=e,i?(l=[],G(),t.setMap(a,{x:0,y:r.layout+1}),v()):l.forEach((t=>{t.off_dates=e})),this),this.noSelection=(e,t)=>void 0===e?r.no_selection:(void 0===t&&(t=!0),r.no_selection=e,t&&v(),this),void 0!==OGX.GridSwiper?"undefined"!=typeof moment?(debug(5,"calender init",r.id),OGX.Data.merge(r,s),r.callbacks.select||(r.callbacks.select=o.onSelect),r.callbacks.unselect||(r.callbacks.unselect=o.onUnselect),(i=o.el).addClass("ogx_calendar"),r.date&&(moment.isMoment(r.date)||(r.date=moment(r.date)),r.display_date=r.date.clone()),r.display_date?moment.isMoment(r.display_date)||(r.display_date=moment(r.display_date)):r.display_date=moment(),n=r.layout,d.y=n+1,i.html('<div class="ogx_calendar_head"><div class="ogx_calendar_head_date"></div><div class="ogx_calendar_head_labels"></div></div><div class="ogx_calendar_body"></div>'),T(),G(),t=o.create("GridSwiper",{el:r.el+" .ogx_calendar_body",loop:!0,map:a,start:{x:1,y:n+1},chromeos:r.chromeos,enabled:r.swipe}),O(),b(l[n].labels(r.display_date)),debug(5,"calendar",r.id,"init")):debug(1,"moment.js not found! "):debug(1,"OGX.GridSwiper not found! ")},OGX.Calendar.SELECT="CalendarSelect",OGX.Calendar.UNSELECT="CalendarUnselect",OGX.Calendar.BIND=OGX.Calendar.SELECT+" "+OGX.Calendar.UNSELECT,OGX.Calendar.BROWSE="CalendarBrowse",OGX.CalendarLayout={},OGX.CalendarLayout.BASE_LAYOUT=function(e){"use strict";this.off_dates=null,this.labels=e=>"",this.html=(e,t,i,a)=>"",this.value=()=>({value:1,unit:"months"}),this.format=()=>e.hasOwnProperty("format")?e.format:"YYYY-MM"},OGX.CalendarLayout.MONTH_DAYS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="YYYY-MM"),!e.hasOwnProperty("labels")&&(e.labels="ddd"),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>{var i="",a=Number(t.format("d")),n=t.clone();a&&n.subtract(a,"day");for(var o=0;o<7;o++)i+='<span class="ogx_calendar_layout_month_days_label">'+n.format(e.labels)+"</span>",n.add(1,"day");return i},this.html=(e,t,i,a)=>{var n,o=e.format("MM"),r=moment(e.format("YYYY-MM-")+"01").day(),s=moment(e.format("YYYY-MM-")+"01").subtract(r,"days"),l="";a&&(l=a.format("YYYY-MM-DD"));for(var d,c="",u=0;u<35;u++)d="",n=s.format("YYYY-MM-DD"),s.format("MM")!==o&&(d+="ogx_calendar_layout_month_days_offset "),n===moment().format("YYYY-MM-DD")&&(d+="ogx_calendar_layout_month_days_today "),a&&l===n&&(d+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(n)&&(d+="ogx_calendar_layout_off_date "),c+='<div class="ogx_calendar_layout_item ogx_calendar_layout_month_days '+d+'" data-ogx-date="'+n+'">'+t(n,i)+"</div>",s.add(1,"days");return c},this.value=()=>({value:1,unit:"months"})},OGX.CalendarLayout.CENTURY_DECADES=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="YYYY"),!e.hasOwnProperty("labels")&&(e.labels=null),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_century_decades_label">'+(e.labels?t.format(e.labels):100*Math.floor(Number(t.format("YYYY"))/100)+"'s")+"</span>",this.html=(e,t,i,a)=>{var n,o,r=moment(),s=100*Math.floor(Number(r.format("YYYY"))/100),l=10*Math.floor(Number(r.format("YYYY").substr(2))/10),d=100*Math.floor(Number(e.format("YYYY"))/100),c=0,u=0;a&&(c=100*Math.floor(Number(a.format("YYYY"))/100),u=10*Math.floor(Number(a.format("YYYY").substr(2))/10));for(var h="",g=0;g<10;g++)o="",s+l===d+(n=10*g)&&(o="ogx_calendar_layout_century_decades_current "),c+u===d+n&&(o+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(d+n)&&(o+="ogx_calendar_layout_off_date "),h+='<div class="ogx_calendar_layout_item ogx_calendar_layout_century_decades '+o+'" data-ogx-date="'+(d+n)+'-01-01">'+t(d+n,i)+"</div>";return h},this.value=()=>({value:100,unit:"years"})},OGX.CalendarLayout.CENTURY_YEARS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="Y"),!e.hasOwnProperty("labels")&&(e.labels=null),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_century_decades_label">'+(e.labels?t.format(e.labels):100*Math.floor(Number(t.format("YYYY"))/100)+"'s")+"</span>",this.html=(e,t,i,a)=>{var n,o=moment(),r=100*Math.floor(Number(o.format("YYYY"))/100),s=Number(o.format("YYYY").substr(2)),l=100*Math.floor(Number(e.format("YYYY"))/100),d=0,c=0;a&&(d=100*Math.floor(Number(a.format("YYYY"))/100),c=Math.floor(Number(a.format("YYYY").substr(2))));for(var u="",h=0;h<100;h++)n="",l+h===r+s&&(n+="ogx_calendar_layout_century_years_current "),l+h===d+c&&(n+="ogx_calendar_selected_item"),this.off_dates&&this.off_dates.includes(l+h)&&(n+="ogx_calendar_layout_off_date "),u+='<div class="ogx_calendar_layout_item ogx_calendar_layout_century_years '+n+'" data-ogx-date="'+(l+h)+'-01-01">'+t(l+h+"-01-01",i)+"</div>";return u},this.value=()=>({value:100,unit:"years"})},OGX.CalendarLayout.DECADE_YEARS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="Y"),!e.hasOwnProperty("labels")&&(e.labels=null),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_century_years_label">'+(e.labels?t.format(e.labels):10*Math.floor(Number(t.format("YYYY"))/10)+"'s")+"</span>",this.html=(e,t,i,a)=>{var n,o=10*Math.floor(Number(e.format("YYYY"))/10),r="",s=Number(moment().format("YYYY")),l="";a&&(l=Number(a.format("YYYY")));for(var d=0;d<10;d++)n="",o+d===s&&(n+="ogx_calendar_layout_decade_years_current "),o+d===l&&(n+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(o+d)&&(n+="ogx_calendar_layout_off_date "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_decade_years '+n+'" data-ogx-date="'+(o+d)+'-01-01">'+t(o+d+"-01-01",i)+"</div>";return r},this.value=()=>({value:10,unit:"years"})},OGX.CalendarLayout.DECADE_MONTHS=function(e){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=e=>{for(var t=10*Math.floor(Number(e.format("YYYY"))/10),i=Number(String(t).substr(2,2)),a="",n=0;n<10;n++)a+='<span class="ogx_calendar_layout_decade_months_label">\''+i+"</span>",i++;return a},this.html=(e,t,i,a)=>{var n,o,r,s,l=10*Math.floor(Number(e.format("YYYY"))/10),d="",c=moment().format("YYYY-MM");a&&(n=a.format("YYYY-MM"));for(var u=0;u<12;u++){s=u+1;for(var h=0;h<10;h++)o="",(r=l+h+"-"+(s<10?"0"+s:s))===c&&(o="ogx_calendar_layout_decade_months_current "),r===n&&(o+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(r)&&(o+="ogx_calendar_layout_off_date "),moment(r+"-01"),d+='<div class="ogx_calendar_layout_item ogx_calendar_layout_decade_months '+o+'" data-ogx-date="'+r+'-01">'+t(r+"-01",i)+"</div>"}return d},this.value=()=>({value:10,unit:"years"}),this.format=e=>"["+10*Math.floor(Number(e.format("YYYY"))/10)+"'s]"},OGX.CalendarLayout.YEAR_MONTHS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="Y"),!e.hasOwnProperty("labels")&&(e.labels="[Months]"),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_year_months_label">'+t.format(e.labels)+"</span>",this.html=(e,t,i,a)=>{var n,o,r=moment().format("YYYY-MM"),s=e.format("YYYY"),l="",d="";a&&(d=a.format("YYYY-MM"));for(var c=1;c<13;c++)n="",s+"-"+(o=c<10?"0"+c:c)===r&&(n+="ogx_calendar_layout_year_months_current "),s+"-"+o===d&&(n+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(s+"-"+o)&&(n+="ogx_calendar_layout_off_date "),l+='<div class="ogx_calendar_layout_item ogx_calendar_layout_year_months '+n+'" data-ogx-date="'+s+"-"+o+'-01">'+t(s+"-"+o+"-01",i)+"</div>";return l},this.value=()=>({value:1,unit:"years"})},OGX.CalendarLayout.YEAR_WEEKS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="Y"),!e.hasOwnProperty("labels")&&(e.labels="[Weeks]"),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_year_weeks_label">'+t.format(e.labels)+"</span>",this.html=(e,t,i,a)=>{var n=moment().week(),o=e.format("YYYY"),r=moment().format("YYYY"),s="",l="";a&&(l=a.week(),s=a.format("YYYY"));for(var d,c,u="",h=1;h<53;h++)d="",c=moment().year(o).week(h).format("YYYY-MM-DD"),n===h&&o===r&&(d="ogx_calendar_layout_year_weeks_current "),l===h&&o===s&&(d+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(c)&&(d+="ogx_calendar_layout_off_date "),u+='<div class="ogx_calendar_layout_item ogx_calendar_layout_year_weeks '+d+'" data-ogx-date="'+c+'">'+t(c,i)+"</div>";return u},this.value=()=>({value:1,unit:"years"})},OGX.CalendarLayout.YEAR_DAYS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="Y"),!e.hasOwnProperty("labels")&&(e.labels="[Nth Day]"),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_year_weeks_label">'+t.format(e.labels)+"</span>",this.html=(e,t,i,a)=>{var n,o,r,s="",l=e.format("YYYY-MM-DD"),d=moment(e.format("YYYY")+"-01-01"),c="";a&&(c=a.format("YYYY-MM-DD")),o=e.isLeapYear()?366:365;for(var u=0;u<o;u++)n="",(r=d.format("YYYY-MM-DD"))===l&&(n="ogx_calendar_layout_year_days_current "),r===c&&(n+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(r)&&(n+="ogx_calendar_layout_off_date "),s+='<div class="ogx_calendar_layout_item ogx_calendar_layout_year_days '+n+'" data-ogx-date="'+r+'">'+t(r,i)+"</div>",d.add(1,"days");return s},this.value=()=>({value:1,unit:"years"})},OGX.CalendarLayout.MONTH_WEEKS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="[(]YYYY-MM[)] W"),!e.hasOwnProperty("labels")&&(e.labels="[Nth Week]"),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_year_weeks_label">'+t.format(e.labels)+"</span>",this.html=(e,t,i,a)=>{var n,o="",r=moment(),s=Number(r.format("YYYY")),l=Number(r.format("w")),d=Number(e.format("YYYY")),c=0,u=0;a&&(c=Number(a.format("YYYY")),u=Number(a.format("w")));o="";for(var h,g=moment(e.format("YYYY-MM-[01]")),f=0;f<5;f++)h="",n=Number(g.format("w")),d===c&&n===u&&(h+="ogx_calendar_selected_item "),d===s&&n===l&&(h+="ogx_calendar_layout_month_weeks_current"),this.off_dates&&this.off_dates.includes(n)&&(h+="ogx_calendar_layout_off_date "),o+='<div class="ogx_calendar_layout_item ogx_calendar_layout_month_weeks '+h+'" data-ogx-date="'+g.format("YYYY-MM-DD")+'">'+t(g.format("YYYY-MM-DD"),i)+"</div>",g.add(7,"days");return o},this.value=()=>({value:1,unit:"months"})},OGX.CalendarLayout.WEEK_DAYS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="YYYY-MM (wo [week])"),!e.hasOwnProperty("labels")&&(e.labels="ddd DD"),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>{var i="",a=Number(t.format("d")),n=t.clone();a&&n.subtract(a,"day");for(var o=0;o<7;o++)i+='<span class="ogx_calendar_layout_month_days_label">'+n.format(e.labels)+"</span>",n.add(1,"day");return i},this.html=(e,t,i,a)=>{var n,o,r="",s=e.weekday(),l=e.subtract(s,"days"),d=moment().format("YYYY-MM-DD"),c="";a&&(c=a.format("YYYY-MM-DD"));for(var u=0;u<7;u++)n="",(o=l.format("YYYY-MM-DD"))===d&&(n="ogx_calendar_layout_week_days_current "),o===c&&(n+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(o)&&(n+="ogx_calendar_layout_off_date "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_week_days '+n+'" data-ogx-date="'+o+'">'+t(o,i)+"</div>",l.add(1,"days");return r},this.value=()=>({value:1,unit:"weeks"})},OGX.CalendarLayout.DAY_HOURS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="YYYY-MM-DD HH:[00]"),!e.hasOwnProperty("labels")&&(e.labels="[Hours]"),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_day_hours_label">'+t.format(e.labels)+"</span>",this.html=(e,t,i,a)=>{var n,o,r="",s=Number(moment().format("HH")),l=e.format("YYYY-MM-DD "),d=moment().format("YYYY-MM-DD "),c="",u="";a&&(c=Number(a.format("HH")),u=a.format("YYYY-MM-DD "));for(var h=0;h<24;h++)o="",h===s&&l===d&&(o="ogx_calendar_layout_days_hours_current "),h===c&&l===u&&(o+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(l+n+":00")&&(o+="ogx_calendar_layout_off_date "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_days_hours '+o+'" data-ogx-date="'+(l+(n=h<10?"0"+h:String(h)))+':00">'+t(l+n+":00",i)+"</div>";return r},this.value=()=>({value:1,unit:"days"})},OGX.CalendarLayout.DAY_WORK_HOURS=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="YYYY-MM-DD HH:[00]"),!e.hasOwnProperty("labels")&&(e.labels="[Work Hours]"),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_day_work_hours_label">'+t.format(e.labels)+"</span>",this.html=(e,t,i,a)=>{i&&void 0!==i?i.hasOwnProperty("start")||(i.start=8,i.end=17):i={start:8,end:17};var n,o,r="",s=Number(moment().format("HH")),l=e.format("YYYY-MM-DD "),d=moment().format("YYYY-MM-DD "),c="",u="";a&&(c=Number(a.format("HH")),u=a.format("YYYY-MM-DD "));for(var h=i.start;h<i.end+1;h++)o="",h===s&&l===d&&(o="ogx_calendar_layout_days_work_hours_current "),h===c&&u===l&&(o+="ogx_calendar_selected_item "),this.off_dates&&this.off_dates.includes(l+n+":00")&&(o+="ogx_calendar_layout_off_date "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_days_work_hours '+o+'" data-ogx-date="'+(l+(n=h<10?"0"+h:h))+':00">'+t(l+n+":00",i)+"</div>";return r},this.value=()=>({value:1,unit:"days"})},OGX.CalendarLayout.DAY=function(e){"use strict";!e.hasOwnProperty("format")&&(e.format="YYYY-MM-DD"),!e.hasOwnProperty("labels")&&(e.labels="dddd DD"),OGX.CalendarLayout.BASE_LAYOUT.call(this,e),this.labels=t=>'<span class="ogx_calendar_layout_day_label">'+t.format(e.labels)+"</span>",this.html=(e,t,i,a)=>{var n="",o=e.format("YYYY-MM-DD"),r=moment().format("YYYY-MM-DD");return a&&o===a.format("YYYY-MM-DD")&&(n+="ogx_calendar_selected_item "),o===r&&(n+="ogx_calendar_layout_day_current "),this.off_dates&&this.off_dates.includes(o)&&(n+="ogx_calendar_layout_off_date "),'<div class="ogx_calendar_layout_item ogx_calendar_layout_day '+n+'" data-ogx-date="'+o+'">'+t(o,i)+"</div>"},this.value=()=>({value:1,unit:"days"}),this.select=e=>{}},OGX.CalendarEngine={},OGX.CalendarEngine.CELL_VALUE=function(e,t){var i=moment(e);return t.hasOwnProperty("css")||(t.css=""),'<div class="ogx_calendar_engine_cell_value '+t.css+'">'+i.format(t.format)+"</div>"},OGX.CalendarEngine.DAY_NUMBER=function(e,t){var i=moment(e);return OGX.CalendarEngine.CELL_VALUE(i,{format:"DD",css:"ogx_calendar_engine_day_number"})},OGX.CalendarEngine.WEEK_NUMBER=function(e,t){return'<div class="ogx_calendar_engine_week_number">'+moment(e).week()+"</div>"},OGX.CalendarEngine.MONTH_NUMBER=function(e,t){return OGX.CalendarEngine.CELL_VALUE(e,{format:"MM",css:"ogx_calendar_engine_month_number"})},OGX.CalendarEngine.YEAR_NUMBER=function(e,t){return OGX.CalendarEngine.CELL_VALUE(e,{format:"YY",css:"ogx_calendar_engine_year_number"})},OGX.CalendarEngine.DECADE_NUMBER=function(e){return'<div class="ogx_calendar_engine_date_day_number">'+String(e).substr(2)+"'s</div>"},require("Carousel","Uxi","Placeholder","Touch"),OGX.Carousel=function(e){construct(this,"Carousel");var t,i,a,n,o,r,s=this,l=e,d={min_x:100,anim:!0,drag:!0,drag_left:!0,drag_right:!0,dots:!1,css:!1,index:0,capture:!1,callbacks:{change:null},display:!1,displays:!1,as:"item",list:null},c={position:"bottom"},u=!1,h=0,g=0,f=new OGX.List,p="ogx_carousel",_=null,m=null;function v(e){if(void 0!==e&&f[e]&&f[e].instance){var t=s.find(f[e].instance._NAME_,f[e].instance.id);t&&t.blur(2)}}function y(e){if(void 0!==e&&f[e]&&f[e].instance){var t=s.find(f[e].instance._NAME_,f[e].instance.id);t&&s.enabled&&t.focus(1)}}function x(e){i.off("transitionend"),i.removeClass(p+"_anim")}function O(e){if(e.dirX){if(-1===e.dirX&&!l.drag_right)return;if(1===e.dirX&&!l.drag_left)return}if(e.distX>e.distY){var t=r*a*-1+e.distX*e.dirX;t<=0&&t>-1*(i.width()-s.el.width())&&i.css({transform:"translate3d("+t+"px, 0, 0)"})}}function b(e){if(e.distX>l.min_x){var i=r+-1*e.dirX;i>=0&&i<g&&r!==i&&(v(r),r=i,s.onChange(r),t.trigger(OGX.Carousel.CHANGE,r))}var a=0;r&&(a=100/g*(-1*r)),w(a,r,!0)}function w(e,t,a){a?(i.addClass(p+"_anim"),i.on("transitionend",(function(){i.off("transitionend"),i.removeClass(p+"_anim"),y(t)}))):(i.removeClass(p+"_anim"),s.enabled&&y(t)),i.css({transform:"translate3d("+e+"%, 0, 0)"})}function G(){u=!0,clearInterval(n),n=setInterval(X,50),a=Math.floor(t.innerWidth()),i.removeClass(p+"_anim")}function X(){u=!1,clearInterval(n),n=!1,l.drag&&m.enable()}function T(){var e,t,a;g&&(f.clear(),i.children("."+p+"_view").each((function(i,n){e=$(n),(t=e.children().first()).length?(t[0].hasAttribute("data-ogx-id")&&(a=t.data("ogx-id"),t.hasClass("ogx_scroller_outer")&&(a=t.find(".ogx_scroller_inner").first().data("ogx-id"))),void 0!==s.nodes[i]&&(i!==r?s.nodes[i].blur():s.enabled&&s.nodes[i].focus(),f.push({index:i,instance:s.nodes.get({id:{eq:String(a)}},null,1),html:!1}))):f.push({index:i,instance:!1,html:e.html()})})))}function D(){for(var e=[],a=0;a<g;a++)i.append('<div class="'+p+'_view" style="width:'+100/g+'%;" data-ogx-panel-id="'+h+'"></div>'),e.push("."+p+'[data-ogx-id="'+s.id+'"] > .'+p+"_views > ."+p+'_view[data-ogx-panel-id="'+h+'"]'),h++;i.css("width",100*g+"%"),s.placeholders(l,e),t.trigger(OGX.Carousel.READY)}this.construct=function(){T(),l.index&&this.showPanel(l.index,!1),l.dots&&o.bind("dots",s)},this.onFocus=()=>{l.drag&&m.enable(),debug(5,"carousel",l.id,"enabled"),setTimeout((()=>{for(var e=0;e<f.length;e++)f[e].instance&&(e!==r?f[e].instance.blur():f[e].instance.focus())}),0)},this.onBlur=()=>{l.drag&&m.disable(),debug(5,"carousel",l.id,"disabled")},this.focus=function(){return this.blured&&(this.blured=!1,this.ux(!0),this.onFocus(),f.length&&f[r].instance&&f[r].instance.focus()),this},this.resize=function(){return l.drag&&m.disable(),setTimeout(G,0),this},this.show=function(e,t){arguments.length||this._show();var i=this.getNodeIndex(e,t);return i&&this.showPanel(i.index),this},this.onChange=function(){},this.getNodeIndex=function(e,t){var i=f.get({"instance.id":{eq:t},"instance._NAME_":{eq:e}},null,1);return!!i&&{index:i.index}},this.anim=function(e){return void 0===e?l.anim:(l.anim=e,this)},this.drag=function(e){return void 0===e?l.drag:(l.drag!==e&&(l.drag&&m.disable(),e&&m.enable(),l.drag=e),this)},this.dragLeft=function(e){return void 0===e?l.drag_left:(l.drag_left=e,this)},this.dragRight=function(e){return void 0===e?l.drag_right:(l.drag_right=e,this)},this.destroy=function(){n&&clearInterval(n),l.dots&&o.destroy()},this.val=function(e){return void 0===e?r:(this.showPanel(e),this)},this.prev=function(){return r>0&&this.showPanel(r-1),this},this.next=function(){return r+1<g&&this.showPanel(r+1),this},this.panels=function(){return f},this.addNode=function(e,a,n,o,r){void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===r&&(r=!1);var l=function(e){void 0===e&&(e="");return g++,i.append('<div class="'+p+'_view" style="width:'+100/g+'%;" data-ogx-panel-id="'+h+'">'+e+"</div>"),i.css("width",Math.round(100*g)+"%"),i.children("."+p+"_view").css("width",100/g+"%"),++h-1}(),d="."+p+'[data-ogx-id="'+this.id+'"] > .'+p+"_views > ."+p+'_view[data-ogx-panel-id="'+l+'"]',c={},u=d;if(e.hasOwnProperty("_NAME_"))e.detach(),e.attach(this,d),n&&this.showPanel(g-1,o);else{for(var f in e){u+=":"+f.split(":")[1],c[u]=e[f];break}var _=null;setTimeout((()=>{s.observe(!0,{childList:!0,subtree:!0},(()=>{s.observe(!1),_&&clearTimeout(_),_=setTimeout(T,20),n&&(s.showPanel(g-1,o),r?r():t.trigger(OGX.Carousel.ADDED,g))})),OGX.OML.render(s,c,a)}),0)}return this},this.removeNode=(e,t)=>{void 0===t&&(t=e,e=null);for(var i=!1,a=0;a<f.length;a++)if(f[a].instance.id===t)return i=!0,e&&(i=f[a].instance._NAME_===e),i&&this.removePanel(a),!0;return!1},this.showPanel=(e,t,i)=>{if((void 0===i&&(i=!1),e>=0&&e<g&&!u)&&((n=r)!==e||i)){void 0===t&&(t=l.anim),r!==e&&v(r);var a=100/g*(-1*e),n=e;return setTimeout((()=>{w(a,n,t)}),0),r=e,l.dots&&o.select(e),!0}return!1},this.getPanel=e=>f.get({index:{eq:e}},null,1),this.swapPanels=(e,a)=>{var n=i.children("."+p+"_view:eq("+e+")").detach();a>e?i.children("."+p+"_view:eq("+(a-1)+")").after(n):i.children("."+p+"_view:eq("+a+")").before(n);var o=100/g*(-1*a);return i.removeClass(p+"_anim"),i.css({transform:"translate3d("+o+"%, 0, 0)"}),r=a,setTimeout(T,0),s.onChange(r),t.trigger(OGX.Carousel.CHANGE,r),this},this.removePanel=(e,a)=>{if(void 0===a&&(a=!0),e>=0&&e<g){var n=null;if(a&&(a="remove"),i.children("."+p+"_view:eq("+e+")").children().data("ogx-id")){var o=f[e];o.instance&&(n=this.find(o.instance._NAME_,o.instance.id,a))&&(a||n.detach()),f.splice(e,1)}return g--,i.children("."+p+"_view:eq("+e+")").remove(),i.removeClass(p+"_anim").css("width",Math.round(100*g)+"%"),i.children("."+p+"_view").css("width",100/g+"%"),e>=r?e--:e=--r,e<0&&(e=0),r=e,s.showPanel(e,!1,!0),t.trigger(OGX.Carousel.REMOVED,g),n}return!1},this.empty=()=>(this.clear(),i.empty(),i.removeClass(p+"_anim").css("width","100%"),i.css({transform:"translate3d(0%, 0, 0)"}),g=0,f=new OGX.List,l.index=r=0,l["node:OML"]=[],this),this.render=(e,t)=>(l["node:OML"]=e,g=l["node:OML"].length,D(),OGX.OML.render(this,l["node:OML"],t),this),this.destroy=()=>{this.touch.wipe()},function(){if(void 0===OGX.Data)return debug(1,"OGX.Data not found!"),!1;!function(){if(OGX.Data.merge(l,d,!1),l.callbacks.change||(l.callbacks.change=s.onChange),l.dots&&("boolean"==typeof l.dots&&(l.dots={}),OGX.Data.merge(l.dots,c)),_=new OGX.Display(l),r=l.index,t=s.el,a=Math.floor(t.innerWidth()),l.hasOwnProperty("node:OML")&&l["node:OML"].length)g=l["node:OML"].length;else if(l.list&&l.list.length){for(var e,i,n=[],o=0;o<l.list.length;o++)if(_.hasOML())e=_.oml('.ogx_carousel[data-ogx-id="'+s.id+'"] > .ogx_carousel_views > .ogx_carousel_view[data-ogx-panel-id="'+o+'"]',l.list[o],l.as),n.push(e);else{i=_.html(l.list[o]);var u='{"default:Html":{"html":'+JSON.stringify(i)+"}}";e=JSON.parse(u),n.push(e)}l["node:OML"]=n,g=l["node:OML"].length}}(),function(){t.addClass(p);var e="";l.dots&&"top"===l.dots.position&&(e+='<div class="carousel_dots"></div>'),e+='<div class="'+p+'_views" style="width:'+100*g+'%;"></div>',l.dots&&"bottom"===l.dots.position&&(e+='<div class="carousel_dots"></div>'),t.append(e),(i=t.find("."+p+"_views").first()).css({transform:"translate3d("+100/g*(-1*r)+"%, 0, 0)"})}(),l.dots&&(o=s.create("Dots",{el:"."+p+'[data-ogx-id="'+s.id+'"] > .carousel_dots',total:g})),D(),m=s.touch.add("Swipe",{x:!0,cb_down:x,cb_swipe:O,cb_up:b,capture:l.capture,state:"manual"}),l.drag?m.enable():s.drag(!1),debug(5,"carousel",l.id,"init")}()},OGX.Carousel.READY="CarouselReady",OGX.Carousel.CHANGE="CarouselChange",OGX.Carousel.ADDED="CarouselAdded",OGX.Carousel.REMOVED="CarouselRemoved",void 0===OGX)var OGX={};if(OGX.Color={},OGX.Color.hexToRgb=e=>{"use strict";e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,i,a){return t+t+i+i+a+a}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null},OGX.Color.rgbToHex=(e,t,i)=>{"use strict";var a,n,o;arguments.length>1&&(e=e+", "+t+", "+i),"object"==typeof e&&(e=Array.isArray(e)?e.join(","):e.r+" "+e.g+" "+e.b);var r=/(\d+)[ ,]*(\d+)[ ,]*(\d+)/g.exec(e);return r&&(r.shift(),a=Number(r[0]),n=Number(r[1]),o=Number(r[2])),"#"+((1<<24)+(a<<16)+(n<<8)+o).toString(16).slice(1)},OGX.Color.rgbToHsl=(e,t,i)=>{"use strict";var a,n,o;arguments.length>1&&(e=e+", "+t+", "+i),"object"==typeof e&&(e=Array.isArray(e)?e.join(","):e.r+" "+e.g+" "+e.b);var r=/(\d+)[ ,]*(\d+)[ ,]*(\d+)/g.exec(e);if(r){r.shift(),a=r[0],n=r[1],o=r[2],a/=255,n/=255,o/=255;var s,l,d=Math.max(a,n,o),c=Math.min(a,n,o),u=(d+c)/2;if(d===c)s=l=0;else{var h=d-c;switch(l=u>.5?h/(2-d-c):h/(d+c),d){case a:s=(n-o)/h+(n<o?6:0);break;case n:s=(o-a)/h+2;break;case o:s=(a-n)/h+4}s/=6}return[s,l,u]}return!1},OGX.Color.hslToRgb=(e,t,i)=>{"use strict";if(1===arguments.length)if("object"==typeof e)Array.isArray(e)?(i=e[2],t=e[1],e=e[0]):(i=e.l,t=e.s,e=e.h);else if("string"==typeof e){var a=/([0-9\.]+)[ ,]*([0-9\.]+)[ ,]*([0-9\.]+)/g.exec(e);a&&(a.shift(),e=Number(a[0]),t=Number(a[1]),i=Number(a[2]))}var n,o,r;if(0===t)n=o=r=i;else{var s=function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},l=i<.5?i*(1+t):i+t-i*t,d=2*i-l;n=s(d,l,e+1/3),o=s(d,l,e),r=s(d,l,e-1/3)}return[Math.round(255*n),Math.round(255*o),Math.round(255*r)]},OGX.Color.formatHex=e=>("#"===e.slice(0,1)&&(e=e.slice(1)),e.length>3||e.split("").map((e=>e+e)),"#"+e),require("Container","Uxi"),OGX.Container=function(e){construct(this,"Container");var t=this,i={tabs:!0,carousel:{enabled:!0},enabled:!0,reorder:!0,anim:!0,flatten:!1,chromeos:!1,index:0,dots:!1},a=e,n=!1,o="normal",r=0;function s(e){e?(t.tabs.el.on(OGX.Tabs.SELECT,(function(e,i){var a=t.tabs.index();t.carousel.val(a),t.el.trigger(OGX.Container.CHANGE,a)})),t.tabs.el.on(OGX.Tabs.REMOVE,(function(){})),t.tabs.el.on(OGX.Tabs.REORDER,(function(e,i){t.carousel.swapPanels(i.from,i.to)})),t.tabs.el.on(OGX.Tabs.ADD,(function(){})),t.carousel.el.on(OGX.Carousel.CHANGE,(function(e,i){t.tabs.index(i),t.el.trigger(OGX.Container.CHANGE,i)}))):(t.tabs.el.off(OGX.Tabs.SELECT),t.tabs.el.off(OGX.Tabs.REMOVE),t.tabs.el.off(OGX.Tabs.REORDER),t.tabs.el.off(OGX.Tabs.ADD),t.carousel.el.off(OGX.Carousel.CHANGE)),l(e)}function l(e){e?t.tabs.el.on(OGX.Tabs.REMOVE,(function(e,i){l(!1),"Popup"===t.parent._NAME_?app.ungroupPopup(t.parent,i.index,i.label,i.x,i.y):t.carousel.removeNode(t.carousel.nodes[i.index].id),setTimeout((()=>{l(!0)}),200)})):t.tabs.el.off(OGX.Tabs.REMOVE)}function d(e){var t=e[0].style.transform;return t=(t=t.match(/translate3d\(([0-9px%,\.\- ]+)\)/))[1].split(",")}function c(){var e={el:'.ogx_container[data-ogx-id="'+t.id+'"]',reorder:a.reorder,add:!1,remove:!1,chromeos:a.chromeos,index:a.index};if(!0===a.tabs){a.tabs=[];for(var i=0;i<a["node:OML"].length;i++)for(var n in a["node:OML"][i])a["node:OML"][i][n].hasOwnProperty("title")&&a.tabs.push({label:a["node:OML"][i][n].title})}e=OGX.Data.merge(a.tabs,e),t.tabs=t.create("Tabs",e)}function u(){n.addClass("ogx_container")}function h(){OGX.Data.merge(a,i,!1),OGX.Data.merge(a.carousel,i.carousel,!1),a.tabs&&"object"!=typeof a.tabs&&(a.tabs={}),n=t.el}function g(){if(void 0===OGX.Data)return debug(1,"OGX.Data not found!"),!1;if(void 0===OGX.Tabs)return debug(1,"OGX.Tabs not found!"),!1;if(void 0===OGX.Carousel)return debug(1,"OGX.Carousel not found!"),!1;debug(5,"container init",a.id),h(),u();var e=!1;a.tabs&&(c(),e="ogx_carousel_shink");var i=a["node:OML"].slice(),n={},o='.ogx_container[data-ogx-id="'+t.id+'"]:Carousel';n["node:OML"]={},n["node:OML"][o]={id:t.id+"_carousel",css:e,anim:a.anim,chromeos:a.chromeos,drag:a.carousel.drag,index:a.index,dots:a.dots,"node:OML":i},a["node:OML"]=n["node:OML"],setTimeout((()=>{t.resize()}),0),debug(5,"container",a.id,"init")}this.carousel=null,this.tabs=null,this.construct=()=>{this.carousel=this.find("Carousel",this.id+"_carousel")},this.show=(e,t)=>{if(arguments.length||this._show(),this.carousel&&"normal"===o){var i=this.carousel.getNodeIndex(e,t);i&&(this.carousel.val(i.index),a.tabs&&this.tabs.index(i.index))}},this.index=e=>(this.carousel&&"normal"===o&&(this.carousel.val(e),a.tabs&&this.tabs.index(e)),this),this.showIndex=e=>(debug(1,"Container.showIndex has been deprecated, use Container.index"),this.index(e),this),this.onFocus=()=>(a.tabs&&this.carousel&&(t.tabs.onFocus(),s(!0)),debug(5,"container",a.id,"enabled"),this),this.onBlur=()=>(a.tabs&&this.carousel&&(t.tabs.onBlur(),s(!1)),debug(5,"container",a.id,"disabled"),this),this.resize=()=>(a.flatten&&(this.carousel&&"flattened"!==o&&this.el.width()>=a.flatten?(o="flattened",a.tabs&&(this.tabs.blur(),this.tabs.hide()),this.carousel.blur(),r=d(this.carousel.el.children(".ogx_carousel_views"))[0],this.carousel.el.children(".ogx_carousel_views").addClass("ogx_container_flattened").css("transform","translate3d(0px, 0px, 0px)")):this.carousel&&"flattened"===o&&this.el.width()<a.flatten&&(o="normal",a.tabs&&(this.tabs.focus(),this.tabs.show()),this.carousel.focus(),this.carousel.el.children(".ogx_carousel_views").removeClass("ogx_container_flattened").css("transform","translate3d("+r+", 0px, 0px)"))),this),this.empty=()=>(this.carousel.empty(),this.tabs.empty(),this),g()},OGX.Container.CHANGE="ContainerChange",void 0===OGX)var OGX={};if(require("Controller","Touch"),OGX.Controller=function(e){construct(this,"Controller");e=OGX.Data.merge(e,{enabled:!0,blured:!0,always_on:!1}),this.el=!1,this.blured=e.blured,this.enabled=e.enabled,this.floating=!1,this.always_on=e.always_on,this.id=e.id},OGX.Controller.prototype.enable=function(){return this.enabled||(this.enabled=!0,this.focus()),this},OGX.Controller.prototype.disable=function(){return this.enabled&&(this.enabled=!1,this.blur()),this},OGX.Controller.prototype.blur=function(){return this.always_on||this.blured||(this.blured=!0,this.ux(!1)),this},OGX.Controller.prototype.focus=function(){return this.blured&&this.enabled&&(this.blured=!1,this.ux(!0)),this},OGX.Controller.prototype.construct=function(){},OGX.Controller.prototype.ux=function(){},OGX.Controller.prototype.resize=function(){},OGX.Controller.prototype.clear=function(){},OGX.Controller.prototype.destroy=function(){},OGX.Controller.prototype.kill=function(){OGX.Object.destroy(this)},OGX.Controller.prototype.toOML=function(){var e={};return e[this.id+":Controllers."+this._CLASS_]={},e},void 0===OGX)var OGX={};if(OGX.Display=function(e){"use strict";var t,i,a={display:!1,displays:!1},n={html:!1,css:!1,oml:!1,placeholder:!1,template:!1,view:!1,bind_css:!1,add_css:!1,calc_css:!1,bind_template:!1,calc_template:!1};function o(e,t){return-1!==e.indexOf("{{")?OGX.OSE.exec(e,t):e}function r(e){if(t.display&&(!t.display.hasOwnProperty("bind")||!t.display.bind))return OGX.Data.merge(t.display,{},!0,!1,!1);if(t.displays&&t.display.hasOwnProperty("bind")&&t.display.bind){if(e.hasOwnProperty(t.display.bind)){var i=e[t.display.bind];return OGX.Data.merge({},t.displays[i],!0,!1,!1)}if(t.displays.hasOwnProperty("__default"))return OGX.Data.clone(t.displays.__default)}return!1}function s(e){var t=OGX.Data.merge(n,e,!0,!0,!1);return t.template&&("object"==typeof t.template?(t.template.hasOwnProperty("conditions")&&(t.calc_template=!0),t.template.hasOwnProperty("bind")&&(t.bind_template=!0)):0===t.template.indexOf("{{")?t.calc_template=!0:(t.html=OGX.Templater.get(t.template),t.template=!1)),t.css&&(t.bind_css="object"==typeof t.css&&t.css.hasOwnProperty("bind"),t.add_css="object"==typeof t.css&&t.css.hasOwnProperty("add"),t.calc_css="object"==typeof t.css&&t.css.hasOwnProperty("conditions")||"string"==typeof t.css&&"{{"===t.css.slice(0,2)),t}function l(e){if(void 0===e&&(e={}),t=OGX.Data.clone(a),!e.hasOwnProperty("display")&&!e.hasOwnProperty("displays"))return t.display=OGX.Data.merge(n,e,!0,!0,!1),t.display=s(t.display),void(i=r());if(e.hasOwnProperty("display")&&e.display&&!e.display.hasOwnProperty("bind"))return t.display=OGX.Data.merge(n,e.display,!0,!0,!1),t.display=s(t.display),void(i=r());if(e.hasOwnProperty("display")&&e.display&&e.display.hasOwnProperty("bind")&&e.hasOwnProperty("displays")&&e.displays&&(t.display=e.display,t.displays=OGX.Data.clone(e.displays)),t.displays)for(var o in t.displays)t.displays[o]=OGX.Data.merge(n,t.displays[o],!0,!0,!0),t.displays[o]=s(t.displays[o])}this.val=e=>{if(void 0===e)return OGX.Data.clone(t);l(e)},this.display=e=>t.displays&&t.displays.hasOwnProperty(e)?(i=t.displays[e],!0):i,this.css=e=>{var t,a="",n=void 0!==e;if((t=n?r(e):i)&&(t.bind_css&&n?a+=e[o(t.css.bind,e)]:t.css&&"string"==typeof t.css&&(a=o(t.css,e)),t.add_css&&(a+=" "+o(t.css.add,e)),t.calc_css&&n))if("string"==typeof t.css)a=o(t.css,e);else for(var s,l,d=0;d<t.css.conditions.length;d++)if(OGX.OSE.exec(t.css.conditions[d][0],e)&&((s=t.css.conditions[d][1]).hasOwnProperty("css")&&(a=o(s.css,e)),s.hasOwnProperty("add")&&(a+=" "+o(s.add,e)),s.hasOwnProperty("remove"))){l=s.remove.explode(" ");for(var c=0;c<l.length;c++)a=a.replace(o(l[c],e),"")}return a||""},this.html=e=>{var t,a=!1,n=void 0!==e;return(t=n?r(e):i)&&(t.bind_template&&n?a=OGX.Templater.get(e[t.template.bind]):t.template?t.calc_template&&0===t.template.indexOf("{{")?(a=OGX.OSE.exec(t.template,e),a=OGX.Templater.get(a)):a=t.html:t.html&&(a=t.html),n&&a&&(a=OGX.Templater.make(a,e))),a||(a=""),a},this.oml=(e,t,a)=>{void 0===a&&(a="&item");var n={},o=r(t);if(o||(o=i),o){if(o.oml)return"string"==typeof o.oml&&(o.oml=app.getOML(o.oml)),n=OGX.OML.rename(OGX.Data.clone(o.oml),e),OGX.OML.replaceDataRecursive(n,t,a),o.placeholder?function(e,t,i){var a,n,o=OGX.Data.clone(e.oml);for(var r in o){var s,l;for(var d in o[a=r.replace("default",t)]=o[r],o[a]["node:OML"]=[],e.placeholder){l=i[d].length;for(var c=0;c<l;c++){for(var u in s=OGX.Data.clone(e.placeholder[d]),(n=OGX.Data.clone(i))[d]=n[d][c],s){s[u].data=n;break}o[a]["node:OML"].push(s)}return delete o[r],o}}return!1}(o,e,t):n;if(o.template){if("string"==typeof o.template)if(0===o.template.indexOf("{{"))(s=OGX.OSE.exec(o.template,t))&&(n[e+":Templates."+s]={data:t});else n[e+":Templates."+o.template]={data:t};else if(o.bind_template)n[e+":Templates."+t[o.template.bind]]={data:t};else if(debug(2,"Draft, undocumented features."),o.calc_template)for(var s,l=0;l<o.template.conditions.length;l++){var d=o.template.conditions[l][0];if(s=OGX.OSE.exec(d,t)){!0===s?n[e+":Templates."+o.template.conditions[l][1]]={data:t}:1===o.template.conditions[l].length&&(n[e+":Templates."+s]={data:t});break}}return n}if(o.hasOwnProperty("html"))return n[e+":Html"]={html:this.html(t)},n}return!1},this.hasOML=()=>!1!==i.oml,this.toJSON=()=>t,l(e)},void 0===OGX)var OGX={};if(require("Dots","Uxi","Touch"),OGX.Dots=function(e){construct(this,"Dots");var t,i=this,a=e,n={el:"document",total:0,current:0,clickable:!0,callbacks:{select:null}},o={};function r(e){switch(o[e]._NAME_){case"Carousel":o[e].el.off(OGX.Carousel.CHANGE,s),o[e].el.off(OGX.Carousel.ADDED+" "+OGX.Carousel.REMOVED,l),delete o[e]}}function s(e,t){i.select(t)}function l(e,t){a.total=t,c()}function d(e){e?t.on(i.touch.down,".ogx_dots_item",(function(){var e=Number($(this).data("id"));i.select(e),i.onSelect(e),t.trigger(OGX.Dots.SELECT,e),function(e){for(var t in o)switch(o[t]._NAME_){case"Carousel":o[t].val(e)}}(e)})):t.off(i.touch.down)}function c(){for(var e,i="",n=0;n<a.total;n++)e="",a.current===n&&(e="ogx_dots_selected"),i+='<div class="ogx_dots_item" data-id="'+n+'"><span class="ogx_dots_gfx '+e+'"></span></div>';t.html(i)}this.onFocus=()=>(a.clickable&&d(!0),debug(5,"dots",a.id,"enabled"),this),this.onBlur=()=>(a.clickable&&d(!1),debug(5,"dots",a.id,"disabled"),this),this.bind=(e,t)=>!(o.hasOwnProperty(e)||!t.hasOwnProperty("_NAME_"))&&function(e,t){switch(o[e]=t,t._NAME_){case"Carousel":a.total=t.panels().length,a.current=t.val(),t.el.on(OGX.Carousel.CHANGE,s),t.el.on(OGX.Carousel.ADDED+" "+OGX.Carousel.REMOVED,l)}return!0}(e,t),this.unbind=e=>!!o.hasOwnProperty(e)&&r(e),this.select=e=>{t.find(".ogx_dots_selected").removeClass("ogx_dots_selected"),t.children(".ogx_dots_item:eq("+e+")").children(".ogx_dots_gfx").first().addClass("ogx_dots_selected"),a.current=e},this.onSelect=()=>{},this.destroy=()=>{!function(){for(var e in o)r(e)}()},OGX.Data.merge(a,n),a.callbacks.select||(a.callbacks.select=i.onSelect),(t=i.el).addClass("ogx_dots"),c(),debug(5,"dots",a.id,"init")},OGX.Dots.SELECT="DotsSelect",void 0===OGX)var OGX={};if(require("DynamicList","Uxi","Bind","Touch"),OGX.DynamicList=function(__config){construct(this,"DynamicList");var that=this,config=__config,config_default={el:null,key:!1,as:"item",display:!1,displays:!1,reorder:!1,swipe:!1,reselect:!1,chromeos:!1,min_x:30,hold_time:1e3,interval:5,list:[],selection:[],no_selection:{enabled:!1,prop:"",val:0},callbacks:{select:null,unselect:null,render:null},mode:OGX.DynamicList.SELECT_MODE_SINGLE,trigger:!1,scope:!0,swipe_template:'<div class="ogx_dynamic_list_item ogx_dynamic_list_swiper_back_item" style="height:{{$height}}px; z-index:{{$zindex}}; margin-bottom:{{$margin}}px;">{{$template}}</div>',zindex:1},swipe_default={mode:OGX.DynamicList.SWIPE_MODE_DELETE,options:{},template:!1,html:""},container,filtered,isFiltered,selection=new OGX.List,key_id=1,key_default="__id__",key,drag={mode:!1,stime:0,target:0,si:0,ei:0,y:0},move_intv=null,hold_intv=null,drag_intv=null,swipe_dir=0,display=new OGX.Display(config),ready=!1,scroller=!1;function isSelectable(__item){return!config.no_selection.enabled||eval("__item."+config.no_selection.prop+" === config.no_selection.val")}function replace(e,t,i){if(display.hasOML()){var a,n,o=toDataId(i[t]),r=display.oml('.ogx_dynamic_list[data-ogx-id="'+that.id+'"] > .ogx_dynamic_list_item[data-ogx-id='+o+"]",i,config.as);$('.ogx_dynamic_list[data-ogx-id="'+that.id+'"] > .ogx_dynamic_list_item[data-ogx-id='+o+"]").find(".ogx_uxi").each((function(e,t){a=$(t).data("ogx-id"),(n=that.cfind(!1,a,1))&&that.find(n._NAME_,n.id,"remove")})),OGX.OML.render(that,r,i)}else{var s="";selection.length&&selection.find(t,i[t],1)&&(s="ogx_dynamic_list_selected_item "),e.attr("class","").addClass("ogx_dynamic_list_item "+s+display.css(i)),e.html(display.html(i))}}function render(){var e=getWorkList(),t=selection;isFiltered&&(selection.resetFilters(),selection.setFilters(config.list.getFilters()),(t=selection.filter()).length!==selection.length&&(t.length?container.trigger(OGX.DynamicList.SELECT_FILTERED,t):container.trigger(OGX.DynamicList.SELECT_UNFILTERED,selection)));for(var i,a,n,o="",r=[],s=0;s<e.length;s++)if(!config.scope||!e[s].hasOwnProperty("scope")||config.scope&&!0===config.scope&&OGX.Scope.eval(e[s].scope)||config.scope&&"string"==typeof config.scope&&OGX.Scope.eval(e[s].scope,config.scope)){!1,a="",i=e[s][key],selection.find(key,i,1)&&(a="ogx_dynamic_list_selected_item"),display.html(e[s]);var l=toDataId(i);o+='<div class="ogx_dynamic_list_item '+a+" "+display.css(e[s])+'" data-ogx-id='+l+"></div>",n=display.oml('.ogx_dynamic_list[data-ogx-id="'+that.id+'"] .ogx_dynamic_list_item[data-ogx-id='+l+"]",e[s],config.as),r.push(n)}else debug(2,"DynamicList "+that.id+" item skipped due to scope",e[s].scope,OGX.Scope.scope());container.html(o),parseOML(r),config.trigger&&container.trigger(OGX.DynamicList.RENDER),that.onRender()}function parseOML(e){for(var t=0;t<e.length;t++)that.parse(e[t])}function listenScope(e){e?$(document).on(OGX.Scope.CHANGE,onScopeChange):$(document).off(OGX.Scope.CHANGE,onScopeChange)}function onScopeChange(){that.render()}function listenItems(e){void 0!==container&&ready&&(e?container.on(that.touch.click,".ogx_dynamic_list_item",onClick):container.off(that.touch.click,".ogx_dynamic_list_item",onClick))}function listenTouch(e){e?container.on(that.touch.down,".ogx_dynamic_list_item",onTouchStart):container.off(that.touch.down,".ogx_dynamic_list_item",onTouchStart)}function listenTouchHold(e){e?hold_intv=setInterval(onTouchHold,20):(clearInterval(hold_intv),hold_intv=null)}function listenTouchMove(e){e?container.on(that.touch.move,".ogx_dynamic_list_item",onTouchMove):container.off(that.touch.move,".ogx_dynamic_list_item")}function onTouchStart(e){drag.mode=!1,drag.target=$(e.currentTarget),drag.si=drag.target.index(),drag.cy=container.offset().top,e=that.event(e),drag.startx=e.pageX,drag.starty=e.pageY,drag_intv&&clearInterval(drag_intv),drag.stime=(new Date).getTime(),config.reorder&&listenTouchHold(!0),listenTouchMove(!0),$("body").on(that.touch.up,onTouchEnd)}function onTouchMove(e){e=that.event(e),drag.y=-1*(drag.starty-e.pageY),drag.mx=e.pageX-drag.startx,drag.px=e.pageX,drag.py=e.pageY,drag.st=!1,config.swipe&&!drag.mode&&Math.abs(drag.mx)>config.min_x&&(drag.mode="swipe",config.scroll&&!drag.st&&(drag.st=!0,scroller.disable(),scroller.container().css("cssText","height:"+scroller.container().height()+"px !important;")),config.reorder&&listenTouchHold(!1),listenSwipeMove(!0))}function onTouchHold(){if(!drag.mode&&(new Date).getTime()-drag.stime>config.hold_time){drag.mode="reorder";var e=drag.target.data("ogx-id"),t=getWorkList();drag.item=t.find(key,e,1),container.trigger(OGX.DynamicList.HOLD,drag.item),listenTouchHold(!1),setTimeout(startDrag(),0)}}function onTouchEnd(e){if($("body").off(that.touch.up,onTouchEnd),(config.reorder||config.swipe)&&(clearInterval(drag_intv),drag_intv=!1,listenTouchMove(!1)),config.swipe&&listenSwipeMove(!1),config.reorder&&listenTouchHold(!1),config.scroll&&(scroller.enable(),scroller.container().removeAttr("style")),config.reorder){if("reorder"===drag.mode&&(container.off(that.touch.move,handleMove),drag.clone)){var t=JSON.parse(JSON.stringify(config.list[drag.si]));return config.list.delete(drag.si),config.list.insert(t,drag.ei),drag.clone.remove(),drag.clone=!1,drag.target.removeClass("ogx_dynamic_list_frozen"),void container.trigger(OGX.DynamicList.DROP,drag.item)}var i=drag.target.data("ogx-id"),a=config.list.find(key,i,1);config.callbacks.select(a),container.trigger(OGX.DynamicList.SELECT,a),that.select(key,i)}else if(config.swipe&&"swipe"===drag.mode){var n=drag.target.outerWidth(!0),o=Math.abs(100*drag.mx/n);o<50?o?(drag.target.addClass("ogx_dynamic_list_swiper_trans_item_restore"),drag.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX(0px)")):(drag.target.next(".ogx_dynamic_list_swiper_back_item").remove(),drag.target.css("transform","translateX(0px)")):drag.mx>0?(drag.target.attr("data-side","left"),drag.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX("+n+"px)")):(drag.target.attr("data-side","right"),drag.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX("+-1*n+"px)"))}drag.mode=!1}function listenSwipeMove(e){e?move_intv=setInterval(onSwipeMove,config.interval):(clearInterval(move_intv),move_intv=!1)}function onSwipeMove(){if("swipe"===drag.mode&&Math.abs(drag.mx)>config.min_x){var e=parseInt(drag.target.css("border-top-width").split("px")[0]),t=parseInt(drag.target.css("border-bottom-width").split("px")[0]),i=drag.target.outerHeight();if(!drag.target.hasClass("ogx_dynamic_list_swiper_work")){drag.target.addClass("ogx_dynamic_list_swiper_work");var a={};a.height=i,a.margin=-2*(e+t),a.top=drag.target.position().top,a.zindex=config.zindex;var n="";config.swipe.template?n=OGX.Templater.get(config.swipe.template):config.swipe.html&&(n=config.swipe.html),a.template=n,n=OGX.Templater.make(config.swipe_template,a),drag.target.after(n)}if(config.swipe.mode===OGX.DynamicList.SWIPE_MODE_SIDE&&(drag.mx<0?(swipe_dir=1,drag.target.next(".ogx_dynamic_list_swiper_back_item").addClass("ogx_dynamic_list_swiper_side_left").removeClass("ogx_dynamic_list_swiper_side_right")):(swipe_dir=-1,drag.target.next(".ogx_dynamic_list_swiper_back_item").addClass("ogx_dynamic_list_swiper_side_right").removeClass("ogx_dynamic_list_swiper_side_left"))),drag.py>=drag.target.offset().top&&drag.py<=drag.target.offset().top+i){drag.target.css("transform","translateX("+drag.mx+"px)");var o=drag.target.next(".ogx_dynamic_list_swiper_back_item");drag.mx<0?o.addClass("ogx_dynamic_list_swiper_right").removeClass("ogx_dynamic_list_swiper_left"):o.addClass("ogx_dynamic_list_swiper_left").removeClass("ogx_dynamic_list_swiper_right")}else onTouchEnd(drag.target)}}function listenTrans(e){e?container.on("transitionend",".ogx_dynamic_list_swiper_trans_item",onTransEnd):container.off("transitionend",".ogx_dynamic_list_swiper_trans_item",onTransEnd)}function onTransEnd(e){var t=$(this),i=t.next(".ogx_dynamic_list_swiper_back_item");if(t.hasClass("ogx_dynamic_list_swiper_trans_item_restore"))i.remove(),t.css("transform","translateX(0px)"),t.removeClass("ogx_dynamic_list_swiper_trans_item");else{var a,n=t.index(),o=t.data("ogx-id");switch(config.swipe.mode){case OGX.DynamicList.SWIPE_MODE_DELETE:t.remove(),shrink(i),a=config.list.findDelete(config.key,String(o),1),container.trigger(OGX.DynamicList.DELETE,{item:a,index:n});break;case OGX.DynamicList.SWIPE_MODE_SIDE:var r;a=config.list.find(config.key,o,1),r=-1===swipe_dir?"right":"left",container.trigger(OGX.DynamicList.SIDED,{side:r,item:a,index:n});break;case OGX.DynamicList.SWIPE_MODE_CUSTOM:}}t.removeClass("ogx_dynamic_list_swiper_work"),t.removeClass("ogx_dynamic_list_swiper_trans_item_restore")}function shrink(e,t){e.addClass("ogx_dynamic_list_swiper_delete"),e.on("transitionend",(function(){e.off("transitionend"),e.remove()}))}function startDrag(){drag.tgy=drag.target.position().top,drag.tgx=drag.target.position().left,drag.y=0;var e=drag.target.outerWidth(),t=drag.target.outerHeight();drag.clone=drag.target.clone().css({position:"absolute",left:drag.tgx+"px",top:drag.tgy+"px",width:e+"px",height:t+"px"}).addClass("ogx_dynamic_list_reorder").prependTo(container),drag.clone.addClass("ogx_dynamic_list_drag"),drag.target.addClass("ogx_dynamic_list_frozen"),drag_intv=setInterval(handleDrag,config.interval),container.on(that.touch.move,handleMove)}function handleMove(e){e.preventDefault(),e.stopImmediatePropagation(),e=that.event(e),drag.y=-1*(drag.starty-e.pageY)}function handleDrag(){if(Math.abs(container.offset().top-drag.cy)>1)return clearInterval(drag_intv),drag_intv=!1,drag.clone.remove(),drag.clone=!1,drag.target.removeClass("ogx_dynamic_list_frozen"),void container.trigger(OGX.DynamicList.RELEASE);var e=!1,t=container.children(".ogx_dynamic_list_item:last"),i=t.offset().top+-1*drag.cy;if(drag.tgy+drag.y<i?drag.clone.css({top:drag.tgy+drag.y}):e=t,!e){var a,n,o,r,s=0;container.children(".ogx_dynamic_list_item").each((function(t,i){if((i=$(i))[0]!==drag.clone[0]&&!i.hasClass("ogx_dynamic_list_frozen")){if(a=i.offset().top,n=i.outerHeight(),r=a+n/2,(o=drag.clone.offset().top)>a&&o<r)return s=-1,void(e=i);if(o>r&&o<a+n)return s=1,void(e=i)}}))}if(e){var l,d=$(e).data("ogx-id");switch(drag.ei=config.list.findIndex(key,d).index,s){case-1:e.index()-1!==drag.target.index()&&((l=drag.target.detach()).removeClass("ogx_dynamic_list_drag"),l.insertBefore(e));break;case 1:e.index()+1!==drag.target.index()&&((l=drag.target.detach()).removeClass("ogx_dynamic_list_drag"),l.insertAfter(e))}e=!1}}function onClick(e){var t=$(this);switch(config.mode){case OGX.DynamicList.SELECT_MODE_SINGLE:!config.reselect&&t.hasClass("ogx_dynamic_list_selected_item")||t.hasClass("ogx_dynamic_list_swiper_trans_item")||(n=selectIndex(t.index(),!0))&&(config.callbacks.select(n),container.trigger(OGX.DynamicList.SELECT,n));break;case OGX.DynamicList.SELECT_MODE_TOGGLE:t.hasClass("ogx_dynamic_list_selected_item")||t.hasClass("ogx_dynamic_list_swiper_trans_item")?(n=selectIndex(t.index(),!1),config.callbacks.unselect(n),container.trigger(OGX.DynamicList.UNSELECT,n)):(that.resetSelection(),(n=selectIndex(t.index(),!0))&&(config.callbacks.select(n),container.trigger(OGX.DynamicList.SELECT,n)));break;case OGX.DynamicList.SELECT_MODE_MULTI:t.hasClass("ogx_dynamic_list_selected_item")||t.hasClass("ogx_dynamic_list_swiper_trans_item")?(n=selectIndex(t.index(),!1),config.callbacks.unselect(n),container.trigger(OGX.DynamicList.UNSELECT,n)):(n=selectIndex(t.index(),!0))&&(config.callbacks.select(n),container.trigger(OGX.DynamicList.SELECT,n));break;case OGX.DynamicList.SELECT_MODE_HIT:var i=getWorkList();if(t.hasClass("ogx_dynamic_list_swiper_back_item")){var a="left";t.hasClass("ogx_dynamic_list_swiper_side_right")&&(a="right"),container.trigger(OGX.DynamicList.BACK_HIT,{side:a,item:i[t.index()]})}else{var n=i[t.index()];config.callbacks.select(n),container.trigger(OGX.DynamicList.SELECT,n)}}}function select(e,t,i){var a=null;"single"===config.mode&&(that.resetSelection(),a=1);var n,o,r=getWorkList(),s={};Array.isArray(t)?(s[e]={in:t},sel=r.get(s,null,a)):(s[e]={eq:t},sel=r.get(s)),sel&&!Array.isArray(sel)&&(sel=[sel]);for(var l=0;l<sel.length;l++)o=toDataId(sel[l][key]),(n=container.find(".ogx_dynamic_list_item[data-ogx-id="+o+"]"))&&(i?(n.addClass("ogx_dynamic_list_selected_item"),selection.push(sel[l])):(n.removeClass("ogx_dynamic_list_selected_item"),selection.findDelete(key,sel[l][key],1)));return"single"===config.mode&&sel.length?sel[0]:sel}function selectIndex(e,t){var i,a,n=getWorkList();if((i=container.find(".ogx_dynamic_list_item:eq("+e+")")).length>0){config.mode===OGX.DynamicList.SELECT_MODE_SINGLE&&that.resetSelection();var o=i.data("ogx-id");return isSelectable(a=n.find(key,o,1))&&(t?(i.addClass("ogx_dynamic_list_selected_item"),selection.push(n[e])):(i.removeClass("ogx_dynamic_list_selected_item"),selection.findDelete(key,o,1))),a}return!1}function getWorkList(){return isFiltered?filtered:config.list}function toDataId(e){return"string"==typeof e&&(e='"'+e+'"'),e}function forceIds(){for(var e=0;e<config.list.length;e++)config.list[e][key]=key_id,key_id++}function clearIds(e){for(var t=0;t<e.length;t++)delete e[t][key];return e}function finalize(){config.selection.length&&that.observeOnce({childList:!0,subtree:!0},(function(){for(var e=0;e<config.selection.length;e++)that.select(key,config.selection[e])})),that.val(config.list,!1,!1),ready=!0,!that.blured&&config.enabled&&listenItems(!0),!0===config.scope&&listenScope(!0),container.trigger(OGX.DynamicList.READY)}function checkMissing(){OGX.hasOwnProperty("Tags")||(OGX.Tags={NAME:"OgxTags"}),OGX.hasOwnProperty("Switch")||(OGX.Switch={NAME:"OgxSwitch"}),OGX.hasOwnProperty("Roulette")||(OGX.Roulette={NAME:"OgxRoulette"})}function initDefaults(){config||(config={}),OGX.Data.merge(config,config_default),config.list.hasOwnProperty("_NAME_")||(config.list=new OGX.List(config.list)),!config.key&&config.list.length>0?(key=key_default,forceIds()):key=config.key,config.swipe&&("object"!=typeof config.swipe&&(config.swipe={}),OGX.Data.merge(config.swipe,swipe_default)),config.callbacks.select||(config.callbacks.select=that.onSelect),config.callbacks.unselect||(config.callbacks.unselect=that.onUnselect),config.callbacks.render||(config.callbacks.render=that.onRender),(container=that.el).addClass("ogx_dynamic_list")}function init(){void 0!==OGX.Templater?void 0!==OGX.List?void 0!==OGX.Display?(checkMissing(),initDefaults(),finalize(),config.scroll&&(scroller=that.find("Scroller",config.id+"_scroller")),debug(5,"dyanmiclist",config.id,"init")):debug(1,"OGX.Display not found! "):debug(1,"OGX.List not found! "):debug(1,"OGX.Templater not found! ")}this.onFocus=e=>(debug(5,"dynamicList",this.id,"enabled"),void 0===e&&(e=!1),(e||config.mode!==OGX.DynamicList.STATIC)&&(listenItems(!0),(config.reorder||config.swipe)&&(listenTouch(!0),config.swipe&&listenTrans(!0))),this),this.onBlur=e=>(debug(5,"dynamicList",this.id,"disabled"),void 0===e&&(e=!1),(e||config.mode!==OGX.DynamicList.STATIC)&&(listenItems(!1),(config.reorder||config.swipe)&&(listenTouch(!1),config.swipe&&listenTrans(!1))),this),this.bindFilter=(e,t,i)=>{debug(4,"dynamicList",this.id,"filter",e,JSON.stringify(i)),void 0!==i&&(config.list.removeFilter(e),config.list.addFilter(e,t,i)),config.list.getFilters()&&(filtered=config.list.filter(),isFiltered=!0),setTimeout(render,0)},this.unbindFilter=e=>(config.list.removeFilter(e),filtered=config.list.filter(),isFiltered=!0,setTimeout(render,0),this),this.bindValue=()=>this.getSelection(),this.destroy=()=>{!0===config.scope&&listenScope(!1),this.clearBinds(),container.empty(),container.removeClass("ogx_dynamic_list")},this.val=(e,t,i)=>{if(void 0===e){if(!config.key){var a=JSON.parse(JSON.stringify(config.list));return clearIds(OGX.List(a))}return config.list}var n;debug(4,"dynamicList",this.id,"set",e.length,"items"),void 0===t&&(t=!1),void 0===i&&(i=!0),e.hasOwnProperty("insert")||(e=new OGX.List(e)),this.resetSelection(),t||(n=config.list.getFilters()),config.list=e,config.key&&key!==key_default||(key_id=1,key=key_default,e=JSON.parse(JSON.stringify(e)),forceIds()),!t&&Object.keys(n).length?(config.list.setFilters(n),setTimeout(this.filter,0)):i?setTimeout(render,0):render()},this.scope=e=>"undefined"!=typeof __script&&"string"==typeof config.scope?(config.scope=e,void this.render()):config.scope,this.onSelect=e=>{},this.onUnselect=e=>{},this.onRender=()=>{},this.getFilteredList=()=>{if(isFiltered){if(!config.key){var e=JSON.parse(JSON.stringify(filtered));return clearIds(OGX.List(e))}return filtered}return!1},this.display=e=>void 0===e?config.display:display.val(e),this.key=e=>{if(void 0===e)return e;config.key=e,config.key||(key=key_default)},this.mode=e=>void 0===e?config.mode:(config.mode!==e&&(config.mode===OGX.DynamicList.STATIC?this.onFocus(!0):e===OGX.DynamicList.STATIC&&this.onBlur(!0),config.mode=e),this),this.noSelection=(e,t)=>1===arguments.length?"object"==typeof e?void(config.no_selection=e):void(config.no_selection.enabled=e):2===arguments.length?(config.no_selection.enabled=!0,config.no_selection.prop=e,void(config.no_selection.val=t)):config.no_selection,this.order=(e,t)=>(config.list.order(e,t),setTimeout(render,0),this),this.filter=()=>(debug(4,"dynamicList",config.id,"filtering with",Object.keys(config.list.getFilters()).length,"filters"),filtered=config.list.filter(),isFiltered=!0,setTimeout(render,0),filtered),this.unfilter=()=>(isFiltered=!1,setTimeout(render,0),this),this.addFilter=(e,t,i)=>config.list.addFilter(e,t,i),this.removeFilter=(e,t,i)=>config.list.removeFilter(e,t,i),this.resetFilters=()=>config.list.resetFilters(),this.getFilters=()=>config.list.getFilters(),this.insert=(e,t)=>{if(!Array.isArray(e)){config.key||(e[key]=key_id++);var i=!1,a=!0;if(isFiltered){var n=new OGX.List(e);n.setFilters(config.list.getFilters()),0===n.filter().length?a=!1:filtered.push(e)}var o=toDataId(e[key]),r='<div class="ogx_dynamic_list_item '+display.css(e)+'" data-ogx-id='+o+"></div>",s=display.oml('.ogx_dynamic_list[data-ogx-id="'+this.id+'"] .ogx_dynamic_list_item[data-ogx-id='+o+"]",e,config.as);if(void 0===t)config.list.push(e),a&&container.append(r);else if(config.list.insert(e,t),a&&(isFiltered?i=(filtered=config.list.filter()).findIndex(key,e[key]):0===t?container.prepend(r):i=config.list.findIndex(key,e[key]),i)){var l=container.children(".ogx_dynamic_list_item:nth-child("+(i.index+1)+")");l.length>0?l.before(r):container.append(r)}return this.parse(s),config.trigger&&container.trigger(OGX.DynamicList.RENDER),this.onRender(),a}for(var d=0;d<e.length;d++)void 0!==t?this.insert(e[d],t+d):this.insert(e[d])},this.delete=e=>{var t=getWorkList().delete(e);if(t){config.list.findDelete(key,t[key],1),isFiltered&&filtered.findDelete(key,t[key],1);var i=container.children(".ogx_dynamic_list_item:eq("+e+")");return this.remove(t[key]),i.remove(),!0}return!1},this.deleteSelection=()=>{for(var e=0;e<selection.length;e++)config.list.findDelete(key,selection[e][key],1),isFiltered&&filtered.findDelete(key,selection[e][key],1),this.remove(selection[e][key]),container.children(".ogx_dynamic_list_selected_item").remove();return!0},this.findDelete=(e,t,i)=>{void 0===i&&1===arguments.length&&(t=e,e=key);var a,n,o,r=config.list.findDelete(e,t,i);r&&!Array.isArray(r)&&(r=[r]);for(var s=0;s<r.length;s++)isFiltered&&filtered.findDelete(e,t,i),o=toDataId(r[s][key]),n=(a=container.children(".ogx_dynamic_list_item[data-ogx-id="+o+"]")).next(".ogx_dynamic_list_swiper_back_item"),a.remove(),this.remove(r[s][key]),shrink(n);return 1===i?r[0]:r},this.findIndex=(e,t)=>{1===arguments.length&&(t=e,e=key);var i=config.list.find(e,t,1);if(i){var a=toDataId(i[key]);return container.children(".ogx_dynamic_list_item[data-ogx-id="+a+"]").index()}return-1},this.findReplace=(e,t,i)=>{2===arguments.length&&(i=t,t=e,e=key),config.key||(i[key]=key_id++);var a=config.list.findReplace(e,t,i,1);if(a){isFiltered&&filtered.findReplace(e,t,i,1);var n=toDataId(a[key]),o=container.children(".ogx_dynamic_list_item[data-ogx-id="+n+"]").first();return o.length&&(o.attr("data-ogx-id",i[key]),replace(o,key,i),config.trigger&&container.trigger(OGX.DynamicList.RENDER),this.onRender()),!0}return!1},this.replaceAt=(e,t)=>{var i=getWorkList();if(void 0===i[e])return!1;if(config.key)i[e]=t;else{var a=i[e][key];i[e]=t,i[e].key=a}return this.refreshAt(e)},this.select=(e,t)=>(void 0===t&&(t=e,e=key),select(e,t,!0)),this.selectIndex=e=>selectIndex(e,!0),this.index=e=>{if(void 0!==e){var t=getWorkList();return this.select(key,t[e][key])}return container.children(".ogx_dynamic_list_selected_item").index()},this.unselect=(e,t)=>(void 0===t&&(t=e,e=key),select(e,t,!1)),this.unselectIndex=e=>selectIndex(e,!1),this.resetSelection=()=>(selection=new OGX.List,container.children(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item"),this),this.getSelection=e=>{if(void 0===e&&(e=!1),!e){var t,i=selection;if(isFiltered&&(selection.resetFilters(),selection.setFilters(config.list.getFilters()),i=selection.filter()),config.key)t=i;else t=clearIds(OGX.Data.clone(i));return config.mode===OGX.DynamicList.SELECT_MODE_SINGLE?!!t.length&&t[0]:t=new OGX.List(t)}return container.children(".ogx_dynamic_list_selected_item")},this.getElement=(e,t)=>{1===arguments.length&&(t=e,e=key);var i=config.list.find(e,t,1);if(i){var a=toDataId(i[key]);return container.children(".ogx_dynamic_list_item[data-ogx-id="+a+"]")[0]}return!1},this.findUpdate=(e,t,i,a,n,o)=>{var r;"number"==typeof a&&(o=n,Array.prototype.unshift.call(arguments,key)),void 0===o&&(o=!0);var s=config.list.findUpdate.apply(config.list,arguments);if(s&&!Array.isArray(s)&&(s=[s]),s.length&&o){var l;isFiltered&&filtered.findUpdate.apply(filtered,arguments);for(var d=0;d<s.length;d++)l=toDataId(s[d][key]),(r=container.children(".ogx_dynamic_list_item[data-ogx-id="+l+"]").first()).length&&(replace(r,key,s[d]),config.trigger&&container.trigger(OGX.DynamicList.RENDER),this.onRender());return s.length}return!1},this.update=(e,t,i,a,n)=>{void 0===n&&(n=!0);var o=config.list.update(e,t,i,a);if(o&&!Array.isArray(o)&&(o=[o]),o.length&&n){var r;isFiltered&&filtered.update(arguments);for(var s=0;s<o.length;s++)r=toDataId(o[s][key]),el=container.children(".ogx_dynamic_list_item[data-ogx-id="+r+"]").first(),el.length&&(replace(el,key,o[s]),config.trigger&&container.trigger(OGX.DynamicList.RENDER),this.onRender());return o.length}return!1},this.refresh=(e,t,i)=>{var a=arguments.length;void 0!==i&&a--,1===a&&(t=e,e=key);var n=config.list.find(e,t,i);if(n&&(1===i&&(n=[n]),n.length))for(var o,r,s=0;s<n.length;s++)r=toDataId(n[s][key]),(o=container.children(".ogx_dynamic_list_item[data-ogx-id="+r+"]")).length>0&&replace(o,key,n[s]);return this},this.refreshAt=e=>{var t=getWorkList();if(void 0!==t[e]){var i=toDataId(t[e][key]),a=container.children(".ogx_dynamic_list_item[data-ogx-id="+i+"]");if(a.length>0)return replace(a,key,t[e]),!0}return!1},this.restore=(e,t)=>{1===arguments.length&&(t=e,e=key);var i=toDataId(config.list.find(e,t,1)[key]),a=container.children(".ogx_dynamic_list_item[data-ogx-id="+i+"]");a.addClass("ogx_dynamic_list_swiper_trans_item_restore"),a.css({transform:"translateX(0px)","z-index":config.zindex+1}),setTimeout((()=>{a.next(".ogx_dynamic_list_swiper_back_item").remove()}),200)},this.wipe=()=>(container.empty(),this),this.clear=()=>(debug(2,"DynamicList clear is deprecated, used wipe instead"),this.wipe(),this),this.reset=()=>(container.empty(),isFiltered=!1,config.list=new OGX.List,selection=new OGX.List,filtered=new OGX.List,this),this.render=()=>(setTimeout(render,0),this),init()},OGX.DynamicList.HOLD="DynamicListHold",OGX.DynamicList.RELEASE="DynamicListRelease",OGX.DynamicList.DROP="DynamicListDrop",OGX.DynamicList.SELECT="DynamicListSelect",OGX.DynamicList.DELETE="DynamicListDelete",OGX.DynamicList.SIDED="DynamicListSided",OGX.DynamicList.BACK_HIT="DynamicListBackHit",OGX.DynamicList.UNSELECT="DynamicListUnselect",OGX.DynamicList.RENDER="DynamicListRender",OGX.DynamicList.SELECT_MODE_SINGLE="single",OGX.DynamicList.SELECT_MODE_TOGGLE="toggle",OGX.DynamicList.SELECT_MODE_MULTI="multi",OGX.DynamicList.SELECT_MODE_HIT="hit",OGX.DynamicList.SELECT_FILTERED="DynamicListSelectFiltered",OGX.DynamicList.SELECT_UNFILTERED="DynamicListSelecUnfiltered",OGX.DynamicList.STATIC="static",OGX.DynamicList.SWIPE_LEFT="DynamicListSwipeLeft",OGX.DynamicList.SWIPE_RIGHT="DynamicListSwipeRight",OGX.DynamicList.SWIPE_MODE_DELETE="DynamicListSwipeModeDelete",OGX.DynamicList.SWIPE_MODE_SIDE="DynamicListSwipeModeSide",OGX.DynamicList.SWIPE_MODE_CUSTOM="DynamicListSwipeModeCustom",OGX.DynamicList.READY="DynamicListReady",OGX.DynamicList.BIND=OGX.DynamicList.SELECT+" "+OGX.DynamicList.UNSELECT,void 0===OGX)var OGX={};if(OGX.Fonction=function(__config,__data,__route_data){var that=this,config=__config,config_default={id:1,parent:null,fnc:null,data:null,success:null,error:null};OGX.Data.merge(config,config_default,!1);var fnc=eval(config.fnc),oml,promise=fnc.apply(null,[config.data]);promise.then((function(e){debug(3,"Promise success"),OGX.OML.result(config.id,e),oml=config.success,OGX.OML.render(config.parent,oml,__data,__route_data)}),(function(e){debug(1,"Promise error"),OGX.OML.result(config.id,e),oml=config.error,OGX.OML.render(config.parent,oml,__data,__route_data)}))},void 0===OGX)var OGX={};if(OGX.Form=function(){"use strict";var e=this,t={el:!1,allowed:!1,forbidden:!1,change_cb:!1,submit_cb:!1,validate:!1,diff:!0,params:null,elem_types:["input","select","textarea"],wait:1e3,fields:{},buffer:null},i={el:!1,allowed:/[0-9a-zA-Z‘’'"à-úÀ-Ú\\-\\!\\.\\?\\#\\@\\$\\:\\(\\)\\/_,;%' ]/,forbidden:/[<>]/,pattern:!1,validate:!1,mask:!1,mask_char:"%",paste:!0,autocomplete:null,multiline:!1,input_cb:!1,change_cb:!1,diff:!0,val:null,last_change:!1,wait:2e3,intv:!1,max:2500,type:"string",params:null},a=new OGX.List,n=new OGX.List,o=!1;function r(t,i){if(!o){var n,r=a.find("el",i,1);if(r&&r.config.change_cb){for(var s in r.fields)if(r.fields[s].intv)return;var d=c(r.form);for(var u in d)r.config.fields.hasOwnProperty(u)&&r.config.fields[u].hasOwnProperty("type")?d[u]=l(r.config.fields[u].type,d[u]):r.config.hasOwnProperty("type")&&(d[u]=l(r.config.type,d[u]));if(n=JSON.stringify(d),!r.diff||r.val!==n){var h;if(r.val=n,r.config.validate){h={obj:d,form:i,valid:!1};var g=e.validate(r.form);!0===g?h.valid=!0:(h.valid=!1,h.error=g)}else h=d;r.config.params&&(h.params=r.config.params),r.buffer&&clearTimeout(r.buffer),r.buffer=setTimeout((()=>{r.config.change_cb(h)}),10)}}}}function s(t){var i={el:t.el,config:t,field:$(t.el),intv:!1};i.name=i.field.attr("name"),i.val=i.field.val(),i.field.val(i.val),t.pattern&&i.field.attr("pattern",t.pattern),a.insert(i),$(document).on("input change",i.el,(function(e){if(!o){var t=$(this).val();if(!i.config.diff||i.config.diff&&t!==i.val){if(i.config.input_cb){var a={value:null,obj:{},el:null};t=l(i.config.type,t),a.el=i.field[0],a.value=t,a.property=i.name,a.obj[i.name]=t,i.config.input_cb(a,i.config.params)}i.intv&&clearTimeout(i.intv),i.intv=setTimeout((()=>{!function(e){var t=$(e.el).val();if(e.val=t,e.config.change_cb){var i={value:null,obj:{},el:null};t=l(e.config.type,t),i.el=e.field[0],i.property=e.name,i.value=t,i.obj[i.property]=t,e.config.validate&&(i.valid=i.el.checkValidity()),e.config.change_cb(i,e.config.params)}}(i)}),i.config.wait)}}})),t.multiline||$(document).on("keydown",i.el,(function(e){var t=$(this);if(void 0!==e.which&&void 0!==e.key){if(!o){if(i.config.mask&&8===e.which||46===e.which){var a=t[0].selectionStart,n=t.val();return n=8===e.which?n.substr(0,a-1):n.substr(0,a),t.val(n),!1}if(8!==e.which&&13!==e.which&&1===e.key.length){var r=e.key;if(13!==e.which&&i.config.mask){if((n=t.val()).length>=i.config.mask.length)return e.preventDefault(),e.stopImmediatePropagation(),!1;for(var s=i.config.mask,d=0;d<n.length;d++)i.config.mask.substr(d,1)===i.config.mask_char&&(s=s.replace(i.config.mask_char,n.substr(d,1)));var c=s.indexOf(i.config.mask_char),u=!1;return c+1<s.length+1&&(u=s.substr(c+1,1)),-1!==c&&(r===i.config.mask.substr(s.indexOf(i.config.mask_char)-1,1)?s=s.substr(0,s.indexOf(i.config.mask_char)-1):(s=s.substr(0,s.indexOf(i.config.mask_char)),u&&u!==i.config.mask_char&&setTimeout((()=>{i.field.val(s+r+u)}),0))),void i.field.val(s)}}if(13===e.which){e.preventDefault(),e.stopImmediatePropagation();n=$(this).val();if(i.intv&&(clearInterval(i.intv),i.intv=null),i.config.change_cb){var h={value:null,obj:{},el:null};n=l(i.config.type,n),h.el=i.field[0],h.property=i.name,h.value=n,h.obj[i.name]=n,i.config.validate&&(h.valid=i.field[0].checkValidity()),i.config.change_cb(h,i.config.params)}else i.field.trigger("change",n)}}}else i.config.mask&&setTimeout((()=>{for(var e=t.val(),a="",n=0,o=0;o<i.config.mask.length&&o-n!==e.length;o++)i.config.mask.substr(o,1)===i.config.mask_char||i.config.mask.substr(o,1)===e.substr(o-n,1)?a+=e.substr(o-n,1):i.config.mask.substr(o,1)!==i.config.mask_char&&(a+=i.config.mask.substr(o,1),o&&n++);t.val(a)}),0)})),(i.config.allowed||i.config.forbidden)&&e.restrictField(i.config)}function l(e,t){switch(e){case"string":return String(t);case"number":return Number(t);case"int":return parseInt(t);case"bool":if([!0,"true",1].includes(t))return!0;case"json":return JSON.parse(t)}return!1}function d(){for(var e=0;e<a.length;e++)a[e].hasOwnProperty("field")&&a[e].field.length&&(a[e].val=$(a[e].field[0]).val())}function c(e){return $(e).serializeArray().map(function(e){return this[e.name]=e.value,this}.bind({}))[0]}this.updateBind=(e,t)=>{var i=this.getBind(e);return i?!!i&&(OGX.Data.merge(i.config,t,!0,!1,!1),!0):(debug(1,"Bind "+e+" not found"),!1)},this.getBind=e=>a.get({el:{in:e}},null,null,1),this.bindForm=n=>!a.find("el",n.el,1)&&(OGX.Data.merge(n,t,!1),function(t){for(var n,l,d={el:t.el,config:t,form:$(t.el),fields:new OGX.List,val:""},u=0;u<t.elem_types.length;u++)d.form.find(t.elem_types[u]).each((function(e,a){a.hasAttribute("name")&&(l=a.getAttribute("name"),n=OGX.Data.clone(i),OGX.Data.merge(n,t,!0,!1,!0),t.fields.hasOwnProperty(l)&&(n=OGX.Data.merge(n,t.fields[l],!0)),n.el=t.el+" "+t.elem_types[u]+'[name="'+l+'"]',n.change_cb=r,n.params=t.el,s(n),d.fields.insert({el:n.el}))}));d.form.on("submit",(function(t){if(t.preventDefault(),t.stopImmediatePropagation(),!o){var i={obj:c(d.el),form:d.el};if(d.config.params&&(i.params=d.config.params),d.config.validate){var a=e.validate(d.el);!0===a?i.valid=!0:(i.valid=!1,i.error=a)}d.config.submit_cb?d.config.submit_cb(i):d.form.trigger("submit",i)}})),a.insert(d)}(n),!0),this.enable=()=>{o&&(o=!1)},this.disable=()=>{o||(o=!0)},this.change=e=>{var t=a.get({el:{eq:e}},null,1);t&&t.fields.length&&r(this.toObj(t.el),t.el)},this.unbindForm=e=>{if(void 0===e)unbindAll("form");else{var t=a.find("el",e,1);if(t){for(var i in $(document).off("submit",t.el),t.fields)this.unbindField(t.fields[i].el);a.findDelete("el",e,1)}}},this.unbindAll=t=>{void 0===t&&(t="all");for(var i=0;i<a.length;i++)["form","all"].includes(t)&&a[i].hasOwnProperty("fields")?e.unbindForm(a[i].el):["field","all"].includes(t)&&!a[i].hasOwnProperty("fields")&&e.unbindField(a[i].el)},this.bindField=e=>!a.find("el",e.el,1)&&(OGX.Data.merge(e,i),s(e),!0),this.unbindField=function(e){if(!a.find("el",e,1))return!1;var t=a.find("el",e,1);t&&($(document).off("input change",t.el),t.config.multiline||$(document).off("keydown",t.el),t.intv&&clearInterval(t.intv),n.find("el",t.el,1)&&this.unrestrictField(t.el),a.findDelete("el",t.el,1))},this.restrictField=function(e){return!n.find("el",e.el,1)&&(OGX.Data.merge(e,i),function(e){var t={el:e.el,config:e,field:$(e.el),keys:[],content:null},i=[8,9];null===e.autocomplete&&t.field[0].hasAttribute("autocomplete")&&"off"!==t.field.attr("autocomplete")?t.config.autocomplete=!0:t.config.autocomplete=e.autocomplete;e.autocomplete||t.keys.push(229);-1!==["input","texarea"].indexOf(t.field.get(0).tagName.toLowerCase())?t.content="val":t.content="html";t.config.multiline||t.keys.push(13);$(document).on("textInput keydown",t.el,(function(e){if("keydown"===e.type&&8==e.keyCode||46==e.keyCode)$(this).trigger("input");else if("textInput"===e.type){var a=e.originalEvent.data;if(a.length>1)return t.config.autocomplete?void 0:(e.preventDefault(),e.stopImmediatePropagation(),!1);if(1===a.length&&-1!==t.keys.indexOf(e.which)&&-1===e.which.indexOf(i))return e.preventDefault(),e.stopImmediatePropagation(),!1;if(t.config.multiline&&13===e.keyCode)return!1;if(t.config.allowed&&!a.match(t.config.allowed))return e.preventDefault(),e.stopImmediatePropagation(),!1;if(t.config.forbidden&&a.match(t.config.forbidden))return e.preventDefault(),e.stopImmediatePropagation(),!1;if($(e.originalEvent.target)[t.content]().length>=t.config.max)return e.preventDefault(),e.stopImmediatePropagation(),!1}})),$(document).on("paste",t.el,(function(e){if(!t.config.paste)return e.preventDefault(),e.stopImmediatePropagation(),!1;var i=e.originalEvent.clipboardData.getData("Text");return t.config.forbidden&&i.match(t.config.forbidden)?(e.preventDefault(),e.stopImmediatePropagation(),!1):void 0})),n.insert(t)}(e),!0)},this.unrestrictField=function(e){if(!n.find("el",e,1))return!1;var t=n.find("el",e,1);return!!t&&($(document).off("textInput keydown",t.el),$(document).off("paste",t.el),n.findDelete("el",e,1),!0)},this.toObj=function(e){return c(e)},this.populate=function(e,t,i){var a,n,o;void 0===i&&(i=null),$(e).find("*[name]").each((function(e,r){a=r.getAttribute("name"),o=!1,"string"!=typeof(o=OGX.Data.eval(t,a))&&(o=JSON.stringify(o)),void 0!==o&&(i&&i.hasOwnProperty(a)&&"function"==typeof i[a]&&(o=i[a](o)),(n=$(r)).val(o),r.hasAttribute("type")&&"hidden"===n.attr("type")&&n.trigger("change"))})),setTimeout(d,0)},this.validate=function(e){var i,a=$(e),n=t.elem_types,o=[];return a.find(n.join(",")).each((function(e,t){"submit"!==(i=$(t)).attr("type")&&(t.checkValidity()||o.push(i))})),!o.length||o}},OGX.Form=new OGX.Form,OGX.Form.fromObject=function(e,t,i,a){var n={el:t.selector+" "+i,data:e,fullpath:!1};return OGX.Data.merge(n,a),t.create("FormInstance",n)},void 0===OGX)var OGX={};if(require("FormInstance","Uxi","Placeholder"),OGX.FormInstance=function(__config){construct(this,"FormInstance");var that=this,config_defaults={fullpath:!1},config=OGX.Data.merge(__config,OGX.Form.defaults,!1,!0);function render(){var html="",oml='{"default:Html":{"html": {{$html}}, "node:OML": {{$oml}}  }}',render_oml=!1,row,nodes=[];function cycle(__o,__path){for(var a in __o){var t=typeof __o[a],p;switch(p=__path?__path+"."+a:a,t){case"object":if(Array.isArray(__o[a]))if(["string","number","boolean"].includes(typeof __o[a][0]))row=genRow("array",a,JSON.stringify(__o[a])),html+=row.html,row.oml&&(nodes.push(row.oml),render_oml=!0);else for(var i=0;i<__o[a].length;i++)cycle(__o[a][i],__path?__path+"."+a+"["+i+"]":a+"["+i+"]");else cycle(__o[a],__path?__path+"."+a:a);break;case"string":case"number":case"boolean":var pattern="",required=!1,readonly=!1,oo;if(config.hasOwnProperty("fields")){try{oo=eval("config.fields."+p)}catch(e){}void 0!==oo&&(oo.hasOwnProperty("pattern")&&(pattern=oo.pattern),oo.hasOwnProperty("required")&&(required=oo.required),oo.hasOwnProperty("readonly")&&(readonly=oo.readonly))}row=genRow(t,p,__o[a],required,pattern,readonly),html+=row.html,row.oml&&(nodes.push(row.oml),render_oml=!0)}}}cycle(config.data,null),html=OGX.Templater.make(OGX.Form.defaults.templates.form,{rows:html}),oml=render_oml?nodes.join(","):null,oml=JSON.parse(oml),oml=OGX.OML.rename(oml,that.selector),that.el.html(html),oml&&OGX.OML.render(that,oml)}function genRow(e,t,i,a,n,o){var r={html:"",oml:null},s=config.types[e],l="",d="",c="";void 0!==a&&a&&(l="required",d='pattern="'+n+'"'),void 0!==o&&o&&(c="readonly");var u=t;return config.fullpath||(u=t.split(".").pop()),r.html=OGX.Templater.make(s.html,{name:u,prop:t,val:i,required:l,pattern:d,readonly:c}),r.html=OGX.Templater.make(OGX.Form.defaults.templates.row,{html:r.html,name:u,prop:t}),s.hasOwnProperty("oml")&&(r.oml=OGX.Templater.make(s.oml,{name:u,prop:t,val:i,required:l,pattern:d,readonly:c})),r}function init(){that.el.addClass("ogx_form"),render(),setTimeout((()=>{OGX.Form.bindForm({el:that.selector+">form",change_cb:that.onChange,submit_cb:that.onSubmit})}),300)}OGX.Data.merge(config,config_defaults,!1),this.destroy=()=>{OGX.Form.unbindForm(that.selector)},this.onChange=e=>{},this.onSubmit=e=>{},init()},OGX.Form.defaults={templates:{form:"<form>{{$rows}}</form>",row:'<span class="row"><span class="label">{{$name}}</span>{{$html}}</span>'},types:{boolean:{html:'<span class="{{$name}}"></span>',oml:'{"default .{{$name}}:Switch":{"name" : "{{$prop}}", "val":{{$val}}, "editable" : {{!$readonly}} } }'},string:{html:'<input type="text" name="{{$prop}}" value="{{$val}}" {{$required}} {{$pattern}} {{$readonly}}>'},number:{html:'<input type="number" name="{{$prop}}" value="{{$val}}" {{$required}} {{$pattern}} {{$readonly}}>'},array:{html:'<span class="{{$name}}"></span>',oml:'{"default .{{$name}}:Tags":{"name" : "{{$prop}}", "editable" : {{!$readonly}}, "current_tags":{{$val}} } }'}}},void 0===OGX)var OGX={};if(OGX.Geo=function(e){"use strict";var t=this;void 0===e&&(e={});var i,a,n,o,r=OGX.Data.merge(e,{map:null,markers:[],icon:"",browser_loc:null});function s(e,i){for(var a,n={},o=0;o<e.length;o++){a=!1;for(var r=0;r<i.length;r++){for(var s=0;s<i[r].address_components.length;s++)if(-1!==i[r].address_components[s].types.indexOf(e[o][0])){n.hasOwnProperty(e[o][1])&&n[e[o][1]].length||(n[e[o][1]]=i[r].address_components[s].short_name),a=!0;break}if(a)break}}return n=t.clean(n)}function l(e){return e*(Math.PI/180)}function d(e){return Array.isArray(e)?new google.maps.LatLng(e[0],e[1]):"function"!=typeof e.lat?new google.maps.LatLng(e.lat,e.lng):e}function c(e){var t={gmap:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),raw:{lat:e.coords.latitude,lng:e.coords.longitude}};o?(o(t),o=null):$(document).trigger(OGX.Geo.BROWSER_LOC_SUCCESS,t)}function u(e){$(document).trigger(OGX.Geo.BROWSER_LOC_ERROR,e)}function h(){i||(i=new google.maps.Geocoder)}this.setMap=e=>{r.map=e,google.maps.event.addListenerOnce(r.map,"tilesloaded",(function(){$(document).trigger(OGX.Geo.MAP_LOADED)}))},this.getMap=()=>r.map,this.getMapRadius=()=>!!r.map&&function(){if(r.map){var e=r.map.getBounds(),t=e.getCenter(),i=e.getNorthEast(),a=3963,n=t.lat()/57.2958,o=t.lng()/57.2958,s=i.lat()/57.2958,l=i.lng()/57.2958;return a*Math.acos(Math.sin(n)*Math.sin(s)+Math.cos(n)*Math.cos(s)*Math.cos(l-o))}return!1}(),this.getCurrentLocation=()=>{return!!r.map&&(e=r.map.getCenter(),new google.maps.LatLng(e.lat(),e.lng()));var e},this.getBrowserLocation=e=>{o=void 0===e?null:e,navigator.geolocation.getCurrentPosition(c,u,{maximumAge:0,timeout:1e4,enableHighAccuracy:!0})},this.getDistance=(e,t,i,a)=>{var n=l(i-e),o=l(a-t),r=Math.sin(n/2)*Math.sin(n/2)+Math.cos(l(e))*Math.cos(l(i))*Math.sin(o/2)*Math.sin(o/2),s=6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return Math.round(1e3*s)/1e3},this.addressToLatLng=(e,t,a)=>{h(),i.geocode({address:e},(function(e,i){i==google.maps.GeocoderStatus.OK?t(e[0].geometry.location,a):t(!1,a)}))},this.getCityBoundaries=(e,t,a,n,o)=>{h(),i.geocode({address:e+", "+t+", "+a},((e,t)=>{t==google.maps.GeocoderStatus.OK?n(e[0].geometry,o):n(!1,o)}))},this.latLngToZip=(e,t,a)=>{e=d(e),h(),i.geocode({location:e},((e,i)=>{if(i===google.maps.GeocoderStatus.OK){var a=s([["postal_code","zip"]],e);t(a)}}))},this.latLngToCountryStateCity=(e,t,a)=>{e=d(e),h(),i.geocode({location:e},((e,i)=>{if(i===google.maps.GeocoderStatus.OK){var n=s([["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);t(n,a)}else t(!1,a)}))},this.partialAddressToCountryStateCity=(e,t,a)=>{h(),i.geocode({address:e},((e,i)=>{if(i===google.maps.GeocoderStatus.OK){var n=s([["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);t(n,a)}else t(!1,a)}))},this.latLngToAddress=(e,t,a)=>{e=d(e),h(),i.geocode({location:e},((e,i)=>{if(i===google.maps.GeocoderStatus.OK){var n=s([["street_number","number"],["route","street"],["postal_code","zip"],["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);e[0].hasOwnProperty("formatted_address")&&(n.formatted=e[0].formatted_address),t(n,a)}else t(!1,a)}))},this.partialAddressToAddress=(e,t,a)=>{h(),i.geocode({address:e},((e,i)=>{if(i===google.maps.GeocoderStatus.OK){var n=s([["street_number","number"],["route","street"],["postal_code","zip"],["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);e[0].hasOwnProperty("formatted_address")&&(n.formatted=e[0].formatted_address),n.lat=e[0].geometry.location.lat(),n.lng=e[0].geometry.location.lng(),t(n,a)}else t(!1,a)}))},this.zipToAddress=(e,t,i)=>{this.partialAddressToAddress(e,t,i)},this.zipToLatLng=(e,t,a)=>{h(),i.geocode({address:e},(function(e,i){if(i===google.maps.GeocoderStatus.OK){var n={};n.lat=e[0].geometry.location.lat(),n.lng=e[0].geometry.location.lng(),t(n,a)}else t(!1,a)}))},this.getRoute=e=>{a||(a=new google.maps.DirectionsService);var t={start:!1,end:!1,waypoints:!1,optimize:!0,mode:OGX.Geo.TRAVEL_MODE_CAR,callback:!1,params:!1};for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i]);var n={origin:e.start,destination:e.end,travelMode:e.mode};e.waypoints&&(n.waypoints=e.waypoints,e.optimize&&(n.optimizeWaypoints=!0)),a.route(n,((t,i)=>{i===google.maps.DirectionsStatus.OK?e.callback(t,e.params):e.callback(!1,e.params)}))},this.calcRouteMinutes=e=>{for(var t=0,i=0;i<e.legs.length;i++)t+=e.legs[i].duration.value;return t=Math.round(t/60)},this.drawRoute=(e,t)=>{void 0===t&&(t=!0),n||(n=new google.maps.DirectionsRenderer({suppressMarkers:!t})),n.setMap(r.map),n.setDirections(e)},this.clearRoute=()=>{r.map&&n&&n.setMap(null)},this.latLngToLoc=(e,t)=>new google.maps.LatLng(e,t),this.clean=(e,t)=>{var i;if(void 0===t&&(t=!1),e.hasOwnProperty("city")&&e.hasOwnProperty("vicinity")&&-1!==e.vicinity.indexOf(",")&&(i=new RegExp(", ([a-z -']+)$","gi").exec(e.vicinity))&&i.length>1&&(e.city===i[1]?e.vicinity=e.vicinity.replace(i[0],""):e.city?e.city.length>i[1].length&&(e.city=i[1],e.vicinity=e.vicinity.replace(i[0],"")):e.city=i[1]),t)for(var a in e)-1===t.indexOf(a)&&delete e[a];return e},"undefined"!=typeof google&&void 0!==google.maps||($(document).trigger(OGX.Geo.ERROR_GMAP),debug(2,"Geo not started, Google Maps not found"))},OGX.Geo.ERROR="GEO_error",OGX.Geo.ERROR_GMAP="GEO_GMAP_ERROR",OGX.Geo.TRAVEL_MODE_CAR="DRIVING",OGX.Geo.TRAVEL_MODE_TRANSIT="TRANSIT",OGX.Geo.TRAVEL_MODE_WALK="WALKING",OGX.Geo.TRAVEL_MODE_BIKE="BICYCLING",OGX.Geo.BROWSER_LOC_SUCCESS="GEO_BROWSER_LOC_SUCCESS",OGX.Geo.BROWSER_LOC_ERROR="GEO_BROWSER_LOC_ERROR",OGX.Geo.MAP_LOADED="GEO_MAP_LOADED",void 0===OGX)var OGX={};if(require("Ghost","Uxi"),OGX.Ghost=function(e){construct(this,"Ghost"),this.el=$(e.el),css="ogx_ghost",this.el.addClass(css),delete css},void 0===OGX)var OGX={};if(require("GridSwiper","Uxi","Touch"),OGX.GridSwiper=function(e){construct(this,"GridSwiper");var t,i,a,n,o,r,s,l,d,c,u,h,g=this,f=e,p={map:[[!0,!0,!0],[!0,!0,!0],[!0,!0,!0]],axis:{x:!0,y:!0},loop:!0,start:!1,chromeos:!1,capture:!1,callbacks:{up:null,down:null,left:null,right:null}},_=!1,m={x:null,y:null},v={x:0,y:0},y=".ogx_grid_swiper_cell",x=!1,O=!1,b=!1,w={x:0,y:0},G={x:0,y:0},X=(new Date).getTime()+Math.round(1e3*Math.random()),T=[];function D(e){e?t.on(g.touch.down,E):t.off(g.touch.down,E)}function E(e){_=!1,o=0,r=0,s=0,l=0,e=Y(e),m.x=e.pageX,m.y=e.pageY,x=!0,k(!0)}function C(e){e?$("body").on(g.touch.up,S):$("body").off(g.touch.up,S)}function S(e){x&&(x=!1,k(!1),!L()&&b&&(t.trigger(OGX.GridSwiper.SWIPE_END),O=!1,b=!1))}function L(e,t,o){var r,s;return void 0===e&&(e=0),void 0===t&&(t=0),void 0===o&&(o=!0),o&&A(!0),i.addClass("ogx_grid_swiper_anim"),v=P(i),r=-1*Math.round((v.x+e)/a)*a*-1,s=-1*Math.round((v.y+t)/n)*n*-1,i.css({transform:"translate3d("+r+"px, "+s+"px, 0px)"}),v.x-r||v.y-s}function k(e){e?(N(!0),t.on(g.touch.move,M)):(N(!1),t.off(g.touch.move,M))}function M(e){e=Y(e),f.capture&&(e.preventDefault(),e.stopImmediatePropagation()),o=0,r=0,s=0,l=0,_||(f.axis.x&&Math.abs(e.pageX-m.x)>Math.abs(e.pageY-m.y)?_="x":f.axis.y&&Math.abs(e.pageX-m.x)<Math.abs(e.pageY-m.y)&&(_="y")),_&&(f.axis.x&&"x"===_?(o=Math.abs(e.pageX-m.x),s=e.pageX-m.x>0?1:-1):f.axis.y&&"y"===_&&(r=Math.abs(e.pageY-m.y),l=e.pageY-m.y>0?1:-1))}function N(e){e?h||(O=!1,h=setInterval(I,10)):h&&(clearInterval(h),h=null)}function I(){if((o||r)&&(O||(b=!0,t.trigger(OGX.GridSwiper.SWIPE_START)),O=!0),f.axis.x&&"x"===_&&o&&s&&o<=a){if(!f.loop&&(w.x+-1*s<0||w.x+-1*s>f.map[0].length-1))return;if((d=(w.x+-1*s)%f.map[0].length)<0&&(d=Math.abs(f.map[0].length+d)),!1===f.map[G.y][d])return;u=o*s,i.css({transform:"translate3d("+(-1*w.x*a+u)+"px, "+v.y+"px, 0px)"})}else if(f.axis.y&&"y"===_&&r&&l&&r<=n){if(!f.loop&&(w.y+-1*l<0||w.y+-1*l>f.map.length-1))return;if((c=(w.y+-1*l)%f.map.length)<0&&(c=Math.abs(f.map.length+c)),!1===f.map[c][G.x])return;u=r*l,i.css({transform:"translate3d("+v.x+"px, "+(-1*w.y*n+u)+"px, 0px)"})}}function A(e){e?(i.off("transitionend"),i.on("transitionend",(function(){O&&b&&(t.trigger(OGX.GridSwiper.SWIPE_END),O=!1,b=!1),i.off("transitionend"),i.removeClass("ogx_grid_swiper_anim"),v=P(i);var e={x:null,y:null};e.x=-1*Math.round(v.x/a),e.y=-1*Math.round(v.y/n),w.x!==e.x?(s=w.x>e.x?1:-1,w.x=e.x,G.x=R(w).x,-1===s?(i.children(y+"[data-y="+(w.y-1)+"]").attr("data-x",w.x).css("left",w.x*a),i.children(y+"[data-y="+(w.y+1)+"]").attr("data-x",w.x).css("left",w.x*a),i.children(y+"[data-x="+(w.x-2)+"][data-y="+w.y+"]").attr("data-x",w.x+1).css("left",(w.x+1)*a),g.onLeft({cell:G,point:w}),t.trigger(OGX.GridSwiper.SWIPE_LEFT,{cell:G,point:w}),F(T=[{x:w.x+1,y:w.y},{x:w.x,y:w.y-1},{x:w.x,y:w.y+1}]),H()):(i.children(y+"[data-y="+(w.y-1)+"]").attr("data-x",w.x).css("left",w.x*a),i.children(y+"[data-y="+(w.y+1)+"]").attr("data-x",w.x).css("left",w.x*a),i.children(y+"[data-x="+(w.x+2)+"][data-y="+w.y+"]").attr("data-x",w.x-1).css("left",(w.x-1)*a),g.onRight({cell:G,point:w}),t.trigger(OGX.GridSwiper.SWIPE_RIGHT,{cell:G,point:w}),F(T=[{x:w.x-1,y:w.y},{x:w.x,y:w.y-1},{x:w.x,y:w.y+1}]),H())):w.y!==e.y&&(l=w.y>e.y?1:-1,w.y=e.y,G.y=R(w).y,-1===l?(i.children(y+"[data-x="+(w.x-1)+"]").attr("data-y",w.y).css("top",w.y*n),i.children(y+"[data-x="+(w.x+1)+"]").attr("data-y",w.y).css("top",w.y*n),i.children(y+"[data-y="+(w.y-2)+"][data-x="+w.x+"]").attr("data-y",w.y+1).css("top",(w.y+1)*n),g.onUp({cell:G,point:w}),t.trigger(OGX.GridSwiper.SWIPE_UP,{cell:G,point:w}),F(T=[{x:w.x,y:w.y+1},{x:w.x-1,y:w.y},{x:w.x+1,y:w.y}]),H()):(i.children(y+"[data-x="+(w.x-1)+"]").attr("data-y",w.y).css("top",w.y*n),i.children(y+"[data-x="+(w.x+1)+"]").attr("data-y",w.y).css("top",w.y*n),i.children(y+"[data-y="+(w.y+2)+"][data-x="+w.x+"]").attr("data-y",w.y-1).css("top",(w.y-1)*n),g.onDown({cell:G,point:w}),t.trigger(OGX.GridSwiper.SWIPE_DOWN,{cell:G,point:w}),F(T=[{x:w.x,y:w.y-1},{x:w.x-1,y:w.y},{x:w.x+1,y:w.y}]),H())),_=0}))):i.off("transitionend")}function P(e,t){var i=e.css("transform");return"none"===i?0:(i=(i=(i=i.substr(7)).substr(0,i.length-1)).split(","),{x:Number(i[4]),y:Number(i[5])})}function Y(e){return e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e}function R(e){var t={x:0,y:0};return t.x=e.x%f.map[0].length,t.x<0&&(t.x=Math.abs(f.map[0].length+t.x)),t.y=e.y%f.map.length,t.y<0&&(t.y=Math.abs(f.map.length+t.y)),t}function F(e){for(var t,i={x:null,y:null},a=0;a<e.length;a++){if(e[a].y<0||e[a].y>f.map.length-1){if(!f.loop)return!1;i.y=R(e[a]).y}else i.y=e[a].y;if(e[a].x<0||e[a].x>f.map[0].length-1){if(!f.loop)return!1;i.x=R(e[a]).x}else i.x=e[a].x;t=f.map[i.y][i.x],W(e[a],t),g.onRender(i)}}function W(e,t){var a=!1;switch(typeof t){case"string":i.children(y+'[data-x="'+e.x+'"][data-y="'+e.y+'"]').children(y+"_content").first().html(t);break;case"function":(a=t(e,R(e),{x:e.x-w.x,y:e.y-w.y},i.children(y+'[data-x="'+e.x+'"][data-y="'+e.y+'"]').children(y+"_content").first()[0]))&&i.children(y+'[data-x="'+e.x+'"][data-y="'+e.y+'"]').children(y+"_content").first().html(a);break;case"object":var n='.ogx_grid_swiper[data-ogx-id="'+X+'"] > .ogx_grid_swiper_container > '+y+'[data-x="'+e.x+'"][data-y="'+e.y+'"] > '+y+"_content",o=R(e);for(var r in t){t[r].id="cell_"+o.x+"_"+o.y;break}t=OGX.OML.rename(t,n);var s=g.nodes.find("id","cell_"+o.x+"_"+o.y,1);s&&g.remove(s._NAME_,s.id),$(n).empty(),OGX.OML.render(g,t,{abs:e,rel:R(e)}),H()}}function H(){for(var e=0;e<g.nodes.length;e++)g.nodes[e].id==="cell_"+G.x+"_"+G.y?g.nodes[e].focus():g.nodes[e].blur()}function z(){T=[],f.axis.x&&(T.push({x:f.start.x-1,y:f.start.y}),T.push({x:f.start.x+1,y:f.start.y})),T.push({x:f.start.x,y:f.start.y}),f.axis.y&&(T.push({x:f.start.x,y:f.start.y-1}),T.push({x:f.start.x,y:f.start.y+1})),F(T)}function B(){f.map.length||(f.map=[[]],f.axis.y=!1),f.map.length&&!Array.isArray(f.map[0])&&(f.map=[f.map],f.axis.y=!1),f.start||(f.start={x:null,y:null},f.start.y=Math.floor(f.map.length/2),f.start.x=Math.floor(f.map[0].length/2))}function U(){var e=f.start.x*-a,o=f.start.y*-n,r=f.start.y-1,s=f.start.x,l='<div class="ogx_grid_swiper_container" style="transform:translate3d('+e+"px, "+o+'px, 0px);">',d=-1*e,c=-1*o-n;f.axis.y&&(l+='<div class="ogx_grid_swiper_cell" style="left:'+d+"px; top:"+c+'px;" data-x="'+s+'" data-y="'+r+'"><div class="ogx_grid_swiper_cell_content"></div></div>',l+='<div class="ogx_grid_swiper_cell" style="left:'+d+"px; top:"+(c+2*n)+'px;" data-x="'+s+'" data-y="'+(r+2)+'"><div class="ogx_grid_swiper_cell_content"></div></div>'),l+='<div class="ogx_grid_swiper_cell" style="left:'+d+"px; top:"+(c+n)+'px;" data-x="'+s+'" data-y="'+(r+1)+'"><div class="ogx_grid_swiper_cell_content"></div></div>',f.axis.x&&(l+='<div class="ogx_grid_swiper_cell" style="left:'+(d-a)+"px; top:"+-1*o+'px;" data-x="'+(s-1)+'" data-y="'+f.start.y+'"><div class="ogx_grid_swiper_cell_content"></div></div>',l+='<div class="ogx_grid_swiper_cell" style="left:'+(d+a)+"px; top:"+-1*o+'px;" data-x="'+(s+1)+'" data-y="'+f.start.y+'"><div class="ogx_grid_swiper_cell_content"></div></div>'),l+="</div>",t.html(l),i=t.children(".ogx_grid_swiper_container").first(),w.x=f.start.x,w.y=f.start.y,v.x=e,v.y=o,G.x=f.start.x,G.y=f.start.y}this.onFocus=()=>(debug(5,"gridwwiper",f.id,"enabled"),D(!0),C(!0),H(),this),this.onBlur=()=>(debug(5,"gridwwiper",f.id,"disabled"),D(!1),C(!1),N(!1),this),this.focus=function(){return this.blured&&(this.blured=!1,this.onFocus()),this},this.resize=function(){A(!1),i.removeClass("ogx_grid_swiper_anim"),a=t.width(),n=t.height();var e=w.x*-a,o=w.y*-n;i.children(y+"[data-y="+(w.y-1)+"]").css({top:(w.y-1)*n,left:w.x*a}),i.children(y+"[data-y="+w.y+"]").css({top:w.y*n,left:w.x*a}),i.children(y+"[data-y="+(w.y+1)+"]").css({top:(w.y+1)*n,left:w.x*a}),i.children(y+"[data-x="+(w.x-1)+"]").css({top:w.y*n,left:(w.x-1)*a}),i.children(y+"[data-x="+(w.x+1)+"]").css({top:w.y*n,left:(w.x+1)*a}),i.css("transform","translate3d("+e+"px, "+o+"px, 0px"),k(!1),setTimeout((()=>{L(0,0,!1),i.addClass("ogx_grid_swiper_anim")}),0)},this.onUp=()=>{},this.onDown=()=>{},this.onLeft=()=>{},this.onRight=()=>{},this.onRender=()=>{},this.setMap=(e,t)=>(f.map=e,void 0!==t&&(f.start=t),w={x:0,y:0},G={x:0,y:0},m={x:null,y:null},v={x:0,y:0},B(),U(),z(),this),this.setMapCell=(e,t)=>(f.map[e.y]||(f.map[e.y]=[]),f.map[e.y][e.x]=t,this),this.getMapCell=e=>e.y>0&&f.map.length<e.y&&e.x>0&&f.map[e.y].length<e.x&&f.map[e.y][e.x],this.getCells=()=>{var e,t,a,n,o=[];return i.children(y).each((function(i,r){e=$(r),t={x:Number(e.attr("data-x")),y:Number(e.attr("data-y"))},a=R(t),n={x:t.x-w.x,y:t.y-w.y},o.push({abs:t,rel:a,offset:n,element:r})})),o},this.getCellContent=e=>i.children(y+"[data-x="+e.x+"][data-y="+e.y+"]").children(y+"_content").first()[0],this.getCurrentCell=()=>G,this.renderCellContent=e=>(F([e]),this),this.setTopCell=e=>(this.setOffsetCell({x:0,y:-1},e),this),this.setBottomCell=e=>(this.setOffsetCell({x:0,y:1},e),this),this.setLeftCell=e=>(this.setOffsetCell({x:-1,y:0},e),this),this.setRightCell=e=>(this.setOffsetCell({x:1,y:0},e),this),this.setOffsetCell=(e,t)=>{var i={x:e.x+w.x,y:e.y+w.y};return this.setMapCell(i,t),this},this.getOffsetCell=e=>{var t={x:e.x+w.x,y:e.y+w.y};return this.getMapCell(t)},this.getOffsetCellContent=e=>{var t={x:e.x+w.x,y:e.y+w.y};return this.getCellContent(t)},this.swipeRight=()=>(L(-a),this),this.swipeLeft=()=>(L(a),this),this.swipeUp=()=>(L(0,-n),this),this.swipeDown=()=>(L(0,n),this),OGX.Data.merge(f,p),f.callbacks.up||(f.callbacks.up=g.onUp),f.callbacks.down||(f.callbacks.down=g.onDown),f.callbacks.right||(f.callbacks.right=g.onRight),f.callbacks.left||(f.callbacks.left=g.onLeft),(t=g.el).addClass("ogx_grid_swiper"),t.attr("data-ogx-id",X),a=t.width(),n=t.height(),B(),U(),z(),debug(5,"gridwwiper",f.id,"init")},OGX.GridSwiper.SWIPE_LEFT="GridSwiperSwipeLeft",OGX.GridSwiper.SWIPE_RIGHT="GridSwiperSwipeRight",OGX.GridSwiper.SWIPE_UP="GridSwiperSwipeUp",OGX.GridSwiper.SWIPE_DOWN="GridSwiperSwipeDown",OGX.GridSwiper.SWIPE_START="GridSwiperSwipeStart",OGX.GridSwiper.SWIPE_END="GridSwiperSwipeEnd",void 0===OGX)var OGX={};if(require("GroupedList","Uxi","Bind","Touch"),OGX.GroupedList=function(e){construct(this,"GroupedList");var t,i,a,n,o,r=this,s=e,l={group_by:"name",group_mode:null,group_param:null,group_order:null,order:null,list:new OGX.List,key:null,swipe:!1,reorder:!1,display:!1,mode:OGX.DynamicList.SELECT_MODE_HIT,scope:["public"]},d="static",c=[];function u(e){e?"static"===d&&t.on(r.touch.down,".ogx_grouped_list_item",h):"static"===d&&t.off(r.touch.down,".ogx_grouped_list_item",h)}function h(){t.find(".ogx_grouped_list_selected_item").removeClass("ogx_grouped_list_selected_item"),$(this).addClass("ogx_grouped_list_selected_item");var e=s.list[Number($(this).data("id"))];t.trigger(OGX.GroupedList.SELECT,e)}function g(e){var t=s.group_order.indexOf(e);if(-1===t)return t;for(var i=t,a=0;a<t;a++)-1===c.indexOf(s.group_order[a])&&i--;return i}function f(e,t){for(var a,n=0;n<i.nodes.length;n++)if(a=i.nodes[n].val().find(e,t,1))return{list:i.nodes[n],item:a};return!1}function p(){var e=!1,t=!1;if(s.list&&(e=s.list,n&&(e=a),e.length&&(t=o,o=e.group(s.group_by,s.group_mode,s.group_param))),e&&e.length){if(JSON.stringify(t)!==JSON.stringify(o)){r.find("NestList",r.id+"_nests","remove");var l=_();OGX.OML.render(r,l),(i=r.find("NestList",r.id+"_nests")).updateNestsHeight()}}else o=!1,r.el.empty()}function _(){var e='.ogx_grouped_list[data-ogx-id="'+r.id+'"]',t={};t[e+":NestList"]={id:r.id+"_nests",list:[],"node:OML":[]};var i,a=[],n=OGX.Data.clone(s.group_order);for(var l in o)i=s.group_order?s.group_order.indexOf(l):a.length,t[e+":NestList"].list.push({title:l}),c.push(l),a[i]={"default:DynamicList":{list:o[l],key:s.key,mode:s.mode,display:s.display,swipe:s.swipe,reorder:s.reorder,order:s.order}};for(var d=0;d<a.length;d++)void 0===a[d]&&(a.splice(d,1),n.splice(d,1),d--);return t[e+":NestList"]["node:OML"]=a,t[e+":NestList"].order=n,t}function m(){OGX.Data.merge(s,l),s.list.hasOwnProperty("insert")||(s.list=new OGX.List(s.list)),s.group_order&&!s.group_order.hasOwnProperty("insert")&&(s.group_order=new OGX.List(s.group_order)),s.display&&s.display.hasOwnProperty("css")&&("object"!=typeof s.display.css&&s.display.css?s.display.css+=" ogx_grouped_list_item":s.display.hasOwnProperty("add")?s.display.add="ogx_grouped_list_item "+s.display.add:s.display.add="ogx_grouped_list_item"),o=!1,(t=r.el).addClass("ogx_grouped_list")}function v(){"undefined"!=typeof moment?void 0!==OGX.List?void 0!==OGX.Templater?void 0!==OGX.NestList?(m(),p(),debug(5,"groupedlist",s.id,"init")):debug(1,"OGX.NestList not found! "):debug(1,"OGX.Templater not found! "):debug(1,"OGX.List not found! "):debug(1,"moment.js not found! ")}this.onFocus=()=>(u(!0),debug(5,"groupedlist",s.id,"enabled"),this),this.onBlur=()=>(u(!1),debug(5,"groupedlist",s.id,"disabled"),this),this.bindFilter=(e,t,i)=>(debug(4,"groupedlist",this.id,"filter",e,JSON.stringify(i)),s.list.removeFilter(e),void 0!==i&&s.list.addFilter(e,t,i),s.list.getFilters()&&(a=s.list.filter(),n=!0),setTimeout(p,0),this),this.bindValue=()=>this.getSelection(),this.destroy=()=>{this.clearBinds()},this.scope=e=>void 0!==e?(s.scope=e,i.scope(e),!0):s.scope,this.val=e=>{if(void 0===e)return s.list;e.hasOwnProperty("insert")||(e=new OGX.List(e));var t=s.list.getFilters();"{}"!==JSON.stringify(t)&&(n=!0,e.setFilters(t),a=e.filter()),s.list=e,setTimeout(p,0)},this.nests=()=>i||!1,this.filter=()=>(a=s.list.filter(),n=!0,setTimeout(p,0),this),this.unfilter=()=>(n=!1,setTimeout(p,0),this),this.addFilter=(e,t,i)=>s.list.addFilter(e,t,i),this.removeFilter=(e,t,i)=>s.list.removeFilter(e,t,i),this.resetFilters=()=>s.list.resetFilters(),this.getFilters=()=>s.list.getFilters(),this.addGroup=(e,t,a)=>{if(s.list.length){var n={title:e,scope:s.scope},o={};void 0===t&&(t=[]),o["default:DynamicList"]={list:t,key:s.key,mode:s.mode,display:s.display,swipe:s.swipe,reorder:s.reorder},i.addNest(n,o,a),s.group_order.insert(e,a),s.list=new OGX.List(s.list.concat(t)),c.push(e)}else s.list.insert(t),p();return this},this.removeGroup=e=>!!this.getGroupList(e)&&(i.removeNest(e),s.list.findDelete(s.group_by,e),c.splice(c.indexOf(e),1),!0),this.addToGroup=(e,t)=>{var a=this.getGroupList(e);return a&&(a.insert(t),s.list.push(t),setTimeout((()=>{i.updateNestHeight(e)}),0)),this},this.removeFromGroup=(e,t,a)=>{2===arguments.length&&(a=t,t=s.key);var n=this.getGroupList(e);return n&&(n.findDelete(t,a,1),s.list.findDelete(t,a,1),n.val().length?setTimeout((()=>{i.updateNestHeight(e)}),0):this.removeGroup(e)),this},this.updateGroupItem=(e,t,i,a)=>(this.getGroupList(e).findUpdate(t,i,a,!1,1),s.list.findUpdate(t,i,a,1),this),this.replaceGroupItem=(e,t,i,a)=>(this.getGroupList(e).findReplace(t,i,a),s.list.findReplace(t,i,a,1),this),this.getGroupList=e=>{var t=g(e);return-1!==t&&t<i.nodes.length&&i.nodes[t]},this.hasGroup=e=>-1!==c.indexOf(e),this.addItem=e=>{if(s.list.length){var t=e[s.group_by];if(this.hasGroup(t))this.addToGroup(t,e);else{var a=-1;-1!==s.group_order.indexOf(t)&&(a=g(t)),-1!==a?this.addGroup(t,[e],a):this.addGroup(t,[e])}setTimeout((()=>{i.updateNestHeight(t)}),0)}else s.list.insert(e),p();return this},this.removeItem=(e,t)=>{s.key&&1===arguments.length&&(t=e,e=s.key);var a=s.list.find(e,t,1);if(a){var n=a[s.group_by];return this.removeFromGroup(n,e,t),setTimeout((()=>{i.updateNestHeight(n)}),0),!0}return!1},this.replaceItem=(e,t,a)=>{s.key&&2===arguments.length&&(t=e,e=s.key);var n=f(e,t);if(n){var o=null;return n.item[s.group_by]!==a[s.group_by]?(o=n.item[s.group_by],n.list.findDelete(e,t,1),s.list.findDelete(e,t,1),-1===s.list.unique(s.group_by,!1).indexOf(o)&&(this.removeGroup(o),o=!1),this.addItem(a),setTimeout((()=>{o&&i.updateNestHeight(n.item[s.group_by]),i.updateNestHeight(a[s.group_by])}),0)):n.list.findReplace(e,t,a),!0}return!1},this.updateItem=(e,t,a,n)=>{if(s.key){var o=arguments.length;void 0!==n&&(o--,n=!1),2===o&&(a=t,t=e,e=s.key)}var r=f(e,t);if(r){if(a.hasOwnProperty(s.group_by)&&r.item[s.group_by]!==a[s.group_by]){var l=r.item[s.group_by],d=r.list.findDelete(e,t,1);r.list.val().length||this.removeGroup(l),s.list.findDelete(e,t,1),d=OGX.Data.merge(d,a,!0,!1,n),this.addItem(d),r.list.val().length&&setTimeout((()=>{i.updateNestHeight(l)}),0)}else r.list.findUpdate(e,t,a,n,1);return!0}return!1},this.render=()=>(setTimeout(p,0),this),this.refresh=()=>{var e=t.find(".ogx_grouped_list_selected_item").first();if(e.length>0){var i=e.data("id");e.html(OGX.Templater.make(s.template,s.list[i]))}return this},v()},OGX.GroupedList.SELECT="GroupedListSelect",OGX.GroupedList.BIND=OGX.GroupedList.SELECT,void 0===OGX)var OGX={};if(require("Html","Uxi","Placeholder"),OGX.Html=function(e){construct(this,"Html"),void 0!==e&&e&&(this.el=$(e.el),OGX.HtmlRender(e))},OGX.HtmlRender=function(e){var t=$(e.el),i=new OGX.Display(e);data=!1,e.data&&Object.keys(e.data).length&&(data=e.data),t.html(i.html(data)),e.css&&t.addClass(i.css(data)),e.hasOwnProperty("id")&&e.id&&"#"===e.id.substr(0,1)&&t.attr("id",e.id.substr(1))},void 0===OGX)var OGX={};if(require("Iceberg","Uxi","Touch"),OGX.Iceberg=function(e){construct(this,"Iceberg");var t,i,a,n,o,r,s=this,l={left:0,right:0,top:0,bottom:0,min:50,drag:!0,flatten:!1,capture:!0,"node:OML":{},callbacks:{up:null,down:null,left:null,right:null,restore:null}},d=e,c=!1,u="normal",h="main",g={left:null,main:null,right:null,top:null,bottom:null},f=[0,0,0],p=0,_=0,m=0,v=0;function y(e){for(var t in g)g[t]&&g[t].instance&&(e===t?g[t].instance.focus():g[t].instance.blur())}function x(){c.hasClass("ogx_iceberg_anim")||(c.off("transitionend"),f=G(c))}function O(e){var t=0;return e.dirY&&e.distY>e.distX&&(t=1),t}function b(e){d.drag&&e.dist&&(!(a=O(e))&&["main","left","right"].includes(h)?e.dirX&&e.distX&&(t=f[0]+e.distX*e.dirX)<=_&&t>=p&&c.css({transform:"translate3d("+t+"px, 0, 0)"}):["main","top","bottom"].includes(h)&&e.dirY&&e.distY&&(i=f[1]+e.distY*e.dirY)<=v&&i>=m&&c.css({transform:"translate3d(0, "+i+"px, 0)"}))}function w(e){if(t=0,i=0,a=O(e),e.swipe&&e.dist){var r;switch(e.swipe=!1,h){case"main":-1===e.dirX&&d.right&&!a?(t=-g.right.outerWidth(),r="right",e.swipe=!0):1===e.dirX&&d.left&&!a?(t=g.left.outerWidth(),r="left",e.swipe=!0):1===e.dirY&&d.top&&a?(i=g.top.outerHeight(),r="top",e.swipe=!0):-1===e.dirY&&d.bottom&&a&&(i=-g.bottom.outerHeight(),r="bottom",e.swipe=!0);break;case"left":-1!==e.dirX||a||(t=0,r="main",e.swipe=!0);break;case"right":1!==e.dirX||a||(t=0,r="main",e.swipe=!0);break;case"top":-1===e.dirY&&a&&(i=0,r="main",e.swipe=!0);break;case"bottom":1===e.dirY&&a&&(i=0,r="main",e.swipe=!0)}a?1===e.dirY?(n=OGX.Iceberg.SWIPE_DOWN,o="down"):(n=OGX.Iceberg.SWIPE_UP,o="up"):1===e.dirX?(n=OGX.Iceberg.SWIPE_RIGHT,o="right"):(n=OGX.Iceberg.SWIPE_LEFT,o="left"),e.swipe&&e.dist&&(c.addClass("ogx_iceberg_anim"),c.on("transitionend",(function(){c.off("transitionend"),c.removeClass("ogx_iceberg_anim"),f=G(c),y(h=r),d.callbacks[o](h),c.trigger(n,h)})),c.css({transform:"translate3d("+t+"px, "+i+"px, 0)"}))}else if(e.dist){switch(t=0,i=0,h){case"left":t=g.left.outerWidth();break;case"right":t=-g.right.outerWidth();break;case"top":i=g.top.outerHeight();break;case"bottom":i=-g.bottom.outerHeight()}c.addClass("ogx_iceberg_anim"),c.on("transitionend",(function(){c.off("transitionend"),c.removeClass("ogx_iceberg_anim"),f=G(c),d.callbacks.onRestore(h),c.trigger(OGX.Iceberg.RESTORE,h)})),c.css({transform:"translate3d("+t+"px, "+i+"px, 0)"})}}function G(e){var t=e[0].style.transform;if(t=t.match(/translate3d\(([0-9px%,\.\- ]+)\)/)){t=t[1].split(",");for(var i=0;i<t.length;i++)t[i]=Number(t[i].split("px")[0]);return t}return[0,0,0]}function X(){var e;for(var t in g)g[t]&&((e=g[t].children().first()).length&&e[0].hasAttribute("data-ogx-id")?g[t].instance=s.nodes.find("id",String(e.data("ogx-id")),1):g[t].instance=!1)}this.show=function(e,t){if(void 0===e&&(e=!1),"normal"===u)for(var i in g)if(g[i]&&g[i].instance&&g[i].instance.id===t){if(!e)return this.val(i),!0;if(g[i].instance._NAME_===g[i].instance.NAME)return this.val(i),!0}return!1},this.val=function(e){if(void 0===e)return h;if(t=0,i=0,"normal"===u){switch(e){case"left":t=g.left.outerWidth();break;case"top":i=g.top.outerHeight();break;case"main":t=0;break;case"right":t=g.left.outerWidth();break;case"bottom":i=-g.bottom.outerHeight()}g[h].instance&&g[h].instance.blur(),g[h=e].instance&&g[h].instance.focus(),c.css({transform:"translate3d("+t+"px, "+i+"px, 0)"})}},this.onFocus=()=>{"flattened"!==u&&(r.enable(),setTimeout((()=>{y(h)}),0)),debug(5,"iceberg",d.id,"enabled")},this.onBlur=()=>{r.disable(),debug(5,"iceberg",d.id,"disabled")},this.focus=()=>(this.blured&&(this.blured=!1,this.onFocus()),this),this.resize=()=>(g.left&&(_=g.left.outerWidth()),g.right&&(p=-g.right.outerWidth()),g.top&&(v=g.top.outerHeight()),g.bottom&&(m=-g.bottom.outerHeight()),d.flatten&&("flattened"!==u&&this.el.outerWidth()>=d.flatten?(u="flattened",f=G(c),c.addClass("ogx_iceberg_views_flattened").css("transform","translate3d(0px, 0px, 0px)"),c.children(".ogx_iceberg_view").addClass("ogx_iceberg_view_flattened"),this.onBlur()):"flattened"===u&&this.el.width()<d.flatten&&(u="normal",c.children(".ogx_iceberg_view").removeClass("ogx_iceberg_view_flattened"),c.removeClass("ogx_iceberg_views_flattened").css("transform","translate3d("+f[0]+"px, 0px, 0px)"),this.onFocus())),this),this.destroy=()=>{this.touch.wipe()},this.onUp=()=>{},this.onDown=()=>{},this.onLeft=()=>{},this.onRight=()=>{},this.onRestore=()=>{},debug(5,"iceberg",d.id,"init"),OGX.Data.merge(d,l),d.callbacks.up||(d.callbacks.up=s.onUp),d.callbacks.down||(d.callbacks.down=s.onDown),d.callbacks.right||(d.callbacks.right=s.onRight),d.callbacks.left||(d.callbacks.left=s.onLeft),d.callbacks.restore||(d.callbacks.restore=s.onRestore),width=Math.round($(d.el).innerWidth()),height=$(d.el).innerHeight(),s.el.addClass("ogx_iceberg"),function(){var e,t,i='<div class="ogx_iceberg_views ogx_hw">',a={},n='.ogx_iceberg[data-ogx-id="'+s.id+'"] > .ogx_iceberg_views > .ogx_iceberg_view[data-ogx-panel-id="';for(var o in d["node:OML"])for(var r in d["node:OML"][o])0===r.indexOf("left")&&(i+='<div class="ogx_iceberg_view_left ogx_view ogx_iceberg_view" data-ogx-panel-id="left" style="width:'+(isNaN(d.left)?d.left:d.left+"px")+';"></div>',a.left=n+'left"]',g.left=!0),0===r.indexOf("top")&&(i+='<div class="ogx_iceberg_view_top ogx_view ogx_iceberg_view" data-ogx-panel-id="top" style="height:'+(isNaN(d.top)?d.top:d.top+"px")+';"></div>',a.top=n+'top"]',g.top=!0),0===r.indexOf("main")&&(i+='<div class="ogx_iceberg_view_main ogx_view ogx_iceberg_view" data-ogx-panel-id="main"></div>',a.main=n+'main"]'),0===r.indexOf("right")&&(i+='<div class="ogx_iceberg_view_right ogx_view ogx_iceberg_view" data-ogx-panel-id="right" style="width:'+(isNaN(d.right)?d.right:d.right+"px")+';"></div>',a.right=n+'right"]',g.right=!0),0===r.indexOf("bottom")&&(i+='<div class="ogx_iceberg_view_bottom ogx_view ogx_iceberg_view" data-ogx-panel-id="bottom" style="height:'+(isNaN(d.bottom)?d.bottom:d.bottom+"px")+';"></div>',a.bottom=n+'bottom"]',g.bottom=!0);for(s.el.html(i),o=0;o<d["node:OML"].length;o++)for(var r in d["node:OML"][o])e=r.split(":")[0],t=r.replace(e,a[e]),d["node:OML"][o][t]=d["node:OML"][o][r],delete d["node:OML"][o][r];c=s.el.children(".ogx_iceberg_views").first(),g.left&&(g.left=c.children(".ogx_iceberg_view_left").first(),_=g.left.outerWidth()),g.top&&(g.top=c.children(".ogx_iceberg_view_top").first(),v=g.top.outerHeight()),g.main=c.children(".ogx_iceberg_view_main").first(),g.right&&(g.right=c.children(".ogx_iceberg_view_right").first(),p=-g.right.outerWidth()),g.bottom&&(g.bottom=c.children(".ogx_iceberg_view_bottom").first(),m=-g.bottom.outerHeight())}(),setTimeout(X,0),r=s.touch.add("Swipe",{state:"manual",capture:d.capture,x:!0,y:!0,min_x:d.min,min_y:d.min,cb_down:x,cb_swipe:b,cb_up:w}),s.resize()},OGX.Iceberg.SWIPE_UP="icebergSwipeUp",OGX.Iceberg.SWIPE_DOWN="icebergSwipeDown",OGX.Iceberg.SWIPE_LEFT="icebergSwipeLeft",OGX.Iceberg.SWIPE_RIGHT="icebergSwipeRight",OGX.Iceberg.RESTORE="icebergRestore",void 0===OGX)var OGX={};if(OGX.Loading=function(e){"use strict";var t=this,i=!1,a={display:{css:"ogx_loading",html:" ",anim:OGX.Overlay.FADE}};e.hasOwnProperty("loading")&&e.loading&&setTimeout(t.addLoading,0),this.hasLoading=()=>!!i,this.addLoading=e=>(t.hasOverlay()||(i=!0,void 0===e&&(e={}),OGX.Data.merge(e,a),t.addOverlay(e)),this),this.removeLoading=e=>(t.hasOverlay()&&(t.removeOverlay(e),i=!1),this)},void 0===OGX)var OGX={};if(OGX.Media=function(){"use strict";var e=!1,t={},i=0;function a(e,t,i){var a=$(e),n=a.parent().innerWidth(),o=a.parent().innerHeight(),r=function(e,t){var i={};return e.width/e.height>t.width/t.height?(i.width=t.width,i.height=Math.round(e.height*(t.width/e.width))):(i.width=Math.round(e.width*(t.height/e.height)),i.height=t.height),i}({width:t,height:i},{width:n,height:o}),s=(n-r.width)/2,l=(o-r.height)/2;a.css("left",s+"px"),a.css("top",l+"px"),a.prop("width",r.width),a.prop("height",r.height)}function n(e){var t,i=$(e);i&&(i.find(".ogx_video").each((function(e,i){t=$(i),function(e,t,i){var a=$(e),n=t/i,o=a.parent().innerWidth(),r=a.parent().innerHeight(),s=o,l=Math.ceil(s/n);l<r&&(s=(l=r)*n),a.prop("width",s),a.prop("height",l)}(i,parseInt(t.data("width"),10),parseInt(t.data("height"),10))})),i.find(".ogx_video_resp").each((function(e,i){t=$(i),function(e,t,i){var a=$(e),n=t/i,o=a.parent().innerWidth(),r=a.parent().innerHeight(),s=o,l=Math.ceil(s/n);l<r&&(s=(l=r)*n),a.prop("width",s),a.prop("height",l)}(i,parseInt(t.data("width"),10),parseInt(t.data("height"),10))})),i.find(".ogx_video_poster").each((function(e,i){t=$(i),function(e,t,i){var a=$(e),n=t/i,o=a.parent().innerWidth(),r=a.parent().innerHeight(),s=o,l=Math.ceil(s/n),d=0,c=0;l<r&&(l=r,s=Math.ceil(l*n)),s>o?d=(s-o)/2*-1:s<o&&(d=(o-s)/2*-1),l>r?c=(l-r)/2*-1:l<r&&(c=(r-l)/2*-1),a.css("left",d+"px"),a.css("top",c+"px"),a.prop("width",s),a.prop("height",l)}(i,parseInt(t.data("width"),10),parseInt(t.data("height"),10))})),i.find(".ogx_image_contain").each((function(e,i){t=$(i),a(i,parseInt(t.data("width"),10),parseInt(t.data("height"),10))})),i.find(".ogx_image_cover").each((function(e,i){t=$(i),function(e,t,i){var a=$(e),n=a.parent().innerWidth(),o=n/(t/i),r=(a.parent().innerHeight()-o)/2;r>0&&(r=0),a.parent().css("overflow","hidden"),a.prop("width",n),a.prop("height",o),a.css("top",r+"px")}(i,parseInt(t.data("width"),10),parseInt(t.data("height"),10))})),i.find(".ogx_image_fit").each((function(e,i){t=$(i),function(e,t,i){var a=$(e),n=t/i,o=a.parent().innerWidth(),r=o,s=Math.ceil(r/n),l=0;r>o?l=(r-o)/2*-1:r<o&&(l=(o-r)/2*-1),a.css("left",l+"px"),a.prop("width",r),a.prop("height",s)}(i,parseInt(t.data("width"),10),parseInt(t.data("height"),10))})),i.find(".ogx_image_scale").each((function(e,i){t=$(i),function(e,t,i){var a=$(e),n=t/i,o=a.parent().innerWidth(),r=Math.ceil(o/n);a.prop("width",o),a.prop("height",r)}(i,parseInt(t.data("width"),10),parseInt(t.data("height"),10))})),i.find(".ogx_image_resp").each((function(e,i){t=$(i),function(e,t,i){var a=$(e),n=t/i,o=a.parent().innerWidth();o>t&&(o=t);var r=Math.ceil(o/n);a.prop("width",o),a.prop("height",r)}(i,parseInt(t.data("width"),10),parseInt(t.data("height"),10))})))}function o(e){e?$(window).on("resize",r):$(window).off("resize",r)}function r(){for(var e in t)n(t[e].selector)}function s(e){var t;e.find(".ogx_video, .ogx_video_resp, .ogx_video_poster").each((function(e,i){(t=$(i)).parent().css("overflow","hidden"),i.hasAttribute("data-width")||(t.attr("data-width",t.attr("width")),t.attr("data-height",t.attr("height")))})),e.find(".ogx_image_cover, .ogx_image_contain, .ogx_image_fit, .ogx_image_scale, .ogx_image_resp").each((function(e,i){(t=$(i)).css("position","relative"),i.hasAttribute("data-width")||(t.attr("data-width",t.attr("width")),t.attr("data-height",t.attr("height")))})),n(e)}this.resize=e=>{void 0!==e?n(e):r()},this.bind=(a,n)=>{return!t.hasOwnProperty(a)&&(t[a]={observer:null,element:n},t[a].observer=(r=n,l=null,(d=new(window.MutationObserver||window.WebKitMutationObserver)((function(e,t){e.forEach((function(e){l&&clearTimeout(l),l=setTimeout((()=>{s($(r))}),10)}))}))).observe(document.querySelector(r),{childList:!0,subtree:!0}),d),t[a].selector=n,i++,e||(e=!0,o(!0)),s($(n)),!0);var r,l,d},this.unbind=a=>!(!t.hasOwnProperty(a)||!t[a].observer)&&(t[a].observer.disconnect(),delete t[a],!--i&&e&&(e=!1,o(!1)),!0)},OGX.Media=new OGX.Media,void 0===OGX)var OGX={};if(require("NestList","Uxi","Bind"),OGX.NestList=function(e){construct(this,"NestList");var t,i,a=this,n={scope:["public"],template:'<div class="ogx_nest_list_item {{$dsp}}" data-ogx-nest-id="{{$id}}"><div class="ogx_nest_list_item_head {{$css}}"><span class="ogx_nest_list_item_title">{{$title}}</span><span class="ogx_nest_list_item_icon"></span></div><div class="ogx_nest_list_item_body"><div class="ogx_nest_list_item_content">{{$body}}</div></div></div>',list:new OGX.List,item_default:!1,map:{title:"title",scope:"scope",id:"id"},order:!1,callbacks:{open:null,close:null}},o={title:"",scope:[],open:!0},r={id:0,title:!1,scope:[],height:0,y:0,hidden:!1,open:!0,selector:!1},s=e,l=!1,d=0,c=0,u=1,h={y:0,h:0,way:1},g=!1,f=new OGX.List;function p(e){e?t.on("click",".ogx_nest_list_item_head",_):t.off("click",".ogx_nest_list_item_head",_)}function _(e){l||(l=!0,m($(this)))}function m(e){var i=e.parent(0).data("ogx-nest-id"),n=!1;e.hasClass("ogx_nest_list_item_head_closed")?(h.way=1,e.addClass("ogx_nest_list_item_head_open").removeClass("ogx_nest_list_item_head_closed"),f.findUpdate("id",i,{open:!0},!1,1),n=!0):(h.way=0,e.removeClass("ogx_nest_list_item_head_open").addClass("ogx_nest_list_item_head_closed"),f.findUpdate("id",i,{open:!1},!1,1));var o=f.find("id",i,1);n?(v(o),a.onOpen(o),t.trigger(OGX.NestList.OPEN,o)):(y(o),a.onClose(o),t.trigger(OGX.NestList.CLOSE,o)),setTimeout(w,0)}function v(e){var t=x(e);return!!t&&(t.focus(),!0)}function y(e){var t=x(e);return!!t&&(t.blur(),!0)}function x(e){var t=$(e.selector).find(".ogx_uxi").first();if(t.length){var i=String(t.data("ogx-id")),n=a.nodes.find("id",i,1);if(n)return n}return!1}function O(e){if(e.hasOwnProperty("scope"))for(var t=0;t<e.scope.length;t++)if(-1!==s.scope.indexOf(e.scope[t]))return!0;return!1}function b(){for(var e,i=0;i<f.length;i++)(e=t.children(f[i].selector)).addClass("ogx_nest_list_item_noanim"),O(f[i])?(f[i].hidden=!1,e.removeClass("ogx_nest_list_item_hidden")):(f[i].hidden=!0,e.addClass("ogx_nest_list_item_hidden"));setTimeout(w,0)}function w(){var e;G();for(var i=t.children(".ogx_nest_list_mask").first(),n=0;n<f.length;n++)(e=t.children('.ogx_nest_list_item[data-ogx-nest-id="'+f[n].id+'"]')).removeClass("ogx_nest_list_item_noanim"),e.css("transform","translateY("+f[n].y+"px)");var o="height:"+Math.ceil(c+h.h)+"px !important;";i.on("transitionend",(function(){h.way||t.css("cssText",o),l=!1,a.scroller&&a.scroller.resize()})),h.way&&t.css("cssText",o),setTimeout((()=>{i.css({transform:"translateY("+h.y+"px)"})}),0)}function G(){var e=0;c=0,h.y=0,h.h=0;for(var i=0;i<f.length;i++)f[i].y=e,f[i].hidden||(d||(d=t.children(".ogx_nest_list_item:eq("+i+")").children(".ogx_nest_list_item_head").outerHeight(!0)),c+=d,h.y=e,f[i].open&&(h.y+=f[i].height,e+=f[i].height,c+=f[i].height),h.h=f[i].height);c-=h.h}function X(e){var t={css:"",dsp:"ogx_nest_list_prep",id:e.id};return t[s.map.title]=e[s.map.title],e.open?t.css="ogx_nest_list_item_head_open":t.css="ogx_nest_list_item_head_closed",OGX.Templater.make(s.template,t)}function T(e,i){OGX.Data.merge(e,o);var n=OGX.Data.merge(r,e,!0,!0);e.hasOwnProperty(s.map.id)?n.id=e[s.map.id]:(n.id=u,u++);var l=X(n);void 0!==i&&i<s.list.length-1?t.children(".ogx_nest_list_item:eq("+i+")").before(l):t.children(".ogx_nest_list_mask").first().before(l),n.selector='.ogx_nest_list[data-ogx-id="'+a.id+'"] > .ogx_nest_list_item[data-ogx-nest-id="'+n.id+'"] > .ogx_nest_list_item_body > .ogx_nest_list_item_content';var d=$('.ogx_nest_list[data-ogx-id="'+a.id+'"] > .ogx_nest_list_item[data-ogx-nest-id="'+n.id+'"]');return n.hidden&&d.addClass("ogx_nest_list_item_hidden"),d.removeClass("ogx_nest_list_prep"),n}function D(e){var t=$(e.selector).outerHeight(!0);e.height=t}function E(){var e=s.list;g&&(e=i),t.empty(),f.clear();var n;t.html('<div class="ogx_nest_list_mask"></div>'),s.hasOwnProperty("node:OML")||(s["node:OML"]=[]);for(var o=0;o<e.length;o++)n=T(e[o]),f.push(n),s["node:OML"][o]=OGX.OML.rename(s["node:OML"][o],n.selector);a.observe(!0,{childList:!0,subtree:!0},(function(){a.updateNestsHeight()}))}function C(){(t=a.el).addClass("ogx_nest_list")}function S(){for(var e=[],t=0;t<s.list.length;t++)e[s.order.indexOf(s.list[t][s.map.title])]=s.list[t];return s.list=new OGX.List(e)}function L(){s.list.hasOwnProperty("insert")||(s.list=new OGX.List(s.list));for(var e=0;e<s.list.length;e++)s.item_default?OGX.Data.merge(s.list[e],s.item_default):OGX.Data.merge(s.list[e],o),s.order&&S()}function k(){OGX.Data.merge(s,n),s.callbacks.open||(s.callbacks.open=a.onOpen),s.callbacks.close||(s.callbacks.close=a.onClose),L(),s.template=s.template.replace("{{$title}}","{{$"+s.map.title+"}}")}function M(){void 0!==OGX.Display?void 0!==OGX.Templater?(k(),C(),s.list.length&&E(),debug(5,"nestlist",s.id,"init")):debug(1,"OGX.Templater not found! "):debug(1,"OGX.Display not found! ")}this.onFocus=()=>(p(!0),debug(5,"nestlist",s.id,"enabled"),this),this.onBlur=()=>(p(!1),debug(5,"nestlist",s.id,"disabled"),this),this.show=(e,t)=>{arguments.length||this._show();var i=this.find(e,t);i&&m(i.el.parents(".ogx_nest_list_item").first().children(".ogx_nest_list_item_head").first());return this},this.bindFilter=(e,t,a)=>{debug(4,"NestedList",this.id,"filter",e,JSON.stringify(a)),s.list.removeFilter(e),void 0!==a&&s.list.addFilter(e,t,a),s.list.getFilters()&&(i=s.list.filter(),g=!0),setTimeout(E,0)},this.destroy=()=>{t.children(".ogx_nest_list_mask").off("transitionend"),a.observe(!1)},this.onOpen=()=>{},this.onClose=()=>{},this.scope=e=>void 0!==e?(s.scope=e,b(),!0):s.scope,this.val=e=>{if(void 0===e)return s.list;s.list=e,L(),setTimeout(E,0)},this.addNest=(e,t,i)=>{var a=T(e,i);if(f.insert(a,i),t=OGX.OML.rename(t,a.selector),OGX.OML.render(this,t),void 0!==i){var n=this.nodes.pop();this.nodes.insert(n,i)}},this.removeNest=e=>{var t=f.findIndex(s.map.title,e);t&&(this.nodes[t.index].kill(),this.nodes.splice(t.index,1),$('.ogx_nest_list[data-ogx-id="'+a.id+'"] > .ogx_nest_list_item[data-ogx-nest-id="'+f[t.index].id+'"]').remove(),f.splice(t.index,1),setTimeout(w,0))},this.updateNestHeight=e=>{var t=f.find(s.map.title,e,1);setTimeout((()=>{D(t),w()}),0)},this.updateNestsHeight=()=>{for(var e,t=0;t<f.length;t++)e=f[t],this.updateNestHeight(e[s.map.title])},this.updateMask=w,M()},OGX.NestList.OPEN="NestListOpen",OGX.NestList.CLOSE="NestListClose",OGX.NestList.READY="NestListReady",void 0===OGX)var OGX={};if(OGX.Net=function(e){"use strict";var t=1,i=[],a=OGX.Data.merge(e,{file_default:{file:!1,path:!1},extensions:[{ext:"json",path:"/json",type:"json"},{ext:"js",path:"/js",type:"text"},{ext:"html",path:"/html",type:"text"},{ext:"oml",path:"/oml",type:"json"},{ext:"ose",path:"/ose",type:"text"},{ext:"mp3",path:"/snd",type:"mp3"},{ext:"wav",path:"/snd"},{ext:"ogg",path:"/snd"},{ext:"png",path:"/img"},{ext:"jpg",path:"/img"},{ext:"gif",path:"/img"},{ext:"svg",path:"/img"}],ios:!1},!1,!0);function n(e,t,a){switch("/app.json"!==e&&debug(4,"NET loaded",e.path+"/"+e.file),"snd"===e.ext&&(i.push(e.data),40===i.length&&(i[0].src="",i.shift())),e.ext){case"json":case"txt":case"oml":case"ose":case"html":case"snd":"app.json"!==e.file&&OGX.Cache.add(e)}void 0!==t?setTimeout((()=>{t(e.data,a)}),0):$(document).trigger(OGX.Net.LOAD_SUCCESS,e)}function o(e,t,i){var o;"/"===(o=e.path+"/"+e.file).substr(0,1)&&(o=o.substr(1)),debug(5,"NET preload file",o),(a.encrypted&&"app.json"===o||"pak"===e.ext)&&(e.type="text"),fetch(o,{method:"GET",mode:"no-cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":r(e.type)},redirect:"follow",referrerPolicy:"same-origin"}).then((t=>{switch(e.type){case"text":return t.text();case"json":return t.json();default:return t.blob()}})).catch((e=>{$(document).trigger(OGX.Api.NETWORK_ERROR,e)})).then((a=>{e.data=a,n(e,t,i)}))}function r(e){switch(e){case"text":case"json":return"text/plain";default:return"application/zip"}}a.extensions.hasOwnProperty("insert")||(a.extensions=new OGX.List(a.extensions)),this.preload=(e,t,i)=>{debug(4,"NET bulk preload init");var a={loaded:0,total:0,files:new OGX.List};for(var n in e)for(var o=0;o<e[n].length;o++)debug(4,"NET preload path",n),a.total++,this.load(n+"/"+e[n][o],r);function r(e,n){a.loaded++,debug(4,"NET preloaded",a.loaded+"/"+a.total,"items"),a.files.insert(e),a.loaded===a.total&&(debug(4,"NET bulk preload done"),setTimeout((()=>{t(a.files,i)}),0))}debug(4,"NET preloading",a.total,"items")},this.load=(e,i,r)=>{var s;"app.json"!==e&&debug(4,"NET loading",e);var l={file:null,path:null};-1!==e.indexOf("/")?(s=e.split("/"),l.file=s.pop(),l.path=s.join("/")):(l.path="",l.file=e),OGX.Data.merge(l,a.file_default);var d=function(e){var t;if(t=/([a-z0-9\_\-]+\.)?([a-z0-9\_\-]+)\.([a-z0-9]{3,4})/gi.exec(e))return t.shift(),t;return!1}(l.file);if(d)switch(l.ext=d[2],l.id=d[1],l.ext){case"json":case"txt":case"oml":case"ose":case"html":l.type=a.extensions.find("ext",l.ext,1).type,o(l,i,r);break;case"mp3":case"ogg":case"wav":!function(e,t,i){var a;function o(){var o=e.path+"/"+e.file;"/"===o.substr(0,1)&&(o=o.substr(1)),debug(5,"NET preload sound",o),a=new Audio(o),e.data=a,e.ext="snd",e.format=e.file.split(".").pop(),n(e,t,i)}o()}(l,i,r);break;case"png":case"gif":case"jpg":case"svg":!function(e,t,i){var a=new Image;function o(){a.onload=function(){e.data=a,n(e,t,i)};var o=e.path+"/"+e.file;"/"===o.substr(0,1)&&(o=o.substr(1)),debug(5,"NET preload img",o),a.src=o}o()}(l,i,r);break;case"ttf":case"eot":case"woff":case"woff2":!function(e,i,a){function o(){var o='<div class="ogx_font_loader" style="font-family:'+e.file.split(".")[0]+';" data-ogx-id="font-loader-'+t+'"><b>ogx</b> <i>font</i> init</div>';$("body").append(o),n(e,i,a),function(e){setTimeout((()=>{$('.ogx_font_loader[data-ogx-id="font-loader-'+e+'"]').remove()}),150)}(t),t++}o()}(l,i,r);break;case"pak":!function(e,t,i){function a(a){for(var o,r=/<!--\[([a-zA-Z0-9_\-]+)\]-->/gi,s=[];o=r.exec(a);)s.push(o[1]);r=/<!--\[[a-zA-Z0-9_\-]+\]-->/gi;var l,d,c,u=a.split(r);u.shift();for(var h=0;h<s.length;h++){switch(e.path){case"/html":d="template."+s[h]+".html",c=u[h];break;default:d=s[h]+"."+e.path.substr(1),c=JSON.parse(u[h])}l={ext:e.path.substr(1),data:c,path:e.path,id:s[h],file:d},OGX.Cache.add(l)}n(e,t,i)}o(e,a,i)}(l,i,r)}},this.refresh=e=>{OGX.Cache.remove("html",null,0);var t={};t["/html"]=e["/html"],this.preload(t,(function(){var e;debug(3,"NET Templates refreshed"),e="?t="+(new Date).getTime(),$('link[rel="stylesheet"]').each((function(){this.href.match(/css\/(views|bin|stages)\//)&&(this.href=this.href.replace(/\?.*|$/,e))})),debug(3,"NET CSS refreshed")}))}},OGX.Net.LOAD_SUCCESS="NET_LOAD_SUCCESS",void 0===OGX)var OGX={};if(OGX.OSE=function(){"use strict";var charcode,to="__thread_object",lo="__local_object",ro="__route_object",oo="__object";function convertValue(e){if(-1===e.indexOf(":"))return e;var t=e.split(":");switch(t[1]){case"Boolean":return"true"===t[0];case"Number":var i=Number(t[0]);return!isNaN(i)&&i}}function convertKeywords(e,t){for(var i=["echo","scope","method","screen","mongogx","uxi","loop","json","ose","template","oml","crumb","result"],a=["eko","sco","met","scr","mgx","ixu","loo","jsn","eso","tpl","lmo","crb","rst"],n=["$","@","#","&"],o=0;o<i.length;o++)for(var r=0;r<n.length;r++)e=t?e.replaceAll(n[r]+i[o],n[r]+"___"+a[o]):e.replaceAll(n[r]+"___"+a[o],n[r]+i[o]);return e}function convertToJS(e,t,i,a,n){var o,r,s,l,d,c=0,u="";if(e=convertKeywords(e=(e=e.replace(/^[ \n\r]*{{|}}[\r\n ]*$/g,"")).replace(/(\/\*+((?!\*+\/)[\S\s])*\*+\/)/g,""),!0),(r=/(screen ?([<>=!+]+ ?\d+) ?\? ?([\S\s]+) ?\: ?([\S\s]+);?)/gi.exec(e))&&(l=(l=(l="var a;"+r[0]).replace("screen","screen.width")).replace(r[3],'a="'+r[3].trim()+'"'),l="null"!==r[4]?l.replace(r[4],'a="'+r[4].trim()+'"'):l.replace(r[4],"a=false;"),l+=";if(a){return a;}",d=new Function(l),e=e.replace(r[0],d())),(r=/(scope ([\S ]+) ?\? ?([\S ]+)\: ?([\S ]+);?)/gi.exec(e))&&(l=r[0],e="null"===(l=(s=OGX.Scope.eval(r[2]))?r[3]:r[4])?e.replace(r[0],""):e.replace(r[0],l)),(r=/(uxi\.?([a-z0-9_]+)? *(?:#|\$|&|@|%)*([a-z0-9_\-]+)):(([a-z0-9]+))/gi.exec(e))&&(s="uxi"===r[1]?'OGX.Object.get({_NAME_:{eq:"'+r[3]+'"}, id:{eq:"'+r[2]+'"}}, null, 1);':'OGX.Object.get({_NAME_:{eq:"'+r[4]+'"}, "'+r[2]+'":{eq:"'+r[3]+'"}}, null, 1);')===(e=e.replace(r[0],s)))return"return "+e;if((r=/method *([a-zA-Z0-9_\-]+) ([a-zA-Z0-9_\-]+):([a-zA-Z0-9_\-]+)/gi.exec(e))&&(s='OGX.Object.get({_NAME_:{eq:"'+r[3]+'"}, id:{eq:"'+r[2]+'"}}, null, 1).'+r[1])===(e=e.replace(r[0],s)))return"return "+e;if((r=/mongogx ([a-z0-9_\-]+)\.([a-z0-9_\-]+)\.([a-z]+)\(([\S ]+)\)/gi.exec(e))&&(s="mongogx.setDatabase('"+r[1]+"');",s+="mongogx.setCollection('"+r[2]+"');",(s+="return mongogx."+r[3]+"("+r[4]+")[0];")===(e=e.replace(r[0],s))))return s;if(isSingleVar(e))return"return "+replaceVars(e=convertKeywords(e,!1),t,i,a,n)+";";for(e=convertKeywords(e+="\r\n",!1);o=/[\S ]+(\r\n|\n)?/gi.exec(e);){if(l=replaceLoop(l=o[0].replace(/(\r\n|\n)/gi,"").trim(),t,i,a,n),charcode++,l=replaceVars(l,t,i,a,n),/^(app|OGX)\.\S+;?/g.test(l))return"return "+l+";";if(e=e.replace(o[0],""),u+=l+"\n",++c>100)return}return u="var __echo=[];\n"+u+'\nif(!__echo.length){return;}else{return __echo.join("");}'}function runJS(e,t,i,a,n,o){var r;try{r=new Function(oo,to,ro,lo,e)(t,i,a,n)}catch(e){return void debug(1,"Invalid script",o,"\n",e.toString())}if(void 0!==r)return r}function isSingleVar(e){return/^[ ]*\S+( \S+)?[ ]*$/g.test(e)}function getTrueVal(__string,__object,__thread_object,__route_object,__local_object,__as_string){void 0===__as_string&&(__as_string=!0);var e=!1,err=!1,str=__string.trim();if(["$","%","@"].includes(str))switch(str){case"&":return to;case"@":return lo;case"$":return oo;case"%":return ro}try{e=eval(__string)}catch(e){err=!0}return err||!e||"function"==typeof e||e&&e instanceof HTMLElement?'"'+__string+'"':e?"string"!=typeof e?__string:__as_string?'"'+e+'"':e:__string}function replaceLoop(e,t,i,a,n){var o,r,s,l;return(o=/loop (\S+) ?(as (\S+) ?(\S+ )?)?{/gi.exec(e))&&(r="__"+String.fromCharCode(charcode).toLowerCase()+"__",s=(s=o[0]).replace(o[0],"for(var "+r+" in JSON.parse(JSON.stringify("+o[1]+"))){"),o[2]&&(l=o[4]?"&"+o[3]+"="+r+"; &"+o[4]+"="+o[1]+"["+r+"]; ":"&"+o[3]+"="+o[1]+"["+r+"]; "),s+=l,e=e.replace(o[0],s)),e}function replaceVars(e,t,i,a,n){for(var o,r,s,l=0;r=/((&|#|@|\$|%)([a-zA-Z_]{1}[a-zA-Z0-9\-_]*))(\.[a-z0-9\-_\.\[\]\$]+|\.\$|\.)?(;)?/gi.exec(e);){switch(s=!1,r[2]){case"&":s=to+"."+r[3];break;case"@":s=lo+"."+r[3];break;case"$":s=oo+"."+r[3];break;case"#":s=r[3];break;case"%":s=ro+"."+r[3]}if(o=r[0].replace(r[1],s),e=e.replace(r[0],o),++l>300)return debug(1,"OSE script exceeded safe pool at replaceVars"),e}for(;r=/([a-z_\-]+)\( *(\$|@|&|%) *\)/gi.exec(e);)s=getTrueVal(r[2]),o=r[1]+"("+s+")",e=e.replace(r[0],o);for(;/^(json|ose|template|oml|crumb|result) (\S+)/g.test(e);)if((r=/crumb (\S+)?/gi.exec(e))&&(o=a.hasOwnProperty(r[1])?"__route_object."+r[1]:"{}",e=e.replace(r[0],o)),(r=/json (\S+)(;)?/gi.exec(e))&&(r[1]=getTrueVal(r[1],t,i,a,n),r[1]||debug(1,"OSE Error",e),e=e.replace(r[0],"app.getJSON("+r[1]+")")),(r=/^template (\S+)( \S+)?[ ;]?/gi.exec(e))&&(r[1]=getTrueVal(r[1],t,i,a,n),r[1]||debug(1,"OSE Error",e),void 0===r[2]?r[2]="__object":r[2]=getTrueVal(r[2].trim(),t,i,a,n),e=e.replace(r[0],"OGX.Templater.make(OGX.Templater.get("+r[1]+"), "+r[2]+", "+to+","+ro+","+lo+")")),(r=/^ose (\S+)(;)?/gi.exec(e))&&(r[1]=getTrueVal(r[1],t,i,a,n),r[1]||debug(1,"OSE Error",e),script=that.get(r[1]),script&&(e=exp.replace(r[0],script.replace(/({{|}})/g,"")))),(r=/^oml (\S+) *(\$)? *(;)?/gi.exec(e))&&(r[1]=getTrueVal(r[1],t,i,a,n),r[1]||debug(1,"OSE Error",e),e=r[2]?e.replace(r[0],"OGX.Templater.jmake(app.getOML("+r[1]+"), __object)"):e.replace(r[0],"app.getOML("+r[1]+")")),(r=/^result (\S+)(;)?$/gi.exec(e))&&(e=e.replace(r[0],'OGX.OML.result("'+r[1]+'")')),++l>300)return debug(1,"OSE script exceeded safe pool"),e;if(["$","@","%","&"].includes(e.trim())){switch(e.trim()){case"$":e=oo;break;case"@":e=lo;break;case"%":e=ro;break;case"&":e=to}return e}for(;r=/echo ('|")?(((?![;}\r\n]+|$)([\S\s]))*)(?:'|")?/gi.exec(e);){var d="+$1+",c="'";if(void 0!==r[1]&&(c="\\"+r[1]),d=c+d+c,r[2]=r[2].replace(/(__(?!;\n\r)[a-z0-9_\-\.]+)/gi,d),o="__echo.push("+c+r[2]+c+");",e=e.replace(r[0],o),++l>300)return debug(1,"OSE script exceeded safe pool"),e}return e}this.get=e=>OGX.Cache.read("ose",e),this.fork=(e,t)=>{var i,a;if(i=e.split(":")[0],void 0===t.data&&(t.data={}),void 0!==(a=OGX.OSE.exec(i,t.data)))for(var n in t.values)if(convertValue(n)===a)return t.values[n];return!1},this.execScript=(e,t,i,a)=>{var n=this.get(e);return n&&this.exec(n,t,i,a),!1},this.exec=(e,t,i,a,n)=>{void 0===t&&(t={}),void 0===i&&(i={}),void 0===a&&(a={}),void 0===n&&(n={}),charcode=65;var o=runJS(convertToJS(e,t,i,a,n),t,i,a,n,e);if(void 0!==o)return o}},OGX.OSE=new OGX.OSE,OGX.OSE.SCRIPT_LOADED="OSE_SCRIPT_LOADED",OGX.OSE.SCRIPTS_LOADED="OSE_SCRIPTS_LOADED",void 0===OGX)var OGX={};if(OGX.Overlay=function(e){"use strict";var t=this,i=!1,a=!1,n={anim:OGX.Overlay.FADE,display:{css:"",html:" "},index:!1,close_on_click:!1},o=!1,r="mousedown";function s(e){i&&(e?i.on(r,l):i.off(r,l))}function l(){"function"==typeof o.close_on_click&&o.close_on_click.apply(null,t),s(!1),t.removeOverlay()}e.hasOwnProperty("overlay")&&e.overlay&&setTimeout((()=>{this.addOverlay(e.overlay)}),0),this.hasOverlay=()=>!!i,this.addOverlay=e=>{if("object"!=typeof e&&(e={}),OGX.Data.merge(e,n),e.display.hasOwnProperty("_NAME_")||(e.display=new OGX.Display(e.display)),o=e,!this.hasOverlay()){var t=this.el;o.hasOwnProperty("el")&&(t=$(o.el));var a="z-index:"+(o.zindex?o.zindex:this.topIndex(t))+";",r='<div class="ogx_overlay '+o.display.css()+'" style="'+a+'">'+o.display.html()+"</div>";if(t.prepend(r),(i=t.children(".ogx_overlay").first()).off("transitionend"),o.anim)switch(o.anim){case OGX.Overlay.FADE:setTimeout((()=>{i&&i.removeClass("ogx_overlay_fade_out").addClass("ogx_overlay_fade_in")}),50)}else i.css("opacity",1)}return e.close_on_click&&s(!0),this},this.removeOverlay=e=>{s(!1);var t=!1;if(void 0===e||!0===e?o.anim&&(t=o.anim):t=e,i){if(t){switch(t){case OGX.Overlay.FADE:i.removeClass("ogx_overlay_fade_in").addClass("ogx_overlay_fade_out"),i.css("opacity")>0?i.on("transitionend",(function(){i&&(i.off("transitionend"),i.remove(),i=!1)})):i&&(i.removeClass("ogx_overlay_fade_in").removeClass("ogx_overlay_fade_out"),i.off("transitionend"),i.remove(),i=!1)}return}return i.remove(),void(i=!1)}return debug(2,"No overlay to remove"),this},this.addGroupOverlay=()=>(a||(this.el.prepend('<div class="ogx_group_overlay" style="z-index:'+(this.topIndex()+1e3)+'"></div>'),a=!0),this),this.removeGroupOverlay=()=>(a&&(this.el.children(".ogx_group_overlay").remove(),a=!1),this)},OGX.Overlay.FADE="fade",OGX.Overlay.REMOVE="OverlayRemove",OGX.Placeholder=function(e){"use strict";this.pholder=null,e.hasOwnProperty("placeholder")&&(this.pholder=e.placeholder),this.pholder&&this.pholder.length&&"default"!==this.pholder||(this.pholder=""),this.placeholder(e)},OGX.Placeholder.prototype.placeholder=function(e){var t;if("object"==typeof e["node:OML"]&&!Array.isArray(e["node:OML"])){var i=this.selector;for(var a in this.pholder&&(i+=" "+this.pholder),e["node:OML"])0===a.indexOf("default")&&(t=a.replace("default",i),e["node:OML"][t]=e["node:OML"][a],delete e["node:OML"][a])}},OGX.Placeholder.prototype.placeholders=function(e,t){var i=0;function a(e){var a;for(var n in e)0===n.indexOf("default")&&(a=n.replace("default",t[i]),i++,e[a]=e[n],delete e[n])}if(void 0!==e&&void 0!==t){e.hasOwnProperty("node:OML")||(e["node:OML"]=[]);var n,o=e["node:OML"];o&&"string"==typeof o&&(0===o.indexOf("{{")?e["node:OML"]=OGX.OSE.exec(o):e["node:OML"]=OGX.Cache.read("oml",e["node:OML"]));for(var r=0;r<e["node:OML"].length;r++)if("string"==typeof(n=e["node:OML"][r])&&(n=0===n.indexOf("{{")?OGX.OSE.exec(n):OGX.Cache.read("oml",n)),"object"==typeof n&&Array.isArray(n))for(var s=0;s<n.length;s++)a(n[s]);else a(n);return e}return!1},void 0===OGX)var OGX={};if(require("Point","Uxi","Placeholder"),OGX.Point=function(e){construct(this,"Point");var t,i=this,a=OGX.Data.merge(e,{live:[],mode:0}),n=new OGX.List,o=0;function r(){var e=function(){var e=i.el.width();e&&e!==o&&(o=e);for(var t=0;t<i.points.length;t++)if(o>=i.points[t].min&&o<i.points[t].max)return{id:t,oml:i.points[t].oml};return!1}();return!(!e||e.id===i.point)&&(i.point=e.id,!0)}this.points=[],this.point=null,this.resize=()=>{r()&&(!function(e){for(var t,o=i.gather(),r=0;r<a.live.length;r++)(t=o.get(a.live[r],null,1))&&(t.sleep(),e&&n.push({q:a.live[r],r:t}),t.parent.nodes.findDelete("id",t.id,1),t.parent=null)}(a.live.length&&!n.length),this.nodes.length&&(this.clear(),a.mode||this.el.empty()),OGX.OML.render(this,this.points[this.point].oml,a.data,a.route_data,n),this.el.trigger(OGX.Point.CHANGE,{min:this.points[this.point].min,max:this.points[this.point].max}))},this.oml=()=>(this.point||r(),this.points[this.point].oml),t=!0,a.el||(a.el=a.parent.el,t=!1),i.el=$(a.el),i.el.addClass("ogx_point"),t&&i.el.addClass("ogx_point_uxi"),function(){var e,t=i.id;for(var n in a.mode&&(t=a.parent.id),a)if(/^\d+\-\d+$/gi.test(n)){e=n.split("-");var o=OGX.Data.clone(a[n]);for(var r in o)0===r.indexOf("default")&&(o['.ogx_point[data-ogx-id="'+t+'"] '+r.replace("default","")]=o[r],delete o[r]);i.points.push({min:parseInt(e[0],10),max:parseInt(e[1],10),oml:o})}}(),function(){if(a.live.length){for(var e,t=0;t<a.live.length;t++)if("string"==typeof a.live[t])a.live[t]={id:{eq:a.live[t]}};else{for(var i in a.live[t])(e={})[i]={eq:a.live[t][i]};a.live[t]=e}a.live=new OGX.List(a.live)}}(),r()},OGX.Point.CHANGE="PointChange",require("Popup","Uxi","Placeholder","Touch","Resize"),OGX.Popup=function(e){construct(this,"Popup");var t,i,a=this,n={el:!1,width:"80%",height:"80%",html:!1,template:!1,title:!1,icon:!1,icons:!1,view:!1,drag:!1,resize:!1,maximize:!0,maximize_dbc:!0,center:!0,x:null,y:null,show:!0,group:!1,data:{},buttons:[],buttons_enabled:!0,anim:OGX.Popup.FADE,anim_param:{scale:.7},responsive:!0,overlay:!1,zindex:!1,chromeos:!1,parent:null},o={label:"",callback:null,params:null,enabled:!0},r=e,s=null,l=null,d=null,c="ogx_popup",u=[],h=[],g={w:0,h:0},f=!1,p=!1,_=!1,m=null,v=!1,O=null,b=!1,w=null;function G(){a.el.addClass("ogx_popup_notrans"),p=!0,T(!0)}function X(e,t){for(var i,n={},o={},r=0;r<e.length;r++)o[e[r]]=a.el[e[r]]();var s=setInterval((()=>{i=!1;for(var r=0;r<e.length;r++)n[e[r]]=a.el[e[r]](),n[e[r]]!==o[e[r]]&&(i=!0),o[e[r]]=n[e[r]];i?setTimeout(G,0):(clearInterval(s),setTimeout(G,100),t&&t())}),50)}function T(e){void 0===e&&(e=!1),r.anim&&a.el.removeClass(c+"_"+r.anim),e&&(r.width=a.el.width(),r.height=a.el.height(),r.center=a.centered=!1),a.resizeNodes()}function D(){r.anim&&a.el.removeClass(c+"_notrans");var e={};C(r.width)?e.width=OGX.Data.getBestSize(d.width(),a.el.width()):e.width=r.width,C(r.height)?e.height=OGX.Data.getBestSize(d.height(),a.el.height()):e.height=r.height,s.on("transitionend",(()=>{s.off("transitionend"),a.resizeNodes()})),a.el.css(e),a.resizeNodes()}function E(){var e=u.length;return e>2&&(e=2),u.slice(0,e).join(" ").replace(/matrix\([0-9,\. ]+\)/,"")}function C(e){return"string"==typeof e&&-1!==e.indexOf("|")}function S(){a.blurNodes(),a.front()}function L(){a.focusNodes(),a.el.removeClass("ogx_popup_notrans"),r.anim&&a.el.addClass(c+"_"+r.anim)}function k(){s.addClass(c+"_drag"),a.front()}function M(e){if(s.removeClass(c+"_drag"),_=!0,f){for(var t=0;t<h.length;t++)h[t].removeGroupOverlay();return h=[],void app.groupPopups(a,f,{drag:r.drag,resize:r.resize,anim:r.anim})}"function"==typeof r.drag&&r.drag(a,!1)}function N(e){if(t=a.el.position(),a.x=t.left,a.y=t.top,u[0]="translate3d("+a.x+"px, "+a.y+"px, 0)",r.group&&a.parent&&(h=a.parent.nodes.get({_NAME_:{eq:"Popup"},group:{eq:a.group},blured:{eq:!1}},{z:-1})).length){f=!1;for(var n=0;n<h.length;n++)a.id!==h[n].id&&h[n].group===a.group&&(i={left:h[n].x,top:h[n].y},g.w=h[n].el.width(),g.h=h[n].el.height(),t.left>i.left&&t.left<i.left+g.w&&t.top>i.top&&t.top<i.top+g.h&&(f||(f=h[n],h[n].addGroupOverlay())),f||h[n].removeGroupOverlay())}f||"function"==typeof r.drag&&r.drag(a,e)}function I(){var e=d.width(),t=d.height();e>screen.width&&(e=screen.width),t>screen.height&&(t=screen.height);var i=r.width,n=r.height,o=0,s=0;return p||(i=OGX.Data.getBestSize(e,i),n=OGX.Data.getBestSize(t,n)),r.center?("string"==typeof i&&(i=-1!==i.indexOf("%")?Math.round(e*Number(i.substr(0,i.length-1))/100):Number(i)),"string"==typeof n&&(n=-1!==n.indexOf("%")?Math.round(t*Number(n.substr(0,n.length-1))/100):Number(n)),x=Math.round(e/2-i/2),y=Math.round(t/2-n/2),r.center&&_&&(r.center=!1)):(_?(x=a.x,y=a.y):r.x&&r.y?(-1!==String(r.x).indexOf("%")?(o=i/2,x=e*Number(r.x.slice(0,-1))/100-o):x=r.x,-1!==String(r.y).indexOf("%")?(s=n/2,y=t*Number(r.y.slice(0,-1))/100-s):y=r.y):(x=Math.round(e/2-i/2),y=Math.round(t/2-n/2)),x>e&&(x=e-x),x<-i&&(x=0),y>t&&(y=t-n),y<0&&(y=0)),{x:x,y:y,w:i,h:n}}function A(e,t,i,n,o,l){var d=!1,h=null;if(void 0===l&&(l=!1),void 0!==t&&!0!==t||(t=r.anim),t&&(d=t),!t&&m&&(d=m),t?a.el.removeClass(c+"_notrans"):a.el.addClass(c+"_notrans"),e?(a.front(),l||a.el.trigger(OGX.Popup.SHOW,a)):l||a.el.trigger(OGX.Popup.HIDE,a),d){var g={};switch(h=c+"_"+d,d){case OGX.Popup.SCALE:u[1]=e?"scale(1,1)":"scale("+r.anim_param.scale+", "+r.anim_param.scale+")",g.transform=E();break;case OGX.Popup.FADE:g.opacity=e?1:0}e&&(s.css("display","flex"),g.visibility="visible",g.display="flex"),t||e||(g.visibility="hidden",g.display="none"),setTimeout((()=>{s.css(g)}),50),t?(m=d,s.on("transitionend",(()=>{s.off("transitionend"),b=!0,e?a.resizeNodes():s.css({display:"none",visibility:"hidden"}),h&&s.removeClass(h),P(i,n,o)})),h&&s.addClass(h)):(s.removeClass(h),P(i,n,o))}else e?s.css({opacity:e,display:"flex",visibility:"visible"}):s.css({display:"none",visibility:"hidden"}),P(i,n,o)}function P(e,t,i){void 0!==e&&e&&e(t),void 0!==i&&i&&i(a.id)}function Y(e){e?s.on(a.touch.down,"."+c+"_button",R):s.off(a.touch.down,"."+c+"_button",R)}function R(e){e.preventDefault(),e.stopImmediatePropagation();var t=$(this);if(!t.hasClass(c+"_button_disabled")){var i=t.index();s.trigger(OGX.Popup.CLICK_BUTTON,{index:i,value:r.buttons[i].label}),r.buttons[i].hasOwnProperty("callback")&&r.buttons[i].callback&&(r.buttons[i].hasOwnProperty("params")?r.buttons[i].callback.apply(null,[r.buttons[i].params]):r.buttons[i].callback())}}function F(){for(var e,t="",i=0;i<r.buttons.length;i++)r.buttons.length>0&&(e=r.buttons[i].enabled?"":c+"_button_disabled",t+='<span class="'+c+"_button "+e+'">'+r.buttons[i].label+"</span>");return t}function W(e,t){void 0===t&&(t=!0),r.buttons=new OGX.List(e);for(var i=0;i<e.length;i++)r.buttons[i]=OGX.Data.merge(r.buttons[i],o);if(t){var a=F();l.html(a)}}function H(e){e?a.el.on(a.touch.down,"."+c+"_icons_icon",(function(e){e.preventDefault(),e.stopImmediatePropagation();var t,i=$(this).index(),a=r.icons[i];"object"==typeof a&&a.hasOwnProperty("callback")&&(a.hasOwnProperty("params")&&(t=a.params),a.callback.call(null,t))})):a.el.off(a.touch.down,"."+c+"_icons_icon")}function z(){for(var e,t="",i=0;i<r.icons.length;i++)e="string"==typeof r.icons[i]?r.icons[i]:r.icons[i].icon,t+='<div class="'+c+'_icons_icon" style="background-image:url(\''+e+"')\"></div>";return t}this.anim=null,this.group=r.group,this.x=0,this.y=0,this.z=0,this.onFocus=()=>{this.enableResize(),r.icons&&r.icons.length&&H(!0),r.buttons&&r.buttons.length&&r.buttons_enabled&&Y(!0),w&&w.enable(),debug(5,"popup",r.id,"enabled")},this.onBlur=()=>{this.disableResize(),r.icons&&r.icons.length&&H(!1),r.buttons&&r.buttons.length&&r.buttons_enabled&&Y(!1),w&&w.disable(),debug(5,"popup",r.id,"disabled")},this.show=(e,t,i)=>{if(!this.visible){if(this._show(),!r.anim||e||b||(e=!0),!e&&r.anim&&"scale"==r.anim){var n=E().replace(/scale\([0-9,\. ]+\)/,"");a.el.css({transform:n}),u=n.split(" ")}A(1,e,t,i),this.focus(1)}return this},this.hide=(e,t,i,a,n)=>(this.visible&&(this._hide(),A(0,e,t,i,a,n),this.blur(1)),this),this.resize=()=>(T(),this),this.maximize=()=>(r.maximize&&!v&&(v=!0,O={width:r.width,height:r.height,x:this.x,y:this.y},r.width=r.height="100%",D(),this.move(0,0)),this),this.normalize=()=>(r.maximize&&v&&(v=!1,r.width=O.width,r.height=O.height,D(),this.move(O.x,O.y),O=null),this),this.width=(e,t,i)=>void 0===e?r.width:(void 0===i&&(i=!1),void 0===t&&(t=!1),t&&a.el.removeClass("ogx_popup_notrans"),r.width=e,X(["width"],i),D(),this),this.height=(e,t,i)=>void 0===e?r.height:(void 0===i&&(i=!1),void 0===t&&(t=!1),t&&a.el.removeClass("ogx_popup_notrans"),r.height=e,X(["height"],i),D(),this),this.destroy=()=>{s.off("transitionend"),this.touch.wipe()},this.buttons=e=>{if(void 0===e)return r.buttons;W(e)},this.enableButton=e=>(r.buttons[e].enabled=!0,l.children("."+c+"_button:eq("+e+")").removeClass(c+"_button_disabled"),r.buttons_enabled||(r.buttons_enabled=!0),this),this.disableButton=e=>(r.buttons[e].enabled=!1,l.children("."+c+"_button:eq("+e+")").addClass(c+"_button_disabled"),this),this.enableButtons=()=>{if(r.buttons.length)for(var e=0;e<r.buttons.length;e++)this.enableButton(e);return r.buttons_enabled=!0,this},this.disableButtons=()=>{if(r.buttons.length)for(var e=0;e<r.buttons.length;e++)this.disableButton(e);return r.buttons_enabled=!1,this},this.center=()=>{var e=I();return _||(u[0]="translate3d("+e.x+"px, "+e.y+"px, 0px)",this.x=e.x,this.y=e.y,a.el.css({transform:E()})),p||(a.el.width(e.w),a.el.height(e.h)),this},this.move=(e,t)=>(null===e&&(e=a.el.position().left),null===t&&(t=a.el.position().top),u[0]="translate3d("+e+"px, "+t+"px, 0px)",this.x=e,this.y=t,this.el.css({transform:E()}),this),this.front=()=>(this.z=r.parent.topIndex(),this.el.css("z-index",this.z),this),this.icon=e=>{if(void 0===e)return r.icon;r.icon=e,this.el.children("."+c+"_head").children("."+c+"_icon").first().css("background-image","url("+e+")")},this.title=e=>{if(void 0===e)return r.title;r.title=e,this.el.find("."+c+"_title").first().html(e)},this.icons=e=>{if(void 0===e)return r.icons;r.icons&&r.icons.length&&H(!1),r.icons=e,this.el.find("."+c+"_icons").first().html(z()),H(!0)},function(){if(void 0!==OGX.Templater)if(void 0!==OGX.Data)if(void 0!==OGX.Container){if(OGX.Data.merge(r,app.getDefaults("popups"),!1),OGX.Data.merge(r,n,!1),W(r.buttons,!1),(s=a.el).addClass(c),d=s.parent(),a.anim=r.anim,a.centered=r.center,function(){r.index?a.z=r.index:a.z=r.parent.topIndex(),null===r.x&&null===r.y||(r.center=!1);var e=I();a.x=e.x,a.y=e.y;var t=e.w,i=e.h;-1===String(t).indexOf("%")&&(t+="px"),-1===String(i).indexOf("%")&&(i+="px");var n="";(r.icon||r.title||r.icons||r.drag)&&(n+='<div class="'+c+'_head">',r.icon&&(n+='<div class="'+c+'_icon" style="background-image:url(\''+r.icon+"')\"></div>"),r.title&&(n+='<div class="'+c+'_title">'+r.title+"</div>"),n+='<div class="'+c+'_icons">',r.icons&&(n+=z()),n+="</div></div>");var o,d=1;if(u=["translate3d("+e.x+"px, "+e.y+"px, 0)"],r.anim)switch(r.anim){case OGX.Popup.FADE:d=0,o=c+"_fade";break;case OGX.Popup.SCALE:o=c+"_scale",u[1]="scale("+r.anim_param.scale+", "+r.anim_param.scale+")"}n+='<div class="'+c+'_body ogx_view">',r.html?n+=r.html:r.template&&(n+=OGX.Templater.make(OGX.Templater.get(r.template),r.data)),n+="</div>",r.buttons&&r.buttons.length&&(n+='<div class="'+c+'_buttons">',n+=F(),n+="</div>"),s.html(n),s.css({width:t,height:i,opacity:d,transform:E(),"z-index":a.z}),r.anim&&s.addClass(o),a.el=s,l=s.children("."+c+"_buttons").first()}(),r.drag){var e={x:!0,y:!0,cb_down:k,cb_up:M,cb_drag:N,target:"."+c+"_head"};r.group||"function"==typeof r.drag&&(e.cb_drag=e=>{r.drag(a,e)}),a.touch.add("Drag",e),a.dragable=!0}if(r.resize&&a.setResize({top:!1,cb_resize:G,cb_down:S,cb_up:L}),r.hasOwnProperty("html")&&r.html)r["node:OML"]=[{"default:Html":{html:r.html}}];else if(r.hasOwnProperty("view")&&r.view){var t={};t["default:Views."+r.view.id]=r,r["node:OML"].push(t)}a.placeholders(r,["."+c+'[data-ogx-id="'+r.id+'"] > .'+c+"_body"]),r.overlay&&a.addOverlay(),r.maximize&&r.maximize_dbc&&(w=a.touch.add("Double",{state:"manual",tg:a.selector+" > .ogx_popup_head",cb:()=>{v?setTimeout((()=>{a.normalize()}),180):setTimeout((()=>{a.maximize()}),180),"function"==typeof r.maximize_dbc&&r.maximize_dbc(!v)}})),a.observe(!0,undefined,(()=>{a.resizeNodes(),a.observe(!1),r.show&&a.show()})),debug(5,"popup",r.id,"init")}else debug(1,"OGX.Container not found! ");else debug(1,"OGX.Data not found! ");else debug(1,"OGX.Templater not found! ")}()},OGX.Popup.FADE="fade",OGX.Popup.SCALE="scale",OGX.Popup.HIDE="PopupHide",OGX.Popup.SHOW="PopupShow",OGX.Popup.CLOSE="PopupClose",OGX.Popup.DRAG="PopupDrag",OGX.Popup.GROUP="PopupGroup",OGX.Popup.UNGROUP="PopupUngroup",OGX.Popup.CLICK_BUTTON="PopupClickButton",OGX.Popup.FLOAT=!0,void 0===OGX)var OGX={};if(OGX.Resize=function(e){"use strict";var t,i,a,n,o,r,s,l,d=this,c=e,u={enabled:!0,top:!0,left:!0,right:!0,bottom:!0,min_width:100,min_height:100,max_width:0,max_height:0,border:10,cb_up:!1,cb_down:!1,cb_resize:!1},h=!1,g="mousedown",f="mouseup",p="mousemove",_=(c=!1,!1),m=!1,v={w:0,h:0},y=null;function x(e){c&&(e?d.el.on(g,O):d.el.off(g,O))}function O(e){var u=D(e);a=u.pageX,n=u.pageY;var h=d.el.position();t=h.left,i=h.top;var g=d.el.offset(),f=a-g.left,p=n-g.top;v.w=d.el.width(),v.h=d.el.height(),o=0,r=0,s=0,l=0,c.top&&p<c.border&&(l=-1),c.bottom&&p>d.el.height()-c.border&&(l=1),c.left&&f<c.border&&(s=-1),c.right&&f>d.el.width()-c.border&&(s=1),_=-1!==window.getComputedStyle(d.el[0],"width"),m=-1!==window.getComputedStyle(d.el[0],"height"),(s||l)&&(e.preventDefault(),y&&y.disable(),b(!0),G(!0),c.cb_down&&c.cb_down())}function b(e){e?h||(h=setInterval(w,5)):h&&(clearInterval(h),h=!1)}function w(){if(-1===s||-1===l){var e=t,a=i;o&&s&&(e+=o),r&&l&&(a+=r),o&&-1===s&&r&&1===l&&(a=i),d.el.css("transform","translate3d("+e+"px, "+a+"px, 0)")}s&&v.w+o*s>c.min_width&&(_?d.el.width(Math.round(100*(v.w+o*s)/d.el.parent().width()*100)/100+"%"):d.el.width(v.w+o*s)),l&&v.h+r*l>c.min_height&&(m?d.el.height(Math.round(100*(v.h+r*l)/d.el.parent().height()*100)/100+"%"):d.el.height(v.h+r*l)),(o||r)&&(c.cb_resize?c.cb_resize():d.el.trigger(OGX.Resize.RESIZING))}function G(e){e?($("body").on(p,X),$("body").on(f,T)):($("body").off(p,X),$("body").off(f,T))}function X(e){e.preventDefault(),e.stopImmediatePropagation(),e=D(e),o=e.pageX-a,r=e.pageY-n}function T(e){b(!1),G(!1),e=D(e),o=e.pageX-a,r=e.pageY-n,c.cb_up&&c.cb_up(),y&&(x(!1),y.enable(),setTimeout((()=>{x(!0)}),0))}function D(e){return e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e}this.resizable=!0,this.setResize=e=>{OGX.Data.merge(e,u,!1),c=e},this.enableResize=()=>(x(!0),this),this.disableResize=()=>(x(!1),this),this.destroy=()=>{this.touch.wipe()},OGX.Data.merge(c,u,!1),void 0===window.ontouchstart||c.chromeos||(g="touchstart",p="touchmove",f="touchend"),d.hasOwnProperty("dragable")&&d.dragable&&(y=d.touch.add("Drag",{state:"manual"}))},OGX.Resize.RESIZING="resizeResizing",void 0===OGX)var OGX={};if(require("Roulette","Uxi","Bind","Touch"),OGX.Roulette=function(e){construct(this,"Roulette");var t,i,a,n,o,r,s,l=this,d=e,c={force_coef:10,time_coef:.1,min_force_pitch:2,value:null,name:!1,required:!1,display:!1,key:"value",mode:OGX.Roulette.MODE_REWIND,icon:!1,list:new OGX.List,capture:!1,callbacks:{change:null}},u={template:!1,html:'<span class="ogx_roulette_block_label">{{$label}}</span>',css:!1},h="object",g=0,f=0,p=null,_="ogx_roulette";function m(e,t){void 0===t&&(t=!0),l.el.children('input[name="'+d.name+'"]').val(e),t&&l.el.children('input[name="'+d.name+'"]').trigger("change")}function v(e){e?t.on(l.touch.down,"."+_+"_icon",(function(e){e.preventDefault(),e.stopImmediatePropagation(),l.next(!0)})):t.off(l.touch.down,"."+_+"_icon")}function y(e){e?t.on("change","input[type=hidden]",x):t.off("change","input[type=hidden]",x)}function x(e){e.preventDefault(),e.stopImmediatePropagation(),l.loopval(0,OGX.Data.stringToVal(e.target.value),!1)}function O(e){return f+e>d.list.length-1?d.list[0]:f+e<0?d.list[d.list.length-1]:d.list[f+e]}function b(e){n=e.y,X(!0)}function w(e){var t;e.dirY!==o?(t=0,n=e.pt1.y):(t=e.pt1.y-n,n=e.pt1.y),o=e.dirY,i.css({transition:"none",transform:"translate3D(0px, "+(C(i)+t)+"px, 0px)"})}function G(e){X(!1),trans=C(i);var t=Math.round(trans/a)*a,n=Math.round(t/a%d.list.length);if(n=n<=0?Math.abs(n):d.list.length-n,f!==n){switch(f=n,h){case"string":d.value=d.list[f];break;case"object":d.value=d.list[f][d.key]}d.name&&l.el.children('input[name="'+d.name+'"]').val(d.value).trigger("input"),l.el.trigger(OGX.Roulette.CHANGE,d.value)}i.css({transition:"all 0.2s ease-out",transform:"translate3D(0px, "+t+"px, 0px)"})}function X(e){e?r=setInterval(T,10):clearInterval(r)}function T(){var e,t,n;(e=Math.floor((i.position().top+a*o)/(a*d.list.length)*-1))!==g&&(0===i.children("."+_+'_stripe[data-id="'+e+'"]').length&&((t=s.clone()).css("top",e*(a*d.list.length)+"px"),t.attr("data-id",e),i.append(t)),i.children("."+_+"_stripe").each((function(e,t){n=i.position().top+$(t).position().top,(Math.ceil(n+a*d.list.length)<-a||n>a)&&$(t).remove()})),g=e)}function D(){X(!1),i.off("transitionend",D)}function E(){var e="",n='<div class="'+_+'_container">';n+='<div class="'+_+'_stripes">';for(var o=0;o<2;o++){n+='<div class="'+_+'_stripe" style="top:'+o*(d.list.length*a)+'px;" data-id="'+o+'">';for(var r=0;r<d.list.length;r++){switch(h){case"string":e=OGX.Templater.make(d.display.html(),{label:d.list[r]});break;case"object":e=d.display.html(d.list[r])}n+='<div class="'+_+"_block "+d.display.css(d.list[r])+'" style="height:'+a+"px; line-height:"+a+'px;" data-ogx-id="'+r+'">'+e+"</div>"}n+="</div>"}if(n+="</div></div>",d.icon&&(n+='<div class="'+_+'_icon"></div>'),void 0===f&&(f=0),d.name){var l="";switch(d.required&&(l=" required"),h){case"string":n+='<input type="hidden" name="'+d.name+'" value="'+d.list[f]+'" '+l+">";break;case"object":n+='<input type="hidden" name="'+d.name+'" value="'+d.list[f][d.key]+'" '+l+">"}}t.html(n),i=t.children("."+_+"_container").children("."+_+"_stripes").first(),s=(s=i.children("."+_+"_stripe:last")).detach();var c=f*a*-1;i.css({transition:"none",transform:"translate3D(0px, "+c+"px, 0px)"})}function C(e){var t=0;return"none"!==e.css("transform")&&(t=Number(e.css("transform").split(",")[5].split(")")[0])),t}function S(e){switch(h){case"string":return{index:d.list.indexOf(e)};case"object":return d.list.findIndex(d.key,e)}}function L(){d.list.length>0&&!d.list.hasOwnProperty("insert")&&(d.list=new OGX.List(d.list)),"string"==typeof d.list[0]&&(h="string"),1===d.list.length&&(d.list[1]=d.list[0])}this.construct=()=>{d.name&&y(!0)},this.onFocus=()=>(t.removeClass(_+"_disabled"),d.icon&&v(!0),p&&p.enable(),debug(5,"roulette",d.id,"enabled"),this),this.onBlur=()=>{t.addClass(_+"_disabled"),d.icon&&v(!1),p&&p.disable(),X(!1),debug(5,"roulette",d.id,"disabled")},this.bindFilter=(e,t,i)=>(d.list.removeFilter(e),d.list.addFilter(e,t,i),d.list.filter(),setTimeout(E,0),this),this.destroy=()=>{d.name&&y(!1),this.touch.wipe()},this.bindRender=(e,t)=>{},this.onSelect=()=>{},this.val=(e,t)=>{if(void 0!==e){var n=S(e).index;return n>-1&&(!function(e,t){void 0===t&&(t=!0);i.off("transitionend",D),X(!1),o=-1;var n=C(i),r=Math.round(n/a)*a,s=n-r,l=Math.round(r/a%d.list.length);l=l<=0?Math.abs(l):d.list.length-l;var c=l-e;d.mode===OGX.Roulette.MODE_CLOSEST&&c>d.list.length/2&&(c=-1*(d.list.length-l+e));var u=n+c*a-s,h=20*Math.round(Math.abs(c*a)*d.time_coef);X(!0),i.on("transitionend",D),i.css({transition:"all "+h+"ms ease-out",transform:"translate3D(0px, "+u+"px, 0px)"}),f=e}(n),d.name&&m(e,!1)),this}switch(h){case"string":return d.list[f];case"object":return d.list[f][d.key]}},this.item=()=>d.list[f],this.loopval=(e,t,n)=>{var o=f,r=S(t).index;r>-1&&(f=r);var s=o-r,l=d.time_coef*Math.abs(s+e*d.list.length);return X(!0),i.css({transition:"all "+l+"s ease-out",transform:"translate3D(0px, "+(C(i)+(s*a-d.list.length*a*e))+"px, 0px)"}),i.on("transitionend",D),d.name&&m(t,n),void 0!==n&&n&&(this.onSelect(val),this.el.trigger(OGX.Roulette.CHANGE,val)),this},this.next=e=>{var t,i=O(1);switch(o=1,h){case"string":t=i;break;case"object":t=i[d.key]}return this.val(t),void 0!==e&&e&&(this.onSelect(t),this.el.trigger(OGX.Roulette.CHANGE,t),d.name&&this.el.children('input[name="'+d.name+'"]').trigger("input")),this},this.prev=e=>{var t,i=O(-1);switch(h){case"string":t=i;break;case"object":t=i[d.key]}return this.val(t),void 0!==e&&e&&(this.onSelect(t),this.el.trigger(OGX.Roulette.CHANGE,t),d.name&&this.el.children('input[name="'+d.name+'"]').trigger("change")),this},this.setData=(e,t)=>(d.value=t,d.list=e,L(),f=void 0===t?0:S(t).index,setTimeout(E,0),this),debug(5,"roulette init",d.id),function(){if(OGX.Data.merge(d,c),d.callbacks.change||(d.callbacks.change=l.onChange),L(),d.display?d.display=new OGX.Display(d.display):d.display=new OGX.Display(u),(t=l.el=$(d.el)).addClass(_),t.width(),a=t.height(),d.list.length){var e=t.parent();e[0].hasAttribute("data-value")&&(d.value=OGX.Data.stringToVal(e.data("value")),e.removeAttr("data-value")),null===d.value&&(d.value=d.list[0],"object"==typeof d.value&&(d.value=d.value.value)),f=S(d.value).index}}(),l.observeOnce({childList:!0},(function(){p=l.touch.add("Swipe",{x:!1,y:!0,cb_down:b,cb_swipe:w,cb_up:G,state:"manual",target:'.ogx_roulette[data-ogx-id="'+l.id+'"] .ogx_roulette_container',capture:d.capture}),d.enabled&&p.enable()}),null),E(),debug(5,"roulette",d.id,"init")},OGX.Roulette.CHANGE="RouletteChange",OGX.Roulette.MODE_REWIND="RouletteModeRewind",OGX.Roulette.MODE_CLOSEST="RouetteModeClosest",OGX.Roulette.BIND=OGX.Roulette.CHANGE,void 0===OGX)var OGX={};if(require("RouletteTree","Uxi"),OGX.RouletteTree=function(e){construct(this,"RouletteTree");var t,a,n=this,o=e,r={groups:!1,data:!1,value:!1,required:!1},s=!1;function l(e){e?t.on(OGX.Roulette.CHANGE,c):t.off(OGX.Roulette.CHANGE,c)}function d(){for(var e,t=0;t<s.length;t++)t>0&&(e=s[t-1].roulette.val()),0===t||t-1>=0&&null!==e&&String(e).length>0?s[t].roulette.enable():t>0&&s[t].roulette.disable()}function c(e,n){e.stopImmediatePropagation();var o,r=$(e.target).data("ogx-id"),l=s.findIndex("id",String(r)),d=s[l.index].roulette.item().hasOwnProperty("head");if(a=l.index,l.index+1<s.length)for(i=l.index+1;i<s.length;i++)d?(s[i].roulette.val(""),s[i].roulette.disable()):(o=u(i-1,s[i-1].roulette.val()),s[i].roulette.setData(o,o[0].value),i===l.index+1?s[i].roulette.enable():s[i].roulette.disable());var c=h(a);t.trigger(OGX.RouletteTree.CHANGE,c),d&&!a&&(a=-1)}function u(e,t){for(var i=[],a=0;a<e+1;a++)i.push(s[a].roulette.val());return f(i)}function h(e){if(void 0===e&&(e=s.length),e<0)return!1;for(var t={},i=0;i<e+1;i++)t[o.groups[i]]=s[i].roulette.val();return t}function g(e){for(var t,i=[],n=0;n<o.groups.length;n++)e.hasOwnProperty(o.groups[n])&&(t=e[o.groups[n]],String(t).length&&(!isNaN(t)&&(t=String(t)),s[n].roulette.val(t),a=n,n>0&&s[n].roulette.setData(f(i),t),i.push(t)));setTimeout(d,0)}function f(e){for(var t=o.data,i=0;i<e.length;i++)e[i].length&&(t=t[e[i]]);var a=[{label:o.groups[e.length],value:""}];for(var n in t)a.push({label:n,value:n});return a}this.onFocus=()=>(s&&(d(),l(!0)),this),this.disable=()=>(s&&l(!1),this),this.val=e=>{if(void 0===e)return a>-1?h(a):{};g(e)},o=OGX.Data.merge(o,r),(t=n.el).addClass("ogx_roulette_tree"),n.observeOnce({childList:!0},(function(){setTimeout((()=>{o.value?g(o.value):d()}),10)})),function(){s=new OGX.List;var e,i,a=0;!function r(l,d){var c;if(!Array.isArray(l)&&"object"==typeof l){if(d>a){for(var u in a=d,t.append('<div class="ogx_roulette_tree_roulette" data-ogx-roulette="'+d+'"></div>'),i=o.groups[d-1],e=[{label:i,value:"",head:!0}],l)e.push({label:u,value:u});c=n.create("Roulette",{el:'.ogx_roulette_tree[data-ogx-id="'+n.id+'"] .ogx_roulette_tree_roulette[data-ogx-roulette="'+d+'"]',list:e,icon:o.icon,value:null,name:i,enabled:!1,required:o.required}),s.push({roulette:c,group:i,id:c.id})}if(d<o.groups.length)for(var u in l)r(l[u],d+1)}}(o.data,1)}(),a=-1,debug(5,"roulettetree",o.id,"init")},OGX.RouletteTree.CHANGE="RouletteTreeChange",OGX.RouletteTree.BIND=OGX.RouletteTree.CHANGE,void 0===OGX)var OGX={};if(OGX.Router=function(__config){"use strict";var that=this,config_default={options:{bookmark:!0,jail:!0,cache:!1,eval:!1,idle:!1},cache:!1,errors:{403:!1,404:!1},routes:{}},options_default={history:!0,reload:!1,data:null},config=__config;OGX.Data.merge(config,config_default,!1),OGX.Data.merge(config.options,config_default.options,!1),OGX.Data.merge(config.errors,config_default.errors,!1);var page=window.location.pathname.split("/").slice(-1)[0],locked=!1,pattern=!1,global_url=null,route=null,request=null,cache=new OGX.List,gate=null,blured=!1,time=0,init_url=window.location.hash.slice(1);function isCachable(e){return!(!config.options.cache||!e.route.hasOwnProperty("cache")||!1===e.route.cache)}function cacheExpired(e){var t=getCache(e);if(!t)return!0;var i=0;return"once"===config.options.cache||(!0!==config.options.cache||!0!==e.route.cache&&0!==e.route.cache)&&(!e.route.hasOwnProperty("cache")||!1===e.route.cache||(!0===e.route.cache&&"boolean"!=typeof config.cache&&(i=config.options.cache),"boolean"!=typeof e.route.cache&&(i=e.route.cache),Math.round((new Date).getTime()/1e3)>t.time+i))}function doCache(e){var t=getStageDefault(app.getStage());if(t){t.uxi.detach();var i={url:e.url,uxi:t.uxi,time:Math.round((new Date).getTime()/1e3)};cache.insert(i),debug(4,"Router caching at",route.url)}}function unCache(e){var t=getCache(e);t&&(t.uxi.kill(),cache.findDelete("url",e.url,1))}function useCache(e){var t=getCache(e);if(t){var i=app.getStage();t.uxi.attach(i,$(i.pholder)),cache.delete("url",e.url,1),route=e}}function getCache(e){return cache.get({url:{eq:e.url}},null,1)}function findRoute(e){var t,i,a,n;debug(4,"Router route lookup",e);var o,r=[],s=OGX.Data.clone(config.routes);for(var l in s){for(r=[],o=s[l],a=l;i=/(?!\/)([a-z0-9_\-]+)\:([^\/]+)/gi.exec(a);)a=a.replace(i[0],i[2]),r.push(i[1]);if((t=e.match("^"+a+"$"))&&t.length){t.shift(),"string"==typeof o&&(debug(2,'Setting OML as string in route is deprecated, use {oml:"'+e+'"}'),o={oml:OGX.Data.clone(OGX.Cache.read("oml",o))}),"string"==typeof o.oml&&(o.oml=OGX.Data.clone(OGX.Cache.read("oml",o.oml))),n={};for(var d=0;d<t.length;d++)n[r[d]]=t[d];return{stage:e.split("/").shift(),route:o,data:n,pattern:l}}}return debug(1,"Route not found",e),!1}function clearStage(e){var t=getStageDefault(e);t&&(t.uxi.kill(),t.pl.empty())}function getStageDefault(e){var t=e.selector+" "+e.pholder,i=$(t),a=app.cfind(null,String(i.find(".ogx_uxi").first().data("ogx-id")));return!!a&&("Scroller"===a._NAME_&&(a=a.parent),{uxi:a,pl:i})}function onBackButton(e){e.preventDefault(),e.stopImmediatePropagation(),locked||navigator.app.backHistory()}function onPopState(e){if(locked)return e.preventDefault(),e.stopImmediatePropagation(),!1;null!==e.originalEvent.state?app.goto(e.originalEvent.state.url,{history:!1}):-1!==window.location.href.indexOf("#")&&app.goto(window.location.href.split("#").pop(),{history:!1})}function captureLink(e){var t=e.originalEvent,i=$(this),a=i.attr("href");if(0===a.indexOf("/")){if(e.preventDefault(),e.stopImmediatePropagation(),a=a.slice(1),t.ctrlKey||t.shiftKey||t.metaKey||t.button&&1==t.button)return config.options.jail?($(document).trigger(OGX.Router.GOTO,a),void setTimeout((()=>{that.goto(a)}),0)):(a=window.location.protocol+"//"+window.location.host+"/app#"+a,window.open(a,"_blank").focus());$(document).trigger(OGX.Router.GOTO,a);var n=!1,o=!0;i[0].hasAttribute("data-reload")&&(n=i.data("reload")),i[0].hasAttribute("data-history")&&(o=i.data("history")),setTimeout((()=>{that.goto(a,{reload:n,history:o})}),0)}}function onFocus(){blured=!1;var e=0;config.options.idle&&"boolean"!=typeof config.options.idle&&(e=config.options.idle),route.route.hasOwnProperty("idle")&&route.route.idle&&(e=route.route.idle),route&&time&&e&&(new Date).getTime()-time>1e3*e&&that.goto(route.url,{reload:!0,history:!1})}function onBlur(){blured=!0,time=(new Date).getTime()}function handleVisibilityChange(){"visible"===document.visibilityState?onFocus():onBlur()}function init(){request={route:null,url:global_url,origin:global_url};var e=null;if(-1!==window.location.href.indexOf("#")){e=window.location.href.split("#").pop(),request.url=e;var t=findRoute(e);t?request.route=t:(debug(2,"404",e),config.errors[404]?(t=findRoute(config.errors[404]),request.route=t):$(document).trigger(OGX.Router.NOT_FOUND,{url:e}))}$(document).on("click touchstart mousedown","a",captureLink),config.options.idle&&$(document).on("visibilitychange",handleVisibilityChange)}this.url=()=>global_url,this.start=()=>{$(document).on("backbutton",onBackButton),$(window).on("popstate",onPopState)},this.stop=()=>{$(document).off("backbutton",onBackButton),$(window).off("popstate",onPopState)},this.lock=()=>{locked=!0},this.unlock=()=>{locked=!1},this.gate=e=>{"function"==typeof e?gate=e:debug(1,"Router gate must be a function")},this.isLocked=()=>locked,this.add=(e,t)=>{var i={url:e};history.pushState(i,"title"+(new Date).getTime(),page+"#"+e),global_url=e,void 0===t&&(t=app.getStage()),t.url=e},this.addToHist=e=>{debug(1,"Router addToHist flag has been deprecated, use add"),this.add(e)},this.request=()=>(request.origin?request.window=!1:request.window=init_url,request),this.expire=e=>{var t=getCache({url:e});t&&unCache(t)},this.goto=(__url,__options)=>{if(route?debug(3,"Router navigate from",global_url,"to",__url):debug(3,"Router navigate to",__url),!locked){void 0!==__options&&__options||(__options={}),OGX.Data.merge(__options,options_default);var r=findRoute(__url);if(request.url=__url,request.origin=global_url,r){request.route=r,r.route.hasOwnProperty("reload")&&(__options.reload=r.route.reload),r.route.hasOwnProperty("scope")||(r.route.scope="public");var access=!0;if(OGX.Scope.eval(r.route.scope)||(debug(2,"invalid scope for",__url),access=!1),config.options.eval){var fnc=eval(config.options.eval);if(!fnc)return debug(1,"route eval function not set!",config.options.eval),!1;if(fnc){var res=fnc(r);res||(access=!1)}}if(!access)return config.errors.hasOwnProperty("403")?setTimeout((()=>{app.goto(config.errors[403],{history:!0})}),0):$(document).trigger(OGX.Router.FORBIDDEN,{url:__url,scope:r.route.scope}),!1;if(delete r.route.scope,r.route.hasOwnProperty("origin")){debug(5,"Router test origin",global_url,r.route.origin);for(var valid=!1,origins=r.route.origin.split(","),reg,i=0;i<origins.length;i++){if("null"===origins[i]&&!global_url){valid=!0;break}if("self"===origins[i]){if(reg=r.pattern.replace(/([a-z]+:)/,""),RegExp(reg).test(global_url)){valid=!0;break}}else if(0===global_url.indexOf(origins[i])){valid=!0;break}}if(!valid)return debug(1,"Expected origin",r.route.origin),void app.goto(global_url);debug(5,"Router origin valid",r.route.origin),delete r.route.origin}if(gate){if(!gate(__url,__options))return void debug(2,"Router nav prevented from gate",__url);gate=null}route&&isCachable(route)&&doCache(route),r.url=__url,pattern=r.pattern;var stage=app.getStage(),render=!0,same=!0;if(r.stage!==stage.id&&(stage=app.cfind("Stage",r.stage),same=!1),stage.url===r.url?__options.reload?clearStage(stage):render=!1:same&&clearStage(stage),same||(app.showStage(r.stage),stage=app.getStage()),stage.pattern=pattern,__options.history?this.add(__url,stage):(global_url=__url,stage.url=__url),config.options.cache&&cache.length&&isCachable(r)){var c=getCache(r);if(c){var cache_valid=!cacheExpired(r);if(cache_valid)return debug(4,"Router re-use cache for",r.url),useCache(r),!0;debug(4,"Router no cache found for",r.url),unCache(r)}}return route=r,render&&OGX.OML.render(stage,r.route.oml,__options.data,r.data),time=(new Date).getTime(),!0}return debug(2,"404",__url),config.errors[404]?setTimeout((()=>{app.goto(config.errors[404],{history:!0})}),0):$(document).trigger(OGX.Router.NOT_FOUND,{url:__url}),!1}return!1},init()},OGX.Router.BACK="RouterBack",OGX.Router.EXIT="RouterExit",OGX.Router.GOTO="RouterGoto",OGX.Router.FORBIDDEN="403",OGX.Router.NOT_FOUND="404",void 0===OGX)var OGX={};if(OGX.Scope=function(e){"use strict";var t="public",i=!1,a=e;this.CHANGE="ScopeChange",this.scope=e=>void 0===e?t:(Array.isArray(e)&&(debug(2,"Deprecated, Scope must now be passed as string"),e=e.join(" ")),a?($(document).trigger(OGX.Scope.CHANGE),!1):(t=e,!0)),this.token=(e,a)=>{if(void 0===e)return!!i;var n=function(e){var t=JSON.parse(atob(e.split(".")[1]));if(t)return t;return!1}(e);return!(!n||n.iss!==a)&&(i=e,t=n.scope,$(document).trigger(OGX.Scope.CHANGE),!0)},this.eval=(e,i)=>{void 0===i&&(i=t),Array.isArray(e)&&(e=e.join(" ")),e=function(e){if(!e.match(/^\/\^?/))return e;for(var i,a=e.split(" "),n=0;n<a.length;n++)a[n].match(/^\/\^?/)&&(i=(i=(i=a[n].trim()).replace(/^\/\^?/,"")).replace(/\$?\/$/,""),i=new RegExp(i,"g"),e=t.match(i)?e.replace(a[n],"1"):e.replace(a[n],"0"));return e}(e);var a=i;"string"==typeof a&&(a=a.split(" "));var n=e.match(/(?!0|1)([a-z0-9_]+)/gi);if(n&&n.length)for(var o=0;o<n.length;o++)e=a.includes(n[o])?e.replace(n[o],"1"):e.replace(n[o],"0");e=e.replace(/ /g,"|");try{var r=new Function("return "+e+";")();return"number"==typeof r&&r>0}catch(e){debug(1,e)}return!1},this.fork=e=>{for(var t in e)if(this.eval(t))return e[t];return!1}},void 0===OGX)var OGX={};if(require("Scroller","Uxi","Touch"),OGX.Scroller=function(e){construct(this,"Scroller");var t,i,a,n,o,r,s,l,d,c,u,h=this,g=e,f={check_delay:30,fade_delay:300,css:!1,zindex:9999,observe:!0,auto_scroll:!1,scroll_callback:!1,trigger:!0,content:!1,overflow:!0},p=0,_="init",m=!1,v=!1,y=null;function x(e){e?i.on(h.touch.down,O):i.off(h.touch.down,O)}function O(e){e=h.event(e),S(!1),G(!0),b(!0),x(!1),L("in"),E(!0)}function b(e){e?(c=setInterval(D,10),i.on(h.touch.move,w)):(clearInterval(c),i.off(h.touch.move,w))}function w(e){e=h.event(e)}function G(e){e?$(document).on(h.touch.up,X):$(document).off(h.touch.up,X)}function X(){b(!1),G(!1),x(!0),E(!1),L("out")}function T(e){e?(window.addEventListener("resize",N),i.on("scroll",(function(e){e.stopImmediatePropagation(),D()})),i.on("wheel",(function(e){E(!0)})),void 0!==OGX.NestedList&&$(document).on(OGX.NestedList.OPENED+" "+OGX.NestedList.CLOSED,(function(){h.update()}))):(window.removeEventListener("resize",N),i.off("scroll"),i.off("wheel"),void 0!==OGX.NestedList&&$(document).off(OGX.NestedList.OPENED+" "+OGX.NestedList.CLOSED))}function D(){var e,n=(e=i.scrollTop())/s,r=Math.round(o.position().top);o.css("top",n+"px"),g.trigger&&!m&&(h.el.trigger(OGX.Scroller.SCROLL,{top:e,percent:100*e/a}),-1*e==i.outerHeight(!0)-t.outerHeight(!0)?r!==Math.ceil(n)&&h.el.trigger(OGX.Scroller.BOTTOM):0===e&&(r&&r!==Math.round(n)||!r)&&h.el.trigger(OGX.Scroller.TOP)),g.scroll_callback&&g.scroll_callback()}function E(e){e?(d&&E(!1),l=t.position().top,d=setInterval(C,g.check_delay-10)):(d&&(clearInterval(d),d=null),v=!1,h.el.trigger(OGX.Scroller.END))}function C(){var e=t.position().top;e!==l?(v||(v=!0,h.el.trigger(OGX.Scroller.START)),L("in")):L("out"),l=e}function S(e){e?u=setInterval(D,g.check_delay):clearInterval(u)}function L(e){o.hasClass("ogx_scroller_track_anim")||o.addClass("ogx_scroller_track_anim"),"in"===e?(clearTimeout(y),y=null,o.addClass("ogx_scroller_track_anim_fade_in").removeClass("ogx_scroller_track_anim_fade_out")):y||(y=setTimeout((()=>{o.addClass("ogx_scroller_track_anim_fade_out").removeClass("ogx_scroller_track_anim_fade_in")}),g.fade_delay))}function k(e){e?h.observe(!0,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","src","width","height"]},M):h.observe(!1)}function M(){p!==t.height()&&(p=t.height(),N(),g.auto_scroll&&h.bottom())}function N(){if(n=i.innerHeight(),a=t.height(),s=a/n,a>n){var e=Math.round(n/s);o.css("height",e+"px"),r.css("display","block")}else r.css("display","none");"init"===_&&(_=OGX.Scroller.READY,h.el.trigger(OGX.Scroller.READY))}this.onFocus=()=>(N(),T(!0),g.observe&&setTimeout((()=>{k(!0)}),0),x(!0),debug(5,"scroller",g.id,"enabled"),this),this.onBlur=()=>(T(!1),g.observe&&k(!1),G(!1),b(!1),x(!1),E(!1),S(!1),o.removeClass("ogx_scroller_track_anim_fade_in"),o.removeClass("ogx_scroller_track_anim_fade_out"),debug(5,"scroller",g.id,"disabled"),this),this.resize=()=>(N(),this),this.destroy=()=>{h.el.removeClass("ogx_scroller_outer"),t.remove(),r.remove()},this.overflow=e=>{if(void 0===e)return g.overflow;g.overflow!==e&&(g.overflow=e,e?(this.onFocus(),this.el.removeClass("ogx_scroller_no_overflow")):(this.onBlur(),this.el.addClass("ogx_scroller_no_overflow")))},this.top=()=>(a>n&&(i[0].scrollTop=0,N()),this),this.bottom=()=>(a>n&&(i.scrollTop(a),N()),this),this.max=()=>t.height()-i.height(),this.scroll=e=>void 0===e?i[0].scrollTop:(i[0].scrollTop=e,N(),this),this.mute=()=>(m=!0,this),this.vocal=()=>(m=!1,this),this.container=()=>t,this.inner=()=>t[0],this.outer=()=>i[0],this.state=()=>_,OGX.Data.merge(g,f),function(){h.el=$(g.el),h.el.addClass("ogx_scroller_outer ogx_hw"),(i=h.el).html('<div class="ogx_scroller_inner ogx_hw"></div>'),t=i.children(".ogx_scroller_inner"),g.content&&t.append(g.content);var e='<div class=ogx_scroller_track ogx_hw" style="z-index:'+g.zindex+';" data-ogx-scroller="'+h.id+'"><div class="ogx_scroller_track_button" data-ogx-scroller="'+h.id+'"></div></div>';i.parent().append(e),r=i.parent().find(".ogx_scroller_track"),o=r.find(".ogx_scroller_track_button")}(),N(),debug(5,"scroller",g.id,"init")},OGX.Scroller.READY="ScrollerReady",OGX.Scroller.TOP="ScrollerTop",OGX.Scroller.BOTTOM="ScrollerBottom",OGX.Scroller.SCROLL="ScrollerScroll",OGX.Scroller.START="ScrollerStart",OGX.Scroller.END="ScrollerEnd",void 0===OGX)var OGX={};if(require("StackedTree","Uxi","Touch"),OGX.StackedTree=function(e){construct(this,"StackedTree");var t,i,a,n,o=this,r={scope:["public"],speed:200,list:[],display:{html:"{{$label}}"},displays:!1,chromeos:!1},s=e,l=[],d=[0],c=0,u=!1,h="ogx_stacked_tree";function g(e){e?(t.on(o.touch.down,".ogx_stacked_tree_level .ogx_stacked_tree_level_prev",f),t.on(o.touch.down,".ogx_stacked_tree_level_list .ogx_dynamic_list_item",(function(e){var t=$(this).data("ogx-id");t--,function(e,t){u=t;var i=l[c].findIndex("__id__",t.__id__);t.hasOwnProperty("items")&&t.items.length&&function(e){if(!e.hasOwnProperty("scope"))return!0;for(var t=0;t<s.scope.length;t++)if(-1!==e.scope.indexOf(s.scope[t]))return!0;return!1}(t)?(d.push(i),m(c+1,t.items),o.el.trigger(OGX.StackedTree.ENTER,t),setTimeout((()=>{v(c+1)}),0)):o.el.trigger(OGX.StackedTree.SELECT,t)}(0,l[c].val()[t])}))):(t.off(o.touch.down,".ogx_stacked_tree_level .ogx_stacked_tree_level_prev",f),t.off(o.touch.down,".ogx_stacked_tree_level_list .ogx_dynamic_list_item"))}function f(e){e.preventDefault(),e.stopImmediatePropagation(),v(c-1,!0),d.pop(),o.el.trigger(OGX.StackedTree.BACK)}function p(e){e?$(window).on("resize",_):$(window).off("resize",_)}function _(){i.removeClass(h+"_anim"),a=i.width(),i.css("transform","translateX("+c*Math.round(a/d.length)*-1+"px)")}function m(e,t){i.removeClass(h+"_anim").css("width",100*(e+1)+"%"),a=i.width();var r,d='<div class="'+h+'_level" data-level="'+e+'">';e>0&&(r=(r=n.css(u)).replace(h+"_door",""),d+='<div class="'+h+"_item ogx_stacked_tree_level_prev "+r+'">'+n.html(u)+"</div>"),d+='<div class="'+h+'_level_list"></div></div>',i.append(d),i.children("."+h+"_level").css("flex-basis",Math.floor(100/(e+1)*100)/100+"%"),function(e,t,i){l[e]&&o.remove(l[e].id,"DynamicList");var a=o.create("DynamicList",{el:t,mode:"static",scroll:!0,display:s.display,displays:s.displays,list:i});l[e]=a}(e,"."+h+'[data-ogx-id="'+o.id+'"] > .'+h+"_container > ."+h+'_level[data-level="'+e+'"] > .'+h+"_level_list",t)}function v(e,t){g(!1),i.addClass(h+"_anim"),void 0!==t&&t?i.on("transitionend",(function(){i.off("transitionend"),i.removeClass(h+"_anim").css("width",100*(e+1)+"%"),o.remove(l[e+1].id,"DynamicList"),l.splice(e+1,1),i.children("."+h+'_level[data-level="'+(e+1)+'"]').remove(),i.children("."+h+"_level").css("flex-basis",Math.floor(100/(e+1)*100)/100+"%"),a=i.width(),u=!1,c=e,g(!0)})):(c=e,g(!0)),a=i.width(),i.css("transform","translateX("+e*Math.round(a/d.length)*-1+"px)")}this.onFocus=()=>{g(!0),p(!0),debug(5,"stackedtree",s.id,"enabled")},this.onBlur=()=>{g(!1),p(!1),debug(5,"stackedtree",s.id,"disabled")},this.resize=()=>(_(),this),this.destroy=()=>{debug(5,"stackedtree destroy",s.id)},this.val=e=>{if(e.length){var t=e.slice();return s.list={items:t},!0}return!1},this.scope=e=>void 0!==e?(s.scope=e,d=[0],c=0,u=!1,!0):s.scope,debug(5,"stackedtree",s.id,"init"),function(){if(void 0!==OGX.DynamicList)if(void 0!==OGX.Display){s=OGX.Data.merge(s,r,!1,!0);var e=(n=new OGX.Display(s)).val();if(e=function(e){if(e.display&&"object"==typeof e.display&&!e.display.hasOwnProperty("bind")&&(e.display=i(e.display)),e.displays)for(var t in e.displays)e.displays[t]=i(e.displays[t]);function i(e){var t=['{{return typeof($items) !== "undefined" && $items.length > 0}}',{add:"ogx_stacked_tree_door"}];if(e.hasOwnProperty("css"))if("object"==typeof e.css)e.css.hasOwnProperty("add")&&e.css.add?e.css.add+=" ogx_stacked_tree_item":e.css.add="ogx_stacked_tree_item",e.css.hasOwnProperty("conditions")?e.css.conditions.push(t):e.css.conditions=[t];else{var i="";e.css&&(i=e.css),i+=" ogx_stacked_tree_item",e.css={add:i,conditions:[t]}}else e.css={add:"ogx_stacked_tree_item",conditions:[t]};return e}return e}(e),n.val(e),s.display=e.display,s.displays=e.displays,(t=o.el).addClass(h),s.list.length){var i=s.list.slice();s.list={items:i}}}else debug(1,"OGX.Display not found! ");else debug(1,"OGX.DynamicList not found! ")}(),t.html('<div class="'+h+'_container" style="width:100%"></div>'),i=t.children("."+h+"_container").first(),s.list.items.length&&m(d[0],s.list.items)},OGX.StackedTree.BACK="StackedTreeBack",OGX.StackedTree.ENTER="StackedTreeEnter",OGX.StackedTree.SELECT="StackedTreeSelect",require("Stage","Uxi","Touch","Placeholder"),OGX.Stage=function(e){construct(this,"Stage");var t=this,i=OGX.Data.merge({id:"stage",anim:null,group_watch:!1},e,!0,!0);function a(e){e?t.el.on(t.touch.down,".ogx_stage_exit",(function(){app.theater.show()})):t.el.off(t.touch.down,".ogx_stage_exit")}this.id=i.id,this.anim=i.anim,this.theater=!1,this.home=null,this.url=null,this.route=null,this.__proto__.onFocus=function(){return i.closeable&&a(!0),this},this.__proto__.onBlur=function(){return i.closeable&&a(!1),this},function(){i.hasOwnProperty("theater")&&(t.theater=i.theater),t.home=i.home;var e=new OGX.Display(i),a="block";i.hasOwnProperty("use")&&i.use||(a="none");var n="";i.closeable&&(n='<div class="ogx_stage_exit"></div>');var o=e.html();i.hasOwnProperty("data")&&(o=OGX.Templater.make(o,i.data)),n+=o,container=t.el,container.html(n),container.addClass("ogx_stage").css("display",a)}()},OGX.Stage.SWAP="swap",OGX.Stage.FLIP="flip",void 0===OGX)var OGX={};if(require("Switch","Uxi","Bind","Touch"),OGX.Switch=function(e){construct(this,"Switch");var t,i=this,a=e,n={el:"document",bind:!1,labels:!0,data:[{label:"OFF",value:!1},{label:"ON",value:!0}],value:!1,name:!1,callbacks:{change:null}},o="ogx_switch";function r(e){a.value===a.data[0].value?a.value=a.data[1].value:a.value=a.data[0].value,s(e)}function s(e){e=void 0!==e;var i=t.find("."+o+"_dot").first(),n=t.find("."+o+"_label").first(),r=t.find("."+o+"_label").last();a.value==a.data[0].value?(i.removeClass(o+"_dot_right").addClass(o+"_dot_left"),n.removeClass(o+"_label_off").addClass(o+"_label_on").addClass(o+"_selected"),r.removeClass(o+"_label_on").addClass(o+"_label_off").removeClass(o+"_selected")):(i.removeClass(o+"_dot_left").addClass(o+"_dot_right"),r.removeClass(o+"_label_off").addClass(o+"_label_on").addClass(o+"_selected"),n.removeClass(o+"_label_on").addClass(o+"_label_off").removeClass(o+"_selected")),a.name&&t.find('input[type="hidden"]').attr("value",a.value),e&&t.children("."+o+"_val").trigger("input")}function l(e){e?t.on(i.touch.down,d):t.off(i.touch.down,d)}function d(e){e.preventDefault(),e.stopImmediatePropagation(),r(),c(!1),i.onChange(a.value),t.trigger(OGX.Switch.CHANGE,a.value),t.children("."+o+"_val").trigger("input"),c(!0)}function c(e){e?t.on("change","input[type=hidden]",u):t.off("change","input[type=hidden]",u)}function u(e){e.preventDefault(),e.stopImmediatePropagation(),a.value=OGX.Data.stringToVal(e.target.value),s()}this.construct=()=>{a.name&&c(!0)},this.onFocus=()=>(l(!0),t.removeClass(o+"_disabled"),debug(5,"switch",a.id,"enabled"),this),this.onBlur=()=>(l(!1),t.addClass(o+"_disabled"),debug(5,"switch",a.id,"disabled"),this),this.destroy=()=>{a.name&&c(!1)},this.bindRender=(e,t)=>{},this.val=(e,i)=>(void 0===i&&(i=!0),void 0!==e&&a.value!==e&&(r(),i&&t.children("."+o+"_val").first().trigger("input")),a.value),this.onChange=()=>{},this.toggle=e=>(r(e=void 0===e),this),debug(5,"switch",a.id,"init"),function(){var e;void 0===a&&(a={}),a.hasOwnProperty("data")&&!a.hasOwnProperty("value")&&(e=a.data[0].value),OGX.Data.merge(a,n),void 0!==e&&(a.value=e),(t=i.el).addClass(o+"_disabled");var r=t.parent();r[0].hasAttribute("data-value")&&(a.value=OGX.Data.stringToVal(r.data("value")),r.removeAttr("data-value"))}(),function(){var e="";a.labels&&(e+='<span class="'+o+'_label_on ogx_switch_label">'+a.data[0].label+"</span>");var i="";a.value===a.data[1].value&&(i=o+"_dot_right"),e+='<div class="'+o+'_track"><div class="'+o+'_track_bg"></div><div class="'+o+"_dot "+i+'"></div></div>',a.labels&&(e+='<span class="'+o+'_label_off ogx_switch_label">'+a.data[1].label+"</span>"),a.name&&(e+='<input class="'+o+'_val" type="hidden" name="'+a.name+'" value="'+a.value+'"></div>'),t.html(e),t.addClass(o)}(),setTimeout(s,0)},OGX.Switch.CHANGE="SwitchChange",OGX.Switch.BIND=OGX.Switch.CHANGE,require("Tabs","Uxi","Touch"),OGX.Tabs=function(e){construct(this,"Tabs");var t=this,i=e;e.hasOwnProperty("editable")&&debug(2,"Tabs editable deprecated, use add/remove");var a,n={editable:!1,detach:!1,detach_min:-4,add:!0,remove:!0,reorder:!0,icons:!1,index:0,list:new OGX.List,display:{html:"",css:""},callbacks:{select:null,close:null,add:null,remove:null}},o=!1,r=0,s=!1,l=!1,d=!1,c=!1,u=!1,h={x:0,y:0},g="ogx_tabs";function f(){r>0?r--:r=0,t.index(r)}function p(){for(var e,t,n='<div class="'+g+'_container">',s=0;s<i.list.length;s++)t=i.display.css(i.list[s]),s===r&&(t+=" ogx_tabs_tab_active"),e=!1,"string"==typeof i.list[s]?e=i.list[s]:(i.list[s].hasOwnProperty("label")&&(e=i.list[s].label),i.list[s].hasOwnProperty("enabled")&&i.list[s].enabled&&(t+=" "+g+"_tab_disabled")),n+='<div class="'+g+"_tab "+t+'">',i.icons&&(n+='<span class="'+g+'_tab_icon" style="background-image:url('+i.icon_path+"/"+i.list[s].icon+')"></span>'),e&&(n+='<span class="'+g+'_tab_label">'+e+"</span>"),i.remove&&(n+='<span class="'+g+'_tab_close"></span>'),n+="</div>",t="";n+="</div>",i.add&&(n+='<div class="'+g+'_tab_add"></div>',a.addClass(g+"_editable")),a.html(n),o=a.children("."+g+"_container").children("."+g+"_tab:eq("+r+")")}function _(e){s||(u=!1,l=$(e),r=l.index(),d={from:r},a.children("."+g+"_container").children("."+g+"_tab_active").first().removeClass(g+"_tab_active"),h.x=l.position().left,h.y=l.position().top,(s={el:$(e).clone(),x:h.x,y:l.position().top}).w=l.width(),s.el.width(s.w),l.addClass(g+"_tab_active").addClass(g+"_frozen"),o=l,s.el.addClass(g+"_tab_active").addClass(g+"_float").css("transform","translate3d("+h.x+"px, "+s.y+"px, 0px)"),a.children("."+g+"_container").prepend(s.el),a.trigger(OGX.Tabs.SELECT,i.list[r]),c=setInterval(v,5))}function m(e){if(s)if(u=e,Math.abs(u.distX)>Math.abs(u.distY)){var n=s.x+u.distX;s.el.css("transform","translate3d("+n+"px, "+s.y+"px, 0px)")}else{var o=s.y+u.distY;s.el.css("transform","translate3d("+s.x+"px, "+o+"px, 0px)");var r=s.el.offset();if(u.distY<i.detach_min){d.to=l.index(),y();var c=i.list[d.from],h={};"string"==typeof c?h.label=c:h=OGX.Data.clone(c),OGX.Data.merge(h,{index:d.to,x:r.left,y:r.top}),t.removeAt(d.to),t.onRemove(h),a.trigger(OGX.Tabs.REMOVE,h)}}}function v(){var e,t,i;s&&u&&(idx=l.index(),Math.abs(u.distX)>Math.abs(u.distY)&&a.children("."+g+"_container").children("."+g+"_tab").each((function(a,n){(e=$(n)).hasClass(g+"_tab_active")||(t=e.position(),i=e.width(),idx!==a&&(s.x+u.distX>t.left+i/2&&s.x+u.distX<t.left+i?(l.detach(),e.after(l)):s.x+u.distX>t.left&&s.x+u.distX<t.left+i/2&&(l.detach(),e.before(l))))})))}function y(){if(s&&(clearInterval(c),c=!1,u=!1,s.el.remove(),s=!1,l.removeClass(g+"_frozen"),d.to=l.index(),d.to!==d.from)){var e=i.list.splice(d.from,1);i.list.insert(e[0],d.to),r=d.to,t.el.trigger(OGX.Tabs.REORDER,d)}}function x(e){e?(a.on("click","."+g+"_tab",(function(){var e=$(this);e.hasClass(g+"_tab_disabled")||(o&&o.removeClass(g+"_tab_active"),e.addClass(g+"_tab_active"),r!==(o=e).index()&&(r=o.index(),t.onSelect(i.list[r]),a.trigger(OGX.Tabs.SELECT,i.list[r])))})),i.add&&a.on("click",".ogx_tabs_tab_add",(function(){t.addTab({label:"New tab"}),a.trigger(OGX.Tabs.ADD)})),i.remove&&a.on("click","."+g+"_tab_close",(function(e){e.preventDefault(),e.stopImmediatePropagation(),t.onClose(i.list[r]);var n=OGX.Data.clone(i.list[r]);return n.index=r,a.trigger(OGX.Tabs.REMOVE,n),t.removeCurrent(),!1}))):(a.off("click","."+g+"_tab"),i.add&&a.off("click","."+g+"_tab_add"),i.remove&&a.off("click","."+g+"_tab_close"))}this.onFocus=()=>(x(!0),i.reorder&&this.touch.get("tabs_hold").enable(),debug(5,"tabs",i.id,"enabled"),this),this.onBlur=()=>(x(!1),i.reorder&&this.touch.get("tabs_hold").disable(),debug(5,"tabs",i.id,"disabled"),this),this.empty=()=>(this.clear(),r=0,o=null,i.list=new OGX.List,a.empty(),this),this.destroy=()=>{this.touch.wipe()},this.val=e=>{if(void 0===e)return o;var t;"string"==typeof e?t=i.list.indexOf(e):e.hasOwnProperty("label")&&(t=(t=i.list.findIndex("label",e.label)).index),this.index(t)},this.set=e=>void 0===e?i.list:(e.hasOwnProperty("insert")||(e=new OGX.List(e)),i.list=e,setTimeout(p,0),this),this.onSelect=()=>{},this.onClose=()=>{},this.onAdd=()=>{},this.onRemove=()=>{},this.add=e=>(i.icons&&(e.hasOwnProperty("icon")||(e.icon=i.icon_default)),i.list.push(e),r=i.list.length-1,setTimeout((()=>{var e,t,i;p(),e=a.width(),t=a.children("."+g+"_container").first(),(i=t.width())>e&&t.css("transform","translateX("+-1*(i-e)+"px)")}),0),this),this.addAt=(e,t)=>(i.icons&&(e.hasOwnProperty("icon")||(e.icon=i.icon_default)),i.list.insert(e,t),r=t,setTimeout(p,0),this),this.remove=(e,t)=>{void 0===t&&(t=e,e="label");var n=i.list.findIndex(e,t);i.list.findDelete(e,t,1)&&(a.children("."+g+"_container").first().children("."+g+"_tab:eq("+n.index+")").remove(),f())},this.removeCurrent=()=>(o&&this.removeAt(r),this),this.removeAt=e=>(i.list.delete(e)&&(a.children("."+g+"_container").first().children("."+g+"_tab:eq("+e+")").remove(),f()),this),this.enableTab=e=>(a.children("."+g+"_container").first().children("."+g+"_tab:eq("+e+")").removeClass(g+"_tab_disabled"),this),this.disableTab=e=>(a.children("."+g+"_container").first().children("."+g+"_tab:eq("+e+")").addClass(g+"_tab_disabled"),this),this.index=e=>void 0!==e?(o&&(o.removeClass(g+"_tab_active"),o=null),(o=a.children("."+g+"_container").first().children("."+g+"_tab:eq("+e+")")).addClass(g+"_tab_active"),r=e,!0):o?r:-1,this.select=e=>{o&&o.removeClass(g+"_tab_active");var t=i.list.findIndex("label",e);return this.index(t.index),this},void 0!==OGX.List?(debug(5,"tabs",i.id,"init"),i||(i={}),OGX.Data.merge(i,n),i.list.hasOwnProperty("insert")||(i.list=new OGX.List(i.list)),i.display.hasOwnProperty("_NAME_")||(i.display=new OGX.Display(i.display)),i.callbacks.select||(i.callbacks.select=t.onSelect),i.callbacks.close||(i.callbacks.close=t.onClose),i.callbacks.add||(i.callbacks.add=t.onAdd),i.callbacks.remove||(i.callbacks.remove=t.onRemove),(a=t.el).addClass(g),i.editable&&a.addClass(g+"_editable"),r=i.index,setTimeout(p,0),i.reorder&&t.touch.add("Hold",{id:"tabs_hold",cb_hold:_,cb_move:m,cb_up:y,state:"manual",time:1e3,target:".ogx_tabs_tab",capture:!1})):debug(1,"OGX.List not found! ")},OGX.Tabs.SELECT="TabsSelect",OGX.Tabs.REORDER="TabsReorder",OGX.Tabs.ADD="TabsAdded",OGX.Tabs.REMOVE="TabsRemoved",void 0===OGX)var OGX={};if(require("Tags","Uxi","Touch"),OGX.Tags=function(__config){construct(this,"Tags");var that=this,config_default={remove:!0,add:!0,name:!1,tags:[],current_tags:[],tags_ascii:[],mode:OGX.Tags.MODE_STRING,keycode:13,placeholder:"keywords",restrict:!1,strict:!1,required:!1,max:0,display_max:0,display_more:!1,click_more:!1,hide_input_on_disable:!0,more_word:"other",callbacks:{select:null,add:null,remove:null}},container,input,sliced={org:[],rem:[]},config=OGX.Data.merge(__config,config_default,!1);function updateHidden(e){var t;t=1===config.max&&config.current_tags.length?config.current_tags[0]:JSON.stringify(config.current_tags),container.find("input[type=hidden]").val(t),e&&container.find("input[type=hidden]").trigger("change")}function addTag(e){var t=!1;switch(config.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:-1===config.current_tags.indexOf(e)&&(config.current_tags.push(e),t=!0);break;case OGX.Tags.MODE_OBJECT:var i=config.current_tags.find("label",e,1);i||((i=config.tags.find("label",e,1))?config.current_tags.push(i):config.current_tags.push({label:e}),t=!0)}if(t){var a="";!0===config.remove&&(a='<span class="ogx_tags_remove"></span>');var n='<span class="ogx_tags_tag"><span>'+e+"</span>"+a+"</span>";container.find(".ogx_tags_tags").first().append(n),listenHidden(!1),updateHidden(!0),listenHidden(!0),that.onAdd(e),container.trigger(OGX.Tags.TAG_ADDED,e),container.trigger(OGX.Tags.CHANGE,[config.current_tags])}container.find(".ogx_tags_input").trigger("focus")}function removeTag(e){var t=!1;switch(config.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:var i=config.current_tags.indexOf(e);i>-1&&(t=config.current_tags.splice(i,1));break;case OGX.Tags.MODE_OBJECT:t=config.current_tags.findDelete("label",e)}return t&&container.find(".ogx_tags_tags").first().find(".ogx_tags_tag").each((function(t,i){if($(i).find("span").first().text()===e)return $(i).remove(),listenHidden(!1),updateHidden(!0),void listenHidden(!0)})),t}function displayTags(e,t){if(e){container.find(".ogx_tags_container").length>0&&(displayTags(!1),listenTagAdd(!1));for(var i='<div class="ogx_tags_container">',a=!1,n=0;n<t.length;n++)if("object"==typeof t[n]&&t[n].hasOwnProperty("__m__"))a=t[n].__m__;else switch(config.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:i+='<span class="ogx_tags_tag ogx_tags_container_tag">'+t[n]+"</span>";break;case OGX.Tags.MODE_OBJECT:i+='<span class="ogx_tags_tag ogx_tags_container_tag">'+t[n].label+"</span>"}a&&(i+='<span class="ogx_tags_tag ogx_tags_more">+'+a+" "+config.more_word+"</span>"),i+="</div>",container.append(i),listenTagAdd(!0)}else container.find(".ogx_tags_container").remove(),listenTagAdd(!1)}function renderTags(e){for(var t="",i="",a=0;a<e.length;a++)switch(i=!0===config.remove?'<span class="ogx_tags_remove"></span>':"",config.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:t+='<span class="ogx_tags_tag"><span>'+e[a]+"</span>"+i+"</span>";break;case OGX.Tags.MODE_OBJECT:t+='<span class="ogx_tags_tag"><span>'+e[a].label+"</span>"+i+"</span>"}return config.current_tags=e,container.find(".ogx_tags_tags").first().html(t),updateHidden(!1),!0}function trimTags(e){return e=OGX.Data.clone(e),sliced={org:OGX.Data.clone(e),rem:[]},Array.isArray(e)&&config.display_max&&e.length>config.display_max&&(sliced.rem=e.slice(config.display_max),e=e.slice(0,config.display_max)),config.display_more&&sliced.rem.length&&e.push({__m__:sliced.rem.length}),new OGX.List(e)}function findTags(e){for(var t,i=[],a=0;a<config.tags.length;a++)if(t=!1,0===config.tags[a].toLowerCase().indexOf(e.toLowerCase())&&-1===config.current_tags.indexOf(config.tags[a])){if(config.display_max){if(!(i.length+1<=config.display_max))return i;t=!0}else t=!0;t&&i.push(config.tags[a])}return trimTags(i)}function findTagsObj(e){var t=new RegExp(e,"gi"),i=config.tags.find("label",t);if(i&&i.length)for(var a=0;a<config.current_tags.length;a++)i.findDelete("label",config.current_tags[a].label);return i&&i.length?trimTags(i):[]}function findTagsAscii(e){var t,i=stringToAscii(e.substr(0,3)),a=[];if(config.tags_ascii[i])for(var n=0;n<config.tags_ascii[i].length;n++)if(t=!1,-1!==config.tags_ascii[i][n].toLowerCase().indexOf(e.toLowerCase())&&-1===config.current_tags.indexOf(config.tags[n])){if(config.display_max){if(!(a.length+1<=config.display_max))return a;t=!0}else t=!0;t&&a.push(config.tags_ascii[i][n])}return a&&a.length?trimTags(a):[]}function stringToAscii(e){for(var t="",i=0;i<e.length;i++)t+=e.toLowerCase().charCodeAt(i).toString();return t}function listenInput(e){e?input.on("keyup",(function(e){var t=$(this).val();if(t.length>=3)if(!config.strict&&e.which===config.keycode&&config.add)addTag(t),input.val(""),displayTags(!1);else{var i;switch(config.mode){case OGX.Tags.MODE_STRING:i=findTags(t);break;case OGX.Tags.MODE_OBJECT:i=findTagsObj(t);break;case OGX.Tags.MODE_ASCII:i=findTagsAscii(t)}i.length>0?displayTags(!0,i):displayTags(!1)}else displayTags(!1)})):input.off("keyup")}function listenSelect(e){e?container.on(that.touch.down,".ogx_tags_tag",onSelect):container.off(that.touch.down,".ogx_tags_tag",onSelect)}function onSelect(e){var t=$(this).text();switch(config.mode){case OGX.Tags.MODE_OBJECT:t=config.current_tags.get({label:{eq:t}},null,1)}config.callbacks.select(t),that.el.trigger(OGX.Tags.SELECT,t)}function listenMore(e){e?container.on(that.touch.down,".ogx_tags_more",onMore):container.off(that.touch.down,".ogx_tags_more",onMore)}function onMore(e){e.preventDefault(),e.stopImmediatePropagation(),sliced.rem.length&&($(this).remove(),displayTags(!0,sliced.org))}function listenTagAdd(e){e?container.on(that.touch.down,".ogx_tags_container_tag",onAdd):container.off(that.touch.down,".ogx_tags_container_tag",onAdd)}function onAdd(e){addTag($(this).text()),input.val(""),displayTags(!1),config.max&&config.current_tags.length===config.max&&(listenInput(!1),input.css("display","none"))}function listenTagRemove(e){e?container.on(that.touch.down,".ogx_tags_remove",onRemove):container.off(that.touch.down,".ogx_tags_remove",onRemove)}function onRemove(e){e.preventDefault(),e.stopImmediatePropagation();var t=removeTag($(this).parent("span").first().find("span").first().text());that.onRemove(t),container.trigger(OGX.Tags.TAG_REMOVED,t),container.trigger(OGX.Tags.CHANGE,[config.current_tags]),config.max&&config.current_tags.length<config.max&&(listenInput(!0),input.css("display","block")),input.trigger("focus")}function listenHidden(e){e?container.on("change","input[type=hidden]",onHiddenChange):container.off("change","input[type=hidden]",onHiddenChange)}function onHiddenChange(e){e.preventDefault(),e.stopImmediatePropagation(),e.target.value.length?config.current_tags=JSON.parse(e.target.value):config.current_tags=[],renderTags(config.current_tags)}function initInput(){var e='<span class="ogx_tags_tags"></span>';if(config.add&&(e+='<input type="text" class="ogx_tags_input" placeholder="'+config.placeholder+'">'),config.name){var t="";config.required&&(t="required"),e+='<input type="hidden" name="'+config.name+'" '+t+">"}if(container.html(e),input=container.find(".ogx_tags_input").first(),config.restrict){var i={multiline:!1,max:30};"object"==typeof config.restrict&&(i=config.restrict),i.el=input[0],OGX.Form.restrictField(i)}}function initDefaults(){config.tags.hasOwnProperty("insert")||(config.tags=new OGX.List(config.tags)),config.current_tags.hasOwnProperty("insert")||(config.current_tags=new OGX.List(config.current_tags)),config.restrict&&("string"==typeof config.restrict.allowed&&(config.restrict.allowed=eval(config.restrict.allowed)),"string"==typeof config.restrict.forbidden&&(config.restrict.forbidden=eval(config.restrict.forbidden))),config.callbacks.select||(config.callbacks.select=that.onSelect),config.callbacks.add||(config.callbacks.add=that.onAdd),config.callbacks.remove||(config.callbacks.remove=that.onRemove),container=that.el,container.addClass("ogx_tags")}function init(){void 0!==OGX.List?config&&config.restrict&&void 0===OGX.Form?debug(1,"OGX.Form not found! "):(initDefaults(),initInput(),config.current_tags.length>0&&renderTags(config.current_tags)):debug(1,"OGX.List not found! ")}this.onFocus=()=>{if(config.remove&&(listenInput(!0),listenTagAdd(!0),listenTagRemove(!0)),config.display_more&&config.click_more&&listenMore(!0),config.name&&listenHidden(!0),listenSelect(!0),config.add){var e=container.find(".ogx_tags_input").first();e.prop("placeholder",config.placeholder),e.prop("disabled",!1),config.hide_input_on_disable&&e.removeClass("ogx_tags_hidden")}return debug(5,"tags",config.id,"enabled"),this},this.onBlur=()=>{if(config.remove&&(listenInput(!1),listenTagAdd(!1),listenTagRemove(!1)),config.display_more&&config.click_more&&listenMore(!1),config.name&&listenHidden(!1),listenSelect(!1),config.add){var e=container.find(".ogx_tags_input").first();e.prop("placeholder",""),e.prop("disabled",!0),config.hide_input_on_disable&&e.addClass("ogx_tags_hidden")}return debug(5,"tags",config.id,"disabled"),this},this.destroy=()=>{config.restrict&&OGX.Form.unrestrictField(container.find(".ogx_tags_input").first()[0])},this.tags=e=>void 0!==e?(e.hasOwnProperty("insert")||(e=new OGX.List(e)),config.tags=e,!0):config.tags,this.val=(e,t)=>{if(displayTags(!1),listenTagAdd(!1),void 0!==e){if(void 0!==t){var i=e,a=config.tags.find(i,t,1);a&&(e=[a])}return e.hasOwnProperty("insert")||(e=new OGX.List(e)),config.current_tags=e,config.max&&config.current_tags.length>=config.max&&container.find(".ogx_tags_input").first().css("display","none"),renderTags(config.current_tags)}return config.current_tags},this.wipe=()=>(config.max&&config.current_tags.length===config.max&&(container.find(".ogx_tags_input").first().css("display","block"),listenInput(!0)),config.current_tags=new OGX.List,container.find(".ogx_tags_tags").first().empty(),container.find("input[type=hidden]").first().val(""),this),this.clear=()=>(debug(2,"Tags clear is deprecated, use wipe"),this.wipe()),this.render=e=>renderTags(trimTags(e)),this.onSelect=()=>{},this.onAdd=()=>{},this.onRemove=()=>{},this.add=e=>addTag(e),this.remove=e=>removeTag(e),init()},OGX.Tags.prototype.tagDataset=function(e,t,i){"use strict";void 0===i&&(i=!1);for(var a,n=[],o=0;o<e.length;o++)for(var r=0;r<t.length;r++)if(e[o].hasOwnProperty(t[r])){a=e[o][t[r]].split(" ");for(var s=0;s<a.length;s++)i&&-1!==i.indexOf(a[s])||n.includes(a[s])||n.push(a[s])}return n},OGX.Tags.prototype.tagDatatree=function(e,t){"use strict";!function(e,t){var i=[];if(function e(a){if(a.hasOwnProperty("items"))for(var n=0;n<a.items.length;n++){for(var o in a.items[n])t.indexOf(o)>-1&&(i.includes(a.items[n][o])||i.push(a.items[n][o]));return e(a.items[n]),!0}}(e));}(e,t)},OGX.Tags.CHANGE="TagsChange",OGX.Tags.SELECT="TagsSelect",OGX.Tags.TAG_ADDED="TagsTagAdded",OGX.Tags.TAG_REMOVED="TagsTagRemoved",OGX.Tags.MODE_STRING="string",OGX.Tags.MODE_OBJECT="object",OGX.Tags.MODE_ASCII="ascii",OGX.Tags.BIND=OGX.Tags.CHANGE,require("Template"),OGX.Template=function(e){construct(this,"Template");var t=new OGX.Display(e),i=t.html(e.data),a=t.css(e.data);i&&this.el.html(i),a&&this.el.addClass(a)},void 0===OGX)var OGX={};if(OGX.Templater=function(){"use strict";var e;this.jmake=(e,t)=>{for(var i,a,n=JSON.stringify(e);m=/({{(\$|#)[a-z0-9_\.]*}})|("{{(\$)}}")/gi.exec(n);)m[0].match(/"{{(\$)}}"/)?(i="<-"+(i=JSON.stringify(t)).substring(1).slice(0,-1)+"->",n=(n=(n=n.replace(m[0],i)).replace(/<\-/,"{")).replace(/\->/,"}")):("object"==typeof(a=OGX.OSE.exec(m[0],t))&&(a=JSON.stringify(a),m[0]='"'+m[0]+'"'),n=n.replace(m[0],a));return JSON.parse(n)},this.make=(t,i,a,n,o)=>{var r,s;for(e={},void 0===o&&(o={}),OGX.Data.merge(e,o),debug(5,"Templatizing",t);r=/{{[^{]+(({[^{]+)+)?}}/gi.exec(t);)void 0===(s=OGX.OSE.exec(r[0],i,a,n,e))&&(s=""),t=t.replace(r[0],s);return debug(5,"Templatized",t),t},this.amake=(e,t,i,a,n)=>{for(var o="",r=0;r<t.length;r++)o+=this.make(e,t[r],i,a,n);return o},this.get=e=>{var t=OGX.Cache.read("html",e);return t||(debug(1,"Template",e,"not found"),!1)}},OGX.Templater=new OGX.Templater,require("Theater","Uxi","Touch"),OGX.Theater=function(e){construct(this,"Theater");var t,i,a,n=this,o=e,r={anim:!1,display:!0,icon_size:50,timeout:30},s={template:!1,html:'<span class="ogx_theater_stage_icon" style="background-image:url(\'{{$icon}}\')"></span><span class="ogx_theater_stage_label">{{$label}}</span>'},l='<div class="list"></div>',d=!0;function c(e){e?($(document).on("backbutton",u),$(window).on("popstate",u),list.el.on(OGX.DynamicList.SELECT,(function(e,t){!function(e){debug(3,"theater show stage",e),n.el.trigger(OGX.Theater.HIDE);var t=app.find("Stage",e);t.wake(),t.resizeNodes();var a,r=list.el.find('.ogx_theater_stage[data-ogx-id="'+t.id+'"]').position();n.observe(!0,{childList:!0},(function(){n.observe(!1),(a=i.children(".ogx_theater_trans")).on("transitionend",(function(){a.off("transitionend"),n.hide(),a.remove(),t.url?(app.showStage(t.id,!1),app.router.addToHist(t.url)):app.goto(t.id+"/"+t.home)})),a.removeClass("ogx_theater_trans_hide"),setTimeout((()=>{a.addClass("ogx_theater_trans_grow").css({opacity:1,width:"100%",height:"100%",transform:"translate3d(0px, 0px, 0px)"})}),o.timeout)}),null,i),i.append('<div class="ogx_theater_trans ogx_theater_trans_hide" style="width:'+o.icon_size+"px; height:"+o.icon_size+"px; transform:translate3d("+r.left+"px,"+r.top+'px, 0px);" data-ogx-id="'+t.id+'"><div class="icon" style="background-image:url(\'/img/'+t.theater.icon+"')\"></div></div>")}(t.id)}))):($(document).off("backbutton",u),$(window).off("popstate",u),list.el.off(OGX.DynamicList.SELECT))}function u(){n.hide()}function h(){t.prepend(l);for(var e,i=[],r=0;r<a.length;r++)e={id:a[r].id,name:"",icon:""},"object"==typeof a[r].theater&&a[r].theater.hasOwnProperty("icon")&&(e.icon="./img/"+a[r].theater.icon,e.label=a[r].theater.label),i.push(e);$(".ogx_theater > .list").on(OGX.DynamicList.RENDER,(function(e){$(".ogx_theater > .list").off(OGX.DynamicList.RENDER),setTimeout((()=>{l=$(".ogx_theater").detach()}),0)})),list=n.create("DynamicList",{el:".ogx_theater > .list",display:{html:o.display.html,css:"ogx_theater_stage"},key:"id",scroll:!0,mode:"hit",list:i,trigger:!0})}function g(){var e=app.gather(OGX.Stage.NAME);a=[];for(var t=0;t<e.length;t++)e[t].theater&&a.push(e[t])}this.update=()=>{g()},this.show=()=>(d&&(debug(3,"show theater"),i.prepend(l),function(){n.el.trigger(OGX.Theater.SHOW);var e,a=app.getStage();n.observe(!0,{childList:!0},(function(t){n.observe(!1),a.sleep(),e=i.children(".ogx_theater_trans");var r=list.el.find('.ogx_theater_stage[data-ogx-id="'+a.id+'"]').position();e.removeClass("ogx_theater_trans_hide"),setTimeout((()=>{e.on("transitionend",(function(){e.off("transitionend"),setTimeout((()=>{e.remove()}),0)})),e.addClass("ogx_theater_trans_show").addClass("ogx_theater_trans_shrink").css({opacity:0,width:o.icon_size+"px",height:o.icon_size+"px",transform:"translate3d("+r.left+"px, "+r.top+"px, 0px)"})}),o.timeout)}),null,i),i.append('<div class="ogx_theater_trans ogx_theater_trans_hide" data-ogx-id="'+a.id+'"><div class="icon" style="background-image:url(\'/img/'+a.theater.icon+"')\"></div></div>"),t.css("visibility","visible")}(),this.focusNodes(),c(!0),d=!1),this),this.hide=()=>(d||(debug(3,"hide theater"),this.blurNodes(),l=t.detach(),c(!1),d=!0),this),this.tile=(e,t)=>{void 0===t&&(t="x")},void 0!==OGX.DynamicList?(OGX.Data.merge(o,r),o.display&&("object"!=typeof o.display&&(o.display={}),OGX.Data.merge(o.display,s),o.display.template&&(o.display.html=OGX.Templater.get(o.display.template))),(t=n.el).addClass("ogx_theater").css("visibility","hidden"),i=$("body"),"undefined"!=typeof app?(g(),$(document).on(OGX.App.READY,h),debug(5,"theater init")):debug(1,"No instance of OGX.App!")):debug(1,"OGX.DynamicList not found! ")},OGX.Theater.ZOOM="TheaterZoom",OGX.Theater.SHOW="TheaterShow",OGX.Theater.HIDE="TheaterHide",OGX.Touch=function(e){"use strict";var t=this,i=0;this.touch=!1,this.touch||this.initTouch(e.chromeos);var a=new OGX.List;this.touch.add=(e,n)=>{var o=new OGX.Touches[e](t),r=o.set(n);return!r.hasOwnProperty("id")&&(r.id=i++),o.id=r.id,"auto"===r.state&&!t.blured&&t.enabled&&o.enable(),a.insert(o),o},this.touch.remove=e=>{"object"==typeof e&&(e=e.id),a.findDelete("id",__id,1).disable()},this.touch.get=e=>a.get({id:{eq:e}},null,1),this.touch.wipe=()=>{for(var e=0;e<a.length;e++)a[e].disable();a.clear()},this.touch.isRightClick=e=>{var i=t.event(e),a=!1;return i.which?a=3===i.which:i.button&&(a=2===i.button),a},this.touch.enable=()=>{for(var e=a.get({state:{eq:"manual"}}),t=0;t<e.length;t++)e[t].enable()},this.touch.disable=()=>{for(var e=a.get({state:{eq:"manual"}}),t=0;t<e.length;t++)e[t].disable()}},OGX.Touch.prototype.initTouch=function(e){void 0===e&&(e=!1),this.touch={hold:{}},this.touch.click="click",this.touch.down="mousedown",this.touch.up="mouseup",this.touch.move="mousemove",void 0===window.ontouchstart||e||(this.touch.down="touchstart",this.touch.up="touchend",this.touch.move="touchmove")},OGX.Touch.prototype.touchable=function(){return void 0!==window.ontouchstart},OGX.Touch.prototype.event=function(e){return e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e},OGX.Touches={},OGX.Touches.Double=function(e){"use strict";var t,i=this,a=e,n={delay:180,target:!1,capture:!1,cb:!1,state:"auto"},o=!1,r=!1,s=$("body"),l=null,d=null,c=0;function u(e){e?s.on(a.touch.down,t,f):s.off(a.touch.down,t,f)}function h(){i.enable(),l&&l()}function g(){i.disable(),d&&d()}function f(){var e=(new Date).getTime();if(c&&!(e-c>o.delay))return e-c<=o.delay?(c=0,void(o.cb&&o.cb())):void(c=e);c=(new Date).getTime()}this.set=e=>(o=e,OGX.Data.merge(o,n),t=a.selector,this.state=o.state,o.target&&(t=o.target),"auto"===o.state&&(l=a.onFocus,d=a.onBlur,a.onFocus=h,a.onBlur=g),o),this.enable=()=>{!r&&o&&(r=!0,u(!0))},this.disable=()=>{r&&(r=!1,u(!1))}},OGX.Touches.Swipe=function(e){"use strict";var t,i=this,a=e,n={speed:10,x:!0,y:!1,min_x:100,min_y:100,cb_down:!1,cb_swipe:!1,cb_up:!1,target:!1,capture:!1,state:"auto"},o=!1,r={x:0,y:0},s={x:0,y:0},l=0,d=0,c=0,u=0,h=0,g=!1,f=!1,p=!1,_=null,m=null,v=$("body");function y(){i.enable(),_&&_()}function x(){i.disable(),m&&m()}function O(e){p||(p=!0,e=a.event(e),r.x=e.pageX,r.y=e.pageY,r.target=e.target,c=u=0,l=d=h=0,b(!0),o.cb_down&&o.cb_down(r))}function b(e){e?(w(!0),g=setInterval(D,o.speed)):(w(!1),g&&(clearInterval(g),g=!1))}function w(e){e?$(t).on(a.touch.move,T):$(t).off(a.touch.move,T)}function G(e){e?(v.on(a.touch.up,X),v.on(a.touch.down,t,O)):(v.off(a.touch.up,X),v.off(a.touch.down,t,O))}function X(e,t){f&&(void 0===t&&(t=!1),b(!1),p&&o.cb_up&&o.cb_up({pt0:r,pt1:s,distX:c,distY:u,dist:h,dirX:l,dirY:d,swipe:t}),p=!1)}function T(e){o.capture&&(e.preventDefault(),e.stopImmediatePropagation()),e=a.event(e),s.x=e.pageX,s.y=e.pageY,l=s.x>r.x?1:-1,d=s.y>r.y?1:-1,c=Math.abs(s.x-r.x),u=Math.abs(s.y-r.y),h=Math.sqrt(Math.abs(Math.pow(s.x-r.x,2)-Math.pow(s.y-r.y,2)))}function D(){o.cb_swipe&&(o.x&&o.min_x&&c>=o.min_x||o.y&&o.min_y&&u>=o.min_y?X(0,!0):o.cb_swipe({pt0:r,pt1:s,dirX:l,dirY:d,distX:c,distY:u,dist:h}))}this.set=e=>(o=e,OGX.Data.merge(o,n),t=a.selector,this.state=o.state,"auto"===o.state&&(_=a.onFocus,m=a.onBlur,a.onFocus=y,a.onBlur=x),o.target&&(t=o.target),o),this.enable=()=>{!f&&o&&(f=!0,G(!0))},this.disable=()=>{f&&(f=!1,G(!1),b(!1))}},OGX.Touches.Hold=function(e){"use strict";var t=this,i={cb_hold:!1,cb_up:!1,cb_move:!1,time:1e3,el:this.el,target:!1,capture:!1,parent:null,state:"auto"},a=!1,n=!1,o=!1,r=!1,s=!1,l=!1,d=e,c={x:0,y:0},u={x:0,y:0},h={x:0,y:0},g={x:0,y:0},f=null,p=null,_=null,m=$("body");function v(){t.enable(),p&&p()}function y(){t.disable(),_&&_()}function x(e){var t=[];e?a.parent?a.parent.on.apply(a.parent,[d.touch.down,O]):(t=a.target?[d.touch.down,a.target,O]:[d.touch.down,O],d.el.on.apply(d.el,t)):a.parent?a.parent.off.apply(a.parent,[d.touch.down,O]):(t=a.target?[d.touch.down,a.target,O]:[d.touch.down,O],d.el.off.apply(d.el,t))}function O(e){e=d.event(e),f=e.currentTarget,r||(r=!0,n=(new Date).getTime(),g.x=c.x=e.pageX,g.y=c.y=e.pageY,o=setInterval(w,1))}function b(e){a.capture&&(e.preventDefault(),e.stopImmediatePropagation()),e=d.event(e),u.x=e.pageX,u.y=e.pageY,u.x<g.x?h.x=-1:h.x=1,u.y<g.y?h.y=-1:h.y=1,0===u.x&&(h.x=0),0===u.y&&(h.y=0),g.x=u.x,g.y=u.y,s?a.cb_move&&a.cb_move({x:u.x,y:u.y,distX:u.x-c.x,distY:u.y-c.y,dirX:h.x,dirY:h.y}):(Math.abs(c.x-u.x)>5||Math.abs(c.y-u.y)>5)&&(clearInterval(o),o=!1)}function w(){r&&(new Date).getTime()-n>a.time&&(s||(s=!0,m.on(d.touch.move,b),a.cb_hold?a.cb_hold(f,c):d.el.trigger(OGX.Touch.HOLD_START)))}function G(t){t=e.event(t),r=!1,clearInterval(o),o=!1,s&&(s=!1,m.off(d.touch.move,b),a.cb_up?a.cb_up({x:t.pageX,y:t.pageY}):d.el.trigger(OGX.Touch.HOLD_END,{x:t.pageX,y:t.pageY}))}this.set=e=>(a=e,OGX.Data.merge(a,i),d.selector,this.state=a.state,"auto"===a.state&&(p=d.onFocus,_=d.onBlur,d.onFocus=v,d.onBlur=y),a.target&&a.target,a),this.enable=()=>{!l&&a&&(l=!0,x(!0),m.on(d.touch.up,G))},this.disable=()=>{l&&(l=!1,(r||o)&&(s=!1,r=!1,clearInterval(o),o=!1),x(!1),m.off(d.touch.up,G),m.off(d.touch.move,b))}},OGX.Touches.Drag=function(e){"use strict";var t,i,a,n,o,r,s=this,l=!1,d={min:10,x:!0,y:!0,limit_x:null,limit_y:null,target:!1,cb_down:!1,cb_drag:!1,cb_up:!1,border:10,capture:!1,parent:null,state:"auto"},c=e,u=!1,h=!1,g=null,f=null,p=$("body");function _(){s.enable(),g&&g()}function m(){s.disable(),f&&f()}function v(e){var t=[];e?l.parent?l.parent.on.apply(l.parent,[c.touch.down,y]):(t=l.target?[c.touch.down,l.target,y]:[c.touch.down,y],c.el.on.apply(c.el,t)):l.parent?l.parent.off.apply(l.parent,[c.touch.down,y]):(t=l.target?[c.touch.down,l.target,y]:[c.touch.down,y],c.el.off.apply(c.el,t))}function y(s){l.capture&&(s.preventDefault(),s.stopImmediatePropagation()),s=e.event(s),a=s.pageX,n=s.pageY;var d=c.el.position();t=d.left,i=d.top;var u=c.el.offset(),h=a-u.left,g=n-u.top;if(l.border){if(h<l.border||h>c.el.width()-l.border)return;if(g<l.border||g>c.el.height()-l.border)return}o=0,r=0,x(!0),O(!0),l.cb_down&&l.cb_down({x:a,y:n,target:s.target})}function x(e){e?u||(u=setInterval(G,10)):u&&(clearInterval(u),u=null)}function O(e){e?(p.on(c.touch.move,w),p.on(c.touch.up,b)):(p.off(c.touch.move,w),p.off(c.touch.up,b))}function b(t){x(!1),O(!1),t=e.event(t),l.x&&(o=t.pageX-a),l.y&&(r=t.pageY-n),l.cb_up&&l.cb_up({distX:o,distY:r})}function w(t){l.capture&&(t.preventDefault(),t.stopImmediatePropagation()),t=e.event(t);var i,s=!1;l.x&&(i=t.pageX-a,null!==l.limit_x?i>=l.limit_x.min&&i<=l.limit_x.max&&(l.min?Math.abs(i)>l.min&&(o=i,s=!0):(o=i,s=!0)):l.min?Math.abs(i)>l.min&&(o=i,s=!0):o=i),l.y&&(i=t.pageY-n,null!==l.limit_y?i>=l.limit_y.min&&i<=l.limit_y.max&&(l.min?Math.abs(i)>l.min&&(r=i,s=!0):(r=i,s=!0)):r=i),s&&l.cb_drag&&l.cb_drag({distX:o,distY:r,x:t.pageX,y:t.pageY})}function G(){c.el.css({transform:"translate3d("+(t+o)+"px, "+(i+r)+"px, 0px)"})}this.dragable=!0,this.set=e=>(l=e,OGX.Data.merge(l,d),"auto"===l.state&&(g=c.onFocus,f=c.onBlur,c.onFocus=_,c.onBlur=m),this.state=l.state,l),this.enable=()=>{!h&&l&&(h=!0,v(!0))},this.disable=()=>{h&&(h=!1,v(!1),O(!1),x(!1))}},OGX.Touches.Move=function(e){"use strict";var t,i,a,n,o,r,s,l,d=this,c=!1,u={min:0,x:!0,y:!0,limit_x:null,limit_y:null,target:null,cb_down:null,cb_move:null,cb_up:null,cb_click:null,capture:!1,parent:null,state:"auto"},h=e,g=!1,f=null,p=null,_=$("body");function m(){d.enable(),f&&f()}function v(){d.disable(),p&&p()}function y(e){var t=[];e?c.parent?c.parent.on.apply(c.parent,[h.touch.down,x]):(t=c.target?[h.touch.down,c.target,x]:[h.touch.down,x],h.el.on.apply(h.el,t)):c.parent?c.parent.off.apply(c.parent,[h.touch.down,x]):(t=c.target?[h.touch.down,c.target,x]:[h.touch.down,x],h.el.off.apply(h.el,t))}function x(d){c.capture&&(d.preventDefault(),d.stopImmediatePropagation()),d=e.event(d),t=d.pageX,i=d.pageY,a=0,n=0,o=0,r=0,s=0,l=0,O(!0),c.cb_down&&c.cb_down({target:d.target,x:t,y:i})}function O(e){e?(_.on(h.touch.move,w),_.on(h.touch.up,b)):(_.off(h.touch.move,w),_.off(h.touch.up,b))}function b(s){if(O(!1),s=e.event(s),c.x&&(a=s.pageX-t),c.y&&(n=s.pageY-i),c.cb_up&&c.cb_up({x:s.pageX,y:s.pageY,distX:a,distY:n,dirX:o,dirY:r}),c.cb_click){var l=!1;c.x&&Math.abs(a)<2&&(l=!0),c.y&&Math.abs(n)<2&&(l=!0),l&&c.cb_click(s)}}function w(d){c.capture&&(d.preventDefault(),d.stopImmediatePropagation()),d=e.event(d);var u,h=!1;c.x&&(o=0,s<d.pageX?o=1:s>d.pageX&&(o=-1),s=d.pageX,u=d.pageX-t,null!==c.limit_x?u>=c.limit_x.min&&u<=c.limit_x.max&&(c.min?Math.abs(u)>c.min&&(a=u,h=!0):(a=u,h=!0)):c.min?Math.abs(u)>c.min&&(a=u,h=!0):(a=u,h=!0)),c.y&&(r=0,l<d.pageY?r=1:l>d.pageY&&(r=-1),l=d.pageY,u=d.pageY-i,null!==c.limit_y?u>=c.limit_y.min&&u<=c.limit_y.max&&(c.min?Math.abs(u)>c.min&&(n=u,h=!0):(n=u,h=!0)):(n=u,h=!0)),h&&c.cb_move&&c.cb_move({distX:a,distY:n,dirX:o,dirY:r,x:d.pageX,y:d.pageY})}this.set=e=>(c=e,OGX.Data.merge(c,u),"auto"===c.state&&(f=h.onFocus,p=h.onBlur,h.onFocus=m,h.onBlur=v),this.state=c.state,c),this.enable=()=>{!g&&c&&(g=!0,y(!0))},this.disable=()=>{g&&(g=!1,y(!1),O(!1))}},OGX.Touch.HOLD_START="TouchHoldStart",OGX.Touch.HOLD_END="TouchHoldEnd",require("Tree","Uxi","Touch"),OGX.Tree=function(e){construct(this,"Tree");var t,i,a,n,o,r,s,l,d=this,c='<span class="ogx_tree_item_icon"></span><span class="ogx_tree_item_label">{{$label}}</span>',u=e,h={show_root:!0,root_label:"root",editable:!1,sort:{enabled:!0,property:"label",way:1},type:"type",toggle:!0,drag_after:1e3,key:null,scope:["public"],chromeos:!1,types:{root:{mode:"folder",display:{html:c}},file:{mode:"file",display:{html:c}},folder:{mode:"folder",display:{html:c}}},data:{_id:0,type:"root",state:"closed",label:null,items:[]},display:null,callbacks:{select:null,unselect:null,open:null,close:null,move:null}},g="_id",f=0;function p(e,t,i,a,n){return e[g]===n[g]&&t}function _(e,t){var i={container_display:"",container_css:"",arrow_display:"",arrow_style:"ogx_tree_item_arrow_open",state:"open",type:t.type};return i[g]=t[g],OGX.Data.merge(i,e,!0),OGX.Templater.make('<div class="ogx_tree_item" data-id="{{$_id}}" data-state="{{$state}}" data-type="{{$type}}" data-compound="{{$type}}-{{$state}}" data-children="{{!$empty}}"><div class="ogx_tree_item_arrow {{$arrow_style}} {{$arrow_display}}"><span></span></div><div class="ogx_tree_item_content"></div><div class="ogx_tree_item_container {{$container_display}} {{$container_css}}"></div></div>',i)}function m(){var e=_({},u.data);t.html(e),u.data.element=t.children(".ogx_tree_item").first(),u.data.uxi=d,O(u.data,d),u.show_root||u.data.element.addClass("ogx_tree_root_hidden")}function v(){m(),y(u.data,d)}function y(e,t){if(e.parent=t,e.hasOwnProperty("items")){var i,a;!e.items.hasOwnProperty("insert")&&(e.items=new OGX.List(e.items)),u.sort.enabled&&e.items.order(u.sort.property,u.sort.way);for(var n=0;n<e.items.length;n++)a=t,i=k(e.items[n]),x(e.element.children(".ogx_tree_item_container").first(),e.items[n]),O(e.items[n],t),i.display.hasOML()&&(a=t.nodes.last()),y(e.items[n],a)}}function x(e,t){var i=k(t),a={_id:t[g],container_display:"",arrow_display:"",arrow_style:"",state:"open"};t.hasOwnProperty("state")&&(a.state=t.state),t.state=a.state,"folder"===i.mode?(t.hasOwnProperty("items")&&t.items.length?a.empty=!!t.items.length:(a.state="closed",a.arrow_style="ogx_tree_item_arrow_disabled",a.empty=!0),"open"===a.state?a.arrow_style="ogx_tree_item_arrow_open":(a.arrow_style+=" ogx_tree_item_arrow_close",a.container_display="ogx_tree_item_container_hidden",a.state="closed")):a.arrow_display="ogx_tree_item_arrow_hidden";var n=_(a,t);e.append(n),t.element=e.children().last()}function O(e,t){var i=k(e),a='.ogx_tree[data-ogx-id="'+d.id+'"] .ogx_tree_item[data-id="'+e[g]+'"] > .ogx_tree_item_content';if(i.display.hasOML()){var n=i.display.oml(a,e,!1);OGX.OML.render(t,n,e),e.uxi=t.nodes.last()}else{var o=i.display.html(e);o=OGX.Templater.make(o,e),$(a).html(o)}}function b(e){return delete e.element,delete e.parent,delete e.uxi,delete e.state,l||delete e[g],!1}function w(e){"folder"===k(e).mode&&(e.items.length?e.element.attr("data-empty",!1):(e.element.attr("data-state","closed").attr("data-compound",e.type+"-closed").attr("data-empty",!0),e.element.children(".ogx_tree_item_arrow").addClass("ogx_tree_item_arrow_disabled")),"open"===e.state?(e.element.attr("data-state","open").attr("data-compound",e.type+"-open"),e.element.children(".ogx_tree_item_arrow").removeClass("ogx_tree_item_arrow_close").removeClass("ogx_tree_item_arrow_disabled").addClass("ogx_tree_item_arrow_open"),e.element.children(".ogx_tree_item_container").removeClass("ogx_tree_item_container_hidden")):(e.element.attr("data-state","open").attr("data-compound",e.type+"-closed"),e.element.children(".ogx_tree_item_arrow").removeClass("ogx_tree_item_arrow_open").addClass("ogx_tree_item_arrow_close"),e.element.children(".ogx_tree_item_container").addClass("ogx_tree_item_container_hidden")))}function G(){if(s){var e=C(s);e&&e.children(".ogx_tree_item_content").removeClass("ogx_tree_selected_item"),s=null}}function X(){return!!s&&E(s)}function T(e){var t=C(e);t&&(s=e,t.children(".ogx_tree_item_content").addClass("ogx_tree_selected_item"))}function D(e,t){return L((function(i){return i[g]===t&&(i.hasOwnProperty("items")||(i.items=new OGX.List),!i.items.hasOwnProperty("insert")&&(i.items=new OGX.List(i.items)),i.items.push(e),i.state="open",w(i),!0)}))}function E(e){if(!e||"root"===e)return u.data;return L((function(t,i){return t[g]===e&&t}))}function C(e){var t=E(e);return!!t&&t.element}function S(){f=1,L((function(e){return e[g]=f++,e.hasOwnProperty("type")||(e.hasOwnProperty("items")?e.type="folder":e.type="file"),!1}))}function L(e,t,i){var a;return void 0===t&&(t=null),void 0===i&&(i=u.data),(a=function i(n,o,r,s){if(a=e(n,o,r,s,t))return a;if(n.hasOwnProperty("items")&&n.items.length)for(var l=0;l<n.items.length;l++)if(a=i(n.items[l],o+"/"+n.label,n,l))return a;return!1}(i,""))||i}function k(e){return!!u.types.hasOwnProperty(e.type)&&u.types[e.type]}function M(e){var i,a,n;i=E(f=e.data("id")),a="root"===(n=i).type?"":L(p,n),u.toggle?e.children(".ogx_tree_item_content").hasClass("ogx_tree_selected_item")?G():(G(),e.children(".ogx_tree_item_content").addClass("ogx_tree_selected_item"),s=f):(G(),s=f,e.children(".ogx_tree_item_content").addClass("ogx_tree_selected_item")),d.onSelect({path:a,item:i}),t.trigger(OGX.Tree.SELECT,{path:a,item:i})}function N(e){e?(u.editable?(t.on(d.touch.down,".ogx_tree_item > .ogx_tree_item_content",(function(e){e.preventDefault(),M($(this).parent(0)),1!==$(this).parent(0).data("id")&&function(){o&&clearInterval(o);r=(new Date).getTime(),o=setInterval(I,50)}()})),$(document).on(d.touch.up,(function(){P(),a&&(A(!1),function(){var e=a.offset().left,o=a.offset().top,r=(l=e,c=o,L((function(e,t){return u=e.element.offset(),h=e.element.children(".ogx_tree_item_content").children(".ogx_tree_item_icon"),l>=u.left&&l<=u.left+h.width()&&c>=u.top&&c<=u.top+h.height()&&e}))),s=k(r);var l,c,u,h;!r||r&&(r[g]===i[g]||"folder"!==s.mode)?(n.css("opacity",1),a.remove(),a=null,i=null):(p=r,function(e){L((function(t,i,a,n){return t[g]===e&&(a.items.splice(n,1),a.items.length||(a.state="closed"),w(a),!0)}))}((f=i)[g]),D(f,p[g]),p.element.children(".ogx_tree_item_container").empty(),p.state="open",y(p,p.element),w(p),n.remove(),a.remove(),a=null,d.onMove(i),t.trigger(OGX.Tree.DROP,i),i=null);var f,p}())}))):t.on("click",".ogx_tree_item > .ogx_tree_item_content",(function(e){M($(this).parent(0))})),t.on(d.touch.down,".ogx_tree_item_arrow",(function(e){e.preventDefault(),P();var i=E($(this).parent(0).data("id"));i&&i.hasOwnProperty("items")&&i.items.length&&("open"===i.state?(d.onClose(i),t.trigger(OGX.Tree.CLOSE,i)):(d.onOpen(i),t.trigger(OGX.Tree.OPEN,i)),"open"===i.state?i.state="closed":i.state="open",w(i))}))):(u.editable?t.off(d.touch.down,".ogx_tree_item > .ogx_tree_item_content"):t.off("click",".ogx_tree_item > .ogx_tree_item_content"),t.off(d.touch.down,".ogx_tree_item_arrow"))}function I(){var e;(new Date).getTime()-r>=u.drag_after&&(s&&(i=E(s))&&(e=i.element,n=e,(a=e.clone()).children(".ogx_tree_item_arrow").css("display","none"),e.css("opacity",.3),a.addClass("ogx_tree_item_drag"),a.css({top:e.offset().top,left:e.offset().left}),t.prepend(a),A(!0),t.trigger(OGX.Tree.DRAG,i)),P())}function A(e){e?$(document).on(d.touch.move,(function(e){e=function(e){if(e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches)return e.originalEvent.changedTouches[0];return e}(e),a.css({top:e.pageY+"px",left:e.pageX+"px"})})):$(document).off(d.touch.move)}function P(){o&&(clearInterval(o),o=null)}this.onFocus=()=>(N(!0),debug(5,"tree",u.id,"enabled"),this),this.onBlur=()=>(N(!1),debug(5,"tree",u.id,"disabled"),this),this.onSelect=()=>{},this.onUnselect=()=>{},this.onOpen=()=>{},this.onClose=()=>{},this.onMove=()=>{},this.addItem=(e,t)=>{if(void 0===t&&(t=s),t){var i=E(t);if("folder"===k(i).mode){l||(e[g]=++f),D(e,t);var a=k(e);x(i.element.children(".ogx_tree_item_container").first(),e),O(e,i.parent);var n=i.uxi;return a.display.hasOML()&&(n=i.uxi.nodes.last()),y(e,n),i.element.data("state","open"),i.element.data("compound",e.type+"-close"),i.element.children(".ogx_tree_item_container").removeClass("ogx_tree_item_container_hidden"),i.element.children(".ogx_tree_item_arrow").removeClass("ogx_tree_item_arrow_disabled ogx_tree_item_arrow_close").addClass("ogx_tree_item_arrow_open"),!0}}return!1},this.getItem=e=>{var t,i,a=E(e);return!!a&&(t=a,i={},OGX.Data.merge(i,t),b(i),i)},this.selectItem=e=>(T(e),X()),this.selectItemByPropVal=(e,t)=>{var i=function(e,t){function i(i,a){return!(!i.data.hasOwnProperty(e)||i.data[e]!==t)&&a+"/"+i.label}return L(i)}(e,t);return!!i&&(G(),T(i[g]),X())},this.selectItemByPath=e=>{var t=function(e){var t=function(e){function t(t,i){return e===i+"/"+t.label&&t}return L(t)}(e);if(t)return t.element;return!1}(e);return!!t&&(G(),t.children(".ogx_tree_item_content").addClass("ogx_tree_selected_item"),s=t.data("id"),X())},this.updateItem=(e,t,i)=>{void 0===i&&(i=!0);var a=E(e);if(a){if(a.uxi){var n=a.uxi.el;a.uxi.kill(),n.empty()}else i&&a.element.children(".ogx_tree_item_container").empty();OGX.Data.merge(a,t,!0),O(a,a.parent),i&&a.hasOwnProperty("items")&&a.items.length&&(y(a,a.parent),a.element.children(".ogx_tree_item_arrow").removeClass("ogx_tree_item_arrow_disabled ogx_tree_item_arrow_close").addClass("ogx_tree_item_arrow_open"),a.element.attr("state","open").attr("state",a.type+"-open"))}},this.replaceItem=e=>{var t=E(e[g]);t&&(t.uxi&&t.uxi.kill(),OGX.Data.merge(e,t,!1),O(t,t.parent),t.hasOwnProperty("items")&&t.items.length&&y(t,t.parent))},this.deleteItem=e=>{var t=E(e);if(t){var i=function(e){function t(t){return!(!t.hasOwnProperty("items")||!t.items.get({_id:{eq:e}},null,1))&&t}return L(t)}(e);return t.uxi&&t.uxi.kill(),i.items.findDelete("_id",e,1),t.element.remove(),i.items.length||(i.state="closed"),w(i),t}},this.deleteSelectedItem=()=>function(){function e(e,t,i,a){if(e[g]===s)return e.element.remove(),i.items.splice(a,1),w(i),!0}if(s)return L(e);return!1}(),this.getSelectedItem=()=>X(),this.getTree=()=>{var e=L(b,null,OGX.Data.clone(u.data));return e||!1},this.setData=e=>{e.hasOwnProperty("types")&&this.setTypes(e.types),e.hasOwnProperty("tree")&&this.setTree(e.tree)},this.setTypes=e=>{u.types=e},this.setTree=e=>{this.scroll?this.clear([this.scroller.id]):this.clear(),u.data=e,u.data.hasOwnProperty("state")||(u.data.state="open"),l||S(),v()},this.newTree=function(){d.scroll?d.clear([d.scroller.id]):d.clear();f=0,m()},this.filterTree=function(e){var t=[];(function i(a,n,o,r){if(-1!==(n+a.label).indexOf(e)&&t.push(n+"/"+a.label),a.hasOwnProperty("items")&&a.items.length)for(var s=0;s<a.items.length;s++)i(a.items[s],n+"/"+a.label,a,s)})(u.data,"")},void 0!==OGX.Templater?(function(){if(OGX.Data.merge(u,h),(t=d.el).addClass("ogx_tree"),Array.isArray(u.data)){var e=new OGX.List(OGX.Data.clone(u.data));u.data={_id:0,type:"root",data:{label:u.root_label},display:null,items:e}}u.callbacks.select||(u.callbacks.select=d.onSelect),u.callbacks.unselect||(u.callbacks.unselect=d.onUnselect),u.callbacks.open||(u.callbacks.open=d.onOpen),u.callbacks.close||(u.callbacks.close=d.onClose),u.callbacks.move||(u.callbacks.move=d.onMove)}(),function(){for(var e in u.types.hasOwnProperty("root")||(u.types.root=h.types.root),u.types)u.types[e].hasOwnProperty("display")||(u.types[e].display={html:c}),u.types[e].display.hasOwnProperty("html")&&u.types[e].display.html||(u.types[e].display.html=c),u.types[e].display=new OGX.Display(u.types[e].display)}(),u.key?(g=u.key,l=!0):(l=!1,S()),u.data&&v(),debug(5,"tree",u.id,"init")):debug(1,"OGX.Templater not found! ")},OGX.Tree.SELECT="TreeSelect",OGX.Tree.UNSELECT="TreeUnselect",OGX.Tree.OPEN="TreeOpen",OGX.Tree.CLOSE="TreeClose",OGX.Tree.DRAG="TreeDrag",OGX.Tree.DROP="TreeDrop",void 0===OGX)var OGX={};if(require("TreedList","Uxi"),OGX.TreedList=function(e){construct(this,"TreedList");var t=this,i={renderer:"Tree",list:new OGX.List,types:null,display:null,displays:null,group_by:null,group_mode:null,group_param:null},a=e,n=null,o=null;function r(){switch(s(a.list),a.renderer){case"Tree":i={el:a.el,data:undefined},a.types&&(i.types=a.types),i.tree=function(){var e={type:"root",label:"root",state:"open",items:[]};function t(e,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)e[a].type="file";i.items=e}else for(var n in e)i.items.push({type:"folder",label:n,state:"open",items:[]}),t(e[n],i.items[i.items.length-1])}return t(n,e),e}(),o=t.create(a.renderer,i);break;case"StackedTree":(i=function(){var e={display:!1,displays:!1};a.display&&a.display.hasOwnProperty("bind")?(e.display=OGX.Data.clone(a.display),e.displays=OGX.Data.clone(a.displays)):(e.display={bind:"__type"},e.displays={__default:OGX.Data.clone(a.display)},"object"==typeof e.displays.__default.css?e.displays.__default.css.hasOwnProperty("add")?e.displays.__default.css.add+=" ogx_stacked_tree_item":e.displays.__default.css.add="ogx_stacked_tree_item":e.displays.__default.css={add:e.displays.__default.css+" ogx_stacked_tree_item"});for(var t=0;t<a.group_by.length;t++)grp=a.group_by[t],e.displays[grp]={html:"{{$label}}",css:"ogx_stacked_tree_item"};return e}()).el=a.el;var e=function(){var e={data:[]};function t(e,i,n,o){var r;if(Array.isArray(e)){for(var s=0;s<e.length;s++)e[s].hasOwnProperty("scope")||(e[s].scope=["public"]);i.items=e}else for(var l in e)r={label:l,__type:a.group_by[o],scope:["public"],items:[]},n?(i.data.push(r),t(e[l],i.data[i.data.length-1],!1,o+1)):(i.items.push(r),t(e[l],i.items[i.items.length-1],!1,o+1))}return t(n,e,!0,0),e}();i.list=e.data,a.hasOwnProperty("id")&&(i.id=a.id+"_stacked"),o=t.create(a.renderer,i);break;case"RouletteTree":var i;(i=OGX.Data.clone(a)).hasOwnProperty("id")&&(i.id=i.id+"_roultree"),i.data=n;for(var r=[],l=0;l<a.group_by.length;l++)r.push(a.group_by[l].split(".").pop());i.groups=r,o=t.create(a.renderer,i)}}function s(e,t,i,o){a.list=e,void 0!==t&&(a.group_by=t),void 0!==i&&(a.group_mode=i),void 0!==o&&(a.group_param=o),n=a.list.group(a.group_by,a.group_mode,a.group_param)}this.val=(e,t,i,a)=>void 0!==e?(s(e),n):n,this.getRenderer=()=>o,this.getTree=()=>n,function(){if(void 0!==OGX.List){switch(a&&void 0!==a||(a={}),OGX.Data.merge(a,i),a.list.hasOwnProperty("insert")||(a.list=new OGX.List(a.list)),t.el.addClass("ogx_treedlist"),a.renderer){case"StackedTree":if(void 0===OGX.StackedTree)return void debug(1,"OGX.StackedTree not found! ");break;case"Tree":if(void 0===OGX.Tree)return void debug(1,"OGX.Tree not found! ");break;case"RouletteTree":if(void 0===OGX.RouletteTree)return void debug(1,"OGX.RouletteTree not found! ")}r(),debug(5,"treedlist",a.id,"init")}else debug(1,"OGX.List not found! ")}()},void 0===OGX)var OGX={};if(require("Uxi","Overlay","Loading"),OGX.Uxi=function(e){construct(this,"Uxi"),this.el=null,this.id=null,this.name=null,this.sleeping=!1,this.blured=!0,this.floating=!1,this.scroll=!1,this.scroller=null,this.enabled=!0,this.always_on=!1,this.visible=!1,this.nodes=new OGX.List,this.points={},this.observer=!1,this.parent=null,this.floats=null,this.group=null,this.always_on=null,this.selector=null,this.title=null,this.data=null,config_default={id:(new Date).getTime()+""+Math.round(1e3*Math.random()),title:"",el:!1,css:""},void 0===e&&(e={}),OGX.Data.merge(e,config_default,!1),OGX.Data.merge(this,e,!0,!1,!0);var t="#"===this.id.substr(0,1);if(t&&(this.id=this.id.substr(1)),this.selector='.ogx_uxi[data-ogx-id="'+this.id+'"]',e.el){var i=$(e.el),a="ogx_uxi "+e.css,n='<div class="'+a+'" data-ogx-id="'+this.id+'"';if(t&&(n+=' id="'+this.id+'"'),n+="></div>",e.scroll){this.scroller=this.create("Scroller",{id:this.id+"_scroller",el:e.el}),e.el='.ogx_uxi[data-ogx-id="'+this.id+'_scroller"] > .ogx_scroller_inner',(i=$(e.el)).addClass(a).attr("data-ogx-id",this.id),t&&i.attr("id",this.id);var o=this;setTimeout((()=>{o.scroller.resize()}),0)}else i.append(n),e.el='.ogx_uxi[data-ogx-id="'+this.id+'"]';this.el=$(e.el)}},OGX.Uxi.prototype.enable=function(e){return this.enabled||(this.enabled=!0,this.focus(e)),this},OGX.Uxi.prototype.disable=function(e){return this.enabled&&(this.enabled=!1,this.blur(e)),this},OGX.Uxi.prototype.ux=function(){},OGX.Uxi.prototype.onFocus=function(){},OGX.Uxi.prototype.onBlur=function(){},OGX.Uxi.onFocus=function(){},OGX.Uxi.onBlur=function(){},OGX.Uxi.prototype.construct=function(){},OGX.Uxi.prototype.destroy=function(){},OGX.Uxi.prototype.resize=function(e){return void 0===e&&(e=!1),e&&this.resizeNodes(),this},OGX.Uxi.prototype.show=function(){return this._show()},OGX.Uxi.prototype.hide=function(){return this._hide()},OGX.Uxi.prototype._show=function(){return this.el&&(this.visible=!0,this.el.removeClass("ogx_uxi_hidden")),this},OGX.Uxi.prototype._hide=function(){return this.el&&(this.visible=!1,this.el.addClass("ogx_uxi_hidden")),this},OGX.Uxi.prototype.render=function(e,t){return debug(2,"Uxi.render has been deprecated, use OGX.OML.render instead"),OGX.OML.render(this,e,t),this},OGX.Uxi.prototype.empty=function(){return this.clear(),this},OGX.Uxi.prototype.observe=function(e,t,i,a,n){var o=this,r=this.el,s=null;if(void 0!==n&&(r=n),e){if(!this.observer)return void 0!==t&&t||(t={childList:!0,subtree:!0}),this.observer=new MutationObserver((function(e,t){e.forEach((function(e){s&&clearTimeout(s),s=setTimeout((()=>{void 0!==i?i(e,a):o.el.trigger(OGX.View.CHANGED,e)}),10)}))})),this.observer.observe(r[0],t),!0}else if(this.observer)return this.observer.disconnect(),this.observer=null,!0;return!1},OGX.Uxi.prototype.observeOnce=function(e,t,i,a){var n=this;this.observe(!0,e,(function(){n.observe(!1),void 0!==t&&t(i)}),null,a)},OGX.Uxi.prototype.sleep=function(){return this.sleeping||(this.blur(2),this.sleeping=!0,this.scroll?(this.__parent=this.el.parents(".ogx_scroller_outer").first().parent(0),this.el=this.__parent.children(".ogx_scroller_outer").first().detach()):(this.__parent=this.el.parent(0),this.el=this.el.detach())),this},OGX.Uxi.prototype.wake=function(e){return e=void 0===e?this.__parent:$(e),this.sleeping&&(this.sleeping=!1,e.prepend(this.el),this.el=e.find('.ogx_uxi[data-ogx-id="'+this.id+'"]').first(),this.focus(2),delete this.__parent),this},OGX.Uxi.prototype.detach=function(){return this.sleep(),this.parent.nodes.findDelete("id",this.id,1),this},OGX.Uxi.prototype.attach=function(e,t){return this.parent=e,this.parent.nodes.insert(this),this.selector=t,this.wake(t),setTimeout((()=>this.resize),0),this},OGX.Uxi.prototype.resizeNodes=function(){for(var e=this.gather(),t=0;t<e.length;t++)"function"==typeof e[t].resize&&e[t].resize();return this},OGX.Uxi.prototype.kill=function(){debug(5,"destroy",this._NAME_,this.id),OGX.Object.destroy(this)},OGX.Uxi.prototype.reveal=function(e){var t=this.path();if(t){for(var i=0;i<t.length;i++)i>0&&"Carousel"===t[i]._NAME_&&"Container"===t[i-1]._NAME_||(t[i].floating?t[i].show(e):t[i].show(this._NAME_,this.id));return this}},OGX.Uxi.prototype.focus=function(e){if(void 0===e&&(e=1),this.blured)switch(this.blured=!1,this.ux(!0),this.__proto__.onFocus(),this.onFocus(),e){case 1:this.focusNodes();break;case 2:this.focusTree()}return this},OGX.Uxi.prototype.focusTree=function(){for(var e=this.gather(),t=0;t<e.length;t++)"function"==typeof e[t].focus&&e[t].focus(0);return this},OGX.Uxi.prototype.focusNodes=function(){for(var e=0;e<this.nodes.length;e++)"function"==typeof this.nodes[e].focus&&this.nodes[e].enabled&&this.nodes[e].focus(1);return this},OGX.Uxi.prototype.blur=function(e){if(void 0===e&&(e=1),!this.always_on&&!this.blured)switch(this.blured=!0,this.ux(!1),this.__proto__.onBlur(),this.onBlur(),e){case 1:this.blurNodes();break;case 2:this.blurTree()}return this},OGX.Uxi.prototype.blurTree=function(){for(var e=this.gather(),t=0;t<e.length;t++)"function"==typeof e[t].blur&&e[t].blur(0);return this},OGX.Uxi.prototype.blurNodes=function(){for(var e=0;e<this.nodes.length;e++)"function"==typeof this.nodes[e].blur&&this.nodes[e].blur(1);return this},OGX.Uxi.prototype.path=function(){for(var e=new OGX.List,t=this;t&&t.hasOwnProperty("parent");)e.insert(t,0),t=t.parent;return e.shift(),e},OGX.Uxi.prototype.gather=function(e){var t=[],i={_NAME_:{eq:""}};return void 0!==e&&(Array.isArray(e)?i={_NAME_:{regex:new RegExp(e.join("|"))}}:-1!==e.indexOf(".")?(comp=e.split("."),i={_NAME_:{regex:new RegExp(comp[0].slice(0,-1))},_CLASS_:{eq:comp[1]}}):i={_NAME_:{regex:new RegExp(e)}}),function e(a){if(void 0!==a&&void 0!==a.nodes&&a.nodes.length){var n=a.nodes.get(i);n&&(t=t.concat(n));for(var o=0;o<a.nodes.length;o++)void 0!==a.nodes[o]&&void 0!==a.nodes[o].nodes&&a.nodes[o].nodes.length&&(n=e(a.nodes[o]))&&n.length&&(t=t.concat(n[0]))}}(this),new OGX.List(t)},OGX.Uxi.prototype.gatherByName=function(e){var t=[],i={name:{eq:e}};return function e(a){if(void 0!==a&&void 0!==a.nodes&&a.nodes.length){var n=a.nodes.get(i);n&&(t=t.concat(n));for(var o=0;o<a.nodes.length;o++)void 0!==a.nodes[o]&&void 0!==a.nodes[o].nodes&&a.nodes[o].nodes.length&&(n=e(a.nodes[o]))&&n.length&&(t=t.concat(n[0]))}}(this),new OGX.List(t)},OGX.Uxi.prototype.cfind=function(e,t,i){var a={};void 0!==t&&t&&(t instanceof RegExp?a.id={regex:t}:a.id={eq:t}),void 0!==e&&e&&(a._NAME_={eq:e}),void 0===i&&(i=1);var n=OGX.Object.get(a,null,i);return(1===i||!!n.length)&&n},OGX.Uxi.prototype.find=function(e,t,i){void 0===i&&(i=!1);var a={};if(typeof t==typeof e==="undefined")return!1;return void 0!==t&&t&&(t instanceof RegExp?a.id={regex:t}:a.id={eq:t}),void 0!==e&&e&&(a._NAME_={eq:e}),function e(t){var n;if(void 0!==t.nodes&&t.nodes.length){if(n=t.nodes.get(a,null,1)){if(i)switch(i){case"remove":return n.kill(),n}return n}for(var o=0;o<t.nodes.length;o++)if(n=e(t.nodes[o]))return n}return!1}(this)},OGX.Uxi.prototype.children=function(e,t){isNaN(e)||void 0!==t||(t=e,e=null),void 0===t&&(t=0);var i={};return void 0!==e&&e&&(i._NAME_={eq:e}),this.nodes.get(i,null,t)},OGX.Uxi.prototype.parents=function(e,t){isNaN(e)||void 0!==t||(t=e,e=null),void 0===t&&(t=0);var i=function i(a){var n=[];if("App"!==a._NAME_&&a.parent){if(a.parent._NAME_===e&&(n.push(a.parent),t&&n.length===t&&1===t))return n;var o=i(a.parent);return o.length&&(n=n.concat(o)),n}return[]}(this);return 1===t&&i.length?i[0]:new OGX.List(i)},OGX.Uxi.prototype.clear=function(e){debug(5,"uxi clear",this._NAME_,this.id),void 0===e&&(e=null);for(var t=this.gather(),i=0;i<t.length;i++)e&&e.includes(t[i].id)||OGX.Object.destroy(t[i],!1);return debug(5,"uxi cleared",t.length,"nodes"),e||(this.nodes=new OGX.List),this},OGX.Uxi.prototype.add=function(e){e.parent=this,this.nodes.insert(e)},OGX.Uxi.prototype.remove=function(e,t){return this.find(e,t,"remove")},OGX.Uxi.prototype.create=function(e,t){"undefined"==typeof __construct&&(__construct=!0);var i=Array.prototype.slice.call(arguments),a=[];t.hasOwnProperty("data")&&a.push(t.data),a=a.concat(i.splice(0,3)),void 0!==OGX[e]&&OGX[e].hasOwnProperty("FLOAT")&&OGX[e].FLOAT&&(t.parent=this,t.el=this.el[0]);var n=OGX.Object.create(e,t);this.add(n),"function"==typeof n.construct&&n.construct.apply(n,a),t.hasOwnProperty("node:OML")&&OGX.OML.render(n,t["node:OML"]);var o=this.enabled;return(!this.enabled||this.parent&&this.parent.blured||"function"!=typeof n.focus)&&(o=!1),o&&n.focus(),n},OGX.Uxi.prototype.parse=function(e){e=OGX.OML.parse(e),OGX.OML.render(this,e)},OGX.Uxi.prototype.topIndex=function(){var e,t=0;return this.el.find("*").each((function(i,a){e=$(a).css("z-index"),e=Number(e),isNaN(e)||e>t&&(t=e)})),t+1},OGX.Uxi.prototype.stage=function(){return function e(t){if(t.parent)return"Stage"!==t.parent._NAME_?e(t.parent):t.parent}(this)},OGX.Uxi.prototype.on=function(){this.el&&this.el.on.apply(this.el,arguments)},OGX.Uxi.prototype.off=function(){this.el&&this.el.off.apply(this.el,arguments)},OGX.Uxi.prototype.toJSON=function(){return{type:this._NAME_,id:this.id,selector:this.selector,data:this.data}},OGX.Uxi.prototype.toOML=function(){var e={},t=this.selector+":"+this._NAME_;if(e[t]={id:this.id,data:this.data,"node:OML":[]},this.nodes.length)for(var i=0;i<this.nodes.length;i++)e[t]["node:OML"].push(this.nodes[i].toOML());return e},OGX.Uxi.prototype.filter=function(e){if(!this.data)return!1;var t=this.data;return Array.isArray(t)||(t=new OGX.List(t)),t.get(e)},require("View","Uxi","Template","Placeholder","Touch"),OGX.View=function(e){construct(this,"View");var t=this,i=!1,a=e;this.__proto__.onFocus=function(){return a.observe&&this.observe(!0),this},this.__proto__.onBlur=function(){return a.observe&&this.observe(!1),this},this.container=()=>i,this.render=e=>(void 0===e?a.hasOwnProperty("html")&&a.html&&i.html(a.html):i.html(e),i.trigger(OGX.View.RENDER),this),(i=t.el).addClass("ogx_view ogx_hw"),t.render()},OGX.View.prototype.toOML=function(){var e={};return e[this.selector+":Views."+this._CLASS_]={data:this.data},e},OGX.View.CHANGED="ViewChanged",OGX.View.RENDER="ViewRender",require("Window","Uxi","Placeholder","Touch","Resize"),OGX.Window=function(__config){construct(this,"Window");var that=this,container=!1,config_default={anim:!1,resize:!1,drag:!0,show:!1,width:"100%",height:"100%",min_width:100,min_height:100,max_width:0,max_height:0,head:OGX.Window.HEAD_BACK,icons:[],title:"",win_html:'<div class="ogx_window_head ogx_window_head_{{$head}} ogx_window_head_{{$side}}">$INNER</div><div class="ogx_window_body">{{$html}}</div>',win_inner:['<span class="ogx_window_main_{{$head}} ogx_window_main_icon"></span>','<span class="ogx_window_title">{{$title}}</span>','<span class="ogx_window_icons">$ICONS</span>'],zindex:!1,close_on_click_out:!1,close_dist:100,parent:null},config=__config,pt={x:null,y:null},dir={x:0,y:0},showto=50,user_resized=!1,zd,touch_drag;function genIcons(){for(var e="",t=0;t<config.icons.length;t++)e+='<div class="ogx_window_icon" style="background-image:url(\''+("string"==typeof config.icons[t]?config.icons[t]:config.icons[t].icon)+"')\"></div>";return e}function listenBackIcon(e){e?that.el.on(that.touch.down,".ogx_window_main_back",onBack):that.el.off(that.touch.down,".ogx_window_main_back",onBack)}function onBack(e){e.preventDefault(),e.stopImmediatePropagation(),that.el.trigger(OGX.Window.HIT_BACK,that),that.hide()}function listenIcons(e){e?that.el.on(that.touch.down,".ogx_window_icon",onIcon):that.el.off(that.touch.down,".ogx_window_icon",onIcon)}function onIcon(e){e.preventDefault(),e.stopImmediatePropagation();var t=$(this).index();if("string"==typeof config.icons[t])that.el.trigger(OGX.Window.HIT_ICON,{index:t,id:config.id});else{var i=t;config.icons[t].hasOwnProperty("callback")&&config.icons[t].callback&&(config.icons[t].hasOwnProperty("params")&&(i=config.icons[t].params),config.icons[t].callback.call(null,i))}}function onDrag(e){(e.distX*dir.x>config.close_dist||e.distY*dir.y>config.close_dist)&&that.hide()}function onRelease(e){e.distX*dir.x>config.close_dist||e.distY*dir.y>config.close_dist?that.hide():(e.distX||e.distY)&&(config.anim&&(that.el.addClass("ogx_window_anim_in"),that.el.on("transitionend",(function(){that.el.off("transitionend"),that.el.removeClass("ogx_window_anim_in")}))),that.el.css("transform","translate3d("+pt.x+"px, "+pt.y+"px, 0px)"))}function render(){var e=prepWindow();container.html(e),zd=config.zindex?config.zindex:config.parent.topIndex();var t=getLimitedSize();container.css({width:t.width,height:t.height,"z-index":zd})}function getLimitedSize(){var e,t,i,a=config.parent.el.width(),n=config.parent.el.height();user_resized?(a=config.width,n=config.height):(e=OGX.Data.getBestSize(a,config.width),t=OGX.Data.getBestSize(n,config.height));var o={width:e,height:t};return(config.min_width||config.max_width)&&(-1!==config.width.indexOf("%")?(a=config.parent.el.width(),i=Number(config.width.split("%")[0])*a/100,config.min_width&&i<config.min_width?o.width=config.min_width+"px":config.max_width&&i>config.max_width&&(o.width=config.max_width+"px")):(-1!==(i=config.width).indexOf("px")&&(i=Number(i.split("px")[0])),config.min_width&&i<config.min_width?o.width=config.min_width+"px":config.max_width&&i>config.max_width&&(o.width=config.max_width+"px"))),(config.min_height||config.max_height)&&(-1!==config.height.indexOf("%")?(n=config.parent.el.height(),i=Number(config.height.split("%")[0])*n/100,config.min_height&&i<config.min_height?o.height=config.min_height+"px":config.max_height&&i>config.max_height&&(o.height=config.max_height+"px")):(-1!==(i=config.height).indexOf("px")&&(i=Number(i.split("px")[0])),config.min_height&&i<config.min_height?o.height=config.min_height+"px":config.max_height&&i>config.max_height&&(o.height=config.max_height+"px"))),o}function listenBody(e){e?that.parent.el.on(that.touch.down,".ogx_overlay",onBody):that.parent.el.off(that.touch.down,".ogx_overlay",onBody)}function onBody(e){that.status===OGX.Window.OPEN&&(that.hide(),that.parent.removeOverlay(OGX.Overlay.Fade))}function animWindow(e,t,i,a){void 0!==t&&!0!==t||(t=config.anim);var n={opac:1,tX:0,tY:0},o=container.parent().width(),r=container.parent().height(),s=that.el.outerWidth(),l=that.el.outerHeight(),d=that.el.find(".ogx_window_main_icon").first();switch(e&&(placeWindow(!0),d.removeClass("ogx_window_main_icon_left ogx_window_main_icon_right ogx_window_main_icon_top")),t){case OGX.Window.ANIM_NONE:break;case OGX.Window.ANIM_TOP:e?(n.tY=0,d.addClass("ogx_window_main_icon_top")):n.tY=-l-10;break;case OGX.Window.ANIM_BOTTOM:e?(n.tY=0,d.addClass("ogx_window_main_icon_bottom")):n.tY=r+10;break;case OGX.Window.ANIM_RIGHT:e?(n.tX=o-s,d.addClass("ogx_window_main_icon_right")):n.tX=o+10;break;case OGX.Window.ANIM_LEFT:e?(n.tX=0,d.addClass("ogx_window_main_icon_left")):n.tX=-s-10}var c=100;e?(pt.x=n.tX,pt.y=n.tY):c=0,setTimeout((function(){dir.x,that.el.on("transitionend",(function(){that.el.off("transitionend"),e?that.el.removeClass("ogx_window_anim_in").addClass("ogx_window_open"):that.el.removeClass("ogx_window_anim_out ogx_window_open"),"function"==typeof i&&i(a),e?(that.status=OGX.Window.OPEN,that.el.trigger(OGX.Window.OPEN,that)):(that.status=OGX.Window.CLOSED,that.el.trigger(OGX.Window.CLOSED,that))})),e?(that.status=OGX.Window.OPENING,that.el.trigger(OGX.Window.OPENING,that)):(that.status=OGX.Window.CLOSING,that.el.trigger(OGX.Window.CLOSING,that)),config.anim!==OGX.Window.ANIM_NONE&&(e?that.el.addClass("ogx_window_anim_in"):that.el.addClass("ogx_window_anim_out")),that.el.css({transform:"translate3d("+n.tX+"px, "+n.tY+"px, 0px)",opacity:n.opac,visibility:"visible"})}),c)}function placeWindow(e){var t=container.parent().width(),i=container.parent().height(),a=that.el.outerHeight(),n=that.el.outerWidth();that.el.removeClass("ogx_window_anim_in").removeClass("ogx_window_anim_out");var o={x:0,y:0};switch(config.anim){case OGX.Window.ANIM_TOP:o.y=e?-a:a,dir.y=-1;break;case OGX.Window.ANIM_BOTTOM:o.y=e?i:i-a,dir.y=1;break;case OGX.Window.ANIM_RIGHT:o.x=e?t:t-n,dir.x=1;break;case OGX.Window.ANIM_LEFT:e&&(o.x=-n),dir.x=-1}that.el.css({transform:"translate3d("+o.x+"px, "+o.y+"px, 0px)"})}function prepWindow(){var e=new OGX.Display(config),t={};t.head=config.head,t.title=config.title,t.icons=config.icons,t.html=e.html();var i=config.win_html,a="";switch(config.anim){case OGX.Window.ANIM_RIGHT:case OGX.Window.ANIM_TOP:case OGX.Window.ANIM_BOTTOM:a=config.win_inner,t.side="right";break;case OGX.Window.ANIM_LEFT:a=config.win_inner.reverse(),t.side="left"}a=a.toString().replace(/>,</g,"><"),i=i.replace("$INNER",a);var n="";return config.icons&&config.icons.length&&(n=genIcons()),i=i.replace("$ICONS",n),OGX.Templater.make(i,t)}function onResize(){user_resized=!0,that.resizeNodes()}function listenScroll(e){e?(that.el.on(OGX.Scroller.START,(function(){that.onBlur()})),that.el.on(OGX.Scroller.END,(function(){that.onFocus()}))):(that.el.off(OGX.Scroller.START),that.el.off(OGX.Scroller.END))}function initPlaceholders(){that.placeholders(config,['.ogx_window[data-ogx-id="'+that.id+'"] > .ogx_window_body'])}function initDefaults(){OGX.Data.merge(config,app.getDefaults("windows")),OGX.Data.merge(config,config_default),-1!==config.head.indexOf(".")&&(config.head=eval(config.head)),-1!==config.anim.indexOf(".")&&(config.anim=eval(config.anim)),container=that.el,container.addClass("ogx_window"),that.dragable=config.drag,that.resizable=config.resize}function init(){if(initDefaults(),render(),initPlaceholders(),placeWindow(!0),config.drag){var e={state:"manual"},t={top:!1,bottom:!1,left:!1,right:!1,cb_resize:onResize};switch(t.min_width=config.min_width,t.min_height=config.min_width,t.max_width=config.max_width,t.max_height=config.max_height,e.cb_drag=onDrag,e.cb_up=onRelease,config.anim){case OGX.Window.ANIM_LEFT:e.x=!0,e.y=!1,e.limit_x={min:-300,max:0},t.right=!0;break;case OGX.Window.ANIM_RIGHT:e.x=!0,e.y=!1,e.limit_x={min:0,max:300},t.left=!0;break;case OGX.Window.ANIM_TOP:e.x=!1,e.y=!0,e.limit_y={min:-300,max:0},t.bottom=!0;break;case OGX.Window.ANIM_BOTTOM:e.x=!1,e.y=!0,e.limit_y={min:0,max:300},t.top=!0}touch_drag=that.touch.add("Drag",e)}config.resize&&that.setResize(t),config.show&&that.show(),config.scroll&&listenScroll(!0),debug(5,"window",config.id,"init")}this.id=config.id,this.dragable=null,this.resizeable=null,this.status=OGX.Window.CLOSED,this.onFocus=()=>(config.close_on_click_out&&listenBody(!0),config.head&&listenBackIcon(!0),config.icons&&listenIcons(!0),config.drag&&touch_drag.enable(),config.resize&&this.enableResize(),debug(5,"window",config.id,"enabled"),this),this.onBlur=()=>(config.close_on_click_out&&listenBody(!1),config.head&&listenBackIcon(!1),config.icons&&listenIcons(!1),config.drag&&touch_drag.disable(),config.resize&&this.disableResize(),debug(5,"window",config.id,"disabled"),this),this.show=(e,t,i)=>(this.visible||(this._show(),config.drag&&touch_drag.enable(),config.resize&&this.enableResize(),listenScroll(!0),-1===[OGX.Window.OPEN,OGX.Window.OPENING].indexOf(this.status)&&(this.focus(1),this.front(),null==e&&(e=config.anim),setTimeout((()=>{animWindow(!0,e,t,i)}),showto),showto&&(showto=0))),this),this.hide=(e,t,i)=>(this.visible&&(this._hide(),config.drag&&touch_drag.disable(),config.resize&&this.disableResize(),listenScroll(!1),-1===[OGX.Window.CLOSED,OGX.Window.CLOSING].indexOf(this.status)&&(this.blur(1),void 0!==e&&!0!==e||(e=config.anim),animWindow(!1,e,t,i))),this),this.resize=()=>{var e=getLimitedSize();return container.css({width:e.width,height:e.height}),this.place(),this},this.destroy=()=>{config.scroll&&listenScroll(!1),this.touch.wipe()},this.icons=e=>{if(void 0===e)return config.icons;config.icons&&config.icons.length&&listenIcons(!1),config.icons=e,this.el.find(".ogx_window_icons").first().html(genIcons()),listenIcons(!0)},this.front=()=>(zd=config.parent.topIndex(),this.el.css("z-index",zd),this),this.place=()=>{placeWindow(this.status===OGX.Window.CLOSED)},this.drag=e=>{e?config.drag||(config.drag=this.dragable=!0):config.drag&&(config.drag=this.dragable=!1)},init()},OGX.Window.READY="WindowReady",OGX.Window.ANIM_LEFT="left",OGX.Window.ANIM_RIGHT="right",OGX.Window.ANIM_TOP="top",OGX.Window.ANIM_BOTTOM="bottom",OGX.Window.ANIM_NONE="none",OGX.Window.HEAD_BACK="back",OGX.Window.HEAD_CLOSE="close",OGX.Window.HEAD_NONE="none",OGX.Window.CLOSING="WindowClosing",OGX.Window.CLOSED="WindowClosed",OGX.Window.OPENING="WindowOpening",OGX.Window.OPEN="WindowOpen",OGX.Window.HIT_ICON="WindowHitIcon",OGX.Window.HIT_BACK="WindowHitBack",OGX.Window.FLOAT=!0,void 0===OGX)var OGX={};OGX.Workers=function(){"use strict";var e=0,t=new OGX.List;function i(e,t,i,a){var n;if(void 0===t&&(t=null),void 0===i&&(i=!1),void 0===a&&(a=null),"string"==typeof e)n=new Worker(e);else{var o="";if(t){for(var r=0;r<t.length;r++)t[r]=window.location.origin+"/"+t[r];o+="importScripts('"+t.join("','")+"');"}var s="onmessage = function(__e) {";i&&(s+='if(__e.data === "__stop__"){__stop(); return;}',s+='if(__e.data === "__start__"){__start(); return;}'),s+="postMessage(__work.call(null, __e.data));",s+="};",i&&(s+="const __stop = () => {clearInterval(intv);};",s+="const __start = () => {intv = setInterval(() => { postMessage(__work.call(null, "+JSON.stringify(a)+"));}, "+i+"); return;};",s+="__start();");var l=e.toString(),d=/^function ?([\w]+)?/.exec(l);l=d&&void 0!==d[1]?l.replace(d[1],"__work"):l.replace("function","function __work");var c=new Blob([o+l+";"+s],{type:"text/javascript"});n=new Worker(window.URL.createObjectURL(c))}return n}this.get=()=>t,this.add=(a,n,o)=>{void 0===n&&(n=++e);var r=i(a,o);return r.id=n,t.insert(r),n},this.remove=e=>{var i=t.get({id:{eq:e}},null,1);if(!i)return!1;i.terminate(),t.findDelete("id",e,1)},this.call=(e,i,a,n)=>{void 0===a&&(a=null);var o=t.get({id:{eq:e}},null,1);return!!o&&(o.onmessage=function(e){a&&(void 0===n?a(e.data):a(e.data,n))},o.postMessage(i),o)},this.run=(a,n,o,r,s,l,d)=>{if((void 0===n||!n)&&(n=++e),void 0===o&&(o=null),void 0===r&&(r=null),void 0===l&&(l=null),r){var c=i(a,o,r,s);return c.id=n,t.insert(c),c.onmessage=function(e){l&&(void 0===d?l(e.data):l(e.data,d))},n}},this.stop=e=>{var i=t.get({id:{eq:e}},null,1);if(!i)return!1;i.postMessage("__stop__")},this.start=e=>{var i=t.get({id:{eq:e}},null,1);if(!i)return!1;i.postMessage("__start__")}},OGX.Workers=new OGX.Workers;